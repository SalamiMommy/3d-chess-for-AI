2025-12-03 13:34:49,135 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-12-03 13:34:49,136 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 13:34:49,138 - __main__ - INFO - Testing move generation...
2025-12-03 13:34:57,335 - __main__ - INFO - [OK] Generated 2418 moves
2025-12-03 13:34:57,335 - __main__ - INFO - Testing GameState caching...
2025-12-03 13:34:57,336 - __main__ - INFO - [OK] GameState caching works
2025-12-03 13:34:57,336 - __main__ - INFO - Testing MoveCache persistence...
2025-12-03 13:34:57,336 - __main__ - INFO - [OK] MoveCache works correctly
2025-12-03 13:34:57,336 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(2418), 'piece_moves_cache_size': 128, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-12-03 13:34:58,880 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251203_133444/temp_model_for_selfplay.pt
2025-12-03 13:34:58,880 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 6 games, 6 workers
2025-12-03 13:35:01,742 - training.parallel_self_play - INFO - Launching workers...
2025-12-03 13:35:10,504 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-12-03 13:35:14,380 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 13:35:14,381 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139759524684144
2025-12-03 13:35:14,424 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 13:35:14,425 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140245213585152
2025-12-03 13:35:14,440 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 13:35:14,441 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140128528028176
2025-12-03 13:35:14,493 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 13:35:14,494 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139733142425696
2025-12-03 13:35:14,506 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 13:35:14,507 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140655857966944
2025-12-03 13:35:14,525 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 13:35:14,526 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140649356763360
2025-12-03 13:35:15,824 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-12-03 13:35:15,829 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-12-03 13:35:15,829 - InferenceServer - INFO - Server Ready. Listening...
2025-12-03 13:35:37,859 - game3d.game.turnmove - INFO - Move 100: BLACK SWAPPER [1 4 6]->[5 1 5] (Move)
2025-12-03 13:35:38,091 - game3d.game.turnmove - INFO - Move 100: WHITE PAWN [1 5 2]->[1 5 3] (Move)
2025-12-03 13:35:38,695 - game3d.game.turnmove - INFO - Move 100: WHITE SWAPPER [6 4 1]->[4 7 2] (Move)
2025-12-03 13:35:42,997 - game3d.game.turnmove - INFO - Move 200: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-12-03 13:35:43,865 - game3d.game.turnmove - INFO - Move 200: BLACK REFLECTOR [8 0 8]->[2 0 2] (Capture)
2025-12-03 13:35:45,270 - game3d.game.turnmove - INFO - Move 100: BLACK FRIENDLYTELEPORTER [1 2 8]->[3 1 6] (Move)
2025-12-03 13:35:48,195 - game3d.game.turnmove - INFO - Move 100: WHITE PAWN [6 0 3]->[6 0 4] (Capture)
2025-12-03 13:35:52,141 - game3d.game.turnmove - INFO - Move 100: WHITE XZZIGZAG [1 8 7]->[2 8 7] (Capture)
2025-12-03 13:35:53,347 - game3d.game.turnmove - INFO - Move 300: WHITE ROOK [5 5 1]->[5 5 8] (Capture)
2025-12-03 13:35:55,210 - game3d.game.turnmove - ERROR - CRITICAL: Wall move rejected by validation! Move: Move(from_coord=array([8, 2, 2], dtype=int16), to_coord=array([8, 5, 2], dtype=int16), promotion=None). Dest: [8 5 2]. SIZE=9. Wall requires 2x2 space.
2025-12-03 13:35:55,210 - game3d.game3d - ERROR - âŒ MOVE REJECTED - Wall move to [8 5 2] would place part of the wall out of bounds
2025-12-03 13:35:55,210 - worker.1 - ERROR - Worker 1 failed: Wall move to [8 5 2] would place part of the wall out of bounds
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 82, in submit_move
    raise InvalidMoveError(validation_error)
game3d.game3d.InvalidMoveError: Wall move to [8 5 2] would place part of the wall out of bounds
2025-12-03 13:35:56,869 - game3d.game.turnmove - INFO - Move 200: BLACK EDGEROOK [2 8 8]->[8 3 8] (Capture)
2025-12-03 13:35:57,914 - game3d.game.turnmove - INFO - Move 200: WHITE BLACKHOLE [2 0 1]->[3 1 0] (Move)
2025-12-03 13:36:04,789 - game3d.game.turnmove - INFO - Move 200: WHITE QUEEN [0 5 1]->[5 5 6] (Capture)
2025-12-03 13:36:05,245 - game3d.game.turnmove - INFO - Move 200: WHITE ECHO [3 8 0]->[5 8 1] (Capture)
2025-12-03 13:36:07,213 - game3d.game.turnmove - INFO - Move 300: BLACK SPIRAL [0 1 8]->[5 1 3] (Capture)
2025-12-03 13:36:08,628 - game3d.game.turnmove - INFO - Move 400: WHITE ARCHER [6 5 1]->[5 6 1] (Move)
2025-12-03 13:36:12,367 - game3d.game.turnmove - ERROR - CRITICAL: Wall move rejected by validation! Move: Move(from_coord=array([5, 8, 2], dtype=int16), to_coord=array([5, 8, 4], dtype=int16), promotion=None). Dest: [5 8 4]. SIZE=9. Wall requires 2x2 space.
2025-12-03 13:36:12,367 - game3d.game3d - ERROR - âŒ MOVE REJECTED - Wall move to [5 8 4] would place part of the wall out of bounds
2025-12-03 13:36:12,367 - worker.5 - ERROR - Worker 5 failed: Wall move to [5 8 4] would place part of the wall out of bounds
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 82, in submit_move
    raise InvalidMoveError(validation_error)
game3d.game3d.InvalidMoveError: Wall move to [5 8 4] would place part of the wall out of bounds
2025-12-03 13:36:13,715 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-12-03 13:36:13,720 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 429)
2025-12-03 13:36:13,720 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(1,3,4)
2025-12-03 13:36:13,720 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,5,8)
2025-12-03 13:36:13,720 - game3d.game.terminal - WARNING -   - Attackers: ARCHER at (1,3,5)
2025-12-03 13:36:13,723 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 429)
2025-12-03 13:36:13,723 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(1,3,4)
2025-12-03 13:36:13,723 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,5,8)
2025-12-03 13:36:13,723 - game3d.game.terminal - WARNING -   - Attackers: ARCHER at (1,3,5)
2025-12-03 13:36:13,725 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 429)
2025-12-03 13:36:13,725 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(1,3,4)
2025-12-03 13:36:13,726 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,5,8)
2025-12-03 13:36:13,726 - game3d.game.terminal - WARNING -   - Attackers: ARCHER at (1,3,5)
2025-12-03 13:36:13,730 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 429)
2025-12-03 13:36:13,730 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(1,3,4)
2025-12-03 13:36:13,731 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,5,8)
2025-12-03 13:36:13,731 - game3d.game.terminal - WARNING -   - Attackers: ARCHER at (1,3,5)
2025-12-03 13:36:13,734 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 429)
2025-12-03 13:36:13,734 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(1,3,4)
2025-12-03 13:36:13,734 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,5,8)
2025-12-03 13:36:13,734 - game3d.game.terminal - WARNING -   - Attackers: ARCHER at (1,3,5)
2025-12-03 13:36:19,772 - game3d.game.turnmove - INFO - Move 300: BLACK FRIENDLYTELEPORTER [5 3 6]->[4 3 5] (Move)
2025-12-03 13:36:20,670 - game3d.game.turnmove - INFO - Move 300: WHITE SLOWER [1 0 1]->[0 2 1] (Capture)
2025-12-03 13:36:23,122 - game3d.game.turnmove - INFO - Move 400: WHITE WALL [6 6 1]->[6 5 1] (Move)
2025-12-03 13:36:25,753 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-12-03 13:36:25,759 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 438)
2025-12-03 13:36:25,759 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,3,1)
2025-12-03 13:36:25,759 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 13:36:25,759 - game3d.game.terminal - WARNING -   - Attackers: SLOWER at (3,5,7)
2025-12-03 13:36:25,763 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 438)
2025-12-03 13:36:25,763 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,3,1)
2025-12-03 13:36:25,763 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 13:36:25,763 - game3d.game.terminal - WARNING -   - Attackers: SLOWER at (3,5,7)
2025-12-03 13:36:25,766 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 438)
2025-12-03 13:36:25,766 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,3,1)
2025-12-03 13:36:25,766 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 13:36:25,766 - game3d.game.terminal - WARNING -   - Attackers: SLOWER at (3,5,7)
2025-12-03 13:36:25,773 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 438)
2025-12-03 13:36:25,773 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,3,1)
2025-12-03 13:36:25,773 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 13:36:25,773 - game3d.game.terminal - WARNING -   - Attackers: SLOWER at (3,5,7)
2025-12-03 13:36:25,777 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 438)
2025-12-03 13:36:25,777 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,3,1)
2025-12-03 13:36:25,778 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 13:36:25,778 - game3d.game.terminal - WARNING -   - Attackers: SLOWER at (3,5,7)
2025-12-03 13:36:31,529 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-12-03 13:36:31,530 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-12-03 13:36:33,899 - game3d.game.turnmove - INFO - Move 400: BLACK XYQUEEN [4 5 5]->[5 4 4] (Capture)
2025-12-03 13:36:35,813 - game3d.game.turnmove - INFO - Move 400: WHITE KNIGHT31 [5 6 3]->[6 6 6] (Capture)
2025-12-03 13:36:36,455 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: Out-of-bounds coordinates detected in batch_set_positions:
  SIZE=9, valid range=[0, 8]
  Invalid coordinates (2 total): [[4 9 5]
 [3 9 5]]...
  First invalid: [4 9 5] at batch index 4
  Total coordinates in batch: 8
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 252, in make_move
    cache_manager.occupancy_cache.batch_set_positions(changed_coords, pieces_data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 498, in batch_set_positions
    raise ValueError(
    ...<5 lines>...
    )
ValueError: Out-of-bounds coordinates detected in batch_set_positions:
  SIZE=9, valid range=[0, 8]
  Invalid coordinates (2 total): [[4 9 5]
 [3 9 5]]...
  First invalid: [4 9 5] at batch index 4
  Total coordinates in batch: 8
2025-12-03 13:36:36,457 - worker.0 - ERROR - Worker 0 failed: Move execution failed: Out-of-bounds coordinates detected in batch_set_positions:
  SIZE=9, valid range=[0, 8]
  Invalid coordinates (2 total): [[4 9 5]
 [3 9 5]]...
  First invalid: [4 9 5] at batch index 4
  Total coordinates in batch: 8
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 252, in make_move
    cache_manager.occupancy_cache.batch_set_positions(changed_coords, pieces_data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 498, in batch_set_positions
    raise ValueError(
    ...<5 lines>...
    )
ValueError: Out-of-bounds coordinates detected in batch_set_positions:
  SIZE=9, valid range=[0, 8]
  Invalid coordinates (2 total): [[4 9 5]
 [3 9 5]]...
  First invalid: [4 9 5] at batch index 4
  Total coordinates in batch: 8

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: Out-of-bounds coordinates detected in batch_set_positions:
  SIZE=9, valid range=[0, 8]
  Invalid coordinates (2 total): [[4 9 5]
 [3 9 5]]...
  First invalid: [4 9 5] at batch index 4
  Total coordinates in batch: 8
2025-12-03 13:36:41,944 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-12-03 13:36:41,948 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 452)
2025-12-03 13:36:41,948 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 13:36:41,948 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 13:36:41,948 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,5,0)
2025-12-03 13:36:41,950 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 452)
2025-12-03 13:36:41,950 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 13:36:41,950 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 13:36:41,950 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,5,0)
2025-12-03 13:36:41,953 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 452)
2025-12-03 13:36:41,954 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 13:36:41,954 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 13:36:41,954 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,5,0)
2025-12-03 13:36:41,958 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 452)
2025-12-03 13:36:41,959 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 13:36:41,959 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 13:36:41,959 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,5,0)
2025-12-03 13:36:41,962 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 452)
2025-12-03 13:36:41,962 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 13:36:41,962 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 13:36:41,962 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,5,0)
2025-12-03 13:36:42,249 - training.parallel_self_play - INFO - Stopping Server...
2025-12-03 13:36:43,042 - InferenceServer - INFO - Server shutting down.
2025-12-03 13:39:57,656 - __main__ - ERROR - [ERROR] Unexpected error in iteration 0: float division by zero
2025-12-03 13:39:57,656 - __main__ - CRITICAL - [ALERT] TRAINING CRASHED: float division by zero
2025-12-03 13:39:59,382 - __main__ - INFO - Emergency checkpoint saved to model_checkpoints/train_huge_20251203_133444/emergency_checkpoint.pt
2025-12-03 13:39:59,383 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-12-03 13:58:27,798 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-12-03 13:58:27,799 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 13:58:27,800 - __main__ - INFO - Testing move generation...
2025-12-03 13:58:28,638 - __main__ - INFO - [OK] Generated 2418 moves
2025-12-03 13:58:28,638 - __main__ - INFO - Testing GameState caching...
2025-12-03 13:58:28,639 - __main__ - INFO - [OK] GameState caching works
2025-12-03 13:58:28,639 - __main__ - INFO - Testing MoveCache persistence...
2025-12-03 13:58:28,639 - __main__ - INFO - [OK] MoveCache works correctly
2025-12-03 13:58:28,639 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(2418), 'piece_moves_cache_size': 128, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-12-03 13:58:30,287 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251203_135823/temp_model_for_selfplay.pt
2025-12-03 13:58:30,287 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 6 games, 6 workers
2025-12-03 13:58:31,093 - __main__ - INFO - Training interrupted by user
2025-12-03 13:58:31,093 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-12-03 13:58:31,098 - torch._subclasses.fake_tensor - INFO - FakeTensor cache stats:
2025-12-03 13:58:31,098 - torch._subclasses.fake_tensor - INFO -   cache_hits: 0
2025-12-03 13:58:31,098 - torch._subclasses.fake_tensor - INFO -   cache_misses: 0
2025-12-03 13:59:00,944 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-12-03 13:59:00,945 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 13:59:00,949 - __main__ - INFO - Testing move generation...
2025-12-03 13:59:09,499 - __main__ - INFO - [OK] Generated 2418 moves
2025-12-03 13:59:09,499 - __main__ - INFO - Testing GameState caching...
2025-12-03 13:59:09,499 - __main__ - INFO - [OK] GameState caching works
2025-12-03 13:59:09,499 - __main__ - INFO - Testing MoveCache persistence...
2025-12-03 13:59:09,500 - __main__ - INFO - [OK] MoveCache works correctly
2025-12-03 13:59:09,500 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(2418), 'piece_moves_cache_size': 128, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-12-03 13:59:11,259 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251203_135856/temp_model_for_selfplay.pt
2025-12-03 13:59:11,259 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 10 games, 10 workers
2025-12-03 13:59:14,150 - training.parallel_self_play - INFO - Launching workers...
2025-12-03 13:59:34,848 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 10)
2025-12-03 13:59:39,630 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 13:59:39,633 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140378364896080
2025-12-03 13:59:39,906 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 13:59:39,907 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140474184817568
2025-12-03 13:59:39,984 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 13:59:39,985 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140502943063376
2025-12-03 13:59:40,031 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 13:59:40,033 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140161870667520
2025-12-03 13:59:40,038 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 13:59:40,039 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140362643595344
2025-12-03 13:59:40,091 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 13:59:40,092 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 13:59:40,093 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140131889386192
2025-12-03 13:59:40,093 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140149553029296
2025-12-03 13:59:40,145 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 13:59:40,146 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140690470411840
2025-12-03 13:59:40,196 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 13:59:40,198 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139771329604496
2025-12-03 13:59:40,236 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 13:59:40,237 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140499393651584
2025-12-03 13:59:43,031 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-12-03 13:59:43,036 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-12-03 13:59:43,036 - InferenceServer - INFO - Server Ready. Listening...
2025-12-03 14:00:49,394 - game3d.game.turnmove - INFO - Move 100: BLACK FRIENDLYTELEPORTER [1 2 8]->[7 7 8] (Move)
2025-12-03 14:00:49,496 - game3d.game.turnmove - INFO - Move 100: BLACK ARCHER [7 3 7]->[6 2 6] (Move)
2025-12-03 14:00:49,546 - game3d.game.turnmove - ERROR - CRITICAL: Wall move rejected by validation! Move: Move(from_coord=array([7, 8, 8], dtype=int16), to_coord=array([8, 3, 3], dtype=int16), promotion=None). Dest: [8 3 3]. SIZE=9. Wall requires 2x2 space.
2025-12-03 14:00:49,546 - game3d.game3d - ERROR - âŒ MOVE REJECTED - Wall move to [8 3 3] would place part of the wall out of bounds
2025-12-03 14:00:49,546 - worker.0 - ERROR - Worker 0 failed: Wall move to [8 3 3] would place part of the wall out of bounds
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 82, in submit_move
    raise InvalidMoveError(validation_error)
game3d.game3d.InvalidMoveError: Wall move to [8 3 3] would place part of the wall out of bounds
2025-12-03 14:00:54,801 - game3d.game.turnmove - INFO - Move 100: BLACK SWAPPER [2 4 6]->[3 4 5] (Capture)
2025-12-03 14:00:55,497 - game3d.game.turnmove - INFO - Move 100: BLACK XZQUEEN [6 1 8]->[5 0 7] (Capture)
2025-12-03 14:00:56,328 - game3d.game.turnmove - INFO - Move 200: BLACK ARCHER [6 2 6]->[6 2 4] (Capture)
2025-12-03 14:01:01,729 - game3d.game.turnmove - INFO - Move 100: WHITE SWAPPER [4 5 0]->[6 0 1] (Move)
2025-12-03 14:01:02,003 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-12-03 14:01:02,015 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 228)
2025-12-03 14:01:02,015 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:01:02,015 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:01:02,015 - game3d.game.terminal - WARNING -   - Attackers: FRIENDLYTELEPORTER at (0,6,5)
2025-12-03 14:01:02,022 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 228)
2025-12-03 14:01:02,022 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:01:02,022 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:01:02,022 - game3d.game.terminal - WARNING -   - Attackers: FRIENDLYTELEPORTER at (0,6,5)
2025-12-03 14:01:02,032 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 228)
2025-12-03 14:01:02,032 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:01:02,032 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:01:02,032 - game3d.game.terminal - WARNING -   - Attackers: FRIENDLYTELEPORTER at (0,6,5)
2025-12-03 14:01:02,040 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 228)
2025-12-03 14:01:02,041 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:01:02,041 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:01:02,041 - game3d.game.terminal - WARNING -   - Attackers: FRIENDLYTELEPORTER at (0,6,5)
2025-12-03 14:01:02,045 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 228)
2025-12-03 14:01:02,045 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:01:02,045 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:01:02,046 - game3d.game.terminal - WARNING -   - Attackers: FRIENDLYTELEPORTER at (0,6,5)
2025-12-03 14:01:03,193 - game3d.game.turnmove - INFO - Move 100: BLACK PAWN [1 3 8]->[0 3 3] (Move)
2025-12-03 14:01:04,332 - game3d.game.turnmove - INFO - Move 200: BLACK BLACKHOLE [1 0 4]->[1 1 3] (Capture)
2025-12-03 14:01:07,087 - game3d.game.turnmove - INFO - Move 100: WHITE SWAPPER [8 3 1]->[3 5 0] (Move)
2025-12-03 14:01:08,479 - game3d.game.turnmove - INFO - Move 200: BLACK SWAPPER [5 0 8]->[3 7 4] (Move)
2025-12-03 14:01:12,678 - game3d.game.turnmove - INFO - Move 200: WHITE SPIRAL [3 1 1]->[8 1 6] (Capture)
2025-12-03 14:01:17,519 - game3d.game.turnmove - INFO - Move 200: WHITE INFILTRATOR [3 2 2]->[4 1 4] (Capture)
2025-12-03 14:01:20,347 - game3d.game.turnmove - INFO - Move 300: WHITE SWAPPER [8 2 4]->[6 6 0] (Move)
2025-12-03 14:01:21,087 - game3d.game.turnmove - INFO - Move 100: BLACK FRIENDLYTELEPORTER [7 6 8]->[0 3 3] (Move)
2025-12-03 14:01:22,207 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: Out-of-bounds coordinates detected in batch_set_positions:
  SIZE=9, valid range=[0, 8]
  Invalid coordinates (2 total): [[4 9 4]
 [3 9 4]]...
  First invalid: [4 9 4] at batch index 4
  Total coordinates in batch: 6
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 252, in make_move
    cache_manager.occupancy_cache.batch_set_positions(changed_coords, pieces_data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 498, in batch_set_positions
    raise ValueError(
    ...<5 lines>...
    )
ValueError: Out-of-bounds coordinates detected in batch_set_positions:
  SIZE=9, valid range=[0, 8]
  Invalid coordinates (2 total): [[4 9 4]
 [3 9 4]]...
  First invalid: [4 9 4] at batch index 4
  Total coordinates in batch: 6
2025-12-03 14:01:22,211 - worker.2 - ERROR - Worker 2 failed: Move execution failed: Out-of-bounds coordinates detected in batch_set_positions:
  SIZE=9, valid range=[0, 8]
  Invalid coordinates (2 total): [[4 9 4]
 [3 9 4]]...
  First invalid: [4 9 4] at batch index 4
  Total coordinates in batch: 6
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 252, in make_move
    cache_manager.occupancy_cache.batch_set_positions(changed_coords, pieces_data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 498, in batch_set_positions
    raise ValueError(
    ...<5 lines>...
    )
ValueError: Out-of-bounds coordinates detected in batch_set_positions:
  SIZE=9, valid range=[0, 8]
  Invalid coordinates (2 total): [[4 9 4]
 [3 9 4]]...
  First invalid: [4 9 4] at batch index 4
  Total coordinates in batch: 6

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: Out-of-bounds coordinates detected in batch_set_positions:
  SIZE=9, valid range=[0, 8]
  Invalid coordinates (2 total): [[4 9 4]
 [3 9 4]]...
  First invalid: [4 9 4] at batch index 4
  Total coordinates in batch: 6
2025-12-03 14:01:24,235 - game3d.game.turnmove - INFO - Move 300: WHITE FRIENDLYTELEPORTER [2 1 3]->[1 5 4] (Move)
2025-12-03 14:01:27,301 - game3d.game.turnmove - INFO - Move 300: WHITE KNIGHT32 [5 5 1]->[8 5 3] (Capture)
2025-12-03 14:01:28,645 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-12-03 14:01:28,652 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 267)
2025-12-03 14:01:28,652 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,5)
2025-12-03 14:01:28,652 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-12-03 14:01:28,652 - game3d.game.terminal - WARNING -   - Attackers: PAWN at (3,4,6), PAWN at (5,4,6), PAWN at (5,6,6), PRIEST at (4,4,5), KNIGHT31 at (4,6,8), NEBULA at (3,6,5), BLACKHOLE at (3,5,5)
2025-12-03 14:01:28,654 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 267)
2025-12-03 14:01:28,654 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,5)
2025-12-03 14:01:28,654 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-12-03 14:01:28,654 - game3d.game.terminal - WARNING -   - Attackers: PAWN at (3,4,6), PAWN at (5,4,6), PAWN at (5,6,6), PRIEST at (4,4,5), KNIGHT31 at (4,6,8), NEBULA at (3,6,5), BLACKHOLE at (3,5,5)
2025-12-03 14:01:28,657 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 267)
2025-12-03 14:01:28,658 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,5)
2025-12-03 14:01:28,658 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-12-03 14:01:28,658 - game3d.game.terminal - WARNING -   - Attackers: PAWN at (3,4,6), PAWN at (5,4,6), PAWN at (5,6,6), PRIEST at (4,4,5), KNIGHT31 at (4,6,8), NEBULA at (3,6,5), BLACKHOLE at (3,5,5)
2025-12-03 14:01:28,664 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 267)
2025-12-03 14:01:28,664 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,5)
2025-12-03 14:01:28,664 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-12-03 14:01:28,664 - game3d.game.terminal - WARNING -   - Attackers: PAWN at (3,4,6), PAWN at (5,4,6), PAWN at (5,6,6), PRIEST at (4,4,5), KNIGHT31 at (4,6,8), NEBULA at (3,6,5), BLACKHOLE at (3,5,5)
2025-12-03 14:01:28,669 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 267)
2025-12-03 14:01:28,669 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,5)
2025-12-03 14:01:28,669 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-12-03 14:01:28,669 - game3d.game.terminal - WARNING -   - Attackers: PAWN at (3,4,6), PAWN at (5,4,6), PAWN at (5,6,6), PRIEST at (4,4,5), KNIGHT31 at (4,6,8), NEBULA at (3,6,5), BLACKHOLE at (3,5,5)
2025-12-03 14:01:32,589 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-12-03 14:01:32,595 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 323)
2025-12-03 14:01:32,595 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,0)
2025-12-03 14:01:32,595 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:01:32,595 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,6,0)
2025-12-03 14:01:32,598 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 323)
2025-12-03 14:01:32,598 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,0)
2025-12-03 14:01:32,598 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:01:32,598 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,6,0)
2025-12-03 14:01:32,601 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 323)
2025-12-03 14:01:32,602 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,0)
2025-12-03 14:01:32,602 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:01:32,602 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,6,0)
2025-12-03 14:01:32,607 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 323)
2025-12-03 14:01:32,607 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,0)
2025-12-03 14:01:32,607 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:01:32,607 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,6,0)
2025-12-03 14:01:32,613 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 323)
2025-12-03 14:01:32,613 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,0)
2025-12-03 14:01:32,613 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:01:32,613 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,6,0)
2025-12-03 14:01:35,334 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-12-03 14:01:35,343 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 137)
2025-12-03 14:01:35,344 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:01:35,344 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:01:35,344 - game3d.game.terminal - WARNING -   - Attackers: WALL at (3,4,8), SWAPPER at (1,5,0), SWAPPER at (7,3,0), SWAPPER at (7,5,0)
2025-12-03 14:01:35,348 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 137)
2025-12-03 14:01:35,349 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:01:35,349 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:01:35,349 - game3d.game.terminal - WARNING -   - Attackers: WALL at (3,4,8), SWAPPER at (1,5,0), SWAPPER at (7,3,0), SWAPPER at (7,5,0)
2025-12-03 14:01:35,354 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 137)
2025-12-03 14:01:35,354 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:01:35,354 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:01:35,354 - game3d.game.terminal - WARNING -   - Attackers: WALL at (3,4,8), SWAPPER at (1,5,0), SWAPPER at (7,3,0), SWAPPER at (7,5,0)
2025-12-03 14:01:35,360 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 137)
2025-12-03 14:01:35,360 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:01:35,360 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:01:35,360 - game3d.game.terminal - WARNING -   - Attackers: WALL at (3,4,8), SWAPPER at (1,5,0), SWAPPER at (7,3,0), SWAPPER at (7,5,0)
2025-12-03 14:01:35,366 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 137)
2025-12-03 14:01:35,366 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:01:35,367 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:01:35,367 - game3d.game.terminal - WARNING -   - Attackers: WALL at (3,4,8), SWAPPER at (1,5,0), SWAPPER at (7,3,0), SWAPPER at (7,5,0)
2025-12-03 14:01:35,595 - game3d.game.turnmove - INFO - Move 100: BLACK KNIGHT32 [3 3 8]->[3 5 5] (Move)
2025-12-03 14:01:39,016 - game3d.game.turnmove - INFO - Move 400: WHITE XZQUEEN [3 8 5]->[4 7 6] (Capture)
2025-12-03 14:01:40,822 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-12-03 14:01:40,822 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-12-03 14:01:46,798 - game3d.game.turnmove - INFO - Move 100: BLACK PAWN [4 5 6]->[4 5 4] (Move)
2025-12-03 14:01:52,644 - game3d.game.turnmove - INFO - Move 500: BLACK WALL [6 4 0]->[5 4 0] (Capture)
2025-12-03 14:01:53,233 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-12-03 14:01:53,238 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 504)
2025-12-03 14:01:53,238 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:01:53,238 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,5,7)
2025-12-03 14:01:53,238 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,5,0)
2025-12-03 14:01:53,240 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 504)
2025-12-03 14:01:53,240 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:01:53,240 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,5,7)
2025-12-03 14:01:53,240 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,5,0)
2025-12-03 14:01:53,243 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 504)
2025-12-03 14:01:53,243 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:01:53,243 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,5,7)
2025-12-03 14:01:53,243 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,5,0)
2025-12-03 14:01:53,248 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 504)
2025-12-03 14:01:53,249 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:01:53,249 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,5,7)
2025-12-03 14:01:53,249 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,5,0)
2025-12-03 14:01:53,251 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 504)
2025-12-03 14:01:53,252 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:01:53,252 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,5,7)
2025-12-03 14:01:53,252 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,5,0)
2025-12-03 14:02:09,423 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-12-03 14:02:11,612 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-12-03 14:02:11,614 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 134)
2025-12-03 14:02:11,614 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(1,7,5)
2025-12-03 14:02:11,614 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-12-03 14:02:11,614 - game3d.game.terminal - WARNING -   - Attackers: PAWN at (0,6,6), PAWN at (0,8,6), PAWN at (2,6,6), BLACKHOLE at (1,7,6)
2025-12-03 14:02:11,617 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 134)
2025-12-03 14:02:11,617 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(1,7,5)
2025-12-03 14:02:11,617 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-12-03 14:02:11,617 - game3d.game.terminal - WARNING -   - Attackers: PAWN at (0,6,6), PAWN at (0,8,6), PAWN at (2,6,6), BLACKHOLE at (1,7,6)
2025-12-03 14:02:11,621 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 134)
2025-12-03 14:02:11,621 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(1,7,5)
2025-12-03 14:02:11,621 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-12-03 14:02:11,621 - game3d.game.terminal - WARNING -   - Attackers: PAWN at (0,6,6), PAWN at (0,8,6), PAWN at (2,6,6), BLACKHOLE at (1,7,6)
2025-12-03 14:02:11,624 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 134)
2025-12-03 14:02:11,624 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(1,7,5)
2025-12-03 14:02:11,624 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-12-03 14:02:11,624 - game3d.game.terminal - WARNING -   - Attackers: PAWN at (0,6,6), PAWN at (0,8,6), PAWN at (2,6,6), BLACKHOLE at (1,7,6)
2025-12-03 14:02:11,627 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 134)
2025-12-03 14:02:11,628 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(1,7,5)
2025-12-03 14:02:11,628 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-12-03 14:02:11,628 - game3d.game.terminal - WARNING -   - Attackers: PAWN at (0,6,6), PAWN at (0,8,6), PAWN at (2,6,6), BLACKHOLE at (1,7,6)
2025-12-03 14:02:21,759 - game3d.game.turnmove - INFO - Move 200: WHITE PAWN [2 7 3]->[2 7 4] (Capture)
2025-12-03 14:03:05,967 - game3d.game.turnmove - INFO - Move 300: WHITE YZZIGZAG [0 2 5]->[0 2 7] (Capture)
2025-12-03 14:03:10,275 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: Out-of-bounds coordinates detected in batch_set_positions:
  SIZE=9, valid range=[0, 8]
  Invalid coordinates (2 total): [[6 9 2]
 [5 9 2]]...
  First invalid: [6 9 2] at batch index 4
  Total coordinates in batch: 6
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 252, in make_move
    cache_manager.occupancy_cache.batch_set_positions(changed_coords, pieces_data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 498, in batch_set_positions
    raise ValueError(
    ...<5 lines>...
    )
ValueError: Out-of-bounds coordinates detected in batch_set_positions:
  SIZE=9, valid range=[0, 8]
  Invalid coordinates (2 total): [[6 9 2]
 [5 9 2]]...
  First invalid: [6 9 2] at batch index 4
  Total coordinates in batch: 6
2025-12-03 14:03:10,277 - worker.7 - ERROR - Worker 7 failed: Move execution failed: Out-of-bounds coordinates detected in batch_set_positions:
  SIZE=9, valid range=[0, 8]
  Invalid coordinates (2 total): [[6 9 2]
 [5 9 2]]...
  First invalid: [6 9 2] at batch index 4
  Total coordinates in batch: 6
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 252, in make_move
    cache_manager.occupancy_cache.batch_set_positions(changed_coords, pieces_data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 498, in batch_set_positions
    raise ValueError(
    ...<5 lines>...
    )
ValueError: Out-of-bounds coordinates detected in batch_set_positions:
  SIZE=9, valid range=[0, 8]
  Invalid coordinates (2 total): [[6 9 2]
 [5 9 2]]...
  First invalid: [6 9 2] at batch index 4
  Total coordinates in batch: 6

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: Out-of-bounds coordinates detected in batch_set_positions:
  SIZE=9, valid range=[0, 8]
  Invalid coordinates (2 total): [[6 9 2]
 [5 9 2]]...
  First invalid: [6 9 2] at batch index 4
  Total coordinates in batch: 6
2025-12-03 14:03:33,666 - game3d.game.turnmove - INFO - Move 200: BLACK KNIGHT32 [5 5 8]->[7 5 5] (Move)
2025-12-03 14:04:46,589 - game3d.game.turnmove - INFO - Move 300: BLACK PAWN [5 4 4]->[5 4 3] (Capture)
2025-12-03 14:04:55,636 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-12-03 14:04:55,642 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 312)
2025-12-03 14:04:55,643 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(8,8,4)
2025-12-03 14:04:55,643 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:04:55,643 - game3d.game.terminal - WARNING -   - Attackers: SWAPPER at (8,8,7), SWAPPER at (8,8,8)
2025-12-03 14:04:55,646 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 312)
2025-12-03 14:04:55,646 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(8,8,4)
2025-12-03 14:04:55,646 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:04:55,646 - game3d.game.terminal - WARNING -   - Attackers: SWAPPER at (8,8,7), SWAPPER at (8,8,8)
2025-12-03 14:04:55,650 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 312)
2025-12-03 14:04:55,650 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(8,8,4)
2025-12-03 14:04:55,650 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:04:55,650 - game3d.game.terminal - WARNING -   - Attackers: SWAPPER at (8,8,7), SWAPPER at (8,8,8)
2025-12-03 14:04:55,655 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 312)
2025-12-03 14:04:55,655 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(8,8,4)
2025-12-03 14:04:55,655 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:04:55,655 - game3d.game.terminal - WARNING -   - Attackers: SWAPPER at (8,8,7), SWAPPER at (8,8,8)
2025-12-03 14:04:55,659 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 312)
2025-12-03 14:04:55,659 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(8,8,4)
2025-12-03 14:04:55,659 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:04:55,659 - game3d.game.terminal - WARNING -   - Attackers: SWAPPER at (8,8,7), SWAPPER at (8,8,8)
2025-12-03 14:04:55,913 - training.parallel_self_play - INFO - Stopping Server...
2025-12-03 14:04:55,917 - InferenceServer - INFO - Server shutting down.
2025-12-03 14:07:05,494 - __main__ - ERROR - [ERROR] Unexpected error in iteration 0: HIP out of memory. Tried to allocate 1.42 GiB. GPU 0 has a total capacity of 23.98 GiB of which 3.48 GiB is free. 20.39 GiB allowed; Of the allocated memory 17.23 GiB is allocated by PyTorch, and 2.58 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-03 14:07:05,495 - __main__ - CRITICAL - [ALERT] TRAINING CRASHED: HIP out of memory. Tried to allocate 1.42 GiB. GPU 0 has a total capacity of 23.98 GiB of which 3.48 GiB is free. 20.39 GiB allowed; Of the allocated memory 17.23 GiB is allocated by PyTorch, and 2.58 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-03 14:07:07,219 - __main__ - INFO - Emergency checkpoint saved to model_checkpoints/train_huge_20251203_135856/emergency_checkpoint.pt
2025-12-03 14:07:07,221 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-12-03 14:14:18,192 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-12-03 14:14:18,192 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:14:18,195 - __main__ - INFO - Testing move generation...
2025-12-03 14:14:26,379 - __main__ - INFO - [OK] Generated 2418 moves
2025-12-03 14:14:26,379 - __main__ - INFO - Testing GameState caching...
2025-12-03 14:14:26,380 - __main__ - INFO - [OK] GameState caching works
2025-12-03 14:14:26,380 - __main__ - INFO - Testing MoveCache persistence...
2025-12-03 14:14:26,380 - __main__ - INFO - [OK] MoveCache works correctly
2025-12-03 14:14:26,380 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(2418), 'piece_moves_cache_size': 128, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-12-03 14:14:27,939 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251203_141413/temp_model_for_selfplay.pt
2025-12-03 14:14:27,940 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 10 games, 10 workers
2025-12-03 14:14:30,770 - training.parallel_self_play - INFO - Launching workers...
2025-12-03 14:14:45,950 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 10)
2025-12-03 14:14:55,138 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:14:55,141 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139833064002256
2025-12-03 14:14:55,162 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:14:55,164 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139633693482560
2025-12-03 14:14:55,165 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:14:55,167 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140634503727616
2025-12-03 14:14:55,169 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:14:55,169 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:14:55,170 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140364505881600
2025-12-03 14:14:55,171 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140532536042368
2025-12-03 14:14:55,206 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:14:55,208 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139780801371808
2025-12-03 14:14:55,224 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:14:55,226 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139962244862288
2025-12-03 14:14:55,301 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:14:55,303 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140636903890640
2025-12-03 14:14:55,360 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:14:55,362 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139943753212368
2025-12-03 14:14:55,409 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:14:55,411 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140517143977488
2025-12-03 14:14:56,851 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-12-03 14:14:56,855 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-12-03 14:14:56,855 - InferenceServer - INFO - Server Ready. Listening...
2025-12-03 14:15:29,575 - game3d.game.turnmove - INFO - Move 100: WHITE GEOMANCER [8 8 4]->[7 6 3] (Move)
2025-12-03 14:15:29,737 - game3d.game.turnmove - INFO - Move 100: BLACK ECHO [3 8 5]->[3 8 2] (Capture)
2025-12-03 14:15:29,795 - game3d.game.turnmove - INFO - Move 100: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Capture)
2025-12-03 14:15:36,031 - game3d.game.turnmove - INFO - Move 200: BLACK FRIENDLYTELEPORTER [5 4 4]->[4 2 4] (Move)
2025-12-03 14:15:36,055 - game3d.game.turnmove - INFO - Move 200: WHITE ECHO [3 3 7]->[2 5 7] (Capture)
2025-12-03 14:15:38,352 - game3d.game.turnmove - INFO - Move 100: BLACK SWAPPER [7 5 8]->[1 2 4] (Move)
2025-12-03 14:15:41,520 - game3d.game.turnmove - ERROR - CRITICAL: Wall move rejected by validation! Move: Move(from_coord=array([2, 5, 7], dtype=int16), to_coord=array([8, 2, 7], dtype=int16), promotion=None). Dest: [8 2 7]. SIZE=9. Wall requires 2x2 space.
2025-12-03 14:15:41,521 - game3d.game3d - ERROR - âŒ MOVE REJECTED - Wall move to [8 2 7] would place part of the wall out of bounds
2025-12-03 14:15:41,521 - worker.2 - ERROR - Worker 2 failed: Wall move to [8 2 7] would place part of the wall out of bounds
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 82, in submit_move
    raise InvalidMoveError(validation_error)
game3d.game3d.InvalidMoveError: Wall move to [8 2 7] would place part of the wall out of bounds
2025-12-03 14:15:44,072 - training.parallel_self_play - INFO - Stopping Server...
2025-12-03 14:15:44,093 - InferenceServer - INFO - Server shutting down.
2025-12-03 14:15:44,424 - __main__ - INFO - Training interrupted by user
2025-12-03 14:15:44,653 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-12-03 14:15:48,906 - __main__ - INFO - Final model saved to model_checkpoints/train_huge_20251203_141413/model_final.pt
2025-12-03 14:16:08,069 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-12-03 14:16:08,070 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:16:08,071 - __main__ - INFO - Testing move generation...
2025-12-03 14:16:08,446 - __main__ - INFO - [OK] Generated 2418 moves
2025-12-03 14:16:08,446 - __main__ - INFO - Testing GameState caching...
2025-12-03 14:16:08,447 - __main__ - INFO - [OK] GameState caching works
2025-12-03 14:16:08,447 - __main__ - INFO - Testing MoveCache persistence...
2025-12-03 14:16:08,447 - __main__ - INFO - [OK] MoveCache works correctly
2025-12-03 14:16:08,447 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(2418), 'piece_moves_cache_size': 128, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-12-03 14:16:10,013 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251203_141603/temp_model_for_selfplay.pt
2025-12-03 14:16:10,013 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 10 games, 10 workers
2025-12-03 14:16:12,915 - training.parallel_self_play - INFO - Launching workers...
2025-12-03 14:16:30,231 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 10)
2025-12-03 14:16:40,085 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:16:40,088 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139840864854288
2025-12-03 14:16:40,157 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:16:40,160 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139687170907760
2025-12-03 14:16:40,309 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:16:40,312 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139634336259744
2025-12-03 14:16:40,409 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:16:40,411 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140270076198864
2025-12-03 14:16:40,556 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:16:40,557 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139975282925216
2025-12-03 14:16:40,571 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:16:40,573 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140188118621568
2025-12-03 14:16:40,596 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:16:40,598 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139710743910080
2025-12-03 14:16:40,638 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:16:40,640 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140598954926304
2025-12-03 14:16:40,651 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:16:40,652 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:16:40,653 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139759393660720
2025-12-03 14:16:40,653 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139689434766384
2025-12-03 14:16:42,702 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-12-03 14:16:42,706 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-12-03 14:16:42,707 - InferenceServer - INFO - Server Ready. Listening...
2025-12-03 14:17:12,002 - game3d.game.turnmove - INFO - Move 100: WHITE PAWN [6 8 3]->[6 8 4] (Capture)
2025-12-03 14:17:12,057 - game3d.game.turnmove - INFO - Move 100: WHITE FRIENDLYTELEPORTER [7 6 0]->[6 8 3] (Move)
2025-12-03 14:17:12,107 - game3d.game.turnmove - INFO - Move 100: BLACK PAWN [8 0 6]->[8 0 4] (Move)
2025-12-03 14:17:13,867 - game3d.game.turnmove - INFO - Move 100: BLACK SWAPPER [7 5 8]->[5 6 5] (Move)
2025-12-03 14:17:14,177 - game3d.game.turnmove - INFO - Move 100: BLACK PAWN [7 5 8]->[7 0 0] (Capture)
2025-12-03 14:17:18,294 - game3d.game.turnmove - INFO - Move 100: WHITE PAWN [0 1 2]->[0 1 4] (Move)
2025-12-03 14:17:19,566 - game3d.game.turnmove - INFO - Move 200: BLACK TRIGONALBISHOP [5 6 5]->[8 3 2] (Capture)
2025-12-03 14:17:21,778 - game3d.game.turnmove - INFO - Move 200: BLACK PAWN [7 1 6]->[7 1 5] (Move)
2025-12-03 14:17:21,808 - game3d.game.turnmove - INFO - Move 200: BLACK SWAPPER [0 1 6]->[0 2 5] (Capture)
2025-12-03 14:17:24,833 - game3d.game.turnmove - INFO - Move 100: WHITE KNIGHT32 [6 0 5]->[8 0 8] (Capture)
2025-12-03 14:17:25,547 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-12-03 14:17:25,548 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-12-03 14:17:26,373 - game3d.game.turnmove - INFO - Move 200: BLACK ROOK [5 5 7]->[5 5 2] (Capture)
2025-12-03 14:17:28,696 - game3d.game.turnmove - INFO - Move 200: BLACK WALL [5 6 6]->[5 6 5] (Move)
2025-12-03 14:17:29,241 - game3d.game.turnmove - ERROR - CRITICAL: Wall move rejected by validation! Move: Move(from_coord=array([5, 8, 4], dtype=int16), to_coord=array([5, 8, 3], dtype=int16), promotion=None). Dest: [5 8 3]. SIZE=9. Wall requires 2x2 space.
2025-12-03 14:17:29,241 - game3d.game3d - ERROR - âŒ MOVE REJECTED - Wall move to [5 8 3] would place part of the wall out of bounds
2025-12-03 14:17:29,241 - worker.9 - ERROR - Worker 9 failed: Wall move to [5 8 3] would place part of the wall out of bounds
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 82, in submit_move
    raise InvalidMoveError(validation_error)
game3d.game3d.InvalidMoveError: Wall move to [5 8 3] would place part of the wall out of bounds
2025-12-03 14:17:29,809 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-12-03 14:17:29,819 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 241)
2025-12-03 14:17:29,820 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(5,4,0)
2025-12-03 14:17:29,820 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:17:29,820 - game3d.game.terminal - WARNING -   - Attackers: WALL at (6,4,0)
2025-12-03 14:17:29,823 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 241)
2025-12-03 14:17:29,824 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(5,4,0)
2025-12-03 14:17:29,824 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:17:29,824 - game3d.game.terminal - WARNING -   - Attackers: WALL at (6,4,0)
2025-12-03 14:17:29,827 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 241)
2025-12-03 14:17:29,827 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(5,4,0)
2025-12-03 14:17:29,827 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:17:29,827 - game3d.game.terminal - WARNING -   - Attackers: WALL at (6,4,0)
2025-12-03 14:17:29,831 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 241)
2025-12-03 14:17:29,831 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(5,4,0)
2025-12-03 14:17:29,831 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:17:29,831 - game3d.game.terminal - WARNING -   - Attackers: WALL at (6,4,0)
2025-12-03 14:17:29,837 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 241)
2025-12-03 14:17:29,837 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(5,4,0)
2025-12-03 14:17:29,837 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:17:29,837 - game3d.game.terminal - WARNING -   - Attackers: WALL at (6,4,0)
2025-12-03 14:17:31,350 - game3d.game.turnmove - INFO - Move 100: BLACK FRIENDLYTELEPORTER [5 6 5]->[4 7 4] (Move)
2025-12-03 14:17:31,686 - game3d.game.turnmove - INFO - Move 100: BLACK SWAPPER [4 7 4]->[5 7 3] (Capture)
2025-12-03 14:17:33,747 - game3d.game.turnmove - INFO - Move 300: BLACK FRIENDLYTELEPORTER [5 6 5]->[4 7 4] (Move)
2025-12-03 14:17:34,297 - game3d.game.turnmove - INFO - Move 300: WHITE REFLECTOR [5 7 4]->[5 6 5] (Capture)
2025-12-03 14:17:34,878 - game3d.game.turnmove - INFO - Move 200: WHITE XYQUEEN [4 4 3]->[2 4 3] (Capture)
2025-12-03 14:17:43,106 - game3d.game.turnmove - INFO - Move 300: BLACK PAWN [0 0 6]->[0 0 5] (Capture)
2025-12-03 14:17:45,359 - game3d.game.turnmove - INFO - Move 100: BLACK SWAPPER [1 5 8]->[5 6 5] (Move)
2025-12-03 14:17:45,574 - game3d.game.turnmove - INFO - Move 200: WHITE PAWN [3 8 2]->[3 8 3] (Move)
2025-12-03 14:17:45,873 - game3d.game.turnmove - INFO - Move 400: WHITE INFILTRATOR [5 4 3]->[6 5 3] (Capture)
2025-12-03 14:17:48,019 - game3d.game.turnmove - INFO - Move 300: BLACK KNIGHT31 [2 4 8]->[5 5 8] (Move)
2025-12-03 14:17:52,808 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-12-03 14:17:52,815 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 347)
2025-12-03 14:17:52,815 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:17:52,815 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:17:52,815 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,4,7)
2025-12-03 14:17:52,820 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 347)
2025-12-03 14:17:52,820 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:17:52,820 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:17:52,820 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,4,7)
2025-12-03 14:17:52,824 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 347)
2025-12-03 14:17:52,825 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:17:52,825 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:17:52,825 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,4,7)
2025-12-03 14:17:52,831 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 347)
2025-12-03 14:17:52,831 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:17:52,831 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:17:52,831 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,4,7)
2025-12-03 14:17:52,837 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 347)
2025-12-03 14:17:52,837 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:17:52,837 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:17:52,837 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,4,7)
2025-12-03 14:17:54,482 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-12-03 14:17:54,489 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 435)
2025-12-03 14:17:54,489 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:17:54,489 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:17:54,489 - game3d.game.terminal - WARNING -   - Attackers: WALL at (3,4,0)
2025-12-03 14:17:54,492 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 435)
2025-12-03 14:17:54,492 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:17:54,492 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:17:54,492 - game3d.game.terminal - WARNING -   - Attackers: WALL at (3,4,0)
2025-12-03 14:17:54,496 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 435)
2025-12-03 14:17:54,496 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:17:54,496 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:17:54,496 - game3d.game.terminal - WARNING -   - Attackers: WALL at (3,4,0)
2025-12-03 14:17:54,502 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 435)
2025-12-03 14:17:54,502 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:17:54,502 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:17:54,502 - game3d.game.terminal - WARNING -   - Attackers: WALL at (3,4,0)
2025-12-03 14:17:54,505 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 435)
2025-12-03 14:17:54,505 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:17:54,505 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:17:54,505 - game3d.game.terminal - WARNING -   - Attackers: WALL at (3,4,0)
2025-12-03 14:17:54,602 - game3d.game.turnmove - INFO - Move 200: BLACK EDGEROOK [2 8 8]->[8 8 2] (Capture)
2025-12-03 14:17:57,631 - game3d.game.turnmove - INFO - Move 200: BLACK FRIENDLYTELEPORTER [5 6 5]->[4 7 4] (Move)
2025-12-03 14:17:58,039 - game3d.game.turnmove - ERROR - CRITICAL: Wall move rejected by validation! Move: Move(from_coord=array([7, 1, 8], dtype=int16), to_coord=array([8, 4, 7], dtype=int16), promotion=None). Dest: [8 4 7]. SIZE=9. Wall requires 2x2 space.
2025-12-03 14:17:58,039 - game3d.game3d - ERROR - âŒ MOVE REJECTED - Wall move to [8 4 7] would place part of the wall out of bounds
2025-12-03 14:17:58,039 - worker.7 - ERROR - Worker 7 failed: Wall move to [8 4 7] would place part of the wall out of bounds
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 82, in submit_move
    raise InvalidMoveError(validation_error)
game3d.game3d.InvalidMoveError: Wall move to [8 4 7] would place part of the wall out of bounds
2025-12-03 14:17:58,484 - game3d.game.turnmove - INFO - Move 300: BLACK PAWN [0 1 6]->[0 1 4] (Move)
2025-12-03 14:17:58,683 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-12-03 14:17:58,689 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 355)
2025-12-03 14:17:58,690 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,5)
2025-12-03 14:17:58,690 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-12-03 14:17:58,690 - game3d.game.terminal - WARNING -   - Attackers: PAWN at (4,5,6), ROOK at (5,5,5), KNIGHT31 at (5,5,8), PANEL at (3,4,7), PANEL at (4,6,7), PANEL at (5,3,5), XYQUEEN at (3,4,6), GEOMANCER at (3,8,7), GEOMANCER at (5,8,7), BLACKHOLE at (5,6,6), INFILTRATOR at (5,6,5)
2025-12-03 14:17:58,693 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 355)
2025-12-03 14:17:58,693 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,5)
2025-12-03 14:17:58,693 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-12-03 14:17:58,694 - game3d.game.terminal - WARNING -   - Attackers: PAWN at (4,5,6), ROOK at (5,5,5), KNIGHT31 at (5,5,8), PANEL at (3,4,7), PANEL at (4,6,7), PANEL at (5,3,5), XYQUEEN at (3,4,6), GEOMANCER at (3,8,7), GEOMANCER at (5,8,7), BLACKHOLE at (5,6,6), INFILTRATOR at (5,6,5)
2025-12-03 14:17:58,698 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 355)
2025-12-03 14:17:58,698 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,5)
2025-12-03 14:17:58,698 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-12-03 14:17:58,698 - game3d.game.terminal - WARNING -   - Attackers: PAWN at (4,5,6), ROOK at (5,5,5), KNIGHT31 at (5,5,8), PANEL at (3,4,7), PANEL at (4,6,7), PANEL at (5,3,5), XYQUEEN at (3,4,6), GEOMANCER at (3,8,7), GEOMANCER at (5,8,7), BLACKHOLE at (5,6,6), INFILTRATOR at (5,6,5)
2025-12-03 14:17:58,703 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 355)
2025-12-03 14:17:58,703 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,5)
2025-12-03 14:17:58,703 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-12-03 14:17:58,703 - game3d.game.terminal - WARNING -   - Attackers: PAWN at (4,5,6), ROOK at (5,5,5), KNIGHT31 at (5,5,8), PANEL at (3,4,7), PANEL at (4,6,7), PANEL at (5,3,5), XYQUEEN at (3,4,6), GEOMANCER at (3,8,7), GEOMANCER at (5,8,7), BLACKHOLE at (5,6,6), INFILTRATOR at (5,6,5)
2025-12-03 14:17:58,708 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 355)
2025-12-03 14:17:58,708 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,5)
2025-12-03 14:17:58,708 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-12-03 14:17:58,708 - game3d.game.terminal - WARNING -   - Attackers: PAWN at (4,5,6), ROOK at (5,5,5), KNIGHT31 at (5,5,8), PANEL at (3,4,7), PANEL at (4,6,7), PANEL at (5,3,5), XYQUEEN at (3,4,6), GEOMANCER at (3,8,7), GEOMANCER at (5,8,7), BLACKHOLE at (5,6,6), INFILTRATOR at (5,6,5)
2025-12-03 14:18:07,314 - game3d.game.turnmove - INFO - Move 300: WHITE FRIENDLYTELEPORTER [4 7 4]->[4 6 5] (Capture)
2025-12-03 14:18:08,097 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-12-03 14:18:08,104 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 253)
2025-12-03 14:18:08,104 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:18:08,104 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,4,8)
2025-12-03 14:18:08,104 - game3d.game.terminal - WARNING -   - Attackers: WALL at (6,4,8)
2025-12-03 14:18:08,108 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 253)
2025-12-03 14:18:08,108 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:18:08,108 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,4,8)
2025-12-03 14:18:08,108 - game3d.game.terminal - WARNING -   - Attackers: WALL at (6,4,8)
2025-12-03 14:18:08,112 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 253)
2025-12-03 14:18:08,112 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:18:08,112 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,4,8)
2025-12-03 14:18:08,112 - game3d.game.terminal - WARNING -   - Attackers: WALL at (6,4,8)
2025-12-03 14:18:08,117 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 253)
2025-12-03 14:18:08,117 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:18:08,117 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,4,8)
2025-12-03 14:18:08,117 - game3d.game.terminal - WARNING -   - Attackers: WALL at (6,4,8)
2025-12-03 14:18:08,122 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 253)
2025-12-03 14:18:08,122 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:18:08,122 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,4,8)
2025-12-03 14:18:08,122 - game3d.game.terminal - WARNING -   - Attackers: WALL at (6,4,8)
2025-12-03 14:18:09,818 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 1]
2025-12-03 14:18:09,818 - game3d.common.state_utils - DEBUG - King for color 2 cached at [5 4 8]
2025-12-03 14:18:11,256 - game3d.game.turnmove - INFO - Move 400: WHITE BOMB [3 4 0]->[4 4 0] (Capture)
2025-12-03 14:18:17,988 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-12-03 14:18:17,992 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 422)
2025-12-03 14:18:17,992 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(3,2,2)
2025-12-03 14:18:17,992 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,4,8)
2025-12-03 14:18:17,992 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,3,8)
2025-12-03 14:18:17,994 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 422)
2025-12-03 14:18:17,995 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(3,2,2)
2025-12-03 14:18:17,995 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,4,8)
2025-12-03 14:18:17,995 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,3,8)
2025-12-03 14:18:17,998 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 422)
2025-12-03 14:18:17,998 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(3,2,2)
2025-12-03 14:18:17,998 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,4,8)
2025-12-03 14:18:17,998 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,3,8)
2025-12-03 14:18:18,002 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 422)
2025-12-03 14:18:18,002 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(3,2,2)
2025-12-03 14:18:18,003 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,4,8)
2025-12-03 14:18:18,003 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,3,8)
2025-12-03 14:18:18,005 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 422)
2025-12-03 14:18:18,005 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(3,2,2)
2025-12-03 14:18:18,006 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,4,8)
2025-12-03 14:18:18,006 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,3,8)
2025-12-03 14:18:21,469 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-12-03 14:18:21,474 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 179)
2025-12-03 14:18:21,474 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(3,0,6)
2025-12-03 14:18:21,474 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-12-03 14:18:21,475 - game3d.game.terminal - WARNING -   - Attackers: PRIEST at (3,1,6), TRIGONALBISHOP at (4,1,7), ORBITER at (3,3,7), ECHO at (3,0,8), ARMOUR at (3,1,7), SLOWER at (2,0,6), GEOMANCER at (3,0,7), BLACKHOLE at (2,0,7)
2025-12-03 14:18:21,477 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 179)
2025-12-03 14:18:21,477 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(3,0,6)
2025-12-03 14:18:21,477 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-12-03 14:18:21,478 - game3d.game.terminal - WARNING -   - Attackers: PRIEST at (3,1,6), TRIGONALBISHOP at (4,1,7), ORBITER at (3,3,7), ECHO at (3,0,8), ARMOUR at (3,1,7), SLOWER at (2,0,6), GEOMANCER at (3,0,7), BLACKHOLE at (2,0,7)
2025-12-03 14:18:21,481 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 179)
2025-12-03 14:18:21,481 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(3,0,6)
2025-12-03 14:18:21,481 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-12-03 14:18:21,481 - game3d.game.terminal - WARNING -   - Attackers: PRIEST at (3,1,6), TRIGONALBISHOP at (4,1,7), ORBITER at (3,3,7), ECHO at (3,0,8), ARMOUR at (3,1,7), SLOWER at (2,0,6), GEOMANCER at (3,0,7), BLACKHOLE at (2,0,7)
2025-12-03 14:18:21,485 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 179)
2025-12-03 14:18:21,485 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(3,0,6)
2025-12-03 14:18:21,485 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-12-03 14:18:21,485 - game3d.game.terminal - WARNING -   - Attackers: PRIEST at (3,1,6), TRIGONALBISHOP at (4,1,7), ORBITER at (3,3,7), ECHO at (3,0,8), ARMOUR at (3,1,7), SLOWER at (2,0,6), GEOMANCER at (3,0,7), BLACKHOLE at (2,0,7)
2025-12-03 14:18:21,489 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 179)
2025-12-03 14:18:21,489 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(3,0,6)
2025-12-03 14:18:21,489 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-12-03 14:18:21,489 - game3d.game.terminal - WARNING -   - Attackers: PRIEST at (3,1,6), TRIGONALBISHOP at (4,1,7), ORBITER at (3,3,7), ECHO at (3,0,8), ARMOUR at (3,1,7), SLOWER at (2,0,6), GEOMANCER at (3,0,7), BLACKHOLE at (2,0,7)
2025-12-03 14:18:22,327 - game3d.game.turnmove - ERROR - CRITICAL: Wall move rejected by validation! Move: Move(from_coord=array([8, 6, 4], dtype=int16), to_coord=array([8, 6, 1], dtype=int16), promotion=None). Dest: [8 6 1]. SIZE=9. Wall requires 2x2 space.
2025-12-03 14:18:22,327 - game3d.game3d - ERROR - âŒ MOVE REJECTED - Wall move to [8 6 1] would place part of the wall out of bounds
2025-12-03 14:18:22,327 - worker.4 - ERROR - Worker 4 failed: Wall move to [8 6 1] would place part of the wall out of bounds
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 82, in submit_move
    raise InvalidMoveError(validation_error)
game3d.game3d.InvalidMoveError: Wall move to [8 6 1] would place part of the wall out of bounds
2025-12-03 14:18:22,331 - training.parallel_self_play - INFO - Stopping Server...
2025-12-03 14:18:23,326 - InferenceServer - INFO - Server shutting down.
2025-12-03 14:24:11,097 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251203_141603/temp_model_for_selfplay.pt
2025-12-03 14:24:11,099 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 10 games, 10 workers
2025-12-03 14:24:14,061 - training.parallel_self_play - INFO - Launching workers...
2025-12-03 14:24:15,625 - training.parallel_self_play - ERROR - Self-play failed: not enough values to unpack (expected 7, got 6)
multiprocessing.pool.RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/usr/lib/python3.13/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
                    ~~~~^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 605, in _pool_worker_shim
    (g_indices, opps, eps, moves, req_q, resp_qs, n_threads) = game_args
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: not enough values to unpack (expected 7, got 6)
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 464, in generate_training_data_parallel
    # 1. Setup Queues
                   ^^
    manager = mp.Manager()
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
               ^^^^^^^^
  File "/usr/lib/python3.13/multiprocessing/pool.py", line 873, in next
    raise value
ValueError: not enough values to unpack (expected 7, got 6)
2025-12-03 14:24:15,633 - training.parallel_self_play - INFO - Stopping Server...
2025-12-03 14:24:22,931 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 10)
2025-12-03 14:24:28,289 - __main__ - ERROR - [ERROR] Unexpected error in iteration 1: not enough values to unpack (expected 7, got 6)
2025-12-03 14:24:28,289 - __main__ - CRITICAL - [ALERT] TRAINING CRASHED: not enough values to unpack (expected 7, got 6)
2025-12-03 14:24:30,085 - __main__ - INFO - Emergency checkpoint saved to model_checkpoints/train_huge_20251203_141603/emergency_checkpoint.pt
2025-12-03 14:24:30,087 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-12-03 14:28:46,861 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-12-03 14:28:46,862 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:28:46,865 - __main__ - INFO - Testing move generation...
2025-12-03 14:28:55,518 - __main__ - INFO - [OK] Generated 2418 moves
2025-12-03 14:28:55,518 - __main__ - INFO - Testing GameState caching...
2025-12-03 14:28:55,519 - __main__ - INFO - [OK] GameState caching works
2025-12-03 14:28:55,519 - __main__ - INFO - Testing MoveCache persistence...
2025-12-03 14:28:55,519 - __main__ - INFO - [OK] MoveCache works correctly
2025-12-03 14:28:55,519 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(2418), 'piece_moves_cache_size': 128, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-12-03 14:28:57,124 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251203_142842/temp_model_for_selfplay.pt
2025-12-03 14:28:57,124 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 12 games, 6 workers
2025-12-03 14:29:00,066 - training.parallel_self_play - INFO - Launching workers...
2025-12-03 14:29:12,626 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-12-03 14:29:19,530 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:29:19,532 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140702244669952
2025-12-03 14:29:19,534 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:29:19,535 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140626103720480
2025-12-03 14:29:19,535 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:29:19,536 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140702220743680
2025-12-03 14:29:19,539 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:29:19,539 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140626131990416
2025-12-03 14:29:19,556 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:29:19,557 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140043717269904
2025-12-03 14:29:19,558 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:29:19,560 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139618583681376
2025-12-03 14:29:19,560 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:29:19,560 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140043749492144
2025-12-03 14:29:19,565 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:29:19,565 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139618615732128
2025-12-03 14:29:19,588 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:29:19,589 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140178148311584
2025-12-03 14:29:19,591 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:29:19,592 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139860129454672
2025-12-03 14:29:19,594 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:29:19,595 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140178178385824
2025-12-03 14:29:19,595 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:29:19,595 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139860135803872
2025-12-03 14:29:23,273 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-12-03 14:29:23,286 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-12-03 14:29:23,286 - InferenceServer - INFO - Server Ready. Listening...
2025-12-03 14:29:39,322 - InferenceServer - INFO - Server shutting down.
2025-12-03 14:29:39,323 - training.parallel_self_play - INFO - Stopping Server...
2025-12-03 14:29:39,764 - __main__ - INFO - Training interrupted by user
2025-12-03 14:29:40,026 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-12-03 14:29:43,201 - __main__ - INFO - Final model saved to model_checkpoints/train_huge_20251203_142842/model_final.pt
2025-12-03 14:33:21,900 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-12-03 14:33:21,900 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:33:21,901 - __main__ - INFO - Testing move generation...
2025-12-03 14:33:23,404 - __main__ - INFO - [OK] Generated 2418 moves
2025-12-03 14:33:23,404 - __main__ - INFO - Testing GameState caching...
2025-12-03 14:33:23,405 - __main__ - INFO - [OK] GameState caching works
2025-12-03 14:33:23,405 - __main__ - INFO - Testing MoveCache persistence...
2025-12-03 14:33:23,405 - __main__ - INFO - [OK] MoveCache works correctly
2025-12-03 14:33:23,406 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(2418), 'piece_moves_cache_size': 128, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-12-03 14:33:24,997 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251203_143317/temp_model_for_selfplay.pt
2025-12-03 14:33:24,997 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 6 games, 6 workers
2025-12-03 14:33:27,867 - training.parallel_self_play - INFO - Launching workers...
2025-12-03 14:33:37,709 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-12-03 14:33:43,477 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:33:43,478 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:33:43,479 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139745979196144
2025-12-03 14:33:43,479 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139905809456416
2025-12-03 14:33:43,482 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:33:43,483 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140297771344192
2025-12-03 14:33:43,484 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:33:43,485 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140505165533904
2025-12-03 14:33:43,495 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:33:43,496 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140478132708176
2025-12-03 14:33:43,504 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-03 14:33:43,505 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140020920082320
2025-12-03 14:33:45,015 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-12-03 14:33:45,019 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-12-03 14:33:45,019 - InferenceServer - INFO - Server Ready. Listening...
2025-12-03 14:34:14,244 - game3d.game.turnmove - INFO - Move 100: BLACK PAWN [4 2 6]->[4 2 5] (Capture)
2025-12-03 14:34:14,697 - game3d.game.turnmove - INFO - Move 100: BLACK PAWN [4 2 6]->[4 2 4] (Move)
2025-12-03 14:34:19,657 - game3d.game.turnmove - INFO - Move 200: BLACK QUEEN [8 5 2]->[8 5 1] (Capture)
2025-12-03 14:34:21,204 - game3d.game.turnmove - INFO - Move 200: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-12-03 14:34:31,304 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-12-03 14:34:31,314 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 299)
2025-12-03 14:34:31,314 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:34:31,314 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,7)
2025-12-03 14:34:31,314 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,3,0), SWAPPER at (5,3,6)
2025-12-03 14:34:31,319 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 299)
2025-12-03 14:34:31,319 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:34:31,319 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,7)
2025-12-03 14:34:31,319 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,3,0), SWAPPER at (5,3,6)
2025-12-03 14:34:31,325 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 299)
2025-12-03 14:34:31,325 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:34:31,325 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,7)
2025-12-03 14:34:31,325 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,3,0), SWAPPER at (5,3,6)
2025-12-03 14:34:31,333 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 299)
2025-12-03 14:34:31,333 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:34:31,333 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,7)
2025-12-03 14:34:31,333 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,3,0), SWAPPER at (5,3,6)
2025-12-03 14:34:31,339 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 299)
2025-12-03 14:34:31,340 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:34:31,340 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,7)
2025-12-03 14:34:31,340 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,3,0), SWAPPER at (5,3,6)
2025-12-03 14:34:33,994 - game3d.game.turnmove - INFO - Move 100: WHITE XZQUEEN [4 7 3]->[0 7 7] (Capture)
2025-12-03 14:34:35,509 - game3d.game.turnmove - INFO - Move 100: WHITE PAWN [8 7 2]->[8 7 4] (Move)
2025-12-03 14:34:37,822 - game3d.game.turnmove - INFO - Move 300: BLACK YZQUEEN [5 7 8]->[5 0 1] (Capture)
2025-12-03 14:34:38,157 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-12-03 14:34:38,160 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 104)
2025-12-03 14:34:38,160 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:34:38,160 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:34:38,160 - game3d.game.terminal - WARNING -   - Attackers: KNIGHT32 at (6,4,5)
2025-12-03 14:34:38,163 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 104)
2025-12-03 14:34:38,163 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:34:38,163 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:34:38,163 - game3d.game.terminal - WARNING -   - Attackers: KNIGHT32 at (6,4,5)
2025-12-03 14:34:38,167 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 104)
2025-12-03 14:34:38,167 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:34:38,168 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:34:38,168 - game3d.game.terminal - WARNING -   - Attackers: KNIGHT32 at (6,4,5)
2025-12-03 14:34:38,171 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 104)
2025-12-03 14:34:38,171 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:34:38,171 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:34:38,171 - game3d.game.terminal - WARNING -   - Attackers: KNIGHT32 at (6,4,5)
2025-12-03 14:34:38,176 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 104)
2025-12-03 14:34:38,176 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:34:38,176 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:34:38,176 - game3d.game.terminal - WARNING -   - Attackers: KNIGHT32 at (6,4,5)
2025-12-03 14:34:38,822 - game3d.game.turnmove - INFO - Move 100: WHITE SWAPPER [1 3 0]->[8 7 4] (Move)
2025-12-03 14:34:41,980 - game3d.game.turnmove - INFO - Move 100: BLACK WALL [6 6 7]->[6 4 5] (Capture)
2025-12-03 14:34:44,711 - game3d.game.turnmove - INFO - Move 200: WHITE SWAPPER [7 3 0]->[5 6 0] (Move)
2025-12-03 14:34:47,886 - game3d.game.turnmove - INFO - Move 200: WHITE ARMOUR [4 3 4]->[4 3 5] (Capture)
2025-12-03 14:34:49,439 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-12-03 14:34:49,447 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 321)
2025-12-03 14:34:49,447 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:34:49,447 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,3,8)
2025-12-03 14:34:49,447 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,3,7), WALL at (6,2,8), FRIENDLYTELEPORTER at (0,8,2), GEOMANCER at (5,4,4)
2025-12-03 14:34:49,453 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 321)
2025-12-03 14:34:49,453 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:34:49,453 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,3,8)
2025-12-03 14:34:49,453 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,3,7), WALL at (6,2,8), FRIENDLYTELEPORTER at (0,8,2), GEOMANCER at (5,4,4)
2025-12-03 14:34:49,458 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 321)
2025-12-03 14:34:49,458 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:34:49,458 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,3,8)
2025-12-03 14:34:49,458 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,3,7), WALL at (6,2,8), FRIENDLYTELEPORTER at (0,8,2), GEOMANCER at (5,4,4)
2025-12-03 14:34:49,464 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 321)
2025-12-03 14:34:49,464 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:34:49,465 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,3,8)
2025-12-03 14:34:49,465 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,3,7), WALL at (6,2,8), FRIENDLYTELEPORTER at (0,8,2), GEOMANCER at (5,4,4)
2025-12-03 14:34:49,469 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE, Turn: 321)
2025-12-03 14:34:49,469 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-12-03 14:34:49,469 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,3,8)
2025-12-03 14:34:49,469 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,3,7), WALL at (6,2,8), FRIENDLYTELEPORTER at (0,8,2), GEOMANCER at (5,4,4)
2025-12-03 14:34:53,263 - game3d.game.turnmove - INFO - Move 200: BLACK QUEEN [7 5 6]->[4 5 3] (Capture)
2025-12-03 14:34:53,811 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-12-03 14:34:53,817 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 221)
2025-12-03 14:34:53,817 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(5,4,0)
2025-12-03 14:34:53,817 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:34:53,817 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,4,1)
2025-12-03 14:34:53,820 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 221)
2025-12-03 14:34:53,820 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(5,4,0)
2025-12-03 14:34:53,820 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:34:53,820 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,4,1)
2025-12-03 14:34:53,824 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 221)
2025-12-03 14:34:53,824 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(5,4,0)
2025-12-03 14:34:53,824 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:34:53,824 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,4,1)
2025-12-03 14:34:53,828 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 221)
2025-12-03 14:34:53,828 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(5,4,0)
2025-12-03 14:34:53,828 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:34:53,828 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,4,1)
2025-12-03 14:34:53,832 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 221)
2025-12-03 14:34:53,832 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(5,4,0)
2025-12-03 14:34:53,832 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:34:53,832 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,4,1)
2025-12-03 14:34:53,990 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-12-03 14:34:53,998 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 221)
2025-12-03 14:34:53,998 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,0)
2025-12-03 14:34:53,998 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:34:53,998 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,5,1), FRIENDLYTELEPORTER at (1,3,8), FRIENDLYTELEPORTER at (1,6,8), FRIENDLYTELEPORTER at (5,2,7), FRIENDLYTELEPORTER at (8,8,7)
2025-12-03 14:34:54,005 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 221)
2025-12-03 14:34:54,005 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,0)
2025-12-03 14:34:54,005 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:34:54,005 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,5,1), FRIENDLYTELEPORTER at (1,3,8), FRIENDLYTELEPORTER at (1,6,8), FRIENDLYTELEPORTER at (5,2,7), FRIENDLYTELEPORTER at (8,8,7)
2025-12-03 14:34:54,012 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 221)
2025-12-03 14:34:54,012 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,0)
2025-12-03 14:34:54,012 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:34:54,012 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,5,1), FRIENDLYTELEPORTER at (1,3,8), FRIENDLYTELEPORTER at (1,6,8), FRIENDLYTELEPORTER at (5,2,7), FRIENDLYTELEPORTER at (8,8,7)
2025-12-03 14:34:54,018 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 221)
2025-12-03 14:34:54,018 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,0)
2025-12-03 14:34:54,018 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:34:54,018 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,5,1), FRIENDLYTELEPORTER at (1,3,8), FRIENDLYTELEPORTER at (1,6,8), FRIENDLYTELEPORTER at (5,2,7), FRIENDLYTELEPORTER at (8,8,7)
2025-12-03 14:34:54,024 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 221)
2025-12-03 14:34:54,024 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,0)
2025-12-03 14:34:54,024 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:34:54,024 - game3d.game.terminal - WARNING -   - Attackers: WALL at (4,5,1), FRIENDLYTELEPORTER at (1,3,8), FRIENDLYTELEPORTER at (1,6,8), FRIENDLYTELEPORTER at (5,2,7), FRIENDLYTELEPORTER at (8,8,7)
2025-12-03 14:35:06,953 - game3d.game.turnmove - INFO - Move 300: BLACK GEOMANCER [5 0 7]->[8 3 5] (Move)
2025-12-03 14:35:16,165 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-12-03 14:35:16,170 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 322)
2025-12-03 14:35:16,170 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(6,4,0)
2025-12-03 14:35:16,170 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:35:16,170 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,3,0)
2025-12-03 14:35:16,172 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 322)
2025-12-03 14:35:16,172 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(6,4,0)
2025-12-03 14:35:16,172 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:35:16,172 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,3,0)
2025-12-03 14:35:16,175 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 322)
2025-12-03 14:35:16,175 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(6,4,0)
2025-12-03 14:35:16,175 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:35:16,175 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,3,0)
2025-12-03 14:35:16,179 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 322)
2025-12-03 14:35:16,179 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(6,4,0)
2025-12-03 14:35:16,179 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:35:16,179 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,3,0)
2025-12-03 14:35:16,182 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 322)
2025-12-03 14:35:16,182 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(6,4,0)
2025-12-03 14:35:16,182 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-12-03 14:35:16,182 - game3d.game.terminal - WARNING -   - Attackers: WALL at (5,3,0)
2025-12-03 14:35:16,409 - training.parallel_self_play - INFO - Stopping Server...
2025-12-03 14:35:17,074 - InferenceServer - INFO - Server shutting down.
2025-12-03 14:38:34,617 - __main__ - ERROR - [ERROR] Unexpected error in iteration 0: float division by zero
2025-12-03 14:38:34,618 - __main__ - CRITICAL - [ALERT] TRAINING CRASHED: float division by zero
2025-12-03 14:38:36,594 - __main__ - INFO - Emergency checkpoint saved to model_checkpoints/train_huge_20251203_143317/emergency_checkpoint.pt
2025-12-03 14:38:36,596 - __main__ - INFO - ðŸ§¹ Clearing all caches...
