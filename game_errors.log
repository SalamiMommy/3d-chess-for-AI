2025-12-11 15:14:10,330 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-12-11 15:14:10,687 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-11 15:14:10,689 - __main__ - INFO - Testing move generation...
2025-12-11 15:14:28,932 - __main__ - INFO - [OK] Generated 2594 moves
2025-12-11 15:14:28,932 - __main__ - INFO - Testing GameState caching...
2025-12-11 15:14:28,932 - __main__ - INFO - [OK] GameState caching works (via MoveCache)
2025-12-11 15:14:28,932 - __main__ - INFO - Testing MoveCache persistence...
2025-12-11 15:14:28,932 - __main__ - INFO - [OK] MoveCache works correctly
2025-12-11 15:14:28,932 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.75), 'pseudolegal_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(2594), 'piece_moves_cache_size': 130, 'prune_operations': 0, 'cache_hits': np.int32(3), 'cache_misses': np.int32(1)}
2025-12-11 15:14:30,300 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251211_151406/temp_model_for_selfplay.pt
2025-12-11 15:14:30,300 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 60 games, 10 workers
2025-12-11 15:14:33,119 - training.parallel_self_play - INFO - Launching workers...
2025-12-11 15:14:46,331 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 10)
2025-12-11 15:14:54,419 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-11 15:14:54,421 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140623543457424
2025-12-11 15:14:54,596 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-11 15:14:54,598 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139714805570944
2025-12-11 15:14:54,650 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-11 15:14:54,651 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139740893109920
2025-12-11 15:14:54,722 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-11 15:14:54,724 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140453957244752
2025-12-11 15:14:54,734 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-11 15:14:54,736 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140419653145872
2025-12-11 15:14:54,747 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-11 15:14:54,749 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139710405746576
2025-12-11 15:14:54,810 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-11 15:14:54,811 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140283167297920
2025-12-11 15:14:54,819 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-11 15:14:54,820 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140264966117248
2025-12-11 15:14:54,837 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-11 15:14:54,838 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139876573600624
2025-12-11 15:14:54,840 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-11 15:14:54,841 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140393089537824
2025-12-11 15:14:55,903 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-12-11 15:14:55,907 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-12-11 15:14:55,907 - InferenceServer - INFO - Server Ready. Listening...
2025-12-11 15:14:55,913 - InferenceServer - INFO - Processing first batch (this may trigger compilation)...
2025-12-11 15:14:58,318 - InferenceServer - INFO - First batch processed.
2025-12-11 15:15:12,399 - filelock - DEBUG - Attempting to acquire lock 140280076423184 on /tmp/torchinductor_salamimommy/locks/c6nc4c3n23q243hd35kjssaeh4b477sbyifhui2oulilbs56pbkq.lock
2025-12-11 15:15:12,399 - filelock - DEBUG - Lock 140280076423184 acquired on /tmp/torchinductor_salamimommy/locks/c6nc4c3n23q243hd35kjssaeh4b477sbyifhui2oulilbs56pbkq.lock
2025-12-11 15:15:13,895 - filelock - DEBUG - Attempting to release lock 140280076423184 on /tmp/torchinductor_salamimommy/locks/c6nc4c3n23q243hd35kjssaeh4b477sbyifhui2oulilbs56pbkq.lock
2025-12-11 15:15:13,895 - filelock - DEBUG - Lock 140280076423184 released on /tmp/torchinductor_salamimommy/locks/c6nc4c3n23q243hd35kjssaeh4b477sbyifhui2oulilbs56pbkq.lock
2025-12-11 15:15:13,896 - filelock - DEBUG - Attempting to acquire lock 140279756604432 on /tmp/torchinductor_salamimommy/locks/cs3ckc3nlqqdamg25egnlvhwshkaajnyvlnz3pdsyqpygf3w3pxa.lock
2025-12-11 15:15:13,896 - filelock - DEBUG - Lock 140279756604432 acquired on /tmp/torchinductor_salamimommy/locks/cs3ckc3nlqqdamg25egnlvhwshkaajnyvlnz3pdsyqpygf3w3pxa.lock
2025-12-11 15:15:13,896 - filelock - DEBUG - Attempting to release lock 140279756604432 on /tmp/torchinductor_salamimommy/locks/cs3ckc3nlqqdamg25egnlvhwshkaajnyvlnz3pdsyqpygf3w3pxa.lock
2025-12-11 15:15:13,896 - filelock - DEBUG - Lock 140279756604432 released on /tmp/torchinductor_salamimommy/locks/cs3ckc3nlqqdamg25egnlvhwshkaajnyvlnz3pdsyqpygf3w3pxa.lock
2025-12-11 15:15:27,582 - game3d.game.turnmove - INFO - Move 100: WHITE PAWN [1 2 2]->[1 2 3] (Capture)
2025-12-11 15:15:27,583 - game3d.game.turnmove - INFO - Move 100: WHITE SWAPPER [0 2 0]->[2 2 2] (Move)
2025-12-11 15:15:27,646 - game3d.game.turnmove - INFO - Move 100: WHITE PAWN [1 2 2]->[1 2 3] (Capture)
2025-12-11 15:15:27,647 - game3d.game.turnmove - INFO - Move 100: WHITE INFILTRATOR [2 5 1]->[3 5 2] (Capture)
2025-12-11 15:15:27,651 - game3d.game.turnmove - INFO - Move 100: BLACK ECHO [3 7 7]->[5 4 5] (Move)
2025-12-11 15:15:27,707 - game3d.game.turnmove - INFO - Move 100: WHITE GEOMANCER [3 0 1]->[6 0 4] (Move)
2025-12-11 15:15:28,025 - game3d.game.turnmove - INFO - Move 100: BLACK PANEL [2 2 8]->[3 2 8] (Capture)
2025-12-11 15:15:28,150 - game3d.game.turnmove - INFO - Move 100: BLACK PAWN [7 1 6]->[7 1 5] (Move)
2025-12-11 15:15:29,715 - game3d.game.turnmove - INFO - Move 100: BLACK PAWN [3 5 6]->[3 5 4] (Move)
2025-12-11 15:15:39,056 - game3d.game.turnmove - INFO - Move 200: BLACK ORBITER [0 4 5]->[1 2 3] (Capture)
2025-12-11 15:15:39,057 - game3d.game.turnmove - INFO - Move 200: WHITE ORBITER [5 0 3]->[6 1 6] (Capture)
2025-12-11 15:15:39,112 - game3d.game.turnmove - INFO - Move 200: BLACK PAWN [6 5 6]->[5 4 5] (Capture)
2025-12-11 15:15:39,115 - game3d.game.turnmove - INFO - Move 200: BLACK TRIGONALBISHOP [4 1 7]->[3 2 6] (Capture)
2025-12-11 15:15:39,417 - game3d.game.turnmove - INFO - Move 200: WHITE KNIGHT [6 4 1]->[5 4 3] (Capture)
2025-12-11 15:15:39,520 - game3d.game.turnmove - INFO - Move 200: BLACK SWAPPER [7 3 8]->[8 0 2] (Move)
2025-12-11 15:15:40,383 - game3d.game.turnmove - INFO - Move 200: WHITE ORBITER [4 8 0]->[5 5 0] (Capture)
2025-12-11 15:15:40,536 - game3d.game.turnmove - INFO - Move 200: BLACK TRAILBLAZER [4 3 8]->[3 3 8] (Capture)
2025-12-11 15:15:46,662 - game3d.game.turnmove - INFO - Move 100: BLACK PAWN [3 5 6]->[3 5 4] (Move)
2025-12-11 15:15:51,291 - game3d.game.turnmove - INFO - Move 300: WHITE PAWN [3 5 3]->[3 5 4] (Move)
2025-12-11 15:15:51,424 - game3d.game.turnmove - INFO - Move 300: WHITE SWAPPER [0 2 0]->[2 2 2] (Move)
2025-12-11 15:15:51,763 - game3d.game.turnmove - INFO - Move 300: WHITE ARMOUR [5 1 1]->[5 1 2] (Capture)
2025-12-11 15:15:51,826 - game3d.game.turnmove - INFO - Move 300: BLACK ARMOUR [4 5 3]->[4 5 2] (Capture)
2025-12-11 15:15:52,502 - game3d.game.turnmove - INFO - Move 300: BLACK ARMOUR [5 7 7]->[4 7 6] (Move)
2025-12-11 15:15:53,085 - game3d.game.turnmove - INFO - Move 300: BLACK EDGEROOK [3 8 8]->[4 8 7] (Move)
2025-12-11 15:15:53,090 - game3d.game.turnmove - INFO - Move 300: BLACK KNIGHT [2 4 7]->[4 4 6] (Capture)
2025-12-11 15:15:53,454 - game3d.movement.generator - WARNING - [_apply_all_filters] ALL moves filtered by KING_SAFETY
2025-12-11 15:15:53,454 - game3d.cache.caches.movecache - DEBUG - No legal moves for WHITE - 144 pieces (Priests: 0)
2025-12-11 15:15:54,519 - game3d.game.turnmove - INFO - Move 300: BLACK WHITEHOLE [0 2 7]->[1 3 8] (Capture)
2025-12-11 15:15:57,257 - game3d.game.turnmove - INFO - Move 200: BLACK PAWN [8 8 5]->[8 8 4] (Move)
2025-12-11 15:15:58,065 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 306)
2025-12-11 15:15:58,065 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(3,1,5)
2025-12-11 15:15:58,065 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-12-11 15:15:58,065 - game3d.game.terminal - WARNING -   - Attackers: PAWN at (2, 2, 6), KNIGHT32 at (3, 3, 8), SLOWER at (2, 1, 6), BLACKHOLE at (2, 0, 6), WALL at (1, 1, 7)
2025-12-11 15:15:58,067 - game3d.movement.generator - WARNING - [_apply_all_filters] ALL moves filtered by KING_SAFETY
2025-12-11 15:15:58,067 - game3d.cache.caches.movecache - DEBUG - No legal moves for WHITE - 144 pieces (Priests: 0)
2025-12-11 15:15:58,068 - worker.3 - DEBUG - Worker 3: Game over detected via receipt (result=2)
2025-12-11 15:15:58,071 - game3d.movement.generator - WARNING - [_apply_all_filters] ALL moves filtered by KING_SAFETY
2025-12-11 15:15:58,071 - game3d.cache.caches.movecache - DEBUG - No legal moves for WHITE - 144 pieces (Priests: 0)
2025-12-11 15:15:58,073 - game3d.movement.generator - WARNING - [_apply_all_filters] ALL moves filtered by KING_SAFETY
2025-12-11 15:15:58,073 - game3d.cache.caches.movecache - DEBUG - No legal moves for WHITE - 144 pieces (Priests: 0)
2025-12-11 15:15:58,242 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-11 15:15:58,243 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139705410233312
2025-12-11 15:16:01,551 - game3d.game.turnmove - INFO - Move 200: BLACK KNIGHT [6 4 7]->[5 4 5] (Capture)
2025-12-11 15:16:03,977 - game3d.game.turnmove - INFO - Move 400: WHITE KING [5 0 4]->[5 1 5] (Capture)
2025-12-11 15:16:04,120 - game3d.game.turnmove - INFO - Move 400: WHITE SWAPPER [4 3 0]->[4 3 1] (Move)
2025-12-11 15:16:04,872 - game3d.game.turnmove - INFO - Move 400: BLACK SPEEDER [8 6 7]->[7 6 6] (Move)
2025-12-11 15:16:06,130 - game3d.game.turnmove - INFO - Move 400: BLACK BISHOP [8 4 7]->[4 4 3] (Move)
2025-12-11 15:16:06,561 - game3d.game.turnmove - INFO - Move 400: WHITE FREEZER [0 0 4]->[1 1 4] (Move)
2025-12-11 15:16:07,468 - game3d.game.turnmove - INFO - Move 400: WHITE SWAPPER [1 8 2]->[2 2 2] (Move)
2025-12-11 15:16:08,074 - game3d.game.turnmove - INFO - Move 400: BLACK PAWN [0 0 6]->[0 0 5] (Move)
2025-12-11 15:16:11,599 - game3d.game.turnmove - INFO - Move 100: BLACK ORBITER [8 4 8]->[7 4 5] (Move)
2025-12-11 15:16:11,780 - game3d.game.turnmove - INFO - Move 300: WHITE WALL [6 1 1]->[6 0 1] (Capture)
2025-12-11 15:16:12,669 - game3d.movement.generator - WARNING - [_apply_all_filters] ALL moves filtered by KING_SAFETY
2025-12-11 15:16:12,669 - game3d.cache.caches.movecache - DEBUG - No legal moves for WHITE - 125 pieces (Priests: 0)
2025-12-11 15:16:12,722 - game3d.attacks.check - WARNING - get_attackers: 1219 moves generated but none target king at [5 1 5]
2025-12-11 15:16:12,722 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK, Turn: 454)
2025-12-11 15:16:12,722 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(5,1,5)
2025-12-11 15:16:12,722 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(3,3,8)
2025-12-11 15:16:12,722 - game3d.game.terminal - WARNING -   - Attackers: Unknown
2025-12-11 15:16:12,724 - game3d.movement.generator - WARNING - [_apply_all_filters] ALL moves filtered by KING_SAFETY
2025-12-11 15:16:12,724 - game3d.cache.caches.movecache - DEBUG - No legal moves for WHITE - 125 pieces (Priests: 0)
2025-12-11 15:16:12,724 - worker.9 - DEBUG - Worker 9: Game over detected via receipt (result=2)
2025-12-11 15:16:12,729 - game3d.movement.generator - WARNING - [_apply_all_filters] ALL moves filtered by KING_SAFETY
2025-12-11 15:16:12,729 - game3d.cache.caches.movecache - DEBUG - No legal moves for WHITE - 125 pieces (Priests: 0)
2025-12-11 15:16:12,731 - game3d.movement.generator - WARNING - [_apply_all_filters] ALL moves filtered by KING_SAFETY
2025-12-11 15:16:12,731 - game3d.cache.caches.movecache - DEBUG - No legal moves for WHITE - 125 pieces (Priests: 0)
2025-12-11 15:16:13,051 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-12-11 15:16:13,051 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140259963381472
2025-12-11 15:16:15,976 - game3d.game.turnmove - INFO - Move 300: WHITE SWAPPER [4 2 1]->[4 1 3] (Move)
2025-12-11 15:16:17,899 - game3d.game.turnmove - INFO - Move 500: WHITE SPIRAL [7 5 0]->[7 4 0] (Move)
2025-12-11 15:16:18,775 - game3d.game.turnmove - INFO - Move 500: WHITE HIVE [4 6 2]->[3 5 3] (Move)
2025-12-11 15:16:20,486 - game3d.game.turnmove - INFO - Move 500: BLACK PAWN [4 1 4]->[4 1 3] (Move)
2025-12-11 15:16:21,487 - game3d.game.turnmove - INFO - Move 500: WHITE SWAPPER [2 2 2]->[0 6 0] (Move)
2025-12-11 15:16:21,582 - game3d.game.turnmove - INFO - Move 500: BLACK PAWN [1 6 5]->[0 5 4] (Capture)
2025-12-11 15:16:22,219 - game3d.game.turnmove - INFO - Move 500: BLACK XYQUEEN [4 3 6]->[5 4 5] (Move)
2025-12-11 15:16:24,704 - training.parallel_self_play - INFO - Stopping Server...
2025-12-11 15:16:24,726 - InferenceServer - INFO - Server shutting down.
2025-12-11 15:16:25,183 - __main__ - INFO - Training interrupted by user
2025-12-11 15:16:25,389 - __main__ - INFO - ðŸ§¹ Clearing all caches...
