2025-11-28 16:52:50,591 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 16:52:50,591 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 16:52:50,594 - __main__ - INFO - Testing move generation...
2025-11-28 16:52:56,753 - __main__ - INFO - [OK] Generated 845 moves
2025-11-28 16:52:56,753 - __main__ - INFO - Testing GameState caching...
2025-11-28 16:52:56,754 - __main__ - INFO - [OK] GameState caching works
2025-11-28 16:52:56,754 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 16:52:56,754 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 16:52:56,754 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(845), 'piece_moves_cache_size': 107, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 16:52:58,154 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_165246/temp_model_for_selfplay.pt
2025-11-28 16:52:58,154 - training.parallel_self_play - INFO - Starting parallel self-play: 1 games, 1 workers
2025-11-28 16:52:58,154 - training.parallel_self_play - INFO - Model checkpoint: model_checkpoints/train_huge_20251128_165246/temp_model_for_selfplay.pt
2025-11-28 16:52:58,154 - training.parallel_self_play - INFO - Device: cuda, Model size: huge
2025-11-28 16:52:58,155 - training.parallel_self_play - INFO - Launching 1 game workers...
2025-11-28 16:53:04,987 - worker.0 - INFO - Worker 0 starting, loading model...
2025-11-28 16:53:09,335 - worker.0 - INFO - Worker 0 model compiled with torch.compile
2025-11-28 16:53:09,336 - worker.0 - INFO - Worker 0 model loaded successfully
2025-11-28 16:53:09,644 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 16:53:09,645 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140709885411184
2025-11-28 16:53:22,655 - game3d.game.turnmove - INFO - Move 100: WHITE SPIRAL [8 7 0]->[7 7 1] (Move)
2025-11-28 16:53:26,771 - game3d.game.turnmove - INFO - Move 200: BLACK FRIENDLYTELEPORTER [5 0 4]->[6 1 3] (Move)
2025-11-28 16:53:30,410 - game3d.game.turnmove - INFO - Move 300: WHITE QUEEN [3 8 5]->[5 6 5] (Capture)
2025-11-28 16:53:36,744 - game3d.game.turnmove - INFO - Move 400: WHITE NEBULA [2 5 0]->[2 4 0] (Move)
2025-11-28 16:53:40,508 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 16:53:40,508 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 16:53:44,337 - game3d.game.turnmove - INFO - Move 500: BLACK WHITEHOLE [0 4 7]->[1 5 6] (Move)
2025-11-28 16:53:53,459 - game3d.game.turnmove - INFO - Move 600: WHITE KNIGHT32 [5 3 4]->[2 1 6] (Move)
2025-11-28 16:53:59,652 - game3d.game.turnmove - INFO - Move 700: WHITE FRIENDLYTELEPORTER [7 7 4]->[8 7 3] (Move)
2025-11-28 16:54:02,598 - game3d.game.turnmove - INFO - Move 800: BLACK FREEZER [4 6 1]->[3 5 1] (Move)
2025-11-28 16:54:07,202 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 16:54:07,202 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 16:54:09,952 - game3d.game.turnmove - INFO - Move 900: BLACK SLOWER [2 2 6]->[3 3 6] (Move)
2025-11-28 16:54:11,751 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 16:54:11,751 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 16:54:12,765 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 16:54:12,765 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 16:54:17,108 - game3d.game.turnmove - INFO - Move 1000: WHITE SLOWER [3 5 7]->[4 4 7] (Move)
2025-11-28 16:54:19,026 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 16:54:19,026 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 16:54:19,205 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 16:54:19,205 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 16:54:19,874 - game3d.game.turnmove - INFO - Move 1100: BLACK FREEZER [3 4 0]->[3 5 1] (Move)
2025-11-28 16:54:22,310 - game3d.game.turnmove - INFO - Move 1200: BLACK MIRROR [4 4 6]->[3 3 6] (Move)
2025-11-28 16:54:24,734 - game3d.game.turnmove - INFO - Move 1300: BLACK PAWN [8 2 3]->[8 1 3] (Move)
2025-11-28 16:54:27,083 - game3d.game.turnmove - INFO - Move 1400: BLACK XZZIGZAG [1 1 8]->[6 1 8] (Move)
2025-11-28 16:54:29,174 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 16 pieces - possible stalemate
2025-11-28 16:54:29,176 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 16 pieces completely immobilized)
2025-11-28 16:54:29,177 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 16 pieces completely immobilized)
2025-11-28 16:54:29,177 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 16 pieces completely immobilized)
2025-11-28 16:54:29,185 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 16 pieces completely immobilized)
2025-11-28 16:54:29,186 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 16 pieces completely immobilized)
2025-11-28 16:54:29,186 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 16 pieces completely immobilized)
2025-11-28 16:54:29,187 - worker.0 - INFO - GAME FINISHED: 0 | DRAW (Stalemate) | 1482 moves | 79.5s | Mat: W=30/B=16 | Priests: W=N B=N | Kings: W=Y B=Y
2025-11-28 16:54:29,187 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 16 pieces completely immobilized)
2025-11-28 16:54:30,401 - training.parallel_self_play - INFO - Game completed: 1482 examples collected
2025-11-28 16:54:32,647 - training.parallel_self_play - INFO - Self-play complete: 1482 total examples from 1 games
2025-11-28 16:54:39,193 - __main__ - INFO - Training interrupted by user
2025-11-28 16:54:39,196 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 16:57:19,274 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 16:57:19,275 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 16:57:19,278 - __main__ - INFO - Testing move generation...
2025-11-28 16:57:25,485 - __main__ - INFO - [OK] Generated 845 moves
2025-11-28 16:57:25,485 - __main__ - INFO - Testing GameState caching...
2025-11-28 16:57:25,486 - __main__ - INFO - [OK] GameState caching works
2025-11-28 16:57:25,486 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 16:57:25,486 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 16:57:25,486 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(845), 'piece_moves_cache_size': 107, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 16:57:26,874 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_165715/temp_model_for_selfplay.pt
2025-11-28 16:57:26,874 - training.parallel_self_play - INFO - Starting parallel self-play: 2 games, 2 workers
2025-11-28 16:57:26,874 - training.parallel_self_play - INFO - Model checkpoint: model_checkpoints/train_huge_20251128_165715/temp_model_for_selfplay.pt
2025-11-28 16:57:26,874 - training.parallel_self_play - INFO - Device: cuda, Model size: huge
2025-11-28 16:57:26,875 - training.parallel_self_play - INFO - Launching 2 game workers...
2025-11-28 16:57:34,137 - worker.0 - INFO - Worker 0 starting, loading model...
2025-11-28 16:57:34,200 - worker.1 - INFO - Worker 1 starting, loading model...
2025-11-28 16:57:39,072 - worker.0 - INFO - Worker 0 model compiled with torch.compile
2025-11-28 16:57:39,073 - worker.0 - INFO - Worker 0 model loaded successfully
2025-11-28 16:57:39,319 - worker.1 - INFO - Worker 1 model compiled with torch.compile
2025-11-28 16:57:39,320 - worker.1 - INFO - Worker 1 model loaded successfully
2025-11-28 16:57:39,402 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 16:57:39,403 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140428950725168
2025-11-28 16:57:39,586 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 16:57:39,587 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140459931890400
2025-11-28 16:57:54,231 - game3d.game.turnmove - INFO - Move 100: WHITE ARMOUR [3 1 2]->[3 1 3] (Move)
2025-11-28 16:57:58,149 - game3d.game.turnmove - INFO - Move 100: BLACK NEBULA [2 5 8]->[5 4 8] (Capture)
2025-11-28 16:57:59,746 - game3d.game.turnmove - INFO - Move 200: WHITE ROOK [5 5 1]->[5 5 6] (Capture)
2025-11-28 16:58:03,855 - game3d.game.turnmove - INFO - Move 300: WHITE TRIGONALBISHOP [5 4 7]->[4 5 8] (Move)
2025-11-28 16:58:04,149 - game3d.game.turnmove - INFO - Move 200: BLACK REFLECTOR [5 8 3]->[4 7 2] (Capture)
2025-11-28 16:58:08,734 - game3d.game.turnmove - INFO - Move 400: WHITE TRIGONALBISHOP [4 1 4]->[2 3 6] (Capture)
2025-11-28 16:58:09,056 - game3d.game.turnmove - INFO - Move 300: BLACK BOMB [8 3 8]->[8 4 8] (Move)
2025-11-28 16:58:15,884 - game3d.game.turnmove - INFO - Move 500: BLACK SPIRAL [3 8 1]->[4 8 0] (Move)
2025-11-28 16:58:19,376 - game3d.game.turnmove - INFO - Move 400: WHITE WHITEHOLE [1 4 2]->[2 5 3] (Move)
2025-11-28 16:58:22,424 - game3d.game.turnmove - INFO - Move 600: WHITE QUEEN [4 4 1]->[4 4 3] (Move)
2025-11-28 16:58:29,614 - game3d.game.turnmove - INFO - Move 500: BLACK YZQUEEN [5 1 8]->[5 4 5] (Capture)
2025-11-28 16:58:32,692 - game3d.game.turnmove - INFO - Move 700: WHITE QUEEN [4 4 3]->[4 4 7] (Move)
2025-11-28 16:58:37,530 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 16:58:37,530 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 16:58:38,209 - game3d.game.turnmove - INFO - Move 600: WHITE BOMB [3 0 1]->[3 1 2] (Move)
2025-11-28 16:58:38,925 - game3d.game.turnmove - INFO - Move 800: WHITE FREEZER [3 5 7]->[3 4 8] (Move)
2025-11-28 16:58:41,797 - game3d.game.turnmove - INFO - Move 900: WHITE QUEEN [4 3 8]->[4 5 8] (Move)
2025-11-28 16:58:44,690 - game3d.game.turnmove - INFO - Move 1000: WHITE SLOWER [3 6 4]->[2 5 5] (Capture)
2025-11-28 16:58:47,386 - game3d.game.turnmove - INFO - Move 1100: WHITE XZZIGZAG [6 7 2]->[0 7 5] (Move)
2025-11-28 16:58:50,104 - game3d.game.turnmove - INFO - Move 1200: WHITE XZZIGZAG [6 7 7]->[3 7 7] (Move)
2025-11-28 16:58:52,885 - game3d.game.turnmove - INFO - Move 1300: WHITE XZZIGZAG [4 7 7]->[6 7 5] (Move)
2025-11-28 16:58:53,108 - game3d.game.turnmove - INFO - Move 700: WHITE PANEL [3 5 0]->[4 4 1] (Move)
2025-11-28 16:58:55,209 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 26 pieces - possible stalemate
2025-11-28 16:58:55,212 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 26 pieces completely immobilized)
2025-11-28 16:58:55,213 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 26 pieces completely immobilized)
2025-11-28 16:58:55,213 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 26 pieces completely immobilized)
2025-11-28 16:58:55,223 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 26 pieces completely immobilized)
2025-11-28 16:58:55,224 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 26 pieces completely immobilized)
2025-11-28 16:58:55,224 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 26 pieces completely immobilized)
2025-11-28 16:58:55,225 - worker.0 - INFO - GAME FINISHED: 0 | DRAW (Stalemate) | 1380 moves | 75.7s | Mat: W=26/B=26 | Priests: W=N B=N | Kings: W=Y B=Y
2025-11-28 16:58:55,226 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 26 pieces completely immobilized)
2025-11-28 16:58:56,420 - training.parallel_self_play - INFO - Game completed: 1380 examples collected
2025-11-28 16:58:59,818 - game3d.game.turnmove - INFO - Move 800: WHITE BOMB [1 5 1]->[1 4 1] (Move)
2025-11-28 16:59:03,427 - game3d.game.turnmove - INFO - Move 900: WHITE WALL [4 1 1]->[4 2 1] (Move)
2025-11-28 16:59:05,843 - game3d.game.turnmove - INFO - Move 1000: WHITE FREEZER [1 1 7]->[2 2 6] (Move)
2025-11-28 16:59:08,224 - game3d.game.turnmove - INFO - Move 1100: WHITE WALL [7 7 1]->[7 6 1] (Move)
2025-11-28 16:59:10,624 - game3d.game.turnmove - INFO - Move 1200: WHITE FREEZER [3 4 8]->[3 5 7] (Move)
2025-11-28 16:59:12,948 - game3d.game.turnmove - INFO - Move 1300: WHITE FREEZER [4 6 7]->[3 5 7] (Move)
2025-11-28 16:59:15,297 - game3d.game.turnmove - INFO - Move 1400: WHITE FREEZER [3 5 7]->[4 5 8] (Move)
2025-11-28 16:59:17,614 - game3d.game.turnmove - INFO - Move 1500: WHITE XZZIGZAG [1 6 8]->[3 6 8] (Move)
2025-11-28 16:59:19,935 - game3d.game.turnmove - INFO - Move 1600: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 16:59:22,256 - game3d.game.turnmove - INFO - Move 1700: WHITE XZZIGZAG [1 6 8]->[3 6 8] (Move)
2025-11-28 16:59:24,573 - game3d.game.turnmove - INFO - Move 1800: WHITE FREEZER [3 5 7]->[4 5 8] (Move)
2025-11-28 16:59:26,858 - game3d.game.turnmove - INFO - Move 1900: WHITE XZZIGZAG [1 6 8]->[3 6 8] (Move)
2025-11-28 16:59:29,158 - game3d.game.turnmove - INFO - Move 2000: WHITE WALL [6 4 8]->[5 4 8] (Move)
2025-11-28 16:59:31,485 - game3d.game.turnmove - INFO - Move 2100: WHITE FREEZER [3 5 7]->[3 4 8] (Move)
2025-11-28 16:59:33,778 - game3d.game.turnmove - INFO - Move 2200: WHITE FREEZER [3 4 8]->[3 5 7] (Move)
2025-11-28 16:59:35,754 - game3d.game.terminal - WARNING - Game over: move rule draw
2025-11-28 16:59:35,755 - game3d.game.terminal - WARNING - Game over: move rule draw
2025-11-28 16:59:35,755 - game3d.game.terminal - WARNING - Game over: move rule draw
2025-11-28 16:59:35,766 - game3d.game.terminal - WARNING - Game over: move rule draw
2025-11-28 16:59:35,766 - game3d.game.terminal - WARNING - Game over: move rule draw
2025-11-28 16:59:35,766 - game3d.game.terminal - WARNING - Game over: move rule draw
2025-11-28 16:59:35,766 - worker.1 - INFO - GAME FINISHED: 1 | DRAW (Move rule draw) | 2284 moves | 116.1s | Mat: W=10/B=6 | Priests: W=N B=N | Kings: W=Y B=Y
2025-11-28 16:59:35,766 - game3d.game.terminal - WARNING - Game over: move rule draw
2025-11-28 16:59:37,440 - training.parallel_self_play - INFO - Game completed: 2284 examples collected
2025-11-28 16:59:40,399 - training.parallel_self_play - INFO - Self-play complete: 3664 total examples from 2 games
2025-11-28 17:02:38,686 - __main__ - INFO - Training interrupted by user
2025-11-28 17:02:38,689 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 17:06:47,636 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 17:06:47,637 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:06:47,640 - __main__ - INFO - Testing move generation...
2025-11-28 17:06:53,900 - __main__ - INFO - [OK] Generated 845 moves
2025-11-28 17:06:53,900 - __main__ - INFO - Testing GameState caching...
2025-11-28 17:06:53,900 - __main__ - INFO - [OK] GameState caching works
2025-11-28 17:06:53,900 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 17:06:53,901 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 17:06:53,901 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(845), 'piece_moves_cache_size': 107, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 17:06:55,363 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_170643/temp_model_for_selfplay.pt
2025-11-28 17:06:55,363 - training.parallel_self_play - INFO - Starting parallel self-play: 2 games, 2 workers
2025-11-28 17:06:55,363 - training.parallel_self_play - INFO - Model checkpoint: model_checkpoints/train_huge_20251128_170643/temp_model_for_selfplay.pt
2025-11-28 17:06:55,363 - training.parallel_self_play - INFO - Device: cuda, Model size: huge
2025-11-28 17:06:55,365 - training.parallel_self_play - INFO - Launching 2 game workers...
2025-11-28 17:07:02,751 - worker.0 - INFO - Worker 0 starting, loading model...
2025-11-28 17:07:02,755 - worker.1 - INFO - Worker 1 starting, loading model...
2025-11-28 17:07:07,935 - worker.0 - INFO - Worker 0 model compiled with torch.compile
2025-11-28 17:07:07,936 - worker.0 - INFO - Worker 0 model loaded successfully
2025-11-28 17:07:07,956 - worker.1 - INFO - Worker 1 model compiled with torch.compile
2025-11-28 17:07:07,957 - worker.1 - INFO - Worker 1 model loaded successfully
2025-11-28 17:07:08,296 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:07:08,296 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:07:08,297 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139827283525200
2025-11-28 17:07:08,297 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139833301190544
2025-11-28 17:07:23,443 - game3d.game.turnmove - INFO - Move 100: WHITE PANEL [3 7 1]->[4 6 2] (Move)
2025-11-28 17:07:27,308 - __main__ - INFO - Training interrupted by user
2025-11-28 17:07:27,312 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 17:07:43,186 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 17:07:43,187 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:07:43,190 - __main__ - INFO - Testing move generation...
2025-11-28 17:07:49,501 - __main__ - INFO - [OK] Generated 845 moves
2025-11-28 17:07:49,501 - __main__ - INFO - Testing GameState caching...
2025-11-28 17:07:49,501 - __main__ - INFO - [OK] GameState caching works
2025-11-28 17:07:49,501 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 17:07:49,501 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 17:07:49,502 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(845), 'piece_moves_cache_size': 107, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 17:07:50,876 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_170739/temp_model_for_selfplay.pt
2025-11-28 17:07:50,876 - training.parallel_self_play - INFO - Starting parallel self-play: 50 games, 2 workers
2025-11-28 17:07:50,876 - training.parallel_self_play - INFO - Model checkpoint: model_checkpoints/train_huge_20251128_170739/temp_model_for_selfplay.pt
2025-11-28 17:07:50,876 - training.parallel_self_play - INFO - Device: cuda, Model size: huge
2025-11-28 17:07:50,878 - training.parallel_self_play - INFO - Launching 50 game workers...
2025-11-28 17:07:58,238 - worker.0 - INFO - Worker 0 starting, loading model...
2025-11-28 17:07:58,281 - worker.1 - INFO - Worker 1 starting, loading model...
2025-11-28 17:08:03,432 - worker.0 - INFO - Worker 0 model compiled with torch.compile
2025-11-28 17:08:03,432 - worker.1 - INFO - Worker 1 model compiled with torch.compile
2025-11-28 17:08:03,433 - worker.0 - INFO - Worker 0 model loaded successfully
2025-11-28 17:08:03,433 - worker.1 - INFO - Worker 1 model loaded successfully
2025-11-28 17:08:03,809 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:08:03,810 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139845003469360
2025-11-28 17:08:03,812 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:08:03,813 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140191744838768
2025-11-28 17:08:18,699 - game3d.game.turnmove - INFO - Move 100: WHITE XZQUEEN [6 7 0]->[6 7 7] (Capture)
2025-11-28 17:08:22,739 - game3d.game.turnmove - INFO - Move 100: WHITE REFLECTOR [8 8 0]->[2 2 6] (Capture)
2025-11-28 17:08:25,551 - game3d.game.turnmove - INFO - Move 200: WHITE QUEEN [1 5 1]->[1 0 6] (Capture)
2025-11-28 17:08:29,319 - game3d.game.turnmove - INFO - Move 200: BLACK INFILTRATOR [6 3 7]->[5 2 6] (Move)
2025-11-28 17:08:35,067 - game3d.game.turnmove - INFO - Move 300: BLACK PAWN [4 7 5]->[4 6 5] (Capture)
2025-11-28 17:08:35,095 - game3d.game.turnmove - INFO - Move 300: BLACK HIVE [4 7 7]->[5 6 6] (Move)
2025-11-28 17:08:42,887 - game3d.game.turnmove - INFO - Move 400: WHITE BISHOP [4 6 3]->[4 2 7] (Capture)
2025-11-28 17:08:47,309 - game3d.game.turnmove - INFO - Move 500: WHITE BISHOP [4 3 8]->[4 4 7] (Move)
2025-11-28 17:08:48,040 - game3d.game.turnmove - INFO - Move 400: BLACK ECHO [4 7 7]->[5 6 6] (Move)
2025-11-28 17:08:48,087 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:08:48,087 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:08:49,364 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:08:49,365 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:08:50,196 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 89 pieces - possible stalemate
2025-11-28 17:08:50,196 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:08:50,197 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:08:53,225 - game3d.game.turnmove - INFO - Move 600: BLACK PANEL [4 5 0]->[5 4 0] (Move)
2025-11-28 17:08:54,638 - game3d.game.turnmove - INFO - Move 500: BLACK SPIRAL [1 0 2]->[3 0 2] (Capture)
2025-11-28 17:08:56,966 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 88 pieces - possible stalemate
2025-11-28 17:08:56,967 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:08:56,967 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:08:58,155 - game3d.game.turnmove - INFO - Move 700: BLACK PANEL [4 3 0]->[5 4 0] (Move)
2025-11-28 17:08:58,205 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:08:58,205 - game3d.common.state_utils - DEBUG - King for color 2 cached at [5 5 8]
2025-11-28 17:08:58,486 - game3d.game.turnmove - INFO - Move 600: WHITE PAWN [2 4 4]->[2 5 4] (Move)
2025-11-28 17:09:01,917 - game3d.game.turnmove - INFO - Move 700: WHITE SPIRAL [3 0 6]->[5 0 8] (Move)
2025-11-28 17:09:02,473 - game3d.game.turnmove - INFO - Move 800: WHITE BISHOP [3 0 7]->[4 0 8] (Move)
2025-11-28 17:09:05,194 - game3d.game.turnmove - INFO - Move 800: BLACK ARCHER [1 5 8]->[2 6 7] (Move)
2025-11-28 17:09:07,610 - game3d.game.turnmove - INFO - Move 900: BLACK BISHOP [4 5 0]->[4 4 1] (Move)
2025-11-28 17:09:08,217 - game3d.game.turnmove - INFO - Move 900: WHITE PAWN [8 4 2]->[8 5 2] (Move)
2025-11-28 17:09:12,238 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 20 pieces - possible stalemate
2025-11-28 17:09:12,720 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 20 pieces - possible stalemate
2025-11-28 17:09:12,722 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 20 pieces completely immobilized)
2025-11-28 17:09:12,722 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 20 pieces completely immobilized)
2025-11-28 17:09:12,723 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 20 pieces completely immobilized)
2025-11-28 17:09:12,730 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 20 pieces completely immobilized)
2025-11-28 17:09:12,730 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 20 pieces completely immobilized)
2025-11-28 17:09:12,731 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 20 pieces completely immobilized)
2025-11-28 17:09:12,731 - worker.0 - INFO - GAME FINISHED: 0 | DRAW (Stalemate) | 991 moves | 68.8s | Mat: W=20/B=40 | Priests: W=N B=N | Kings: W=Y B=Y
2025-11-28 17:09:12,732 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 20 pieces completely immobilized)
2025-11-28 17:09:13,847 - worker.2 - INFO - Worker 2 starting, loading model...
2025-11-28 17:09:13,948 - training.parallel_self_play - INFO - Game completed: 991 examples collected
2025-11-28 17:09:15,417 - game3d.game.turnmove - INFO - Move 1000: BLACK SPEEDER [4 5 7]->[4 4 7] (Capture)
2025-11-28 17:09:17,283 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 56 pieces - possible stalemate
2025-11-28 17:09:17,284 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:09:17,284 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:09:17,399 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f80e519d080>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f80e56b40e0> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 93, in submit_move
    new_state = turnmove.execute_hive_move(self._state, move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 326, in execute_hive_move
    new_state = apply_multi_hive_move(game_state, move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/hive.py", line 84, in apply_multi_hive_move
    new_state = state.make_move_vectorized(move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/gamestate.py", line 241, in make_move_vectorized
    return turnmove.make_move(self, move)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 506, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 413, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f80e519d080>) returned a result with an exception set
2025-11-28 17:09:17,406 - worker.1 - ERROR - Worker failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f80e519d080>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f80e56b40e0> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 93, in submit_move
    new_state = turnmove.execute_hive_move(self._state, move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 326, in execute_hive_move
    new_state = apply_multi_hive_move(game_state, move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/hive.py", line 84, in apply_multi_hive_move
    new_state = state.make_move_vectorized(move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/gamestate.py", line 241, in make_move_vectorized
    return turnmove.make_move(self, move)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 506, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 413, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f80e519d080>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 247, in _game_worker_permodel
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f80e519d080>) returned a result with an exception set
2025-11-28 17:09:17,646 - worker.3 - INFO - Worker 3 starting, loading model...
2025-11-28 17:09:17,662 - __main__ - INFO - Training interrupted by user
2025-11-28 17:09:17,666 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 17:13:16,418 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 17:13:16,419 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:13:16,422 - __main__ - INFO - Testing move generation...
2025-11-28 17:13:22,647 - __main__ - INFO - [OK] Generated 845 moves
2025-11-28 17:13:22,647 - __main__ - INFO - Testing GameState caching...
2025-11-28 17:13:22,648 - __main__ - INFO - [OK] GameState caching works
2025-11-28 17:13:22,648 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 17:13:22,648 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 17:13:22,648 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(845), 'piece_moves_cache_size': 107, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 17:13:24,049 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_171312/temp_model_for_selfplay.pt
2025-11-28 17:13:24,049 - training.parallel_self_play - INFO - Starting parallel self-play: 50 games, 2 workers
2025-11-28 17:13:24,049 - training.parallel_self_play - INFO - Model checkpoint: model_checkpoints/train_huge_20251128_171312/temp_model_for_selfplay.pt
2025-11-28 17:13:24,049 - training.parallel_self_play - INFO - Device: cuda, Model size: huge
2025-11-28 17:13:24,052 - training.parallel_self_play - INFO - Launching 50 game workers...
2025-11-28 17:13:31,428 - worker.0 - INFO - Worker 0 starting, loading model...
2025-11-28 17:13:31,428 - worker.1 - INFO - Worker 1 starting, loading model...
2025-11-28 17:13:36,336 - worker.1 - INFO - Worker 1 model compiled with torch.compile
2025-11-28 17:13:36,337 - worker.1 - INFO - Worker 1 model loaded successfully
2025-11-28 17:13:36,338 - worker.0 - INFO - Worker 0 model compiled with torch.compile
2025-11-28 17:13:36,339 - worker.0 - INFO - Worker 0 model loaded successfully
2025-11-28 17:13:36,690 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:13:36,690 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:13:36,691 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140429596114512
2025-11-28 17:13:36,691 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139973834656976
2025-11-28 17:13:53,595 - game3d.game.turnmove - INFO - Move 100: WHITE SWAPPER [7 3 0]->[0 6 3] (Move)
2025-11-28 17:13:54,611 - game3d.game.turnmove - INFO - Move 100: BLACK INFILTRATOR [6 3 7]->[5 3 7] (Move)
2025-11-28 17:14:05,508 - game3d.game.turnmove - INFO - Move 200: BLACK PANEL [4 4 7]->[4 4 6] (Move)
2025-11-28 17:14:05,517 - game3d.game.turnmove - INFO - Move 200: WHITE KNIGHT31 [4 0 6]->[5 3 5] (Move)
2025-11-28 17:14:16,220 - game3d.game.turnmove - INFO - Move 300: BLACK MIRROR [4 4 5]->[3 4 6] (Move)
2025-11-28 17:14:19,087 - game3d.game.turnmove - INFO - Move 300: BLACK TRIGONALBISHOP [7 4 7]->[3 8 3] (Move)
2025-11-28 17:14:26,976 - game3d.game.turnmove - INFO - Move 400: WHITE FREEZER [0 0 1]->[0 0 2] (Capture)
2025-11-28 17:14:30,954 - game3d.game.turnmove - INFO - Move 400: BLACK YZZIGZAG [8 6 6]->[8 6 1] (Capture)
2025-11-28 17:14:38,533 - game3d.game.turnmove - INFO - Move 500: WHITE ROOK [4 5 8]->[4 3 8] (Move)
2025-11-28 17:14:40,363 - game3d.game.turnmove - INFO - Move 500: WHITE FRIENDLYTELEPORTER [3 6 0]->[2 5 1] (Move)
2025-11-28 17:14:42,049 - game3d.game.turnmove - INFO - Move 600: BLACK REFLECTOR [5 5 5]->[0 6 0] (Capture)
2025-11-28 17:14:45,335 - game3d.game.turnmove - INFO - Move 700: BLACK SLOWER [5 7 5]->[4 7 5] (Move)
2025-11-28 17:14:45,755 - game3d.game.turnmove - INFO - Move 600: WHITE SLOWER [3 7 3]->[4 8 4] (Capture)
2025-11-28 17:14:45,833 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:14:45,834 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:14:46,165 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:14:46,165 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:14:46,625 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:14:46,625 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:14:47,792 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:14:47,792 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:14:48,107 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:14:48,107 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:14:48,229 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:14:48,229 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:14:48,542 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:14:48,542 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:14:48,902 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:14:48,902 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:14:49,237 - game3d.game.turnmove - INFO - Move 800: BLACK SPIRAL [4 4 6]->[7 4 3] (Move)
2025-11-28 17:14:49,384 - game3d.game.turnmove - INFO - Move 700: WHITE PANEL [4 7 0]->[3 6 1] (Move)
2025-11-28 17:14:49,422 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:14:49,423 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:14:49,708 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:14:49,709 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:14:51,776 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:14:51,776 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:14:52,387 - game3d.game.turnmove - INFO - Move 900: BLACK ECHO [4 1 6]->[5 2 5] (Move)
2025-11-28 17:14:54,830 - game3d.game.turnmove - INFO - Move 800: BLACK ARCHER [6 3 4]->[5 3 4] (Move)
2025-11-28 17:14:55,148 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:14:55,148 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:14:55,518 - game3d.game.turnmove - INFO - Move 1000: WHITE SLOWER [7 1 1]->[8 1 0] (Capture)
2025-11-28 17:14:55,820 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:14:55,820 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:14:56,308 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:14:56,309 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:14:56,883 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:14:56,883 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:14:57,409 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:14:57,410 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:14:57,958 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:14:57,958 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:14:59,198 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:14:59,198 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:14:59,799 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:14:59,799 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:15:00,203 - game3d.game.turnmove - INFO - Move 900: WHITE PANEL [4 4 0]->[4 4 1] (Move)
2025-11-28 17:15:00,463 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:15:00,463 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:15:00,495 - game3d.game.turnmove - INFO - Move 1100: WHITE YZZIGZAG [0 2 8]->[0 2 2] (Move)
2025-11-28 17:15:00,871 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:15:00,871 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:15:01,370 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 37 pieces - possible stalemate
2025-11-28 17:15:01,371 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:15:01,371 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:15:01,981 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:15:01,981 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:15:02,360 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:15:02,360 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:15:02,786 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:15:02,786 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:15:03,381 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:15:03,381 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:15:04,068 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 16 pieces - possible stalemate
2025-11-28 17:15:04,071 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 16 pieces completely immobilized)
2025-11-28 17:15:04,072 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 16 pieces completely immobilized)
2025-11-28 17:15:04,073 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 16 pieces completely immobilized)
2025-11-28 17:15:04,080 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 16 pieces completely immobilized)
2025-11-28 17:15:04,081 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 16 pieces completely immobilized)
2025-11-28 17:15:04,082 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 16 pieces completely immobilized)
2025-11-28 17:15:04,082 - worker.1 - INFO - GAME FINISHED: 1 | DRAW (Stalemate) | 1155 moves | 87.3s | Mat: W=27/B=16 | Priests: W=N B=N | Kings: W=Y B=Y
2025-11-28 17:15:04,083 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 16 pieces completely immobilized)
2025-11-28 17:15:04,569 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:15:04,569 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:15:04,652 - game3d.game.turnmove - INFO - Move 1000: BLACK BOMB [4 4 8]->[4 4 7] (Move)
2025-11-28 17:15:04,952 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:15:04,952 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:15:04,983 - worker.2 - INFO - Worker 2 starting, loading model...
2025-11-28 17:15:05,101 - training.parallel_self_play - INFO - Game completed: 1155 examples collected
2025-11-28 17:15:05,337 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 34 pieces - possible stalemate
2025-11-28 17:15:05,337 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:15:05,337 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:15:05,606 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 34 pieces - possible stalemate
2025-11-28 17:15:05,606 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:15:05,606 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:15:05,824 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 33 pieces - possible stalemate
2025-11-28 17:15:05,824 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:15:05,824 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:15:06,388 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:15:06,388 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:15:06,668 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 31 pieces - possible stalemate
2025-11-28 17:15:06,668 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:15:06,668 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:15:07,397 - game3d.game.turnmove - INFO - Move 1100: BLACK FREEZER [5 3 6]->[4 4 5] (Move)
2025-11-28 17:15:09,214 - worker.2 - INFO - Worker 2 model compiled with torch.compile
2025-11-28 17:15:09,215 - worker.2 - INFO - Worker 2 model loaded successfully
2025-11-28 17:15:09,215 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:15:09,216 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139961121035152
2025-11-28 17:15:10,070 - game3d.game.turnmove - INFO - Move 1200: BLACK ARCHER [3 4 0]->[4 3 0] (Move)
2025-11-28 17:15:13,075 - game3d.game.turnmove - INFO - Move 1300: BLACK PAWN [6 3 5]->[6 3 4] (Move)
2025-11-28 17:15:15,067 - game3d.game.turnmove - INFO - Move 100: BLACK YZQUEEN [3 1 8]->[3 7 2] (Capture)
2025-11-28 17:15:16,123 - game3d.game.turnmove - INFO - Move 1400: BLACK WHITEHOLE [4 3 0]->[5 4 0] (Move)
2025-11-28 17:15:19,174 - game3d.game.turnmove - INFO - Move 1500: BLACK XZQUEEN [5 4 0]->[4 4 1] (Move)
2025-11-28 17:15:20,393 - game3d.game.turnmove - INFO - Move 200: WHITE QUEEN [0 5 1]->[0 4 1] (Move)
2025-11-28 17:15:22,242 - game3d.game.turnmove - INFO - Move 1600: BLACK FREEZER [3 3 1]->[4 3 0] (Move)
2025-11-28 17:15:25,252 - game3d.game.turnmove - INFO - Move 300: WHITE BLACKHOLE [6 6 1]->[6 5 2] (Move)
2025-11-28 17:15:25,368 - game3d.game.turnmove - INFO - Move 1700: BLACK XZZIGZAG [2 6 7]->[5 6 4] (Move)
2025-11-28 17:15:25,806 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 8 pieces - possible stalemate
2025-11-28 17:15:25,807 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 8 pieces completely immobilized)
2025-11-28 17:15:25,808 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 8 pieces completely immobilized)
2025-11-28 17:15:25,808 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 8 pieces completely immobilized)
2025-11-28 17:15:25,818 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 8 pieces completely immobilized)
2025-11-28 17:15:25,819 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 8 pieces completely immobilized)
2025-11-28 17:15:25,819 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 8 pieces completely immobilized)
2025-11-28 17:15:25,820 - worker.0 - INFO - GAME FINISHED: 0 | DRAW (Stalemate) | 1690 moves | 109.0s | Mat: W=8/B=20 | Priests: W=N B=N | Kings: W=Y B=Y
2025-11-28 17:15:25,820 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 8 pieces completely immobilized)
2025-11-28 17:15:27,475 - worker.3 - INFO - Worker 3 starting, loading model...
2025-11-28 17:15:27,764 - training.parallel_self_play - INFO - Game completed: 1690 examples collected
2025-11-28 17:15:29,388 - game3d.game.turnmove - INFO - Move 400: WHITE SWAPPER [4 5 1]->[4 5 2] (Move)
2025-11-28 17:15:31,198 - worker.3 - INFO - Worker 3 model compiled with torch.compile
2025-11-28 17:15:31,199 - worker.3 - INFO - Worker 3 model loaded successfully
2025-11-28 17:15:31,200 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:15:31,201 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140428834086128
2025-11-28 17:15:32,671 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 112 pieces - possible stalemate
2025-11-28 17:15:32,672 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:15:32,672 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:15:35,814 - game3d.game.turnmove - INFO - Move 500: BLACK NEBULA [4 5 5]->[4 4 5] (Move)
2025-11-28 17:15:37,142 - game3d.game.turnmove - INFO - Move 100: WHITE KNIGHT [4 6 1]->[5 6 3] (Capture)
2025-11-28 17:15:42,823 - game3d.game.turnmove - INFO - Move 200: WHITE GEOMANCER [5 5 0]->[2 5 3] (Move)
2025-11-28 17:15:46,195 - game3d.game.turnmove - INFO - Move 600: WHITE FRIENDLYTELEPORTER [4 5 1]->[3 4 2] (Move)
2025-11-28 17:15:49,198 - game3d.game.turnmove - INFO - Move 300: BLACK BLACKHOLE [6 8 7]->[6 7 7] (Capture)
2025-11-28 17:15:55,819 - game3d.game.turnmove - INFO - Move 700: BLACK QUEEN [5 4 0]->[4 5 0] (Move)
2025-11-28 17:16:07,748 - game3d.game.turnmove - INFO - Move 800: BLACK SPIRAL [3 8 1]->[4 8 0] (Move)
2025-11-28 17:16:19,605 - game3d.game.turnmove - INFO - Move 900: BLACK SPIRAL [3 8 1]->[4 8 0] (Move)
2025-11-28 17:16:31,620 - game3d.game.turnmove - INFO - Move 1000: BLACK SPIRAL [3 8 1]->[4 8 0] (Move)
2025-11-28 17:16:45,896 - game3d.game.turnmove - INFO - Move 1100: BLACK SPIRAL [3 8 1]->[4 8 0] (Move)
2025-11-28 17:16:56,228 - game3d.game.turnmove - INFO - Move 1200: BLACK SPIRAL [4 3 0]->[3 4 0] (Move)
2025-11-28 17:17:02,309 - game3d.game.turnmove - INFO - Move 1300: BLACK BOMB [4 3 8]->[5 4 7] (Move)
2025-11-28 17:17:05,112 - game3d.game.turnmove - INFO - Move 1400: BLACK PAWN [6 0 7]->[8 8 1] (Capture)
2025-11-28 17:17:07,312 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 22 pieces - possible stalemate
2025-11-28 17:17:07,314 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 22 pieces completely immobilized)
2025-11-28 17:17:07,315 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 22 pieces completely immobilized)
2025-11-28 17:17:07,315 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 22 pieces completely immobilized)
2025-11-28 17:17:07,325 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 22 pieces completely immobilized)
2025-11-28 17:17:07,325 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 22 pieces completely immobilized)
2025-11-28 17:17:07,326 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 22 pieces completely immobilized)
2025-11-28 17:17:07,327 - worker.2 - INFO - GAME FINISHED: 2 | DRAW (Stalemate) | 1481 moves | 118.1s | Mat: W=46/B=22 | Priests: W=N B=N | Kings: W=Y B=Y
2025-11-28 17:17:07,327 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 22 pieces completely immobilized)
2025-11-28 17:17:08,330 - worker.4 - INFO - Worker 4 starting, loading model...
2025-11-28 17:17:08,479 - training.parallel_self_play - INFO - Game completed: 1481 examples collected
2025-11-28 17:17:12,070 - worker.4 - INFO - Worker 4 model compiled with torch.compile
2025-11-28 17:17:12,072 - worker.4 - INFO - Worker 4 model loaded successfully
2025-11-28 17:17:12,075 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:17:12,075 - game3d.cache.manager - DEBUG - Created cache manager #3 for board 139961671263152
2025-11-28 17:17:19,071 - game3d.game.turnmove - INFO - Move 100: WHITE NEBULA [2 5 0]->[3 5 0] (Capture)
2025-11-28 17:17:24,425 - game3d.game.turnmove - INFO - Move 200: BLACK KNIGHT31 [4 1 1]->[5 4 0] (Move)
2025-11-28 17:17:29,067 - game3d.game.turnmove - INFO - Move 300: WHITE FRIENDLYTELEPORTER [7 6 0]->[7 2 6] (Capture)
2025-11-28 17:17:33,404 - game3d.game.turnmove - INFO - Move 400: BLACK KNIGHT31 [2 4 8]->[1 8 7] (Move)
2025-11-28 17:17:42,053 - game3d.game.turnmove - INFO - Move 500: BLACK NEBULA [7 1 6]->[8 1 3] (Move)
2025-11-28 17:17:48,723 - game3d.game.turnmove - INFO - Move 600: BLACK PANEL [3 4 0]->[4 3 0] (Move)
2025-11-28 17:17:50,195 - game3d.game.turnmove - INFO - Move 400: BLACK BLACKHOLE [4 3 0]->[4 4 1] (Move)
2025-11-28 17:17:55,578 - game3d.game.turnmove - INFO - Move 700: BLACK PANEL [4 3 0]->[4 4 1] (Move)
2025-11-28 17:18:00,638 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 74 pieces - possible stalemate
2025-11-28 17:18:00,638 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:18:00,638 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:18:01,416 - game3d.game.turnmove - INFO - Move 800: BLACK FREEZER [6 7 2]->[6 6 1] (Capture)
2025-11-28 17:18:01,472 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:18:01,472 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:18:04,133 - game3d.game.turnmove - INFO - Move 900: WHITE FREEZER [1 0 0]->[2 1 0] (Move)
2025-11-28 17:18:05,411 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 20 pieces - possible stalemate
2025-11-28 17:18:05,413 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 20 pieces completely immobilized)
2025-11-28 17:18:05,413 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 20 pieces completely immobilized)
2025-11-28 17:18:05,414 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 20 pieces completely immobilized)
2025-11-28 17:18:05,420 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 20 pieces completely immobilized)
2025-11-28 17:18:05,421 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 20 pieces completely immobilized)
2025-11-28 17:18:05,421 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 20 pieces completely immobilized)
2025-11-28 17:18:05,422 - worker.4 - INFO - GAME FINISHED: 4 | DRAW (Stalemate) | 940 moves | 53.3s | Mat: W=20/B=58 | Priests: W=N B=N | Kings: W=Y B=Y
2025-11-28 17:18:05,422 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 20 pieces completely immobilized)
2025-11-28 17:18:06,102 - worker.5 - INFO - Worker 5 starting, loading model...
2025-11-28 17:18:06,187 - training.parallel_self_play - INFO - Game completed: 940 examples collected
2025-11-28 17:18:09,609 - worker.5 - INFO - Worker 5 model compiled with torch.compile
2025-11-28 17:18:09,610 - worker.5 - INFO - Worker 5 model loaded successfully
2025-11-28 17:18:09,611 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:18:09,611 - game3d.cache.manager - DEBUG - Created cache manager #4 for board 139961085234624
2025-11-28 17:18:15,554 - game3d.game.turnmove - INFO - Move 100: WHITE FRIENDLYTELEPORTER [7 6 1]->[6 6 2] (Move)
2025-11-28 17:18:20,789 - game3d.game.turnmove - INFO - Move 200: BLACK PANEL [6 2 8]->[6 2 0] (Capture)
2025-11-28 17:18:25,204 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:18:25,204 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:18:26,721 - game3d.game.turnmove - INFO - Move 300: BLACK ORBITER [8 1 7]->[8 1 3] (Move)
2025-11-28 17:18:30,807 - game3d.game.turnmove - INFO - Move 400: BLACK SPEEDER [7 2 6]->[6 3 5] (Move)
2025-11-28 17:18:45,528 - game3d.game.turnmove - INFO - Move 500: WHITE FRIENDLYTELEPORTER [5 3 4]->[4 4 4] (Capture)
2025-11-28 17:18:54,000 - game3d.game.turnmove - INFO - Move 600: BLACK ARCHER [5 4 6]->[4 5 5] (Move)
2025-11-28 17:18:57,232 - game3d.game.turnmove - INFO - Move 700: BLACK XYQUEEN [8 8 7]->[4 4 7] (Capture)
2025-11-28 17:19:00,090 - game3d.game.turnmove - INFO - Move 800: BLACK YZZIGZAG [0 2 7]->[0 2 6] (Capture)
2025-11-28 17:19:00,622 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:19:00,622 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:19:02,758 - game3d.game.turnmove - INFO - Move 900: WHITE ARCHER [1 4 8]->[2 4 8] (Move)
2025-11-28 17:19:05,330 - game3d.game.turnmove - INFO - Move 1000: WHITE BOMB [4 4 3]->[3 4 3] (Capture)
2025-11-28 17:19:07,996 - game3d.game.turnmove - INFO - Move 1100: WHITE ARCHER [3 4 8]->[2 3 8] (Move)
2025-11-28 17:19:10,649 - game3d.game.turnmove - INFO - Move 1200: WHITE ARCHER [3 4 8]->[4 3 8] (Move)
2025-11-28 17:19:13,176 - game3d.game.turnmove - INFO - Move 1300: WHITE ARCHER [3 4 8]->[4 3 8] (Move)
2025-11-28 17:19:15,684 - game3d.game.turnmove - INFO - Move 1400: WHITE ARCHER [3 4 8]->[4 3 8] (Move)
2025-11-28 17:19:18,267 - game3d.game.turnmove - INFO - Move 1500: WHITE ARCHER [4 3 8]->[4 2 8] (Move)
2025-11-28 17:19:20,820 - game3d.game.turnmove - INFO - Move 1600: WHITE ARCHER [5 2 7]->[4 3 8] (Move)
2025-11-28 17:19:23,384 - game3d.game.turnmove - INFO - Move 1700: WHITE YZZIGZAG [0 6 3]->[0 6 4] (Move)
2025-11-28 17:19:25,925 - game3d.game.turnmove - INFO - Move 1800: WHITE ARCHER [4 3 8]->[3 4 8] (Move)
2025-11-28 17:19:28,486 - game3d.game.turnmove - INFO - Move 1900: WHITE ARCHER [4 3 8]->[3 4 8] (Move)
2025-11-28 17:19:28,943 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 2 pieces - possible stalemate
2025-11-28 17:19:28,944 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 2 pieces completely immobilized)
2025-11-28 17:19:28,945 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 2 pieces completely immobilized)
2025-11-28 17:19:28,945 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 2 pieces completely immobilized)
2025-11-28 17:19:28,957 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 2 pieces completely immobilized)
2025-11-28 17:19:28,958 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 2 pieces completely immobilized)
2025-11-28 17:19:28,958 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 2 pieces completely immobilized)
2025-11-28 17:19:28,959 - worker.5 - INFO - GAME FINISHED: 5 | DRAW (Stalemate) | 1914 moves | 79.3s | Mat: W=2/B=23 | Priests: W=N B=N | Kings: W=Y B=Y
2025-11-28 17:19:28,959 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 2 pieces completely immobilized)
2025-11-28 17:19:30,255 - worker.6 - INFO - Worker 6 starting, loading model...
2025-11-28 17:19:30,480 - training.parallel_self_play - INFO - Game completed: 1914 examples collected
2025-11-28 17:19:33,780 - worker.6 - INFO - Worker 6 model compiled with torch.compile
2025-11-28 17:19:33,781 - worker.6 - INFO - Worker 6 model loaded successfully
2025-11-28 17:19:33,782 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:19:33,782 - game3d.cache.manager - DEBUG - Created cache manager #5 for board 139961783412208
2025-11-28 17:19:40,086 - game3d.game.turnmove - INFO - Move 100: WHITE PAWN [5 5 2]->[6 6 3] (Capture)
2025-11-28 17:19:49,976 - game3d.game.turnmove - INFO - Move 200: WHITE ROOK [5 3 1]->[5 3 6] (Capture)
2025-11-28 17:20:02,844 - game3d.game.turnmove - INFO - Move 300: BLACK BISHOP [0 4 7]->[1 3 7] (Move)
2025-11-28 17:20:08,969 - game3d.game.turnmove - INFO - Move 400: BLACK NEBULA [4 5 6]->[4 4 5] (Move)
2025-11-28 17:20:18,384 - game3d.game.turnmove - INFO - Move 500: WHITE FRIENDLYTELEPORTER [6 4 1]->[5 3 2] (Move)
2025-11-28 17:20:25,335 - game3d.game.turnmove - INFO - Move 600: WHITE QUEEN [8 1 1]->[1 1 8] (Move)
2025-11-28 17:20:34,737 - game3d.game.turnmove - INFO - Move 700: WHITE SPEEDER [3 6 0]->[3 5 0] (Move)
2025-11-28 17:20:38,561 - game3d.game.turnmove - INFO - Move 800: WHITE FREEZER [3 5 7]->[3 4 8] (Move)
2025-11-28 17:20:41,517 - game3d.game.turnmove - INFO - Move 900: WHITE BOMB [6 6 2]->[5 6 3] (Move)
2025-11-28 17:20:44,292 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 16 pieces - possible stalemate
2025-11-28 17:20:44,294 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 16 pieces completely immobilized)
2025-11-28 17:20:44,295 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 16 pieces completely immobilized)
2025-11-28 17:20:44,296 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 16 pieces completely immobilized)
2025-11-28 17:20:44,302 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 16 pieces completely immobilized)
2025-11-28 17:20:44,303 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 16 pieces completely immobilized)
2025-11-28 17:20:44,303 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 16 pieces completely immobilized)
2025-11-28 17:20:44,304 - worker.6 - INFO - GAME FINISHED: 6 | DRAW (Stalemate) | 977 moves | 70.5s | Mat: W=63/B=16 | Priests: W=N B=N | Kings: W=Y B=Y
2025-11-28 17:20:44,304 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 16 pieces completely immobilized)
2025-11-28 17:20:45,139 - worker.7 - INFO - Worker 7 starting, loading model...
2025-11-28 17:20:45,235 - training.parallel_self_play - INFO - Game completed: 977 examples collected
2025-11-28 17:20:48,844 - worker.7 - INFO - Worker 7 model compiled with torch.compile
2025-11-28 17:20:48,845 - worker.7 - INFO - Worker 7 model loaded successfully
2025-11-28 17:20:48,845 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:20:48,846 - game3d.cache.manager - DEBUG - Created cache manager #6 for board 139961730924656
2025-11-28 17:20:55,394 - game3d.game.turnmove - INFO - Move 100: WHITE FREEZER [8 0 1]->[8 1 1] (Capture)
2025-11-28 17:21:01,030 - game3d.game.turnmove - INFO - Move 200: WHITE FRIENDLYTELEPORTER [2 1 2]->[0 6 3] (Capture)
2025-11-28 17:21:01,145 - game3d.game.turnmove - INFO - Move 500: BLACK BLACKHOLE [3 2 0]->[4 3 0] (Move)
2025-11-28 17:21:06,385 - game3d.game.turnmove - INFO - Move 300: WHITE SPIRAL [4 4 7]->[5 4 8] (Capture)
2025-11-28 17:21:16,354 - game3d.game.turnmove - INFO - Move 400: WHITE ARCHER [2 5 1]->[2 4 2] (Move)
2025-11-28 17:21:29,520 - game3d.game.turnmove - INFO - Move 500: BLACK WALL [1 2 7]->[1 2 6] (Move)
2025-11-28 17:21:36,426 - game3d.game.turnmove - INFO - Move 600: BLACK REFLECTOR [5 3 2]->[4 4 1] (Capture)
2025-11-28 17:21:39,437 - game3d.game.turnmove - INFO - Move 700: BLACK BLACKHOLE [2 7 6]->[3 7 6] (Move)
2025-11-28 17:21:42,793 - game3d.game.turnmove - INFO - Move 800: BLACK PANEL [4 4 8]->[4 4 7] (Capture)
2025-11-28 17:21:45,560 - game3d.game.turnmove - INFO - Move 900: BLACK MIRROR [4 4 7]->[4 4 6] (Move)
2025-11-28 17:21:48,391 - game3d.game.turnmove - INFO - Move 1000: BLACK XYQUEEN [1 2 6]->[3 2 6] (Move)
2025-11-28 17:21:51,180 - game3d.game.turnmove - INFO - Move 1100: BLACK EDGEROOK [8 8 2]->[8 4 2] (Capture)
2025-11-28 17:21:53,898 - game3d.game.turnmove - INFO - Move 1200: BLACK WHITEHOLE [4 3 0]->[4 4 1] (Move)
2025-11-28 17:21:56,598 - game3d.game.turnmove - INFO - Move 1300: BLACK WHITEHOLE [4 4 1]->[4 5 0] (Move)
2025-11-28 17:21:59,205 - game3d.game.turnmove - INFO - Move 1400: BLACK YZZIGZAG [0 1 0]->[0 1 5] (Move)
2025-11-28 17:22:01,786 - game3d.game.turnmove - INFO - Move 1500: BLACK WHITEHOLE [4 3 0]->[4 4 1] (Move)
2025-11-28 17:22:04,455 - game3d.game.turnmove - INFO - Move 1600: BLACK SWAPPER [4 3 0]->[5 4 0] (Move)
2025-11-28 17:22:07,142 - game3d.game.turnmove - INFO - Move 1700: BLACK FREEZER [5 3 1]->[5 3 0] (Move)
2025-11-28 17:22:09,804 - game3d.game.turnmove - INFO - Move 1800: BLACK FREEZER [5 3 1]->[5 3 0] (Move)
2025-11-28 17:22:12,464 - game3d.game.turnmove - INFO - Move 1900: BLACK FREEZER [5 5 1]->[5 4 1] (Move)
2025-11-28 17:22:15,086 - game3d.game.turnmove - INFO - Move 2000: BLACK FREEZER [5 4 1]->[5 5 1] (Move)
2025-11-28 17:22:17,711 - game3d.game.turnmove - INFO - Move 2100: BLACK FREEZER [5 3 0]->[5 3 1] (Move)
2025-11-28 17:22:20,352 - game3d.game.turnmove - INFO - Move 2200: BLACK FREEZER [5 5 1]->[5 4 1] (Move)
2025-11-28 17:22:22,986 - game3d.game.turnmove - INFO - Move 2300: BLACK FREEZER [5 4 1]->[5 5 1] (Move)
2025-11-28 17:22:25,596 - game3d.game.turnmove - INFO - Move 2400: BLACK FREEZER [5 3 1]->[5 4 0] (Move)
2025-11-28 17:22:28,298 - game3d.game.turnmove - INFO - Move 2500: BLACK FREEZER [5 4 1]->[5 5 1] (Move)
2025-11-28 17:22:30,956 - game3d.game.turnmove - INFO - Move 2600: BLACK FREEZER [5 4 1]->[5 5 1] (Move)
2025-11-28 17:22:33,609 - game3d.game.turnmove - INFO - Move 2700: BLACK ECHO [4 3 1]->[3 2 1] (Move)
2025-11-28 17:22:36,299 - game3d.game.turnmove - INFO - Move 2800: BLACK YZZIGZAG [0 1 3]->[0 1 0] (Move)
2025-11-28 17:22:38,935 - game3d.game.turnmove - INFO - Move 2900: BLACK FREEZER [5 3 1]->[5 3 0] (Move)
2025-11-28 17:22:41,576 - game3d.game.turnmove - INFO - Move 3000: BLACK FREEZER [5 5 1]->[5 4 1] (Move)
2025-11-28 17:22:44,183 - game3d.game.turnmove - INFO - Move 3100: BLACK FREEZER [5 4 1]->[5 5 1] (Move)
2025-11-28 17:22:46,819 - game3d.game.turnmove - INFO - Move 3200: BLACK FREEZER [5 5 1]->[5 4 1] (Move)
2025-11-28 17:22:49,473 - game3d.game.turnmove - INFO - Move 3300: BLACK FREEZER [5 5 1]->[5 4 1] (Move)
2025-11-28 17:22:52,091 - game3d.game.turnmove - INFO - Move 3400: BLACK FREEZER [5 3 1]->[5 3 0] (Move)
2025-11-28 17:22:54,728 - game3d.game.turnmove - INFO - Move 3500: BLACK FREEZER [5 3 0]->[5 3 1] (Move)
2025-11-28 17:22:57,349 - game3d.game.turnmove - INFO - Move 3600: BLACK FREEZER [5 5 1]->[5 4 1] (Move)
2025-11-28 17:23:00,011 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 9 pieces - possible stalemate
2025-11-28 17:23:00,012 - game3d.game.turnmove - INFO - Move 3700: BLACK EDGEROOK [8 1 3]->[8 4 3] (Move)
2025-11-28 17:23:00,013 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 9 pieces completely immobilized)
2025-11-28 17:23:00,014 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 9 pieces completely immobilized)
2025-11-28 17:23:00,014 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 9 pieces completely immobilized)
2025-11-28 17:23:00,038 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 9 pieces completely immobilized)
2025-11-28 17:23:00,038 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 9 pieces completely immobilized)
2025-11-28 17:23:00,039 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 9 pieces completely immobilized)
2025-11-28 17:23:00,039 - worker.7 - INFO - GAME FINISHED: 7 | DRAW (Stalemate) | 3699 moves | 131.1s | Mat: W=9/B=32 | Priests: W=N B=N | Kings: W=Y B=Y
2025-11-28 17:23:00,040 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 9 pieces completely immobilized)
2025-11-28 17:23:02,312 - worker.8 - INFO - Worker 8 starting, loading model...
2025-11-28 17:23:03,046 - training.parallel_self_play - INFO - Game completed: 3699 examples collected
2025-11-28 17:23:05,716 - worker.8 - INFO - Worker 8 model compiled with torch.compile
2025-11-28 17:23:05,717 - worker.8 - INFO - Worker 8 model loaded successfully
2025-11-28 17:23:05,718 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:23:05,718 - game3d.cache.manager - DEBUG - Created cache manager #7 for board 139961381704736
2025-11-28 17:23:11,966 - game3d.game.turnmove - INFO - Move 100: WHITE FRIENDLYTELEPORTER [7 6 0]->[6 6 1] (Move)
2025-11-28 17:23:19,809 - game3d.game.turnmove - INFO - Move 200: WHITE WHITEHOLE [8 2 1]->[7 2 1] (Capture)
2025-11-28 17:23:29,578 - game3d.game.turnmove - INFO - Move 300: WHITE SPIRAL [5 8 7]->[4 8 8] (Move)
2025-11-28 17:23:42,193 - game3d.game.turnmove - INFO - Move 400: BLACK MIRROR [3 3 6]->[4 4 5] (Move)
2025-11-28 17:23:54,253 - game3d.game.turnmove - INFO - Move 500: BLACK ARMOUR [3 7 4]->[4 6 3] (Capture)
2025-11-28 17:23:56,716 - __main__ - INFO - Training interrupted by user
2025-11-28 17:23:56,732 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 17:24:12,890 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 17:24:12,890 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:24:12,892 - __main__ - INFO - Testing move generation...
2025-11-28 17:24:16,917 - __main__ - INFO - [OK] Generated 845 moves
2025-11-28 17:24:16,917 - __main__ - INFO - Testing GameState caching...
2025-11-28 17:24:16,918 - __main__ - INFO - [OK] GameState caching works
2025-11-28 17:24:16,918 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 17:24:16,918 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 17:24:16,918 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(845), 'piece_moves_cache_size': 107, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 17:24:18,365 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_172408/temp_model_for_selfplay.pt
2025-11-28 17:24:18,365 - training.parallel_self_play - INFO - Starting parallel self-play: 50 games, 2 workers
2025-11-28 17:24:18,365 - training.parallel_self_play - INFO - Model checkpoint: model_checkpoints/train_huge_20251128_172408/temp_model_for_selfplay.pt
2025-11-28 17:24:18,365 - training.parallel_self_play - INFO - Device: cuda, Model size: huge
2025-11-28 17:24:18,367 - training.parallel_self_play - INFO - Launching 50 game workers...
2025-11-28 17:24:25,744 - worker.0 - INFO - Worker 0 starting, loading model...
2025-11-28 17:24:25,814 - worker.1 - INFO - Worker 1 starting, loading model...
2025-11-28 17:24:30,638 - worker.1 - INFO - Worker 1 model compiled with torch.compile
2025-11-28 17:24:30,639 - worker.0 - INFO - Worker 0 model compiled with torch.compile
2025-11-28 17:24:30,639 - worker.1 - INFO - Worker 1 model loaded successfully
2025-11-28 17:24:30,639 - worker.0 - INFO - Worker 0 model loaded successfully
2025-11-28 17:24:30,956 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:24:30,956 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:24:30,958 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140367417971696
2025-11-28 17:24:30,958 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139887397234832
2025-11-28 17:24:40,584 - game3d.game.turnmove - INFO - Move 100: WHITE KNIGHT [4 4 2]->[4 3 4] (Move)
2025-11-28 17:24:40,589 - game3d.game.turnmove - INFO - Move 100: WHITE PRIEST [3 5 2]->[4 4 2] (Capture)
2025-11-28 17:24:45,867 - game3d.game.turnmove - INFO - Move 200: WHITE XYQUEEN [3 6 2]->[4 5 1] (Move)
2025-11-28 17:24:49,834 - game3d.game.turnmove - INFO - Move 200: WHITE TRAILBLAZER [4 3 6]->[4 3 7] (Capture)
2025-11-28 17:24:56,042 - game3d.game.turnmove - INFO - Move 300: WHITE BLACKHOLE [6 0 3]->[6 1 3] (Capture)
2025-11-28 17:25:00,956 - game3d.game.turnmove - INFO - Move 300: BLACK MIRROR [5 1 7]->[5 1 6] (Move)
2025-11-28 17:25:09,056 - game3d.common.state_utils - DEBUG - King for color 1 cached at [3 4 1]
2025-11-28 17:25:09,056 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:25:10,139 - game3d.game.turnmove - INFO - Move 400: WHITE REFLECTOR [3 4 7]->[4 3 8] (Move)
2025-11-28 17:25:11,041 - game3d.game.turnmove - INFO - Move 400: BLACK NEBULA [5 4 8]->[4 4 7] (Move)
2025-11-28 17:25:21,665 - game3d.game.turnmove - INFO - Move 500: BLACK PAWN [0 6 6]->[0 5 5] (Move)
2025-11-28 17:25:28,244 - game3d.game.turnmove - INFO - Move 500: WHITE SPIRAL [4 5 8]->[3 4 8] (Move)
2025-11-28 17:25:29,629 - game3d.game.turnmove - INFO - Move 600: BLACK SLOWER [3 3 1]->[3 4 0] (Move)
2025-11-28 17:25:33,138 - game3d.game.turnmove - INFO - Move 700: BLACK SLOWER [8 1 8]->[8 2 8] (Move)
2025-11-28 17:25:36,556 - game3d.game.turnmove - INFO - Move 800: BLACK FREEZER [6 6 0]->[5 5 1] (Move)
2025-11-28 17:25:39,881 - game3d.game.turnmove - INFO - Move 900: BLACK FREEZER [6 6 0]->[5 5 1] (Move)
2025-11-28 17:25:42,052 - game3d.game.turnmove - INFO - Move 600: WHITE SPIRAL [4 5 8]->[5 4 8] (Move)
2025-11-28 17:25:43,181 - game3d.game.turnmove - INFO - Move 1000: BLACK FREEZER [6 6 0]->[5 5 1] (Move)
2025-11-28 17:25:46,338 - game3d.game.turnmove - INFO - Move 1100: WHITE SPEEDER [3 3 7]->[4 4 7] (Move)
2025-11-28 17:25:48,787 - __main__ - INFO - Training interrupted by user
2025-11-28 17:25:48,791 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 17:26:23,480 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 17:26:23,480 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:26:23,483 - __main__ - INFO - Testing move generation...
2025-11-28 17:26:31,077 - __main__ - INFO - [OK] Generated 845 moves
2025-11-28 17:26:31,077 - __main__ - INFO - Testing GameState caching...
2025-11-28 17:26:31,078 - __main__ - INFO - [OK] GameState caching works
2025-11-28 17:26:31,078 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 17:26:31,078 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 17:26:31,078 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(845), 'piece_moves_cache_size': 107, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 17:26:32,492 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_172619/temp_model_for_selfplay.pt
2025-11-28 17:26:32,492 - training.parallel_self_play - INFO - Starting parallel self-play: 50 games, 3 workers
2025-11-28 17:26:32,492 - training.parallel_self_play - INFO - Model checkpoint: model_checkpoints/train_huge_20251128_172619/temp_model_for_selfplay.pt
2025-11-28 17:26:32,492 - training.parallel_self_play - INFO - Device: cuda, Model size: huge
2025-11-28 17:26:32,494 - training.parallel_self_play - INFO - Launching 50 game workers...
2025-11-28 17:26:40,976 - worker.2 - INFO - Worker 2 starting, loading model...
2025-11-28 17:26:40,980 - worker.1 - INFO - Worker 1 starting, loading model...
2025-11-28 17:26:41,097 - worker.0 - INFO - Worker 0 starting, loading model...
2025-11-28 17:26:46,722 - worker.1 - INFO - Worker 1 model compiled with torch.compile
2025-11-28 17:26:46,723 - worker.1 - INFO - Worker 1 model loaded successfully
2025-11-28 17:26:46,728 - worker.0 - INFO - Worker 0 model compiled with torch.compile
2025-11-28 17:26:46,729 - worker.0 - INFO - Worker 0 model loaded successfully
2025-11-28 17:26:46,743 - worker.2 - INFO - Worker 2 model compiled with torch.compile
2025-11-28 17:26:46,743 - worker.2 - INFO - Worker 2 model loaded successfully
2025-11-28 17:26:47,109 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:26:47,110 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:26:47,111 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140123681089680
2025-11-28 17:26:47,111 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140332416191696
2025-11-28 17:26:47,122 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:26:47,123 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140494039511632
2025-11-28 17:27:03,087 - game3d.game.turnmove - INFO - Move 100: BLACK INFILTRATOR [2 3 7]->[6 7 0] (Capture)
2025-11-28 17:27:03,630 - game3d.game.turnmove - INFO - Move 100: BLACK QUEEN [0 5 7]->[0 6 7] (Move)
2025-11-28 17:27:08,292 - game3d.game.turnmove - INFO - Move 200: WHITE GEOMANCER [3 8 1]->[5 7 0] (Move)
2025-11-28 17:27:08,983 - game3d.game.turnmove - INFO - Move 200: BLACK ARCHER [1 2 7]->[2 2 6] (Move)
2025-11-28 17:27:10,537 - game3d.game.turnmove - INFO - Move 100: BLACK NEBULA [3 5 8]->[4 4 7] (Move)
2025-11-28 17:27:13,978 - game3d.game.turnmove - INFO - Move 300: WHITE XYQUEEN [4 2 1]->[3 3 2] (Capture)
2025-11-28 17:27:18,996 - game3d.game.turnmove - INFO - Move 300: BLACK XYQUEEN [4 0 4]->[4 7 4] (Move)
2025-11-28 17:27:20,200 - game3d.game.turnmove - INFO - Move 400: WHITE EDGEROOK [8 5 4]->[8 5 8] (Capture)
2025-11-28 17:27:22,502 - game3d.game.turnmove - INFO - Move 200: BLACK ORBITER [2 6 4]->[2 4 2] (Capture)
2025-11-28 17:27:27,781 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:27:27,781 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:27:31,938 - game3d.game.turnmove - INFO - Move 400: BLACK MIRROR [6 3 8]->[5 3 7] (Move)
2025-11-28 17:27:33,248 - game3d.game.turnmove - INFO - Move 500: WHITE QUEEN [8 6 3]->[8 6 7] (Capture)
2025-11-28 17:27:39,345 - game3d.game.turnmove - INFO - Move 300: WHITE SLOWER [7 0 1]->[6 0 2] (Move)
2025-11-28 17:27:42,231 - game3d.game.turnmove - INFO - Move 600: BLACK HIVE [1 3 7]->[2 2 6] (Move)
2025-11-28 17:27:43,919 - game3d.game.turnmove - INFO - Move 500: WHITE SPIRAL [3 4 8]->[4 3 8] (Move)
2025-11-28 17:27:46,477 - game3d.game.turnmove - INFO - Move 700: BLACK SWAPPER [5 5 8]->[6 6 7] (Move)
2025-11-28 17:27:50,402 - game3d.game.turnmove - INFO - Move 800: BLACK SLOWER [2 6 7]->[3 6 6] (Move)
2025-11-28 17:27:52,039 - game3d.game.turnmove - INFO - Move 400: BLACK YZZIGZAG [0 6 6]->[0 6 2] (Capture)
2025-11-28 17:27:53,728 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 34 pieces - possible stalemate
2025-11-28 17:27:53,729 - game3d.common.state_utils - DEBUG - King for color 1 cached at [5 4 0]
2025-11-28 17:27:53,729 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:27:53,900 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 34 pieces - possible stalemate
2025-11-28 17:27:53,900 - game3d.common.state_utils - DEBUG - King for color 1 cached at [5 4 0]
2025-11-28 17:27:53,900 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:27:54,575 - game3d.common.state_utils - DEBUG - King for color 1 cached at [5 4 0]
2025-11-28 17:27:54,575 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:27:54,674 - game3d.game.turnmove - INFO - Move 600: WHITE SPIRAL [3 4 8]->[5 4 8] (Move)
2025-11-28 17:27:55,742 - game3d.common.state_utils - DEBUG - King for color 1 cached at [5 4 0]
2025-11-28 17:27:55,742 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:27:56,983 - game3d.game.turnmove - INFO - Move 1000: WHITE PAWN [7 3 0]->[8 4 1] (Capture)
2025-11-28 17:28:00,189 - game3d.game.turnmove - INFO - Move 1100: WHITE PAWN [2 6 1]->[2 7 1] (Move)
2025-11-28 17:28:03,047 - game3d.game.turnmove - INFO - Move 500: WHITE SPIRAL [4 4 5]->[4 4 7] (Move)
2025-11-28 17:28:04,069 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 17 pieces - possible stalemate
2025-11-28 17:28:04,071 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 17 pieces completely immobilized)
2025-11-28 17:28:04,071 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 17 pieces completely immobilized)
2025-11-28 17:28:04,072 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 17 pieces completely immobilized)
2025-11-28 17:28:04,080 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 17 pieces completely immobilized)
2025-11-28 17:28:04,080 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 17 pieces completely immobilized)
2025-11-28 17:28:04,081 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 17 pieces completely immobilized)
2025-11-28 17:28:04,082 - worker.1 - INFO - GAME FINISHED: 1 | DRAW (Stalemate) | 1160 moves | 76.8s | Mat: W=17/B=57 | Priests: W=N B=N | Kings: W=Y B=Y
2025-11-28 17:28:04,082 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 17 pieces completely immobilized)
2025-11-28 17:28:05,369 - worker.3 - INFO - Worker 3 starting, loading model...
2025-11-28 17:28:05,672 - training.parallel_self_play - INFO - Game completed: 1160 examples collected
2025-11-28 17:28:06,114 - game3d.game.turnmove - INFO - Move 700: WHITE GEOMANCER [6 0 4]->[4 3 2] (Move)
2025-11-28 17:28:07,480 - game3d.game.turnmove - INFO - Move 600: BLACK EDGEROOK [6 8 8]->[8 4 1] (Capture)
2025-11-28 17:28:09,577 - worker.3 - INFO - Worker 3 model compiled with torch.compile
2025-11-28 17:28:09,578 - worker.3 - INFO - Worker 3 model loaded successfully
2025-11-28 17:28:09,579 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:28:09,579 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140123339871744
2025-11-28 17:28:16,059 - game3d.game.turnmove - INFO - Move 100: WHITE KNIGHT31 [5 3 3]->[6 4 6] (Capture)
2025-11-28 17:28:16,452 - game3d.game.turnmove - INFO - Move 700: BLACK SPEEDER [4 1 5]->[4 3 5] (Move)
2025-11-28 17:28:17,995 - game3d.game.turnmove - INFO - Move 800: WHITE SPIRAL [5 2 7]->[4 2 8] (Move)
2025-11-28 17:28:20,719 - game3d.game.turnmove - INFO - Move 800: WHITE BLACKHOLE [2 6 1]->[2 5 2] (Move)
2025-11-28 17:28:21,577 - game3d.game.turnmove - INFO - Move 200: WHITE KNIGHT32 [3 4 5]->[0 6 7] (Capture)
2025-11-28 17:28:23,914 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 30 pieces - possible stalemate
2025-11-28 17:28:23,915 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:23,915 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:24,060 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 30 pieces - possible stalemate
2025-11-28 17:28:24,060 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:24,060 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:24,186 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 30 pieces - possible stalemate
2025-11-28 17:28:24,186 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:24,186 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:24,326 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 30 pieces - possible stalemate
2025-11-28 17:28:24,326 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:24,326 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:24,683 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 30 pieces - possible stalemate
2025-11-28 17:28:24,684 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:24,684 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:24,802 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 30 pieces - possible stalemate
2025-11-28 17:28:24,802 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:24,803 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:24,829 - game3d.game.turnmove - INFO - Move 900: BLACK SPIRAL [5 4 0]->[3 4 0] (Move)
2025-11-28 17:28:25,155 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 30 pieces - possible stalemate
2025-11-28 17:28:25,156 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:25,156 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:25,289 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 30 pieces - possible stalemate
2025-11-28 17:28:25,289 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:25,289 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:25,630 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 30 pieces - possible stalemate
2025-11-28 17:28:25,631 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:25,631 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:25,935 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:25,935 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:26,070 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 30 pieces - possible stalemate
2025-11-28 17:28:26,071 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:26,071 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:26,503 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 30 pieces - possible stalemate
2025-11-28 17:28:26,503 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:26,503 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:26,650 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 30 pieces - possible stalemate
2025-11-28 17:28:26,650 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:26,651 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:26,732 - game3d.game.turnmove - INFO - Move 300: WHITE ROOK [3 3 1]->[3 3 8] (Capture)
2025-11-28 17:28:27,014 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 30 pieces - possible stalemate
2025-11-28 17:28:27,014 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:27,014 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:27,175 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 30 pieces - possible stalemate
2025-11-28 17:28:27,175 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:27,176 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:27,599 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 30 pieces - possible stalemate
2025-11-28 17:28:27,599 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:27,599 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:27,742 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 30 pieces - possible stalemate
2025-11-28 17:28:27,743 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:27,743 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:28,111 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 29 pieces - possible stalemate
2025-11-28 17:28:28,111 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:28,111 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:28,260 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 29 pieces - possible stalemate
2025-11-28 17:28:28,261 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:28,261 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:28,423 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 29 pieces - possible stalemate
2025-11-28 17:28:28,424 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:28,424 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:28,687 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:28,687 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:28,824 - game3d.game.turnmove - INFO - Move 1000: WHITE PAWN [8 2 2]->[8 3 2] (Capture)
2025-11-28 17:28:29,033 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:29,034 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:29,034 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:29,338 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:29,338 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:29,466 - game3d.game.turnmove - INFO - Move 900: WHITE SPIRAL [3 4 7]->[4 4 7] (Move)
2025-11-28 17:28:29,490 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:29,490 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:29,490 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:29,854 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:29,854 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:29,855 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:30,012 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:30,012 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:30,012 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:30,378 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:30,379 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:30,379 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:30,552 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:30,553 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:30,553 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:30,925 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:30,925 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:30,925 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:31,085 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:31,086 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:31,086 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:31,456 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:31,457 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:31,457 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:31,505 - game3d.game.turnmove - INFO - Move 400: WHITE FRIENDLYTELEPORTER [7 2 1]->[6 2 2] (Move)
2025-11-28 17:28:31,618 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:31,618 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:31,618 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:31,982 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:31,982 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:31,983 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:32,142 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:32,143 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:32,143 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:32,511 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:32,512 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:32,897 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:32,897 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:32,897 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:32,940 - game3d.game.turnmove - INFO - Move 1100: BLACK SPIRAL [3 4 0]->[5 4 0] (Move)
2025-11-28 17:28:33,056 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:33,056 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:33,056 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:33,424 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:33,425 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:33,425 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:33,596 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:33,596 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:33,596 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:33,955 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:33,955 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:33,955 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:34,100 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:34,100 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:34,100 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:34,343 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:34,343 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:34,343 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:34,651 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:34,652 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:34,652 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:34,881 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:34,881 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:34,881 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:35,050 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:35,051 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:35,051 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:35,357 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:35,357 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:35,357 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:35,517 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:35,517 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:35,517 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:35,834 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:35,834 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:35,834 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:35,851 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 106 pieces - possible stalemate
2025-11-28 17:28:35,852 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:35,852 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:35,992 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:35,993 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:35,993 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:36,276 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:36,276 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:36,276 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:36,547 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:36,548 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:36,548 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:36,551 - game3d.game.turnmove - INFO - Move 500: BLACK TRAILBLAZER [5 5 8]->[5 4 8] (Capture)
2025-11-28 17:28:36,946 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:36,946 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:36,946 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:37,215 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:37,215 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:37,215 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:37,480 - game3d.game.turnmove - INFO - Move 1000: WHITE SPIRAL [5 3 7]->[4 4 7] (Move)
2025-11-28 17:28:37,665 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:37,665 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:37,665 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:37,930 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:37,931 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:37,931 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:37,995 - game3d.game.turnmove - INFO - Move 1200: WHITE XZZIGZAG [4 7 0]->[2 7 0] (Move)
2025-11-28 17:28:38,393 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:38,393 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:38,393 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:38,652 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:38,652 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:38,653 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:39,127 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:39,127 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:39,127 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:39,460 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:39,460 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:39,461 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:39,880 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:39,880 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:39,880 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:40,101 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:40,101 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:40,102 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:40,426 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:40,427 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:40,427 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:40,593 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 17:28:40,593 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:40,593 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:40,932 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:40,932 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:41,323 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 24 pieces - possible stalemate
2025-11-28 17:28:41,323 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:41,323 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:41,501 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 24 pieces - possible stalemate
2025-11-28 17:28:41,501 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:41,501 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:41,880 - game3d.game.turnmove - INFO - Move 1100: WHITE SPIRAL [3 1 7]->[3 4 7] (Move)
2025-11-28 17:28:41,889 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 23 pieces - possible stalemate
2025-11-28 17:28:41,889 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:41,889 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:42,058 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 23 pieces - possible stalemate
2025-11-28 17:28:42,058 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:42,058 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:42,411 - game3d.game.turnmove - INFO - Move 600: WHITE PAWN [2 5 1]->[2 0 6] (Capture)
2025-11-28 17:28:42,472 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 23 pieces - possible stalemate
2025-11-28 17:28:42,472 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:42,472 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:42,636 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 23 pieces - possible stalemate
2025-11-28 17:28:42,636 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:42,637 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:42,955 - game3d.game.turnmove - INFO - Move 1300: WHITE HIVE [3 4 8]->[4 3 8] (Move)
2025-11-28 17:28:43,042 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 23 pieces - possible stalemate
2025-11-28 17:28:43,043 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:43,043 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:43,205 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 23 pieces - possible stalemate
2025-11-28 17:28:43,206 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:43,206 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:43,594 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 22 pieces - possible stalemate
2025-11-28 17:28:43,594 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:43,594 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:43,781 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 22 pieces - possible stalemate
2025-11-28 17:28:43,782 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:43,782 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:44,169 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 22 pieces - possible stalemate
2025-11-28 17:28:44,170 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:44,170 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:44,329 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 22 pieces - possible stalemate
2025-11-28 17:28:44,329 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:44,329 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:44,636 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 22 pieces - possible stalemate
2025-11-28 17:28:44,636 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:44,636 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:44,784 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 22 pieces - possible stalemate
2025-11-28 17:28:44,784 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:44,784 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:45,004 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 22 pieces - possible stalemate
2025-11-28 17:28:45,005 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:28:45,005 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:28:45,031 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 22 pieces - possible stalemate
2025-11-28 17:28:45,033 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 22 pieces completely immobilized)
2025-11-28 17:28:45,033 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 22 pieces completely immobilized)
2025-11-28 17:28:45,034 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 22 pieces completely immobilized)
2025-11-28 17:28:45,041 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 22 pieces completely immobilized)
2025-11-28 17:28:45,042 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 22 pieces completely immobilized)
2025-11-28 17:28:45,042 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 22 pieces completely immobilized)
2025-11-28 17:28:45,043 - worker.0 - INFO - GAME FINISHED: 0 | DRAW (Stalemate) | 1264 moves | 117.8s | Mat: W=22/B=30 | Priests: W=N B=N | Kings: W=Y B=Y
2025-11-28 17:28:45,043 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 22 pieces completely immobilized)
2025-11-28 17:28:45,892 - worker.4 - INFO - Worker 4 starting, loading model...
2025-11-28 17:28:46,037 - training.parallel_self_play - INFO - Game completed: 1264 examples collected
2025-11-28 17:28:46,127 - game3d.game.turnmove - INFO - Move 1200: WHITE PAWN [2 5 1]->[2 1 8] (Capture)
2025-11-28 17:28:46,904 - game3d.game.turnmove - INFO - Move 700: WHITE FREEZER [3 3 7]->[3 4 8] (Capture)
2025-11-28 17:28:49,749 - worker.4 - INFO - Worker 4 model compiled with torch.compile
2025-11-28 17:28:49,750 - worker.4 - INFO - Worker 4 model loaded successfully
2025-11-28 17:28:49,753 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:28:49,753 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140488103823872
2025-11-28 17:28:49,805 - game3d.game.turnmove - INFO - Move 1300: WHITE ARCHER [1 7 3]->[2 6 4] (Move)
2025-11-28 17:28:51,287 - game3d.game.turnmove - INFO - Move 800: WHITE SWAPPER [3 4 6]->[4 4 7] (Move)
2025-11-28 17:28:53,458 - game3d.game.turnmove - INFO - Move 1400: WHITE WHITEHOLE [4 3 8]->[3 4 8] (Move)
2025-11-28 17:28:56,228 - game3d.game.turnmove - INFO - Move 100: WHITE SWAPPER [7 3 0]->[8 4 1] (Move)
2025-11-28 17:28:56,855 - game3d.game.turnmove - INFO - Move 1500: WHITE WHITEHOLE [4 4 7]->[4 3 8] (Move)
2025-11-28 17:28:57,160 - game3d.game.turnmove - INFO - Move 900: WHITE WHITEHOLE [1 3 7]->[1 4 8] (Capture)
2025-11-28 17:29:00,332 - game3d.game.turnmove - INFO - Move 1600: BLACK ARMOUR [5 2 0]->[4 3 0] (Move)
2025-11-28 17:29:00,472 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:29:00,472 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:29:00,707 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:29:00,707 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:29:01,179 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:29:01,179 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:29:01,717 - game3d.game.turnmove - INFO - Move 200: BLACK INFILTRATOR [5 2 0]->[4 3 1] (Capture)
2025-11-28 17:29:03,741 - game3d.game.turnmove - INFO - Move 1700: BLACK WHITEHOLE [4 4 1]->[5 4 0] (Move)
2025-11-28 17:29:04,820 - game3d.game.turnmove - INFO - Move 1000: WHITE FRIENDLYTELEPORTER [7 6 0]->[6 6 1] (Move)
2025-11-28 17:29:06,946 - game3d.game.turnmove - INFO - Move 300: BLACK KNIGHT [4 6 7]->[4 7 4] (Move)
2025-11-28 17:29:07,041 - game3d.game.turnmove - INFO - Move 1800: BLACK NEBULA [4 3 0]->[4 3 1] (Move)
2025-11-28 17:29:10,078 - game3d.game.turnmove - INFO - Move 1100: BLACK ARCHER [5 4 6]->[4 3 5] (Move)
2025-11-28 17:29:10,595 - game3d.game.turnmove - INFO - Move 1900: BLACK FREEZER [4 3 1]->[5 3 1] (Move)
2025-11-28 17:29:12,186 - game3d.game.turnmove - INFO - Move 400: BLACK QUEEN [8 4 3]->[8 4 1] (Capture)
2025-11-28 17:29:14,153 - game3d.game.turnmove - INFO - Move 2000: BLACK WHITEHOLE [4 4 1]->[3 5 2] (Move)
2025-11-28 17:29:14,158 - game3d.game.turnmove - INFO - Move 1200: BLACK WHITEHOLE [6 3 1]->[5 4 0] (Move)
2025-11-28 17:29:16,969 - game3d.game.turnmove - INFO - Move 500: BLACK YZZIGZAG [8 6 8]->[8 6 2] (Capture)
2025-11-28 17:29:17,769 - game3d.game.turnmove - INFO - Move 2100: BLACK NEBULA [5 4 0]->[4 3 0] (Move)
2025-11-28 17:29:18,005 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 9 pieces - possible stalemate
2025-11-28 17:29:18,007 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 9 pieces completely immobilized)
2025-11-28 17:29:18,007 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 9 pieces completely immobilized)
2025-11-28 17:29:18,008 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 9 pieces completely immobilized)
2025-11-28 17:29:18,015 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 9 pieces completely immobilized)
2025-11-28 17:29:18,016 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 9 pieces completely immobilized)
2025-11-28 17:29:18,016 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 9 pieces completely immobilized)
2025-11-28 17:29:18,017 - worker.3 - INFO - GAME FINISHED: 3 | DRAW (Stalemate) | 1287 moves | 68.4s | Mat: W=9/B=22 | Priests: W=N B=N | Kings: W=Y B=Y
2025-11-28 17:29:18,018 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 9 pieces completely immobilized)
2025-11-28 17:29:18,841 - worker.5 - INFO - Worker 5 starting, loading model...
2025-11-28 17:29:18,975 - training.parallel_self_play - INFO - Game completed: 1287 examples collected
2025-11-28 17:29:20,973 - game3d.game.turnmove - INFO - Move 2200: BLACK WHITEHOLE [2 4 0]->[3 4 0] (Move)
2025-11-28 17:29:21,134 - game3d.game.turnmove - INFO - Move 600: BLACK SWAPPER [5 4 0]->[4 3 0] (Move)
2025-11-28 17:29:22,432 - worker.5 - INFO - Worker 5 model compiled with torch.compile
2025-11-28 17:29:22,432 - worker.5 - INFO - Worker 5 model loaded successfully
2025-11-28 17:29:22,433 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:29:22,433 - game3d.cache.manager - DEBUG - Created cache manager #3 for board 140122905531328
2025-11-28 17:29:24,489 - game3d.game.turnmove - INFO - Move 2300: BLACK WHITEHOLE [5 4 0]->[3 4 0] (Move)
2025-11-28 17:29:25,504 - game3d.game.turnmove - INFO - Move 700: BLACK SPIRAL [3 4 0]->[4 5 0] (Move)
2025-11-28 17:29:28,304 - game3d.game.turnmove - INFO - Move 2400: BLACK WHITEHOLE [4 3 0]->[5 4 0] (Move)
2025-11-28 17:29:28,649 - game3d.game.turnmove - INFO - Move 100: WHITE KNIGHT32 [5 3 3]->[3 1 6] (Capture)
2025-11-28 17:29:30,225 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 44 pieces - possible stalemate
2025-11-28 17:29:30,225 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:29:30,225 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:29:30,362 - game3d.game.turnmove - INFO - Move 800: BLACK SWAPPER [5 4 0]->[4 3 0] (Move)
2025-11-28 17:29:31,924 - game3d.game.turnmove - INFO - Move 2500: BLACK BOMB [5 3 1]->[5 4 0] (Move)
2025-11-28 17:29:34,497 - game3d.game.turnmove - INFO - Move 900: BLACK SPIRAL [5 4 2]->[4 4 1] (Move)
2025-11-28 17:29:35,589 - game3d.game.turnmove - INFO - Move 2600: BLACK ARCHER [5 4 0]->[4 5 0] (Move)
2025-11-28 17:29:36,585 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 49 pieces - possible stalemate
2025-11-28 17:29:36,586 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:29:36,586 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:29:36,709 - game3d.game.turnmove - INFO - Move 200: BLACK SPEEDER [1 1 6]->[2 2 6] (Move)
2025-11-28 17:29:38,579 - game3d.game.turnmove - INFO - Move 1000: BLACK FRIENDLYTELEPORTER [0 5 7]->[1 5 6] (Move)
2025-11-28 17:29:39,196 - game3d.game.turnmove - INFO - Move 2700: BLACK WHITEHOLE [5 2 0]->[4 3 0] (Move)
2025-11-28 17:29:42,644 - game3d.game.turnmove - INFO - Move 1100: BLACK BISHOP [4 4 3]->[4 7 0] (Move)
2025-11-28 17:29:43,126 - game3d.game.turnmove - INFO - Move 2800: BLACK PAWN [8 1 5]->[8 0 5] (Move)
2025-11-28 17:29:43,201 - game3d.game.turnmove - INFO - Move 300: BLACK PRIEST [5 6 7]->[6 6 8] (Move)
2025-11-28 17:29:44,527 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 31 pieces - possible stalemate
2025-11-28 17:29:44,529 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 31 pieces completely immobilized)
2025-11-28 17:29:44,530 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 31 pieces completely immobilized)
2025-11-28 17:29:44,530 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 31 pieces completely immobilized)
2025-11-28 17:29:44,537 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 31 pieces completely immobilized)
2025-11-28 17:29:44,538 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 31 pieces completely immobilized)
2025-11-28 17:29:44,538 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 31 pieces completely immobilized)
2025-11-28 17:29:44,539 - worker.4 - INFO - GAME FINISHED: 4 | DRAW (Stalemate) | 1142 moves | 54.7s | Mat: W=22/B=31 | Priests: W=N B=N | Kings: W=Y B=Y
2025-11-28 17:29:44,539 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 31 pieces completely immobilized)
2025-11-28 17:29:45,385 - worker.6 - INFO - Worker 6 starting, loading model...
2025-11-28 17:29:45,512 - training.parallel_self_play - INFO - Game completed: 1142 examples collected
2025-11-28 17:29:46,601 - game3d.game.turnmove - INFO - Move 2900: BLACK WHITEHOLE [5 3 0]->[4 3 0] (Move)
2025-11-28 17:29:48,915 - game3d.game.turnmove - INFO - Move 400: WHITE BOMB [8 5 0]->[8 4 1] (Capture)
2025-11-28 17:29:49,013 - worker.6 - INFO - Worker 6 model compiled with torch.compile
2025-11-28 17:29:49,014 - worker.6 - INFO - Worker 6 model loaded successfully
2025-11-28 17:29:49,015 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:29:49,015 - game3d.cache.manager - DEBUG - Created cache manager #3 for board 140488197815648
2025-11-28 17:29:49,555 - game3d.game.turnmove - INFO - Move 3000: BLACK WHITEHOLE [5 4 0]->[4 3 0] (Move)
2025-11-28 17:29:50,627 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _generate_all_slider_moves at 0x7f722f22ef20>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f722f8b40e0> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 506, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 413, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/trailblazer.py", line 139, in trailblazer_move_dispatcher
    return generate_trailblazer_moves(state.cache_manager, state.color, pos, max_dist, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/trailblazer.py", line 43, in generate_trailblazer_moves
    moves = slider_engine.generate_slider_moves_array(
        cache_manager=cache_manager,
    ...<4 lines>...
        ignore_occupancy=ignore_occupancy
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/slider_engine.py", line 150, in generate_slider_moves_array
    destinations, captures = self.generate_slider_moves_vectorized(
                             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        cache_manager, color, pos, directions, max_distance, ignore_occupancy
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/slider_engine.py", line 119, in generate_slider_moves_vectorized
    return _generate_all_slider_moves(
        color, pos_arr, directions, max_distance, flattened, ignore_occupancy
    )
SystemError: CPUDispatcher(<function _generate_all_slider_moves at 0x7f722f22ef20>) returned a result with an exception set
2025-11-28 17:29:50,632 - worker.5 - ERROR - Worker failed: Move execution failed: CPUDispatcher(<function _generate_all_slider_moves at 0x7f722f22ef20>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f722f8b40e0> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 506, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 413, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/trailblazer.py", line 139, in trailblazer_move_dispatcher
    return generate_trailblazer_moves(state.cache_manager, state.color, pos, max_dist, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/trailblazer.py", line 43, in generate_trailblazer_moves
    moves = slider_engine.generate_slider_moves_array(
        cache_manager=cache_manager,
    ...<4 lines>...
        ignore_occupancy=ignore_occupancy
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/slider_engine.py", line 150, in generate_slider_moves_array
    destinations, captures = self.generate_slider_moves_vectorized(
                             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        cache_manager, color, pos, directions, max_distance, ignore_occupancy
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/slider_engine.py", line 119, in generate_slider_moves_vectorized
    return _generate_all_slider_moves(
        color, pos_arr, directions, max_distance, flattened, ignore_occupancy
    )
SystemError: CPUDispatcher(<function _generate_all_slider_moves at 0x7f722f22ef20>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 247, in _game_worker_permodel
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _generate_all_slider_moves at 0x7f722f22ef20>) returned a result with an exception set
2025-11-28 17:29:50,827 - worker.7 - INFO - Worker 7 starting, loading model...
2025-11-28 17:29:50,989 - __main__ - INFO - Training interrupted by user
2025-11-28 17:29:50,997 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 17:30:22,513 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 17:30:22,514 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:30:22,515 - __main__ - INFO - Testing move generation...
2025-11-28 17:30:22,867 - __main__ - INFO - [OK] Generated 845 moves
2025-11-28 17:30:22,867 - __main__ - INFO - Testing GameState caching...
2025-11-28 17:30:22,868 - __main__ - INFO - [OK] GameState caching works
2025-11-28 17:30:22,868 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 17:30:22,868 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 17:30:22,868 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(845), 'piece_moves_cache_size': 107, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 17:30:24,291 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_173018/temp_model_for_selfplay.pt
2025-11-28 17:30:24,291 - training.parallel_self_play - INFO - Starting parallel self-play: 50 games, 6 workers
2025-11-28 17:30:24,291 - training.parallel_self_play - INFO - Model checkpoint: model_checkpoints/train_huge_20251128_173018/temp_model_for_selfplay.pt
2025-11-28 17:30:24,291 - training.parallel_self_play - INFO - Device: cuda, Model size: huge
2025-11-28 17:30:24,295 - training.parallel_self_play - INFO - Launching 50 game workers...
2025-11-28 17:30:35,601 - worker.1 - INFO - Worker 1 starting, loading model...
2025-11-28 17:30:35,602 - worker.3 - INFO - Worker 3 starting, loading model...
2025-11-28 17:30:35,677 - worker.2 - INFO - Worker 2 starting, loading model...
2025-11-28 17:30:35,677 - worker.4 - INFO - Worker 4 starting, loading model...
2025-11-28 17:30:35,844 - worker.5 - INFO - Worker 5 starting, loading model...
2025-11-28 17:30:35,874 - worker.0 - INFO - Worker 0 starting, loading model...
2025-11-28 17:30:42,548 - worker.4 - INFO - Worker 4 model compiled with torch.compile
2025-11-28 17:30:42,548 - worker.2 - INFO - Worker 2 model compiled with torch.compile
2025-11-28 17:30:42,548 - worker.5 - INFO - Worker 5 model compiled with torch.compile
2025-11-28 17:30:42,549 - worker.4 - INFO - Worker 4 model loaded successfully
2025-11-28 17:30:42,549 - worker.2 - INFO - Worker 2 model loaded successfully
2025-11-28 17:30:42,549 - worker.5 - INFO - Worker 5 model loaded successfully
2025-11-28 17:30:42,562 - worker.3 - INFO - Worker 3 model compiled with torch.compile
2025-11-28 17:30:42,563 - worker.3 - INFO - Worker 3 model loaded successfully
2025-11-28 17:30:42,575 - worker.1 - INFO - Worker 1 model compiled with torch.compile
2025-11-28 17:30:42,576 - worker.1 - INFO - Worker 1 model loaded successfully
2025-11-28 17:30:42,816 - worker.0 - INFO - Worker 0 model compiled with torch.compile
2025-11-28 17:30:42,817 - worker.0 - INFO - Worker 0 model loaded successfully
2025-11-28 17:30:42,898 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:30:42,898 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:30:42,898 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:30:42,899 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:30:42,899 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:30:42,900 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140659773230288
2025-11-28 17:30:42,900 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140588741627856
2025-11-28 17:30:42,900 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139755910512208
2025-11-28 17:30:42,900 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139971682422016
2025-11-28 17:30:42,900 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140089610058480
2025-11-28 17:30:43,130 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:30:43,131 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139729752429552
2025-11-28 17:31:04,035 - game3d.game.turnmove - INFO - Move 100: WHITE FREEZER [8 0 1]->[7 1 2] (Move)
2025-11-28 17:31:04,050 - game3d.game.turnmove - INFO - Move 100: WHITE ARMOUR [5 8 1]->[6 7 2] (Capture)
2025-11-28 17:31:05,033 - game3d.game.turnmove - INFO - Move 100: BLACK SWAPPER [2 1 4]->[2 1 3] (Capture)
2025-11-28 17:31:05,363 - game3d.game.turnmove - INFO - Move 100: WHITE ECHO [3 0 0]->[2 0 1] (Move)
2025-11-28 17:31:06,527 - game3d.game.turnmove - INFO - Move 100: WHITE XZZIGZAG [0 8 6]->[1 8 6] (Capture)
2025-11-28 17:31:10,218 - game3d.game.turnmove - INFO - Move 100: BLACK INFILTRATOR [3 6 6]->[4 6 6] (Capture)
2025-11-28 17:31:12,757 - game3d.game.turnmove - INFO - Move 200: BLACK NEBULA [2 3 8]->[4 5 6] (Move)
2025-11-28 17:31:13,349 - game3d.game.turnmove - INFO - Move 200: WHITE MIRROR [3 3 2]->[3 2 2] (Capture)
2025-11-28 17:31:15,435 - game3d.game.turnmove - INFO - Move 200: BLACK ROOK [4 2 1]->[4 4 1] (Move)
2025-11-28 17:31:18,101 - game3d.game.turnmove - INFO - Move 200: WHITE SPIRAL [6 7 1]->[6 7 6] (Capture)
2025-11-28 17:31:26,892 - game3d.game.turnmove - INFO - Move 300: BLACK SPIRAL [2 7 8]->[8 7 2] (Capture)
2025-11-28 17:31:26,926 - game3d.game.turnmove - INFO - Move 200: WHITE EDGEROOK [3 8 2]->[5 8 8] (Capture)
2025-11-28 17:31:27,959 - game3d.game.turnmove - INFO - Move 200: BLACK GEOMANCER [1 2 8]->[4 3 5] (Move)
2025-11-28 17:31:31,215 - game3d.game.turnmove - INFO - Move 300: WHITE ORBITER [4 8 0]->[4 8 5] (Capture)
2025-11-28 17:31:38,551 - game3d.game.turnmove - INFO - Move 300: BLACK KNIGHT32 [5 5 8]->[7 3 5] (Move)
2025-11-28 17:31:39,792 - game3d.game.turnmove - INFO - Move 300: WHITE WHITEHOLE [0 2 1]->[1 2 2] (Move)
2025-11-28 17:31:51,212 - game3d.game.turnmove - INFO - Move 300: WHITE BLACKHOLE [2 8 1]->[0 6 3] (Move)
2025-11-28 17:31:54,679 - game3d.game.turnmove - INFO - Move 400: BLACK SPIRAL [8 7 8]->[0 7 0] (Capture)
2025-11-28 17:31:56,131 - game3d.game.turnmove - INFO - Move 400: WHITE HIVE [4 4 7]->[3 4 8] (Move)
2025-11-28 17:31:57,290 - game3d.game.turnmove - INFO - Move 400: BLACK ORBITER [0 4 8]->[1 3 6] (Move)
2025-11-28 17:32:01,136 - game3d.game.turnmove - INFO - Move 300: BLACK QUEEN [8 3 7]->[8 8 2] (Capture)
2025-11-28 17:32:07,518 - game3d.game.turnmove - INFO - Move 500: WHITE ORBITER [4 8 0]->[4 7 3] (Move)
2025-11-28 17:32:08,475 - game3d.game.turnmove - INFO - Move 500: BLACK FRIENDLYTELEPORTER [2 5 5]->[2 4 4] (Move)
2025-11-28 17:32:12,997 - game3d.game.turnmove - INFO - Move 400: BLACK FREEZER [3 5 1]->[4 5 0] (Move)
2025-11-28 17:32:14,873 - game3d.game.turnmove - INFO - Move 400: WHITE SLOWER [3 0 1]->[4 1 0] (Capture)
2025-11-28 17:32:16,430 - game3d.game.turnmove - INFO - Move 500: BLACK SWAPPER [1 5 8]->[1 4 8] (Move)
2025-11-28 17:32:19,392 - game3d.game.turnmove - INFO - Move 600: BLACK BLACKHOLE [6 0 7]->[4 2 5] (Move)
2025-11-28 17:32:19,902 - game3d.game.turnmove - INFO - Move 600: WHITE PANEL [3 5 4]->[4 4 5] (Move)
2025-11-28 17:32:30,615 - game3d.game.turnmove - INFO - Move 600: WHITE INFILTRATOR [2 4 4]->[1 3 5] (Capture)
2025-11-28 17:32:31,020 - game3d.game.turnmove - INFO - Move 700: WHITE PANEL [3 5 5]->[4 4 6] (Move)
2025-11-28 17:32:31,753 - game3d.game.turnmove - INFO - Move 400: BLACK BISHOP [5 8 1]->[4 8 0] (Move)
2025-11-28 17:32:32,791 - game3d.game.turnmove - INFO - Move 700: WHITE PANEL [4 4 3]->[4 4 4] (Move)
2025-11-28 17:32:36,625 - game3d.game.turnmove - INFO - Move 500: WHITE WHITEHOLE [4 3 6]->[4 4 7] (Move)
2025-11-28 17:32:37,626 - game3d.game.turnmove - INFO - Move 500: BLACK FREEZER [2 4 0]->[3 3 1] (Move)
2025-11-28 17:32:38,802 - game3d.game.turnmove - INFO - Move 700: WHITE ARCHER [1 1 6]->[2 1 7] (Move)
2025-11-28 17:32:43,667 - game3d.game.turnmove - INFO - Move 800: WHITE MIRROR [4 7 0]->[5 7 1] (Move)
2025-11-28 17:32:46,243 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f6926f9d080>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f69274b00e0> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 307, in make_move
    _process_hole_effects(game_state, opp_color)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 709, in _process_hole_effects
    apply_forced_moves(game_state, forced_moves)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 662, in apply_forced_moves
    cache_manager._invalidate_affected_piece_moves(all_coords, Color.BLACK, game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/manager.py", line 461, in _invalidate_affected_piece_moves
    dep_coords = self.dependency_graph.get_affected_pieces_vectorized(game_state, color)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/manager.py", line 595, in get_affected_pieces_vectorized
    colors, piece_types = self._manager.occupancy_cache.batch_get_attributes(all_coords)
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f6926f9d080>) returned a result with an exception set
2025-11-28 17:32:46,243 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fec530a1080>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7fec535b80e0> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 506, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 413, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fec530a1080>) returned a result with an exception set
2025-11-28 17:32:46,247 - worker.2 - ERROR - Worker failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f6926f9d080>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f69274b00e0> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 307, in make_move
    _process_hole_effects(game_state, opp_color)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 709, in _process_hole_effects
    apply_forced_moves(game_state, forced_moves)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 662, in apply_forced_moves
    cache_manager._invalidate_affected_piece_moves(all_coords, Color.BLACK, game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/manager.py", line 461, in _invalidate_affected_piece_moves
    dep_coords = self.dependency_graph.get_affected_pieces_vectorized(game_state, color)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/manager.py", line 595, in get_affected_pieces_vectorized
    colors, piece_types = self._manager.occupancy_cache.batch_get_attributes(all_coords)
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f6926f9d080>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 247, in _game_worker_permodel
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f6926f9d080>) returned a result with an exception set
2025-11-28 17:32:46,243 - worker.4 - ERROR - Worker failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fde7a2a1080>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7fde7a7b80e0> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 247, in _game_worker_permodel
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 113, in submit_move
    is_game_over=_terminal_is_game_over(new_state),
                 ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/usr/lib/python3.13/contextlib.py", line 85, in inner
    return func(*args, **kwds)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/terminal.py", line 229, in is_game_over
    legal_moves = game_state.legal_moves
                  ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/gamestate.py", line 231, in legal_moves
    return turnmove.legal_moves(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 54, in legal_moves
    structured_moves = generate_legal_moves(game_state)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 549, in generate_legal_moves
    return _generator.generate(state)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 161, in generate
    return self.generate_fused(state)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 272, in generate_fused
    final_moves = filter_safe_moves_optimized(state, final_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fde7a2a1080>) returned a result with an exception set
2025-11-28 17:32:46,248 - worker.1 - ERROR - Worker failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fec530a1080>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7fec535b80e0> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 506, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 413, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fec530a1080>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 247, in _game_worker_permodel
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fec530a1080>) returned a result with an exception set
2025-11-28 17:32:46,487 - worker.6 - INFO - Worker 6 starting, loading model...
2025-11-28 17:32:46,621 - __main__ - INFO - Training interrupted by user
2025-11-28 17:32:46,625 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 17:33:16,936 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 17:33:16,937 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:33:16,938 - __main__ - INFO - Testing move generation...
2025-11-28 17:33:17,289 - __main__ - INFO - [OK] Generated 845 moves
2025-11-28 17:33:17,289 - __main__ - INFO - Testing GameState caching...
2025-11-28 17:33:17,290 - __main__ - INFO - [OK] GameState caching works
2025-11-28 17:33:17,290 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 17:33:17,290 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 17:33:17,290 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(845), 'piece_moves_cache_size': 107, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 17:33:18,707 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_173312/temp_model_for_selfplay.pt
2025-11-28 17:33:18,707 - training.parallel_self_play - INFO - Starting parallel self-play: 50 games, 5 workers
2025-11-28 17:33:18,707 - training.parallel_self_play - INFO - Model checkpoint: model_checkpoints/train_huge_20251128_173312/temp_model_for_selfplay.pt
2025-11-28 17:33:18,707 - training.parallel_self_play - INFO - Device: cuda, Model size: huge
2025-11-28 17:33:18,710 - training.parallel_self_play - INFO - Launching 50 game workers...
2025-11-28 17:33:28,711 - worker.1 - INFO - Worker 1 starting, loading model...
2025-11-28 17:33:28,743 - worker.3 - INFO - Worker 3 starting, loading model...
2025-11-28 17:33:28,748 - worker.2 - INFO - Worker 2 starting, loading model...
2025-11-28 17:33:28,749 - worker.4 - INFO - Worker 4 starting, loading model...
2025-11-28 17:33:28,753 - worker.0 - INFO - Worker 0 starting, loading model...
2025-11-28 17:33:35,330 - worker.3 - INFO - Worker 3 model compiled with torch.compile
2025-11-28 17:33:35,330 - worker.2 - INFO - Worker 2 model compiled with torch.compile
2025-11-28 17:33:35,331 - worker.3 - INFO - Worker 3 model loaded successfully
2025-11-28 17:33:35,331 - worker.2 - INFO - Worker 2 model loaded successfully
2025-11-28 17:33:35,357 - worker.1 - INFO - Worker 1 model compiled with torch.compile
2025-11-28 17:33:35,358 - worker.1 - INFO - Worker 1 model loaded successfully
2025-11-28 17:33:35,366 - worker.4 - INFO - Worker 4 model compiled with torch.compile
2025-11-28 17:33:35,367 - worker.4 - INFO - Worker 4 model loaded successfully
2025-11-28 17:33:35,391 - worker.0 - INFO - Worker 0 model compiled with torch.compile
2025-11-28 17:33:35,392 - worker.0 - INFO - Worker 0 model loaded successfully
2025-11-28 17:33:35,635 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:33:35,635 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:33:35,636 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139774808640720
2025-11-28 17:33:35,636 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140596746141312
2025-11-28 17:33:35,662 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:33:35,663 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140339858984144
2025-11-28 17:33:35,686 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:33:35,687 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140571152727632
2025-11-28 17:33:35,700 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:33:35,701 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139631543816864
2025-11-28 17:33:53,151 - game3d.game.turnmove - INFO - Move 100: BLACK KNIGHT31 [5 1 7]->[4 2 4] (Move)
2025-11-28 17:33:53,242 - game3d.game.turnmove - INFO - Move 100: BLACK KNIGHT31 [6 4 8]->[7 3 5] (Move)
2025-11-28 17:33:53,887 - game3d.game.turnmove - INFO - Move 100: WHITE KNIGHT31 [3 3 3]->[4 2 6] (Capture)
2025-11-28 17:33:53,935 - game3d.game.turnmove - INFO - Move 100: WHITE KNIGHT31 [4 6 0]->[5 5 3] (Capture)
2025-11-28 17:33:55,246 - game3d.game.turnmove - INFO - Move 100: WHITE KNIGHT [4 6 6]->[3 6 8] (Capture)
2025-11-28 17:33:59,685 - game3d.game.turnmove - INFO - Move 200: WHITE FRIENDLYTELEPORTER [7 2 0]->[4 1 5] (Capture)
2025-11-28 17:34:00,106 - game3d.game.turnmove - INFO - Move 200: BLACK GEOMANCER [3 8 7]->[2 8 4] (Move)
2025-11-28 17:34:01,286 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 174 pieces - possible stalemate
2025-11-28 17:34:01,287 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:34:01,287 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:34:02,082 - game3d.game.turnmove - INFO - Move 200: WHITE CONESLIDER [4 5 8]->[5 4 8] (Move)
2025-11-28 17:34:03,783 - game3d.game.turnmove - INFO - Move 200: WHITE MIRROR [5 6 0]->[5 6 1] (Move)
2025-11-28 17:34:04,279 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 169 pieces - possible stalemate
2025-11-28 17:34:04,281 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:34:04,281 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:34:07,706 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 166 pieces - possible stalemate
2025-11-28 17:34:07,708 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:34:07,708 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:34:09,155 - game3d.game.turnmove - INFO - Move 300: BLACK XZQUEEN [6 7 8]->[0 7 2] (Capture)
2025-11-28 17:34:09,847 - game3d.game.turnmove - INFO - Move 300: WHITE WHITEHOLE [4 1 5]->[3 2 6] (Capture)
2025-11-28 17:34:10,186 - game3d.game.turnmove - INFO - Move 300: WHITE TRIGONALBISHOP [7 4 1]->[3 0 5] (Capture)
2025-11-28 17:34:11,052 - game3d.game.turnmove - INFO - Move 200: BLACK PANEL [6 6 8]->[6 5 7] (Move)
2025-11-28 17:34:14,964 - game3d.game.turnmove - INFO - Move 400: BLACK ARCHER [7 5 7]->[7 7 5] (Move)
2025-11-28 17:34:15,666 - game3d.game.turnmove - INFO - Move 400: BLACK NEBULA [4 6 5]->[3 7 4] (Move)
2025-11-28 17:34:20,081 - game3d.game.turnmove - INFO - Move 500: BLACK PAWN [1 5 6]->[1 4 6] (Move)
2025-11-28 17:34:20,765 - game3d.game.turnmove - INFO - Move 500: WHITE PANEL [2 1 2]->[2 0 2] (Capture)
2025-11-28 17:34:22,843 - game3d.game.turnmove - INFO - Move 400: BLACK PAWN [7 7 6]->[7 6 6] (Capture)
2025-11-28 17:34:24,388 - game3d.game.turnmove - INFO - Move 300: BLACK SPIRAL [8 7 8]->[8 7 7] (Move)
2025-11-28 17:34:27,142 - game3d.game.turnmove - INFO - Move 600: BLACK BLACKHOLE [2 8 6]->[1 7 5] (Move)
2025-11-28 17:34:30,577 - game3d.game.turnmove - INFO - Move 600: WHITE MIRROR [4 7 2]->[5 6 3] (Capture)
2025-11-28 17:34:31,538 - game3d.game.turnmove - INFO - Move 700: BLACK ARCHER [5 6 5]->[4 5 4] (Move)
2025-11-28 17:34:34,829 - game3d.game.turnmove - INFO - Move 300: WHITE PAWN [5 0 2]->[4 1 1] (Capture)
2025-11-28 17:34:35,393 - game3d.game.turnmove - INFO - Move 800: BLACK PAWN [0 2 6]->[0 1 6] (Move)
2025-11-28 17:34:36,033 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:34:36,033 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:34:36,247 - game3d.game.turnmove - INFO - Move 500: WHITE ARMOUR [1 3 6]->[1 2 5] (Capture)
2025-11-28 17:34:38,955 - game3d.game.turnmove - INFO - Move 900: BLACK PAWN [0 1 7]->[0 0 7] (Move)
2025-11-28 17:34:42,286 - game3d.game.turnmove - INFO - Move 700: WHITE SWAPPER [5 5 1]->[4 4 2] (Move)
2025-11-28 17:34:42,741 - game3d.game.turnmove - INFO - Move 1000: BLACK FREEZER [3 5 1]->[4 5 0] (Move)
2025-11-28 17:34:44,247 - game3d.game.turnmove - INFO - Move 600: BLACK BISHOP [5 6 4]->[4 5 4] (Capture)
2025-11-28 17:34:46,003 - game3d.common.state_utils - DEBUG - King for color 1 cached at [2 5 0]
2025-11-28 17:34:46,003 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:34:46,808 - game3d.common.state_utils - DEBUG - King for color 1 cached at [2 5 0]
2025-11-28 17:34:46,809 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:34:47,695 - game3d.common.state_utils - DEBUG - King for color 1 cached at [2 5 0]
2025-11-28 17:34:47,695 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:34:47,857 - game3d.game.turnmove - INFO - Move 1100: WHITE FREEZER [4 5 8]->[3 5 7] (Move)
2025-11-28 17:34:48,035 - game3d.game.turnmove - INFO - Move 400: BLACK BLACKHOLE [3 8 2]->[4 7 1] (Capture)
2025-11-28 17:34:48,449 - game3d.game.turnmove - INFO - Move 700: BLACK BISHOP [4 4 3]->[4 1 0] (Move)
2025-11-28 17:34:48,528 - game3d.common.state_utils - DEBUG - King for color 1 cached at [2 5 0]
2025-11-28 17:34:48,529 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:34:52,312 - game3d.game.turnmove - INFO - Move 1200: BLACK PAWN [0 1 7]->[0 0 7] (Move)
2025-11-28 17:34:52,929 - game3d.game.turnmove - INFO - Move 800: BLACK BISHOP [4 4 3]->[4 1 0] (Move)
2025-11-28 17:34:52,999 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:34:53,000 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:34:53,653 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:34:53,653 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:34:53,970 - game3d.game.turnmove - INFO - Move 800: WHITE WHITEHOLE [2 3 3]->[2 4 4] (Move)
2025-11-28 17:34:54,191 - game3d.game.turnmove - INFO - Move 400: BLACK INFILTRATOR [6 3 7]->[5 2 6] (Move)
2025-11-28 17:34:57,822 - game3d.game.turnmove - INFO - Move 900: WHITE XYQUEEN [3 2 2]->[5 4 2] (Capture)
2025-11-28 17:34:58,052 - game3d.game.turnmove - INFO - Move 1300: BLACK PAWN [0 0 7]->[0 1 7] (Move)
2025-11-28 17:35:00,473 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 37 pieces - possible stalemate
2025-11-28 17:35:00,474 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:35:00,474 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:35:00,729 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 37 pieces - possible stalemate
2025-11-28 17:35:00,730 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:35:00,730 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:35:02,143 - game3d.game.turnmove - INFO - Move 1000: WHITE BOMB [5 4 3]->[4 5 3] (Move)
2025-11-28 17:35:03,362 - game3d.game.turnmove - INFO - Move 1400: BLACK PAWN [0 1 7]->[0 0 7] (Move)
2025-11-28 17:35:05,904 - game3d.game.turnmove - INFO - Move 1100: WHITE ECHO [3 4 4]->[3 4 5] (Move)
2025-11-28 17:35:06,768 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fe054d99080>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7fe0552b40e0> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 506, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 413, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fe054d99080>) returned a result with an exception set
2025-11-28 17:35:06,773 - worker.2 - ERROR - Worker failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fe054d99080>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7fe0552b40e0> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 506, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 413, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fe054d99080>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 247, in _game_worker_permodel
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fe054d99080>) returned a result with an exception set
2025-11-28 17:35:06,987 - worker.6 - INFO - Worker 6 starting, loading model...
2025-11-28 17:35:07,046 - __main__ - INFO - Training interrupted by user
2025-11-28 17:35:07,049 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 17:35:37,271 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 17:35:37,272 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:35:37,275 - __main__ - INFO - Testing move generation...
2025-11-28 17:35:44,925 - __main__ - INFO - [OK] Generated 845 moves
2025-11-28 17:35:44,925 - __main__ - INFO - Testing GameState caching...
2025-11-28 17:35:44,925 - __main__ - INFO - [OK] GameState caching works
2025-11-28 17:35:44,925 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 17:35:44,926 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 17:35:44,926 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(845), 'piece_moves_cache_size': 107, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 17:35:46,387 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_173533/temp_model_for_selfplay.pt
2025-11-28 17:35:46,387 - training.parallel_self_play - INFO - Starting parallel self-play: 50 games, 4 workers
2025-11-28 17:35:46,387 - training.parallel_self_play - INFO - Model checkpoint: model_checkpoints/train_huge_20251128_173533/temp_model_for_selfplay.pt
2025-11-28 17:35:46,388 - training.parallel_self_play - INFO - Device: cuda, Model size: huge
2025-11-28 17:35:46,390 - training.parallel_self_play - INFO - Launching 50 game workers...
2025-11-28 17:35:55,073 - worker.3 - INFO - Worker 3 starting, loading model...
2025-11-28 17:35:55,113 - worker.2 - INFO - Worker 2 starting, loading model...
2025-11-28 17:35:55,156 - worker.0 - INFO - Worker 0 starting, loading model...
2025-11-28 17:35:55,168 - worker.1 - INFO - Worker 1 starting, loading model...
2025-11-28 17:36:01,168 - worker.0 - INFO - Worker 0 model compiled with torch.compile
2025-11-28 17:36:01,169 - worker.0 - INFO - Worker 0 model loaded successfully
2025-11-28 17:36:01,179 - worker.2 - INFO - Worker 2 model compiled with torch.compile
2025-11-28 17:36:01,179 - worker.2 - INFO - Worker 2 model loaded successfully
2025-11-28 17:36:01,187 - worker.3 - INFO - Worker 3 model compiled with torch.compile
2025-11-28 17:36:01,188 - worker.3 - INFO - Worker 3 model loaded successfully
2025-11-28 17:36:01,279 - worker.1 - INFO - Worker 1 model compiled with torch.compile
2025-11-28 17:36:01,280 - worker.1 - INFO - Worker 1 model loaded successfully
2025-11-28 17:36:01,530 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:36:01,532 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140570602327248
2025-11-28 17:36:01,536 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:36:01,536 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:36:01,537 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139960372522448
2025-11-28 17:36:01,537 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140645448040016
2025-11-28 17:36:01,592 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:36:01,593 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140362560228560
2025-11-28 17:36:20,791 - game3d.game.turnmove - INFO - Move 100: WHITE PANEL [6 6 0]->[6 6 1] (Move)
2025-11-28 17:36:21,048 - game3d.game.turnmove - INFO - Move 100: WHITE PAWN [0 0 2]->[0 1 2] (Move)
2025-11-28 17:36:21,137 - game3d.game.turnmove - INFO - Move 100: WHITE ECHO [3 2 6]->[2 2 7] (Capture)
2025-11-28 17:36:21,550 - game3d.game.turnmove - INFO - Move 100: WHITE FREEZER [8 0 1]->[7 1 2] (Move)
2025-11-28 17:36:27,664 - game3d.game.turnmove - INFO - Move 200: BLACK INFILTRATOR [2 2 7]->[3 2 6] (Move)
2025-11-28 17:36:29,762 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:36:29,762 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:36:30,860 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:36:30,861 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:36:33,704 - game3d.game.turnmove - INFO - Move 300: WHITE PAWN [2 1 3]->[3 2 4] (Capture)
2025-11-28 17:36:34,103 - game3d.game.turnmove - INFO - Move 200: WHITE BISHOP [4 7 8]->[4 4 5] (Move)
2025-11-28 17:36:34,727 - game3d.game.turnmove - INFO - Move 200: BLACK PANEL [3 3 7]->[4 4 7] (Capture)
2025-11-28 17:36:35,406 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:36:35,406 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:36:39,045 - game3d.game.turnmove - INFO - Move 200: BLACK KNIGHT [6 4 7]->[4 3 7] (Move)
2025-11-28 17:36:39,833 - game3d.game.turnmove - INFO - Move 400: WHITE KNIGHT31 [5 5 4]->[4 4 7] (Move)
2025-11-28 17:36:44,079 - game3d.game.turnmove - INFO - Move 500: BLACK XZQUEEN [5 7 7]->[5 7 1] (Capture)
2025-11-28 17:36:45,802 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 82 pieces - possible stalemate
2025-11-28 17:36:45,803 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:36:45,803 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:36:49,634 - game3d.game.turnmove - INFO - Move 600: WHITE BLACKHOLE [4 5 8]->[4 4 7] (Move)
2025-11-28 17:36:52,840 - game3d.game.turnmove - INFO - Move 300: WHITE FRIENDLYTELEPORTER [2 3 4]->[2 4 5] (Move)
2025-11-28 17:36:54,643 - game3d.game.turnmove - INFO - Move 700: WHITE BISHOP [2 3 6]->[4 3 8] (Move)
2025-11-28 17:36:54,729 - game3d.game.turnmove - INFO - Move 300: BLACK ECHO [4 8 4]->[4 7 3] (Capture)
2025-11-28 17:36:55,728 - game3d.game.turnmove - INFO - Move 300: WHITE BISHOP [4 4 5]->[4 7 8] (Move)
2025-11-28 17:36:57,109 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:36:57,109 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:36:58,586 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:36:58,586 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:36:59,033 - game3d.game.turnmove - INFO - Move 800: WHITE SPEEDER [7 6 3]->[7 5 4] (Move)
2025-11-28 17:36:59,610 - game3d.game.turnmove - INFO - Move 400: BLACK BLACKHOLE [5 0 7]->[4 0 6] (Move)
2025-11-28 17:37:02,973 - game3d.game.turnmove - INFO - Move 900: WHITE SLOWER [7 8 1]->[7 8 3] (Move)
2025-11-28 17:37:05,217 - game3d.game.turnmove - INFO - Move 500: WHITE FREEZER [3 2 6]->[3 3 7] (Move)
2025-11-28 17:37:05,717 - game3d.game.turnmove - INFO - Move 400: WHITE KNIGHT31 [5 5 1]->[2 4 2] (Move)
2025-11-28 17:37:06,713 - game3d.game.turnmove - INFO - Move 1000: BLACK WHITEHOLE [4 4 3]->[4 4 2] (Move)
2025-11-28 17:37:10,252 - game3d.game.turnmove - INFO - Move 1100: BLACK ECHO [4 4 1]->[5 4 0] (Move)
2025-11-28 17:37:10,433 - game3d.game.turnmove - INFO - Move 600: WHITE FREEZER [3 2 6]->[3 3 7] (Move)
2025-11-28 17:37:13,793 - game3d.game.turnmove - INFO - Move 1200: BLACK ECHO [4 4 1]->[5 5 1] (Move)
2025-11-28 17:37:14,278 - game3d.game.turnmove - INFO - Move 500: BLACK ROOK [5 4 0]->[3 4 0] (Move)
2025-11-28 17:37:14,529 - game3d.game.turnmove - INFO - Move 400: WHITE PANEL [2 2 0]->[4 4 2] (Move)
2025-11-28 17:37:15,956 - game3d.game.turnmove - INFO - Move 700: WHITE SPIRAL [4 4 7]->[5 4 8] (Capture)
2025-11-28 17:37:17,861 - game3d.game.turnmove - INFO - Move 1300: BLACK WHITEHOLE [3 4 0]->[4 5 0] (Move)
2025-11-28 17:37:17,974 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 4 pieces - possible stalemate
2025-11-28 17:37:17,977 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 4 pieces - possible stalemate
2025-11-28 17:37:17,977 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 4 pieces completely immobilized)
2025-11-28 17:37:17,977 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 4 pieces completely immobilized)
2025-11-28 17:37:17,978 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 4 pieces completely immobilized)
2025-11-28 17:37:17,987 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 4 pieces completely immobilized)
2025-11-28 17:37:17,988 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 4 pieces completely immobilized)
2025-11-28 17:37:17,988 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 4 pieces completely immobilized)
2025-11-28 17:37:17,989 - worker.3 - INFO - GAME FINISHED: 3 | DRAW (Stalemate) | 1299 moves | 76.3s | Mat: W=32/B=4 | Priests: W=N B=N | Kings: W=Y B=Y
2025-11-28 17:37:17,990 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 4 pieces completely immobilized)
2025-11-28 17:37:18,644 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 108 pieces - possible stalemate
2025-11-28 17:37:18,646 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:37:18,646 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:37:19,002 - worker.4 - INFO - Worker 4 starting, loading model...
2025-11-28 17:37:19,159 - training.parallel_self_play - INFO - Game completed: 1299 examples collected
2025-11-28 17:37:19,267 - game3d.game.turnmove - INFO - Move 600: WHITE ROOK [4 5 8]->[4 3 8] (Move)
2025-11-28 17:37:21,275 - game3d.game.turnmove - INFO - Move 800: WHITE SPIRAL [3 4 7]->[4 4 7] (Move)
2025-11-28 17:37:21,629 - game3d.common.state_utils - DEBUG - King for color 1 cached at [7 1 1]
2025-11-28 17:37:21,629 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:37:23,355 - worker.4 - INFO - Worker 4 model compiled with torch.compile
2025-11-28 17:37:23,356 - worker.4 - INFO - Worker 4 model loaded successfully
2025-11-28 17:37:23,357 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:37:23,357 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139959695849552
2025-11-28 17:37:25,577 - game3d.game.turnmove - INFO - Move 900: WHITE SPIRAL [4 4 7]->[3 4 8] (Move)
2025-11-28 17:37:26,864 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:37:26,864 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:37:27,191 - game3d.game.turnmove - INFO - Move 500: BLACK HIVE [4 3 7]->[4 4 7] (Capture)
2025-11-28 17:37:30,082 - game3d.game.turnmove - INFO - Move 1000: WHITE SPIRAL [3 4 8]->[4 4 7] (Move)
2025-11-28 17:37:30,183 - game3d.game.turnmove - INFO - Move 100: WHITE FREEZER [0 0 1]->[0 0 2] (Capture)
2025-11-28 17:37:33,249 - game3d.game.turnmove - INFO - Move 700: BLACK BLACKHOLE [7 1 2]->[7 2 1] (Move)
2025-11-28 17:37:34,707 - game3d.game.turnmove - INFO - Move 1100: WHITE FREEZER [3 2 6]->[3 3 7] (Move)
2025-11-28 17:37:36,006 - game3d.game.turnmove - INFO - Move 200: WHITE SLOWER [3 8 1]->[4 7 2] (Capture)
2025-11-28 17:37:37,771 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 140 pieces - possible stalemate
2025-11-28 17:37:37,772 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:37:37,772 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:37:39,343 - game3d.game.turnmove - INFO - Move 1200: WHITE SPIRAL [3 2 7]->[3 4 7] (Move)
2025-11-28 17:37:41,046 - game3d.game.turnmove - INFO - Move 300: WHITE KNIGHT31 [5 7 7]->[2 6 6] (Capture)
2025-11-28 17:37:44,152 - game3d.game.turnmove - INFO - Move 1300: WHITE SPIRAL [3 4 7]->[4 4 7] (Move)
2025-11-28 17:37:45,502 - game3d.game.turnmove - INFO - Move 600: WHITE YZQUEEN [3 2 7]->[4 3 8] (Move)
2025-11-28 17:37:47,014 - game3d.game.turnmove - INFO - Move 400: BLACK ARCHER [7 3 7]->[8 2 8] (Capture)
2025-11-28 17:37:49,282 - game3d.game.turnmove - INFO - Move 1400: WHITE SPIRAL [4 4 7]->[5 4 8] (Move)
2025-11-28 17:37:51,525 - game3d.game.turnmove - INFO - Move 700: WHITE HIVE [4 4 5]->[4 3 6] (Capture)
2025-11-28 17:37:52,794 - game3d.game.turnmove - INFO - Move 800: BLACK ROOK [3 4 0]->[3 5 0] (Move)
2025-11-28 17:37:54,062 - game3d.game.turnmove - INFO - Move 1500: WHITE FREEZER [3 2 6]->[3 3 7] (Move)
2025-11-28 17:37:56,604 - game3d.game.turnmove - INFO - Move 800: WHITE ORBITER [7 4 3]->[7 5 6] (Capture)
2025-11-28 17:37:58,804 - game3d.game.turnmove - INFO - Move 500: WHITE FREEZER [2 3 2]->[1 4 3] (Move)
2025-11-28 17:37:58,924 - game3d.game.turnmove - INFO - Move 1600: WHITE SPIRAL [3 2 7]->[5 4 7] (Move)
2025-11-28 17:38:00,978 - game3d.game.turnmove - INFO - Move 900: WHITE BISHOP [5 8 7]->[4 8 8] (Move)
2025-11-28 17:38:04,103 - game3d.game.turnmove - INFO - Move 1700: WHITE ORBITER [7 0 3]->[8 0 6] (Capture)
2025-11-28 17:38:05,403 - game3d.game.turnmove - INFO - Move 1000: WHITE SPIRAL [5 5 5]->[4 4 5] (Move)
2025-11-28 17:38:08,427 - game3d.game.turnmove - INFO - Move 600: WHITE KNIGHT31 [3 3 3]->[4 4 6] (Move)
2025-11-28 17:38:09,184 - game3d.game.turnmove - INFO - Move 1800: WHITE FREEZER [2 2 8]->[3 3 7] (Move)
2025-11-28 17:38:09,331 - game3d.game.turnmove - INFO - Move 900: BLACK PANEL [7 1 0]->[8 1 1] (Move)
2025-11-28 17:38:09,684 - game3d.game.turnmove - INFO - Move 1100: WHITE SPIRAL [5 4 8]->[4 5 8] (Move)
2025-11-28 17:38:14,200 - game3d.game.turnmove - INFO - Move 1900: BLACK SPIRAL [5 4 0]->[4 3 0] (Move)
2025-11-28 17:38:14,348 - game3d.game.turnmove - INFO - Move 1200: WHITE SPIRAL [3 4 8]->[4 3 8] (Move)
2025-11-28 17:38:18,813 - game3d.game.turnmove - INFO - Move 1300: WHITE SPIRAL [4 5 8]->[3 4 8] (Move)
2025-11-28 17:38:18,962 - game3d.game.turnmove - INFO - Move 2000: BLACK XZQUEEN [5 6 7]->[5 6 3] (Move)
2025-11-28 17:38:19,930 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 92 pieces - possible stalemate
2025-11-28 17:38:19,931 - game3d.common.state_utils - DEBUG - King for color 1 cached at [7 1 1]
2025-11-28 17:38:19,931 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:38:22,804 - game3d.game.turnmove - INFO - Move 1400: WHITE SPIRAL [3 4 8]->[5 4 8] (Move)
2025-11-28 17:38:23,248 - game3d.game.turnmove - INFO - Move 2100: BLACK SWAPPER [4 4 0]->[4 4 1] (Move)
2025-11-28 17:38:26,540 - game3d.game.turnmove - INFO - Move 1000: WHITE ROOK [4 5 8]->[4 3 8] (Move)
2025-11-28 17:38:27,050 - game3d.game.turnmove - INFO - Move 1500: WHITE SPIRAL [4 5 8]->[5 4 8] (Move)
2025-11-28 17:38:27,582 - game3d.game.turnmove - INFO - Move 2200: BLACK QUEEN [4 3 0]->[3 4 0] (Move)
2025-11-28 17:38:28,435 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:38:28,435 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:38:30,627 - worker.5 - INFO - Worker 5 starting, loading model...
2025-11-28 17:38:31,746 - game3d.game.turnmove - INFO - Move 2300: BLACK QUEEN [5 4 0]->[4 5 0] (Move)
2025-11-28 17:38:31,877 - game3d.game.turnmove - INFO - Move 1600: BLACK BISHOP [5 3 3]->[4 4 3] (Move)
2025-11-28 17:38:35,912 - game3d.game.turnmove - INFO - Move 2400: BLACK QUEEN [4 3 0]->[4 5 0] (Move)
2025-11-28 17:38:36,140 - game3d.game.turnmove - INFO - Move 1700: BLACK PANEL [6 2 2]->[5 3 1] (Move)
2025-11-28 17:38:36,150 - worker.5 - INFO - Worker 5 model compiled with torch.compile
2025-11-28 17:38:36,151 - worker.5 - INFO - Worker 5 model loaded successfully
2025-11-28 17:38:36,488 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:38:36,489 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140491048963280
2025-11-28 17:38:40,549 - game3d.game.turnmove - INFO - Move 2500: BLACK PAWN [0 4 6]->[1 3 5] (Capture)
2025-11-28 17:38:40,908 - game3d.game.turnmove - INFO - Move 1800: BLACK PANEL [6 2 2]->[5 3 1] (Move)
2025-11-28 17:38:45,973 - game3d.game.turnmove - INFO - Move 2600: BLACK YZZIGZAG [8 6 2]->[8 6 1] (Move)
2025-11-28 17:38:46,616 - game3d.game.turnmove - INFO - Move 1900: BLACK YZZIGZAG [0 6 3]->[0 6 4] (Move)
2025-11-28 17:38:48,013 - game3d.game.turnmove - INFO - Move 1100: WHITE ROOK [4 5 8]->[4 3 8] (Move)
2025-11-28 17:38:48,909 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 57 pieces - possible stalemate
2025-11-28 17:38:48,909 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:38:48,909 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:38:50,708 - game3d.game.turnmove - INFO - Move 2700: BLACK WHITEHOLE [4 4 1]->[5 4 0] (Move)
2025-11-28 17:38:52,210 - game3d.game.turnmove - INFO - Move 100: WHITE NEBULA [2 3 0]->[1 2 1] (Move)
2025-11-28 17:38:53,091 - game3d.game.turnmove - INFO - Move 2000: WHITE ECHO [3 5 7]->[4 4 7] (Move)
2025-11-28 17:38:55,122 - game3d.game.turnmove - INFO - Move 2800: BLACK WHITEHOLE [4 4 1]->[5 4 0] (Move)
2025-11-28 17:38:57,485 - game3d.game.turnmove - INFO - Move 2100: WHITE WALL [8 4 1]->[6 2 3] (Move)
2025-11-28 17:38:59,259 - game3d.game.turnmove - INFO - Move 2900: BLACK SWAPPER [3 4 0]->[4 3 0] (Move)
2025-11-28 17:39:00,476 - game3d.game.turnmove - INFO - Move 200: BLACK PANEL [4 4 2]->[4 4 1] (Move)
2025-11-28 17:39:01,799 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 21 pieces - possible stalemate
2025-11-28 17:39:01,802 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 21 pieces completely immobilized)
2025-11-28 17:39:01,803 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 21 pieces completely immobilized)
2025-11-28 17:39:01,804 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 21 pieces completely immobilized)
2025-11-28 17:39:01,820 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 21 pieces completely immobilized)
2025-11-28 17:39:01,821 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 21 pieces completely immobilized)
2025-11-28 17:39:01,822 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 21 pieces completely immobilized)
2025-11-28 17:39:01,822 - worker.0 - INFO - GAME FINISHED: 0 | DRAW (Stalemate) | 2154 moves | 180.2s | Mat: W=21/B=48 | Priests: W=N B=N | Kings: W=Y B=Y
2025-11-28 17:39:01,823 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 21 pieces completely immobilized)
2025-11-28 17:39:02,617 - game3d.game.turnmove - INFO - Move 3000: BLACK WHITEHOLE [4 4 1]->[5 4 0] (Move)
2025-11-28 17:39:03,598 - worker.6 - INFO - Worker 6 starting, loading model...
2025-11-28 17:39:03,697 - game3d.common.state_utils - DEBUG - King for color 1 cached at [7 1 1]
2025-11-28 17:39:03,697 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:39:03,869 - training.parallel_self_play - INFO - Game completed: 2154 examples collected
2025-11-28 17:39:06,197 - game3d.game.turnmove - INFO - Move 3100: BLACK SLOWER [5 5 1]->[4 5 0] (Move)
2025-11-28 17:39:08,339 - worker.6 - INFO - Worker 6 model compiled with torch.compile
2025-11-28 17:39:08,340 - worker.6 - INFO - Worker 6 model loaded successfully
2025-11-28 17:39:08,341 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:39:08,342 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140645012045888
2025-11-28 17:39:09,468 - game3d.game.turnmove - INFO - Move 3200: BLACK SLOWER [4 5 0]->[3 5 1] (Move)
2025-11-28 17:39:12,442 - game3d.game.turnmove - INFO - Move 1200: BLACK PANEL [7 1 2]->[6 1 1] (Move)
2025-11-28 17:39:12,941 - game3d.game.turnmove - INFO - Move 3300: BLACK WHITEHOLE [4 3 0]->[4 4 1] (Move)
2025-11-28 17:39:15,986 - game3d.game.turnmove - INFO - Move 100: WHITE INFILTRATOR [6 3 1]->[5 4 2] (Capture)
2025-11-28 17:39:16,469 - game3d.game.turnmove - INFO - Move 3400: BLACK SWAPPER [4 4 1]->[3 4 0] (Move)
2025-11-28 17:39:16,850 - game3d.game.turnmove - INFO - Move 300: WHITE PAWN [2 3 2]->[2 4 2] (Move)
2025-11-28 17:39:20,016 - game3d.game.turnmove - INFO - Move 3500: BLACK SWAPPER [4 4 1]->[5 4 0] (Move)
2025-11-28 17:39:23,415 - game3d.game.turnmove - INFO - Move 3600: BLACK SLOWER [3 3 1]->[3 4 0] (Move)
2025-11-28 17:39:26,101 - game3d.game.turnmove - INFO - Move 200: BLACK ARMOUR [3 1 7]->[4 0 6] (Move)
2025-11-28 17:39:26,735 - game3d.game.turnmove - INFO - Move 3700: BLACK WHITEHOLE [3 4 0]->[4 3 0] (Move)
2025-11-28 17:39:28,660 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:39:28,661 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:39:30,034 - game3d.game.turnmove - INFO - Move 3800: BLACK SWAPPER [4 4 1]->[5 4 0] (Move)
2025-11-28 17:39:30,602 - game3d.game.turnmove - INFO - Move 1300: BLACK BLACKHOLE [6 1 1]->[7 2 1] (Move)
2025-11-28 17:44:55,143 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 17:44:55,144 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:44:55,145 - __main__ - INFO - Testing move generation...
2025-11-28 17:44:55,557 - __main__ - INFO - [OK] Generated 845 moves
2025-11-28 17:44:55,557 - __main__ - INFO - Testing GameState caching...
2025-11-28 17:44:55,557 - __main__ - INFO - [OK] GameState caching works
2025-11-28 17:44:55,557 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 17:44:55,558 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 17:44:55,558 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(845), 'piece_moves_cache_size': 107, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 17:44:57,011 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_174450/temp_model_for_selfplay.pt
2025-11-28 17:44:57,011 - training.parallel_self_play - INFO - Starting parallel self-play: 50 games, 4 workers
2025-11-28 17:44:57,011 - training.parallel_self_play - INFO - Model checkpoint: model_checkpoints/train_huge_20251128_174450/temp_model_for_selfplay.pt
2025-11-28 17:44:57,012 - training.parallel_self_play - INFO - Device: cuda, Model size: huge
2025-11-28 17:44:57,014 - training.parallel_self_play - INFO - Launching 50 game workers...
2025-11-28 17:45:05,434 - worker.1 - INFO - Worker 1 starting, loading model...
2025-11-28 17:45:05,469 - worker.0 - INFO - Worker 0 starting, loading model...
2025-11-28 17:45:05,469 - worker.2 - INFO - Worker 2 starting, loading model...
2025-11-28 17:45:05,472 - worker.3 - INFO - Worker 3 starting, loading model...
2025-11-28 17:45:09,122 - worker.1 - INFO - Worker 1 model loaded successfully (No Compile)
2025-11-28 17:45:09,182 - worker.2 - INFO - Worker 2 model loaded successfully (No Compile)
2025-11-28 17:45:09,187 - worker.3 - INFO - Worker 3 model loaded successfully (No Compile)
2025-11-28 17:45:09,188 - worker.0 - INFO - Worker 0 model loaded successfully (No Compile)
2025-11-28 17:45:09,298 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:45:09,299 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140631191124240
2025-11-28 17:45:09,343 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:45:09,344 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139919575202592
2025-11-28 17:45:09,345 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:45:09,346 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139852736644000
2025-11-28 17:45:09,347 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:45:09,348 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140624968794512
2025-11-28 17:45:16,810 - game3d.game.turnmove - INFO - Move 100: BLACK YZQUEEN [6 6 7]->[5 5 6] (Move)
2025-11-28 17:45:17,039 - game3d.game.turnmove - INFO - Move 100: BLACK CONESLIDER [0 0 0]->[5 5 2] (Capture)
2025-11-28 17:45:17,203 - game3d.game.turnmove - INFO - Move 100: WHITE TRIGONALBISHOP [2 3 5]->[1 2 6] (Capture)
2025-11-28 17:45:19,993 - game3d.game.turnmove - INFO - Move 100: WHITE YZZIGZAG [0 6 0]->[0 6 6] (Capture)
2025-11-28 17:45:22,383 - game3d.game.turnmove - INFO - Move 200: WHITE PANEL [5 7 2]->[5 7 3] (Capture)
2025-11-28 17:45:23,124 - game3d.game.turnmove - INFO - Move 200: BLACK PANEL [6 2 8]->[5 3 7] (Capture)
2025-11-28 17:45:26,045 - game3d.game.turnmove - INFO - Move 200: BLACK FREEZER [0 8 7]->[1 7 6] (Move)
2025-11-28 17:45:28,183 - game3d.game.turnmove - INFO - Move 200: BLACK PAWN [7 5 6]->[8 4 5] (Move)
2025-11-28 17:45:28,622 - game3d.game.turnmove - INFO - Move 300: BLACK HIVE [5 6 2]->[5 5 1] (Capture)
2025-11-28 17:45:31,185 - game3d.game.turnmove - INFO - Move 300: WHITE SPIRAL [1 0 8]->[4 3 8] (Move)
2025-11-28 17:45:31,744 - game3d.game.turnmove - INFO - Move 300: BLACK ARCHER [1 5 7]->[2 6 7] (Move)
2025-11-28 17:45:33,611 - game3d.game.turnmove - INFO - Move 300: BLACK TRIGONALBISHOP [1 4 7]->[5 8 3] (Move)
2025-11-28 17:45:33,875 - game3d.game.turnmove - INFO - Move 400: BLACK QUEEN [4 5 0]->[4 3 0] (Capture)
2025-11-28 17:45:35,337 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 109 pieces - possible stalemate
2025-11-28 17:45:35,337 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:45:35,338 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:45:38,306 - game3d.game.turnmove - INFO - Move 400: BLACK QUEEN [7 5 0]->[5 5 0] (Capture)
2025-11-28 17:45:40,351 - game3d.game.turnmove - INFO - Move 400: WHITE PANEL [4 4 1]->[4 4 0] (Move)
2025-11-28 17:45:41,393 - game3d.game.turnmove - INFO - Move 500: BLACK PANEL [4 4 5]->[4 4 4] (Move)
2025-11-28 17:45:43,011 - game3d.game.turnmove - INFO - Move 500: BLACK PANEL [4 4 8]->[4 4 7] (Move)
2025-11-28 17:45:43,687 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 97 pieces - possible stalemate
2025-11-28 17:45:43,688 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:45:43,688 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:45:46,583 - game3d.game.turnmove - INFO - Move 500: BLACK ECHO [5 0 8]->[2 5 3] (Capture)
2025-11-28 17:45:46,690 - game3d.game.turnmove - INFO - Move 600: WHITE XZZIGZAG [1 1 0]->[6 1 0] (Move)
2025-11-28 17:45:50,732 - game3d.game.turnmove - INFO - Move 600: WHITE NEBULA [4 4 3]->[4 4 7] (Capture)
2025-11-28 17:45:51,318 - game3d.game.turnmove - INFO - Move 600: BLACK SWAPPER [1 5 4]->[1 5 3] (Capture)
2025-11-28 17:45:51,735 - game3d.game.turnmove - INFO - Move 700: BLACK PAWN [1 6 7]->[1 5 7] (Move)
2025-11-28 17:45:55,520 - game3d.game.turnmove - INFO - Move 400: WHITE XYQUEEN [5 7 1]->[6 6 2] (Move)
2025-11-28 17:45:58,090 - game3d.game.turnmove - INFO - Move 700: BLACK PAWN [0 6 6]->[0 5 6] (Move)
2025-11-28 17:45:58,223 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:45:58,223 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:45:59,604 - game3d.game.turnmove - INFO - Move 800: BLACK ARMOUR [6 6 2]->[5 6 1] (Capture)
2025-11-28 17:46:02,909 - game3d.game.turnmove - INFO - Move 700: WHITE FREEZER [3 1 4]->[4 0 5] (Capture)
2025-11-28 17:46:04,230 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 127 pieces - possible stalemate
2025-11-28 17:46:04,231 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:46:04,231 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:46:05,298 - game3d.game.turnmove - INFO - Move 900: BLACK PAWN [4 6 6]->[4 5 6] (Move)
2025-11-28 17:46:06,092 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fe5cd69d080>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7fe5cdbb40e0> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 223, in make_move
    cache_manager.consolidated_aura_cache.trigger_freeze(game_state.color, game_state.turn_number)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/effectscache/auracache.py", line 469, in trigger_freeze
    frozen_coords = get_all_frozen_squares_numpy(self.cm, color)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/freezer.py", line 56, in get_all_frozen_squares_numpy
    _, piece_types = cache_manager.occupancy_cache.batch_get_attributes(all_coords)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fe5cd69d080>) returned a result with an exception set
2025-11-28 17:46:06,095 - worker.0 - ERROR - Worker failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fe5cd69d080>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7fe5cdbb40e0> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 223, in make_move
    cache_manager.consolidated_aura_cache.trigger_freeze(game_state.color, game_state.turn_number)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/effectscache/auracache.py", line 469, in trigger_freeze
    frozen_coords = get_all_frozen_squares_numpy(self.cm, color)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/freezer.py", line 56, in get_all_frozen_squares_numpy
    _, piece_types = cache_manager.occupancy_cache.batch_get_attributes(all_coords)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fe5cd69d080>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 237, in _game_worker_permodel
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fe5cd69d080>) returned a result with an exception set
2025-11-28 17:46:06,093 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f4187199080>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: mirror_move_dispatcher() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f41876ac0e0> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 506, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 413, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/mirror.py", line 57, in mirror_move_dispatcher
    return generate_mirror_moves(state.cache_manager, state.color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/mirror.py", line 36, in generate_mirror_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(target_coord.reshape(1, 3))
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f4187199080>) returned a result with an exception set
2025-11-28 17:46:06,097 - worker.2 - ERROR - Worker failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f4187199080>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: mirror_move_dispatcher() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f41876ac0e0> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 506, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 413, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/mirror.py", line 57, in mirror_move_dispatcher
    return generate_mirror_moves(state.cache_manager, state.color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/mirror.py", line 36, in generate_mirror_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(target_coord.reshape(1, 3))
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f4187199080>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 237, in _game_worker_permodel
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f4187199080>) returned a result with an exception set
2025-11-28 17:46:06,208 - worker.4 - INFO - Worker 4 starting, loading model...
2025-11-28 17:46:06,209 - worker.5 - INFO - Worker 5 starting, loading model...
2025-11-28 17:46:06,596 - __main__ - INFO - Training interrupted by user
2025-11-28 17:46:06,596 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 17:54:43,029 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 17:54:43,029 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:54:43,032 - __main__ - INFO - Testing move generation...
2025-11-28 17:54:50,461 - __main__ - INFO - [OK] Generated 845 moves
2025-11-28 17:54:50,462 - __main__ - INFO - Testing GameState caching...
2025-11-28 17:54:50,462 - __main__ - INFO - [OK] GameState caching works
2025-11-28 17:54:50,462 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 17:54:50,462 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 17:54:50,462 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(845), 'piece_moves_cache_size': 107, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 17:54:51,902 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_175439/temp_model_for_selfplay.pt
2025-11-28 17:54:51,902 - training.parallel_self_play - INFO - Starting parallel self-play: 50 games, 4 workers
2025-11-28 17:54:51,902 - training.parallel_self_play - INFO - Model checkpoint: model_checkpoints/train_huge_20251128_175439/temp_model_for_selfplay.pt
2025-11-28 17:54:51,902 - training.parallel_self_play - INFO - Device: cuda, Model size: huge
2025-11-28 17:54:51,904 - training.parallel_self_play - INFO - Launching 50 game workers...
2025-11-28 17:55:00,309 - worker.0 - INFO - Worker 0 starting, loading model...
2025-11-28 17:55:00,327 - worker.1 - INFO - Worker 1 starting, loading model...
2025-11-28 17:55:00,330 - worker.2 - INFO - Worker 2 starting, loading model...
2025-11-28 17:55:00,331 - worker.3 - INFO - Worker 3 starting, loading model...
2025-11-28 17:55:03,910 - worker.1 - INFO - Worker 1 model loaded successfully (No Compile)
2025-11-28 17:55:03,987 - worker.2 - INFO - Worker 2 model loaded successfully (No Compile)
2025-11-28 17:55:04,013 - worker.0 - INFO - Worker 0 model loaded successfully (No Compile)
2025-11-28 17:55:04,035 - worker.3 - INFO - Worker 3 model loaded successfully (No Compile)
2025-11-28 17:55:04,150 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:55:04,151 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139928661758864
2025-11-28 17:55:04,162 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:55:04,163 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140018441325776
2025-11-28 17:55:04,188 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:55:04,189 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140098707509200
2025-11-28 17:55:04,200 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:55:04,201 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139736192704112
2025-11-28 17:55:16,182 - game3d.game.turnmove - INFO - Move 100: WHITE BOMB [8 3 0]->[7 3 0] (Move)
2025-11-28 17:55:16,258 - game3d.game.turnmove - INFO - Move 100: WHITE ORBITER [7 1 0]->[7 2 3] (Move)
2025-11-28 17:55:16,483 - game3d.game.turnmove - INFO - Move 100: WHITE KNIGHT32 [7 3 3]->[4 5 5] (Capture)
2025-11-28 17:55:17,256 - game3d.game.turnmove - INFO - Move 100: WHITE ROOK [3 3 2]->[3 3 6] (Capture)
2025-11-28 17:55:22,571 - game3d.game.turnmove - INFO - Move 200: WHITE SWAPPER [7 2 1]->[5 8 2] (Move)
2025-11-28 17:55:22,686 - game3d.game.turnmove - INFO - Move 200: WHITE WHITEHOLE [7 5 4]->[6 4 4] (Move)
2025-11-28 17:55:23,404 - game3d.game.turnmove - INFO - Move 200: BLACK KNIGHT32 [3 5 8]->[1 3 5] (Move)
2025-11-28 17:55:24,073 - game3d.game.turnmove - INFO - Move 200: WHITE FRIENDLYTELEPORTER [5 6 3]->[6 5 4] (Move)
2025-11-28 17:55:28,346 - game3d.game.turnmove - INFO - Move 300: WHITE ARMOUR [6 8 3]->[6 8 4] (Move)
2025-11-28 17:55:31,344 - game3d.game.turnmove - INFO - Move 300: BLACK FREEZER [5 3 5]->[6 3 4] (Capture)
2025-11-28 17:55:31,700 - game3d.game.turnmove - INFO - Move 300: BLACK SLOWER [6 8 5]->[5 8 5] (Capture)
2025-11-28 17:55:33,163 - game3d.game.turnmove - INFO - Move 400: WHITE NEBULA [6 1 2]->[5 2 3] (Capture)
2025-11-28 17:55:37,725 - game3d.game.turnmove - INFO - Move 500: BLACK KNIGHT [6 4 7]->[6 5 5] (Move)
2025-11-28 17:55:38,253 - game3d.game.turnmove - INFO - Move 300: WHITE SPEEDER [7 0 2]->[6 1 2] (Capture)
2025-11-28 17:55:41,688 - game3d.game.turnmove - INFO - Move 600: WHITE SLOWER [2 0 2]->[3 0 2] (Move)
2025-11-28 17:55:43,031 - game3d.game.turnmove - INFO - Move 400: WHITE SPIRAL [7 8 0]->[5 8 2] (Move)
2025-11-28 17:55:44,386 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 57 pieces - possible stalemate
2025-11-28 17:55:44,388 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:55:44,388 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:55:44,749 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:55:44,749 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:55:45,437 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 55 pieces - possible stalemate
2025-11-28 17:55:45,439 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:55:45,439 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:55:46,395 - game3d.game.turnmove - INFO - Move 700: BLACK BLACKHOLE [5 1 8]->[5 1 7] (Capture)
2025-11-28 17:55:46,933 - game3d.game.turnmove - INFO - Move 400: BLACK ARCHER [3 4 4]->[3 4 3] (Move)
2025-11-28 17:55:47,251 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 49 pieces - possible stalemate
2025-11-28 17:55:47,251 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:55:47,252 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:55:47,487 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:55:47,488 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:55:47,681 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 49 pieces - possible stalemate
2025-11-28 17:55:47,682 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:55:47,682 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:55:47,882 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 48 pieces - possible stalemate
2025-11-28 17:55:47,883 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:55:47,883 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:55:48,107 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 48 pieces - possible stalemate
2025-11-28 17:55:48,107 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:55:48,108 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:55:48,667 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 47 pieces - possible stalemate
2025-11-28 17:55:48,667 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:55:48,667 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:55:49,231 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:55:49,231 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:55:50,813 - game3d.game.turnmove - INFO - Move 800: WHITE XZQUEEN [3 7 0]->[4 7 0] (Move)
2025-11-28 17:55:53,888 - game3d.game.turnmove - INFO - Move 500: BLACK FREEZER [2 6 2]->[3 5 1] (Move)
2025-11-28 17:55:54,885 - game3d.game.turnmove - INFO - Move 900: WHITE ARCHER [3 8 4]->[2 7 5] (Move)
2025-11-28 17:55:55,128 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:55:55,128 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:55:56,582 - game3d.game.turnmove - INFO - Move 400: BLACK INFILTRATOR [4 8 2]->[5 8 2] (Capture)
2025-11-28 17:55:58,306 - game3d.game.turnmove - INFO - Move 500: WHITE ARCHER [3 3 3]->[3 4 4] (Capture)
2025-11-28 17:55:59,060 - game3d.game.turnmove - INFO - Move 1000: WHITE FREEZER [4 2 8]->[3 3 7] (Move)
2025-11-28 17:56:03,472 - game3d.game.turnmove - INFO - Move 600: WHITE YZZIGZAG [0 2 0]->[0 2 2] (Capture)
2025-11-28 17:56:03,583 - game3d.game.turnmove - INFO - Move 1100: BLACK PANEL [4 3 0]->[5 4 0] (Move)
2025-11-28 17:56:05,851 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 60 pieces - possible stalemate
2025-11-28 17:56:05,852 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 17:56:05,852 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 17:56:15,769 - worker.4 - INFO - Worker 4 starting, loading model...
2025-11-28 17:56:15,939 - worker.5 - INFO - Worker 5 starting, loading model...
2025-11-28 17:56:16,145 - worker.6 - INFO - Worker 6 starting, loading model...
2025-11-28 17:56:16,363 - worker.7 - INFO - Worker 7 starting, loading model...
2025-11-28 17:56:19,122 - worker.4 - INFO - Worker 4 model loaded successfully (No Compile)
2025-11-28 17:56:19,309 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:56:19,310 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139895532387440
2025-11-28 17:56:19,378 - worker.5 - INFO - Worker 5 model loaded successfully (No Compile)
2025-11-28 17:56:19,571 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:56:19,572 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140692163437296
2025-11-28 17:56:19,593 - worker.6 - INFO - Worker 6 model loaded successfully (No Compile)
2025-11-28 17:56:19,794 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:56:19,795 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140063278370480
2025-11-28 17:56:19,797 - worker.7 - INFO - Worker 7 model loaded successfully (No Compile)
2025-11-28 17:56:19,992 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:56:19,993 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139990378561936
2025-11-28 17:56:26,876 - game3d.game.turnmove - INFO - Move 100: BLACK BISHOP [4 0 7]->[5 1 7] (Capture)
2025-11-28 17:56:27,461 - __main__ - INFO - Training interrupted by user
2025-11-28 17:56:27,461 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 17:59:38,785 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 17:59:38,786 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:59:38,786 - __main__ - INFO - Testing move generation...
2025-11-28 17:59:39,127 - __main__ - INFO - [OK] Generated 845 moves
2025-11-28 17:59:39,127 - __main__ - INFO - Testing GameState caching...
2025-11-28 17:59:39,127 - __main__ - INFO - [OK] GameState caching works
2025-11-28 17:59:39,127 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 17:59:39,127 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 17:59:39,128 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(845), 'piece_moves_cache_size': 107, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 17:59:40,546 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_175934/temp_model_for_selfplay.pt
2025-11-28 17:59:40,546 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 50 games, 4 workers
2025-11-28 17:59:43,343 - training.parallel_self_play - INFO - Launching workers...
2025-11-28 17:59:49,684 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 4)
2025-11-28 17:59:52,682 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:59:52,683 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140473186300064
2025-11-28 17:59:52,705 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:59:52,706 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140245945425952
2025-11-28 17:59:52,732 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:59:52,733 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139642319844784
2025-11-28 17:59:52,794 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 17:59:52,795 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139889780617472
2025-11-28 17:59:54,095 - InferenceServer - CRITICAL - Server Crashed: Error(s) in loading state_dict for OptimizedModule:
	Missing key(s) in state_dict: "_orig_mod.input_proj.0.weight", "_orig_mod.input_proj.0.bias", "_orig_mod.input_proj.2.weight", "_orig_mod.input_proj.2.bias", "_orig_mod.pos_encoding.pe_x", "_orig_mod.pos_encoding.pe_y", "_orig_mod.pos_encoding.pe_z", "_orig_mod.layers.0.norm1.weight", "_orig_mod.layers.0.norm1.bias", "_orig_mod.layers.0.attn.to_qkv.weight", "_orig_mod.layers.0.attn.to_out.weight", "_orig_mod.layers.0.attn.to_out.bias", "_orig_mod.layers.0.norm2.weight", "_orig_mod.layers.0.norm2.bias", "_orig_mod.layers.0.ff.net.0.weight", "_orig_mod.layers.0.ff.net.0.bias", "_orig_mod.layers.0.ff.net.3.weight", "_orig_mod.layers.0.ff.net.3.bias", "_orig_mod.layers.1.norm1.weight", "_orig_mod.layers.1.norm1.bias", "_orig_mod.layers.1.attn.to_qkv.weight", "_orig_mod.layers.1.attn.to_out.weight", "_orig_mod.layers.1.attn.to_out.bias", "_orig_mod.layers.1.norm2.weight", "_orig_mod.layers.1.norm2.bias", "_orig_mod.layers.1.ff.net.0.weight", "_orig_mod.layers.1.ff.net.0.bias", "_orig_mod.layers.1.ff.net.3.weight", "_orig_mod.layers.1.ff.net.3.bias", "_orig_mod.layers.2.norm1.weight", "_orig_mod.layers.2.norm1.bias", "_orig_mod.layers.2.attn.to_qkv.weight", "_orig_mod.layers.2.attn.to_out.weight", "_orig_mod.layers.2.attn.to_out.bias", "_orig_mod.layers.2.norm2.weight", "_orig_mod.layers.2.norm2.bias", "_orig_mod.layers.2.ff.net.0.weight", "_orig_mod.layers.2.ff.net.0.bias", "_orig_mod.layers.2.ff.net.3.weight", "_orig_mod.layers.2.ff.net.3.bias", "_orig_mod.layers.3.norm1.weight", "_orig_mod.layers.3.norm1.bias", "_orig_mod.layers.3.attn.to_qkv.weight", "_orig_mod.layers.3.attn.to_out.weight", "_orig_mod.layers.3.attn.to_out.bias", "_orig_mod.layers.3.norm2.weight", "_orig_mod.layers.3.norm2.bias", "_orig_mod.layers.3.ff.net.0.weight", "_orig_mod.layers.3.ff.net.0.bias", "_orig_mod.layers.3.ff.net.3.weight", "_orig_mod.layers.3.ff.net.3.bias", "_orig_mod.layers.4.norm1.weight", "_orig_mod.layers.4.norm1.bias", "_orig_mod.layers.4.attn.to_qkv.weight", "_orig_mod.layers.4.attn.to_out.weight", "_orig_mod.layers.4.attn.to_out.bias", "_orig_mod.layers.4.norm2.weight", "_orig_mod.layers.4.norm2.bias", "_orig_mod.layers.4.ff.net.0.weight", "_orig_mod.layers.4.ff.net.0.bias", "_orig_mod.layers.4.ff.net.3.weight", "_orig_mod.layers.4.ff.net.3.bias", "_orig_mod.layers.5.norm1.weight", "_orig_mod.layers.5.norm1.bias", "_orig_mod.layers.5.attn.to_qkv.weight", "_orig_mod.layers.5.attn.to_out.weight", "_orig_mod.layers.5.attn.to_out.bias", "_orig_mod.layers.5.norm2.weight", "_orig_mod.layers.5.norm2.bias", "_orig_mod.layers.5.ff.net.0.weight", "_orig_mod.layers.5.ff.net.0.bias", "_orig_mod.layers.5.ff.net.3.weight", "_orig_mod.layers.5.ff.net.3.bias", "_orig_mod.layers.6.norm1.weight", "_orig_mod.layers.6.norm1.bias", "_orig_mod.layers.6.attn.to_qkv.weight", "_orig_mod.layers.6.attn.to_out.weight", "_orig_mod.layers.6.attn.to_out.bias", "_orig_mod.layers.6.norm2.weight", "_orig_mod.layers.6.norm2.bias", "_orig_mod.layers.6.ff.net.0.weight", "_orig_mod.layers.6.ff.net.0.bias", "_orig_mod.layers.6.ff.net.3.weight", "_orig_mod.layers.6.ff.net.3.bias", "_orig_mod.layers.7.norm1.weight", "_orig_mod.layers.7.norm1.bias", "_orig_mod.layers.7.attn.to_qkv.weight", "_orig_mod.layers.7.attn.to_out.weight", "_orig_mod.layers.7.attn.to_out.bias", "_orig_mod.layers.7.norm2.weight", "_orig_mod.layers.7.norm2.bias", "_orig_mod.layers.7.ff.net.0.weight", "_orig_mod.layers.7.ff.net.0.bias", "_orig_mod.layers.7.ff.net.3.weight", "_orig_mod.layers.7.ff.net.3.bias", "_orig_mod.layers.8.norm1.weight", "_orig_mod.layers.8.norm1.bias", "_orig_mod.layers.8.attn.to_qkv.weight", "_orig_mod.layers.8.attn.to_out.weight", "_orig_mod.layers.8.attn.to_out.bias", "_orig_mod.layers.8.norm2.weight", "_orig_mod.layers.8.norm2.bias", "_orig_mod.layers.8.ff.net.0.weight", "_orig_mod.layers.8.ff.net.0.bias", "_orig_mod.layers.8.ff.net.3.weight", "_orig_mod.layers.8.ff.net.3.bias", "_orig_mod.layers.9.norm1.weight", "_orig_mod.layers.9.norm1.bias", "_orig_mod.layers.9.attn.to_qkv.weight", "_orig_mod.layers.9.attn.to_out.weight", "_orig_mod.layers.9.attn.to_out.bias", "_orig_mod.layers.9.norm2.weight", "_orig_mod.layers.9.norm2.bias", "_orig_mod.layers.9.ff.net.0.weight", "_orig_mod.layers.9.ff.net.0.bias", "_orig_mod.layers.9.ff.net.3.weight", "_orig_mod.layers.9.ff.net.3.bias", "_orig_mod.layers.10.norm1.weight", "_orig_mod.layers.10.norm1.bias", "_orig_mod.layers.10.attn.to_qkv.weight", "_orig_mod.layers.10.attn.to_out.weight", "_orig_mod.layers.10.attn.to_out.bias", "_orig_mod.layers.10.norm2.weight", "_orig_mod.layers.10.norm2.bias", "_orig_mod.layers.10.ff.net.0.weight", "_orig_mod.layers.10.ff.net.0.bias", "_orig_mod.layers.10.ff.net.3.weight", "_orig_mod.layers.10.ff.net.3.bias", "_orig_mod.layers.11.norm1.weight", "_orig_mod.layers.11.norm1.bias", "_orig_mod.layers.11.attn.to_qkv.weight", "_orig_mod.layers.11.attn.to_out.weight", "_orig_mod.layers.11.attn.to_out.bias", "_orig_mod.layers.11.norm2.weight", "_orig_mod.layers.11.norm2.bias", "_orig_mod.layers.11.ff.net.0.weight", "_orig_mod.layers.11.ff.net.0.bias", "_orig_mod.layers.11.ff.net.3.weight", "_orig_mod.layers.11.ff.net.3.bias", "_orig_mod.layers.12.norm1.weight", "_orig_mod.layers.12.norm1.bias", "_orig_mod.layers.12.attn.to_qkv.weight", "_orig_mod.layers.12.attn.to_out.weight", "_orig_mod.layers.12.attn.to_out.bias", "_orig_mod.layers.12.norm2.weight", "_orig_mod.layers.12.norm2.bias", "_orig_mod.layers.12.ff.net.0.weight", "_orig_mod.layers.12.ff.net.0.bias", "_orig_mod.layers.12.ff.net.3.weight", "_orig_mod.layers.12.ff.net.3.bias", "_orig_mod.layers.13.norm1.weight", "_orig_mod.layers.13.norm1.bias", "_orig_mod.layers.13.attn.to_qkv.weight", "_orig_mod.layers.13.attn.to_out.weight", "_orig_mod.layers.13.attn.to_out.bias", "_orig_mod.layers.13.norm2.weight", "_orig_mod.layers.13.norm2.bias", "_orig_mod.layers.13.ff.net.0.weight", "_orig_mod.layers.13.ff.net.0.bias", "_orig_mod.layers.13.ff.net.3.weight", "_orig_mod.layers.13.ff.net.3.bias", "_orig_mod.layers.14.norm1.weight", "_orig_mod.layers.14.norm1.bias", "_orig_mod.layers.14.attn.to_qkv.weight", "_orig_mod.layers.14.attn.to_out.weight", "_orig_mod.layers.14.attn.to_out.bias", "_orig_mod.layers.14.norm2.weight", "_orig_mod.layers.14.norm2.bias", "_orig_mod.layers.14.ff.net.0.weight", "_orig_mod.layers.14.ff.net.0.bias", "_orig_mod.layers.14.ff.net.3.weight", "_orig_mod.layers.14.ff.net.3.bias", "_orig_mod.layers.15.norm1.weight", "_orig_mod.layers.15.norm1.bias", "_orig_mod.layers.15.attn.to_qkv.weight", "_orig_mod.layers.15.attn.to_out.weight", "_orig_mod.layers.15.attn.to_out.bias", "_orig_mod.layers.15.norm2.weight", "_orig_mod.layers.15.norm2.bias", "_orig_mod.layers.15.ff.net.0.weight", "_orig_mod.layers.15.ff.net.0.bias", "_orig_mod.layers.15.ff.net.3.weight", "_orig_mod.layers.15.ff.net.3.bias", "_orig_mod.layers.16.norm1.weight", "_orig_mod.layers.16.norm1.bias", "_orig_mod.layers.16.attn.to_qkv.weight", "_orig_mod.layers.16.attn.to_out.weight", "_orig_mod.layers.16.attn.to_out.bias", "_orig_mod.layers.16.norm2.weight", "_orig_mod.layers.16.norm2.bias", "_orig_mod.layers.16.ff.net.0.weight", "_orig_mod.layers.16.ff.net.0.bias", "_orig_mod.layers.16.ff.net.3.weight", "_orig_mod.layers.16.ff.net.3.bias", "_orig_mod.layers.17.norm1.weight", "_orig_mod.layers.17.norm1.bias", "_orig_mod.layers.17.attn.to_qkv.weight", "_orig_mod.layers.17.attn.to_out.weight", "_orig_mod.layers.17.attn.to_out.bias", "_orig_mod.layers.17.norm2.weight", "_orig_mod.layers.17.norm2.bias", "_orig_mod.layers.17.ff.net.0.weight", "_orig_mod.layers.17.ff.net.0.bias", "_orig_mod.layers.17.ff.net.3.weight", "_orig_mod.layers.17.ff.net.3.bias", "_orig_mod.layers.18.norm1.weight", "_orig_mod.layers.18.norm1.bias", "_orig_mod.layers.18.attn.to_qkv.weight", "_orig_mod.layers.18.attn.to_out.weight", "_orig_mod.layers.18.attn.to_out.bias", "_orig_mod.layers.18.norm2.weight", "_orig_mod.layers.18.norm2.bias", "_orig_mod.layers.18.ff.net.0.weight", "_orig_mod.layers.18.ff.net.0.bias", "_orig_mod.layers.18.ff.net.3.weight", "_orig_mod.layers.18.ff.net.3.bias", "_orig_mod.layers.19.norm1.weight", "_orig_mod.layers.19.norm1.bias", "_orig_mod.layers.19.attn.to_qkv.weight", "_orig_mod.layers.19.attn.to_out.weight", "_orig_mod.layers.19.attn.to_out.bias", "_orig_mod.layers.19.norm2.weight", "_orig_mod.layers.19.norm2.bias", "_orig_mod.layers.19.ff.net.0.weight", "_orig_mod.layers.19.ff.net.0.bias", "_orig_mod.layers.19.ff.net.3.weight", "_orig_mod.layers.19.ff.net.3.bias", "_orig_mod.layers.20.norm1.weight", "_orig_mod.layers.20.norm1.bias", "_orig_mod.layers.20.attn.to_qkv.weight", "_orig_mod.layers.20.attn.to_out.weight", "_orig_mod.layers.20.attn.to_out.bias", "_orig_mod.layers.20.norm2.weight", "_orig_mod.layers.20.norm2.bias", "_orig_mod.layers.20.ff.net.0.weight", "_orig_mod.layers.20.ff.net.0.bias", "_orig_mod.layers.20.ff.net.3.weight", "_orig_mod.layers.20.ff.net.3.bias", "_orig_mod.layers.21.norm1.weight", "_orig_mod.layers.21.norm1.bias", "_orig_mod.layers.21.attn.to_qkv.weight", "_orig_mod.layers.21.attn.to_out.weight", "_orig_mod.layers.21.attn.to_out.bias", "_orig_mod.layers.21.norm2.weight", "_orig_mod.layers.21.norm2.bias", "_orig_mod.layers.21.ff.net.0.weight", "_orig_mod.layers.21.ff.net.0.bias", "_orig_mod.layers.21.ff.net.3.weight", "_orig_mod.layers.21.ff.net.3.bias", "_orig_mod.layers.22.norm1.weight", "_orig_mod.layers.22.norm1.bias", "_orig_mod.layers.22.attn.to_qkv.weight", "_orig_mod.layers.22.attn.to_out.weight", "_orig_mod.layers.22.attn.to_out.bias", "_orig_mod.layers.22.norm2.weight", "_orig_mod.layers.22.norm2.bias", "_orig_mod.layers.22.ff.net.0.weight", "_orig_mod.layers.22.ff.net.0.bias", "_orig_mod.layers.22.ff.net.3.weight", "_orig_mod.layers.22.ff.net.3.bias", "_orig_mod.layers.23.norm1.weight", "_orig_mod.layers.23.norm1.bias", "_orig_mod.layers.23.attn.to_qkv.weight", "_orig_mod.layers.23.attn.to_out.weight", "_orig_mod.layers.23.attn.to_out.bias", "_orig_mod.layers.23.norm2.weight", "_orig_mod.layers.23.norm2.bias", "_orig_mod.layers.23.ff.net.0.weight", "_orig_mod.layers.23.ff.net.0.bias", "_orig_mod.layers.23.ff.net.3.weight", "_orig_mod.layers.23.ff.net.3.bias", "_orig_mod.from_head.0.weight", "_orig_mod.from_head.0.bias", "_orig_mod.from_head.1.weight", "_orig_mod.from_head.1.bias", "_orig_mod.from_head.3.weight", "_orig_mod.from_head.3.bias", "_orig_mod.to_head.0.weight", "_orig_mod.to_head.0.bias", "_orig_mod.to_head.1.weight", "_orig_mod.to_head.1.bias", "_orig_mod.to_head.3.weight", "_orig_mod.to_head.3.bias", "_orig_mod.value_head.0.weight", "_orig_mod.value_head.0.bias", "_orig_mod.value_head.1.weight", "_orig_mod.value_head.1.bias", "_orig_mod.value_head.3.weight", "_orig_mod.value_head.3.bias". 
	Unexpected key(s) in state_dict: "input_proj.0.weight", "input_proj.0.bias", "input_proj.2.weight", "input_proj.2.bias", "pos_encoding.pe_x", "pos_encoding.pe_y", "pos_encoding.pe_z", "layers.0.norm1.weight", "layers.0.norm1.bias", "layers.0.attn.to_qkv.weight", "layers.0.attn.to_out.weight", "layers.0.attn.to_out.bias", "layers.0.norm2.weight", "layers.0.norm2.bias", "layers.0.ff.net.0.weight", "layers.0.ff.net.0.bias", "layers.0.ff.net.3.weight", "layers.0.ff.net.3.bias", "layers.1.norm1.weight", "layers.1.norm1.bias", "layers.1.attn.to_qkv.weight", "layers.1.attn.to_out.weight", "layers.1.attn.to_out.bias", "layers.1.norm2.weight", "layers.1.norm2.bias", "layers.1.ff.net.0.weight", "layers.1.ff.net.0.bias", "layers.1.ff.net.3.weight", "layers.1.ff.net.3.bias", "layers.2.norm1.weight", "layers.2.norm1.bias", "layers.2.attn.to_qkv.weight", "layers.2.attn.to_out.weight", "layers.2.attn.to_out.bias", "layers.2.norm2.weight", "layers.2.norm2.bias", "layers.2.ff.net.0.weight", "layers.2.ff.net.0.bias", "layers.2.ff.net.3.weight", "layers.2.ff.net.3.bias", "layers.3.norm1.weight", "layers.3.norm1.bias", "layers.3.attn.to_qkv.weight", "layers.3.attn.to_out.weight", "layers.3.attn.to_out.bias", "layers.3.norm2.weight", "layers.3.norm2.bias", "layers.3.ff.net.0.weight", "layers.3.ff.net.0.bias", "layers.3.ff.net.3.weight", "layers.3.ff.net.3.bias", "layers.4.norm1.weight", "layers.4.norm1.bias", "layers.4.attn.to_qkv.weight", "layers.4.attn.to_out.weight", "layers.4.attn.to_out.bias", "layers.4.norm2.weight", "layers.4.norm2.bias", "layers.4.ff.net.0.weight", "layers.4.ff.net.0.bias", "layers.4.ff.net.3.weight", "layers.4.ff.net.3.bias", "layers.5.norm1.weight", "layers.5.norm1.bias", "layers.5.attn.to_qkv.weight", "layers.5.attn.to_out.weight", "layers.5.attn.to_out.bias", "layers.5.norm2.weight", "layers.5.norm2.bias", "layers.5.ff.net.0.weight", "layers.5.ff.net.0.bias", "layers.5.ff.net.3.weight", "layers.5.ff.net.3.bias", "layers.6.norm1.weight", "layers.6.norm1.bias", "layers.6.attn.to_qkv.weight", "layers.6.attn.to_out.weight", "layers.6.attn.to_out.bias", "layers.6.norm2.weight", "layers.6.norm2.bias", "layers.6.ff.net.0.weight", "layers.6.ff.net.0.bias", "layers.6.ff.net.3.weight", "layers.6.ff.net.3.bias", "layers.7.norm1.weight", "layers.7.norm1.bias", "layers.7.attn.to_qkv.weight", "layers.7.attn.to_out.weight", "layers.7.attn.to_out.bias", "layers.7.norm2.weight", "layers.7.norm2.bias", "layers.7.ff.net.0.weight", "layers.7.ff.net.0.bias", "layers.7.ff.net.3.weight", "layers.7.ff.net.3.bias", "layers.8.norm1.weight", "layers.8.norm1.bias", "layers.8.attn.to_qkv.weight", "layers.8.attn.to_out.weight", "layers.8.attn.to_out.bias", "layers.8.norm2.weight", "layers.8.norm2.bias", "layers.8.ff.net.0.weight", "layers.8.ff.net.0.bias", "layers.8.ff.net.3.weight", "layers.8.ff.net.3.bias", "layers.9.norm1.weight", "layers.9.norm1.bias", "layers.9.attn.to_qkv.weight", "layers.9.attn.to_out.weight", "layers.9.attn.to_out.bias", "layers.9.norm2.weight", "layers.9.norm2.bias", "layers.9.ff.net.0.weight", "layers.9.ff.net.0.bias", "layers.9.ff.net.3.weight", "layers.9.ff.net.3.bias", "layers.10.norm1.weight", "layers.10.norm1.bias", "layers.10.attn.to_qkv.weight", "layers.10.attn.to_out.weight", "layers.10.attn.to_out.bias", "layers.10.norm2.weight", "layers.10.norm2.bias", "layers.10.ff.net.0.weight", "layers.10.ff.net.0.bias", "layers.10.ff.net.3.weight", "layers.10.ff.net.3.bias", "layers.11.norm1.weight", "layers.11.norm1.bias", "layers.11.attn.to_qkv.weight", "layers.11.attn.to_out.weight", "layers.11.attn.to_out.bias", "layers.11.norm2.weight", "layers.11.norm2.bias", "layers.11.ff.net.0.weight", "layers.11.ff.net.0.bias", "layers.11.ff.net.3.weight", "layers.11.ff.net.3.bias", "layers.12.norm1.weight", "layers.12.norm1.bias", "layers.12.attn.to_qkv.weight", "layers.12.attn.to_out.weight", "layers.12.attn.to_out.bias", "layers.12.norm2.weight", "layers.12.norm2.bias", "layers.12.ff.net.0.weight", "layers.12.ff.net.0.bias", "layers.12.ff.net.3.weight", "layers.12.ff.net.3.bias", "layers.13.norm1.weight", "layers.13.norm1.bias", "layers.13.attn.to_qkv.weight", "layers.13.attn.to_out.weight", "layers.13.attn.to_out.bias", "layers.13.norm2.weight", "layers.13.norm2.bias", "layers.13.ff.net.0.weight", "layers.13.ff.net.0.bias", "layers.13.ff.net.3.weight", "layers.13.ff.net.3.bias", "layers.14.norm1.weight", "layers.14.norm1.bias", "layers.14.attn.to_qkv.weight", "layers.14.attn.to_out.weight", "layers.14.attn.to_out.bias", "layers.14.norm2.weight", "layers.14.norm2.bias", "layers.14.ff.net.0.weight", "layers.14.ff.net.0.bias", "layers.14.ff.net.3.weight", "layers.14.ff.net.3.bias", "layers.15.norm1.weight", "layers.15.norm1.bias", "layers.15.attn.to_qkv.weight", "layers.15.attn.to_out.weight", "layers.15.attn.to_out.bias", "layers.15.norm2.weight", "layers.15.norm2.bias", "layers.15.ff.net.0.weight", "layers.15.ff.net.0.bias", "layers.15.ff.net.3.weight", "layers.15.ff.net.3.bias", "layers.16.norm1.weight", "layers.16.norm1.bias", "layers.16.attn.to_qkv.weight", "layers.16.attn.to_out.weight", "layers.16.attn.to_out.bias", "layers.16.norm2.weight", "layers.16.norm2.bias", "layers.16.ff.net.0.weight", "layers.16.ff.net.0.bias", "layers.16.ff.net.3.weight", "layers.16.ff.net.3.bias", "layers.17.norm1.weight", "layers.17.norm1.bias", "layers.17.attn.to_qkv.weight", "layers.17.attn.to_out.weight", "layers.17.attn.to_out.bias", "layers.17.norm2.weight", "layers.17.norm2.bias", "layers.17.ff.net.0.weight", "layers.17.ff.net.0.bias", "layers.17.ff.net.3.weight", "layers.17.ff.net.3.bias", "layers.18.norm1.weight", "layers.18.norm1.bias", "layers.18.attn.to_qkv.weight", "layers.18.attn.to_out.weight", "layers.18.attn.to_out.bias", "layers.18.norm2.weight", "layers.18.norm2.bias", "layers.18.ff.net.0.weight", "layers.18.ff.net.0.bias", "layers.18.ff.net.3.weight", "layers.18.ff.net.3.bias", "layers.19.norm1.weight", "layers.19.norm1.bias", "layers.19.attn.to_qkv.weight", "layers.19.attn.to_out.weight", "layers.19.attn.to_out.bias", "layers.19.norm2.weight", "layers.19.norm2.bias", "layers.19.ff.net.0.weight", "layers.19.ff.net.0.bias", "layers.19.ff.net.3.weight", "layers.19.ff.net.3.bias", "layers.20.norm1.weight", "layers.20.norm1.bias", "layers.20.attn.to_qkv.weight", "layers.20.attn.to_out.weight", "layers.20.attn.to_out.bias", "layers.20.norm2.weight", "layers.20.norm2.bias", "layers.20.ff.net.0.weight", "layers.20.ff.net.0.bias", "layers.20.ff.net.3.weight", "layers.20.ff.net.3.bias", "layers.21.norm1.weight", "layers.21.norm1.bias", "layers.21.attn.to_qkv.weight", "layers.21.attn.to_out.weight", "layers.21.attn.to_out.bias", "layers.21.norm2.weight", "layers.21.norm2.bias", "layers.21.ff.net.0.weight", "layers.21.ff.net.0.bias", "layers.21.ff.net.3.weight", "layers.21.ff.net.3.bias", "layers.22.norm1.weight", "layers.22.norm1.bias", "layers.22.attn.to_qkv.weight", "layers.22.attn.to_out.weight", "layers.22.attn.to_out.bias", "layers.22.norm2.weight", "layers.22.norm2.bias", "layers.22.ff.net.0.weight", "layers.22.ff.net.0.bias", "layers.22.ff.net.3.weight", "layers.22.ff.net.3.bias", "layers.23.norm1.weight", "layers.23.norm1.bias", "layers.23.attn.to_qkv.weight", "layers.23.attn.to_out.weight", "layers.23.attn.to_out.bias", "layers.23.norm2.weight", "layers.23.norm2.bias", "layers.23.ff.net.0.weight", "layers.23.ff.net.0.bias", "layers.23.ff.net.3.weight", "layers.23.ff.net.3.bias", "from_head.0.weight", "from_head.0.bias", "from_head.1.weight", "from_head.1.bias", "from_head.3.weight", "from_head.3.bias", "to_head.0.weight", "to_head.0.bias", "to_head.1.weight", "to_head.1.bias", "to_head.3.weight", "to_head.3.bias", "value_head.0.weight", "value_head.0.bias", "value_head.1.weight", "value_head.1.bias", "value_head.3.weight", "value_head.3.bias". 
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 60, in _inference_server_loop
    model.load_state_dict(state_dict)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/.local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 2629, in load_state_dict
    raise RuntimeError(
    ...<3 lines>...
    )
RuntimeError: Error(s) in loading state_dict for OptimizedModule:
	Missing key(s) in state_dict: "_orig_mod.input_proj.0.weight", "_orig_mod.input_proj.0.bias", "_orig_mod.input_proj.2.weight", "_orig_mod.input_proj.2.bias", "_orig_mod.pos_encoding.pe_x", "_orig_mod.pos_encoding.pe_y", "_orig_mod.pos_encoding.pe_z", "_orig_mod.layers.0.norm1.weight", "_orig_mod.layers.0.norm1.bias", "_orig_mod.layers.0.attn.to_qkv.weight", "_orig_mod.layers.0.attn.to_out.weight", "_orig_mod.layers.0.attn.to_out.bias", "_orig_mod.layers.0.norm2.weight", "_orig_mod.layers.0.norm2.bias", "_orig_mod.layers.0.ff.net.0.weight", "_orig_mod.layers.0.ff.net.0.bias", "_orig_mod.layers.0.ff.net.3.weight", "_orig_mod.layers.0.ff.net.3.bias", "_orig_mod.layers.1.norm1.weight", "_orig_mod.layers.1.norm1.bias", "_orig_mod.layers.1.attn.to_qkv.weight", "_orig_mod.layers.1.attn.to_out.weight", "_orig_mod.layers.1.attn.to_out.bias", "_orig_mod.layers.1.norm2.weight", "_orig_mod.layers.1.norm2.bias", "_orig_mod.layers.1.ff.net.0.weight", "_orig_mod.layers.1.ff.net.0.bias", "_orig_mod.layers.1.ff.net.3.weight", "_orig_mod.layers.1.ff.net.3.bias", "_orig_mod.layers.2.norm1.weight", "_orig_mod.layers.2.norm1.bias", "_orig_mod.layers.2.attn.to_qkv.weight", "_orig_mod.layers.2.attn.to_out.weight", "_orig_mod.layers.2.attn.to_out.bias", "_orig_mod.layers.2.norm2.weight", "_orig_mod.layers.2.norm2.bias", "_orig_mod.layers.2.ff.net.0.weight", "_orig_mod.layers.2.ff.net.0.bias", "_orig_mod.layers.2.ff.net.3.weight", "_orig_mod.layers.2.ff.net.3.bias", "_orig_mod.layers.3.norm1.weight", "_orig_mod.layers.3.norm1.bias", "_orig_mod.layers.3.attn.to_qkv.weight", "_orig_mod.layers.3.attn.to_out.weight", "_orig_mod.layers.3.attn.to_out.bias", "_orig_mod.layers.3.norm2.weight", "_orig_mod.layers.3.norm2.bias", "_orig_mod.layers.3.ff.net.0.weight", "_orig_mod.layers.3.ff.net.0.bias", "_orig_mod.layers.3.ff.net.3.weight", "_orig_mod.layers.3.ff.net.3.bias", "_orig_mod.layers.4.norm1.weight", "_orig_mod.layers.4.norm1.bias", "_orig_mod.layers.4.attn.to_qkv.weight", "_orig_mod.layers.4.attn.to_out.weight", "_orig_mod.layers.4.attn.to_out.bias", "_orig_mod.layers.4.norm2.weight", "_orig_mod.layers.4.norm2.bias", "_orig_mod.layers.4.ff.net.0.weight", "_orig_mod.layers.4.ff.net.0.bias", "_orig_mod.layers.4.ff.net.3.weight", "_orig_mod.layers.4.ff.net.3.bias", "_orig_mod.layers.5.norm1.weight", "_orig_mod.layers.5.norm1.bias", "_orig_mod.layers.5.attn.to_qkv.weight", "_orig_mod.layers.5.attn.to_out.weight", "_orig_mod.layers.5.attn.to_out.bias", "_orig_mod.layers.5.norm2.weight", "_orig_mod.layers.5.norm2.bias", "_orig_mod.layers.5.ff.net.0.weight", "_orig_mod.layers.5.ff.net.0.bias", "_orig_mod.layers.5.ff.net.3.weight", "_orig_mod.layers.5.ff.net.3.bias", "_orig_mod.layers.6.norm1.weight", "_orig_mod.layers.6.norm1.bias", "_orig_mod.layers.6.attn.to_qkv.weight", "_orig_mod.layers.6.attn.to_out.weight", "_orig_mod.layers.6.attn.to_out.bias", "_orig_mod.layers.6.norm2.weight", "_orig_mod.layers.6.norm2.bias", "_orig_mod.layers.6.ff.net.0.weight", "_orig_mod.layers.6.ff.net.0.bias", "_orig_mod.layers.6.ff.net.3.weight", "_orig_mod.layers.6.ff.net.3.bias", "_orig_mod.layers.7.norm1.weight", "_orig_mod.layers.7.norm1.bias", "_orig_mod.layers.7.attn.to_qkv.weight", "_orig_mod.layers.7.attn.to_out.weight", "_orig_mod.layers.7.attn.to_out.bias", "_orig_mod.layers.7.norm2.weight", "_orig_mod.layers.7.norm2.bias", "_orig_mod.layers.7.ff.net.0.weight", "_orig_mod.layers.7.ff.net.0.bias", "_orig_mod.layers.7.ff.net.3.weight", "_orig_mod.layers.7.ff.net.3.bias", "_orig_mod.layers.8.norm1.weight", "_orig_mod.layers.8.norm1.bias", "_orig_mod.layers.8.attn.to_qkv.weight", "_orig_mod.layers.8.attn.to_out.weight", "_orig_mod.layers.8.attn.to_out.bias", "_orig_mod.layers.8.norm2.weight", "_orig_mod.layers.8.norm2.bias", "_orig_mod.layers.8.ff.net.0.weight", "_orig_mod.layers.8.ff.net.0.bias", "_orig_mod.layers.8.ff.net.3.weight", "_orig_mod.layers.8.ff.net.3.bias", "_orig_mod.layers.9.norm1.weight", "_orig_mod.layers.9.norm1.bias", "_orig_mod.layers.9.attn.to_qkv.weight", "_orig_mod.layers.9.attn.to_out.weight", "_orig_mod.layers.9.attn.to_out.bias", "_orig_mod.layers.9.norm2.weight", "_orig_mod.layers.9.norm2.bias", "_orig_mod.layers.9.ff.net.0.weight", "_orig_mod.layers.9.ff.net.0.bias", "_orig_mod.layers.9.ff.net.3.weight", "_orig_mod.layers.9.ff.net.3.bias", "_orig_mod.layers.10.norm1.weight", "_orig_mod.layers.10.norm1.bias", "_orig_mod.layers.10.attn.to_qkv.weight", "_orig_mod.layers.10.attn.to_out.weight", "_orig_mod.layers.10.attn.to_out.bias", "_orig_mod.layers.10.norm2.weight", "_orig_mod.layers.10.norm2.bias", "_orig_mod.layers.10.ff.net.0.weight", "_orig_mod.layers.10.ff.net.0.bias", "_orig_mod.layers.10.ff.net.3.weight", "_orig_mod.layers.10.ff.net.3.bias", "_orig_mod.layers.11.norm1.weight", "_orig_mod.layers.11.norm1.bias", "_orig_mod.layers.11.attn.to_qkv.weight", "_orig_mod.layers.11.attn.to_out.weight", "_orig_mod.layers.11.attn.to_out.bias", "_orig_mod.layers.11.norm2.weight", "_orig_mod.layers.11.norm2.bias", "_orig_mod.layers.11.ff.net.0.weight", "_orig_mod.layers.11.ff.net.0.bias", "_orig_mod.layers.11.ff.net.3.weight", "_orig_mod.layers.11.ff.net.3.bias", "_orig_mod.layers.12.norm1.weight", "_orig_mod.layers.12.norm1.bias", "_orig_mod.layers.12.attn.to_qkv.weight", "_orig_mod.layers.12.attn.to_out.weight", "_orig_mod.layers.12.attn.to_out.bias", "_orig_mod.layers.12.norm2.weight", "_orig_mod.layers.12.norm2.bias", "_orig_mod.layers.12.ff.net.0.weight", "_orig_mod.layers.12.ff.net.0.bias", "_orig_mod.layers.12.ff.net.3.weight", "_orig_mod.layers.12.ff.net.3.bias", "_orig_mod.layers.13.norm1.weight", "_orig_mod.layers.13.norm1.bias", "_orig_mod.layers.13.attn.to_qkv.weight", "_orig_mod.layers.13.attn.to_out.weight", "_orig_mod.layers.13.attn.to_out.bias", "_orig_mod.layers.13.norm2.weight", "_orig_mod.layers.13.norm2.bias", "_orig_mod.layers.13.ff.net.0.weight", "_orig_mod.layers.13.ff.net.0.bias", "_orig_mod.layers.13.ff.net.3.weight", "_orig_mod.layers.13.ff.net.3.bias", "_orig_mod.layers.14.norm1.weight", "_orig_mod.layers.14.norm1.bias", "_orig_mod.layers.14.attn.to_qkv.weight", "_orig_mod.layers.14.attn.to_out.weight", "_orig_mod.layers.14.attn.to_out.bias", "_orig_mod.layers.14.norm2.weight", "_orig_mod.layers.14.norm2.bias", "_orig_mod.layers.14.ff.net.0.weight", "_orig_mod.layers.14.ff.net.0.bias", "_orig_mod.layers.14.ff.net.3.weight", "_orig_mod.layers.14.ff.net.3.bias", "_orig_mod.layers.15.norm1.weight", "_orig_mod.layers.15.norm1.bias", "_orig_mod.layers.15.attn.to_qkv.weight", "_orig_mod.layers.15.attn.to_out.weight", "_orig_mod.layers.15.attn.to_out.bias", "_orig_mod.layers.15.norm2.weight", "_orig_mod.layers.15.norm2.bias", "_orig_mod.layers.15.ff.net.0.weight", "_orig_mod.layers.15.ff.net.0.bias", "_orig_mod.layers.15.ff.net.3.weight", "_orig_mod.layers.15.ff.net.3.bias", "_orig_mod.layers.16.norm1.weight", "_orig_mod.layers.16.norm1.bias", "_orig_mod.layers.16.attn.to_qkv.weight", "_orig_mod.layers.16.attn.to_out.weight", "_orig_mod.layers.16.attn.to_out.bias", "_orig_mod.layers.16.norm2.weight", "_orig_mod.layers.16.norm2.bias", "_orig_mod.layers.16.ff.net.0.weight", "_orig_mod.layers.16.ff.net.0.bias", "_orig_mod.layers.16.ff.net.3.weight", "_orig_mod.layers.16.ff.net.3.bias", "_orig_mod.layers.17.norm1.weight", "_orig_mod.layers.17.norm1.bias", "_orig_mod.layers.17.attn.to_qkv.weight", "_orig_mod.layers.17.attn.to_out.weight", "_orig_mod.layers.17.attn.to_out.bias", "_orig_mod.layers.17.norm2.weight", "_orig_mod.layers.17.norm2.bias", "_orig_mod.layers.17.ff.net.0.weight", "_orig_mod.layers.17.ff.net.0.bias", "_orig_mod.layers.17.ff.net.3.weight", "_orig_mod.layers.17.ff.net.3.bias", "_orig_mod.layers.18.norm1.weight", "_orig_mod.layers.18.norm1.bias", "_orig_mod.layers.18.attn.to_qkv.weight", "_orig_mod.layers.18.attn.to_out.weight", "_orig_mod.layers.18.attn.to_out.bias", "_orig_mod.layers.18.norm2.weight", "_orig_mod.layers.18.norm2.bias", "_orig_mod.layers.18.ff.net.0.weight", "_orig_mod.layers.18.ff.net.0.bias", "_orig_mod.layers.18.ff.net.3.weight", "_orig_mod.layers.18.ff.net.3.bias", "_orig_mod.layers.19.norm1.weight", "_orig_mod.layers.19.norm1.bias", "_orig_mod.layers.19.attn.to_qkv.weight", "_orig_mod.layers.19.attn.to_out.weight", "_orig_mod.layers.19.attn.to_out.bias", "_orig_mod.layers.19.norm2.weight", "_orig_mod.layers.19.norm2.bias", "_orig_mod.layers.19.ff.net.0.weight", "_orig_mod.layers.19.ff.net.0.bias", "_orig_mod.layers.19.ff.net.3.weight", "_orig_mod.layers.19.ff.net.3.bias", "_orig_mod.layers.20.norm1.weight", "_orig_mod.layers.20.norm1.bias", "_orig_mod.layers.20.attn.to_qkv.weight", "_orig_mod.layers.20.attn.to_out.weight", "_orig_mod.layers.20.attn.to_out.bias", "_orig_mod.layers.20.norm2.weight", "_orig_mod.layers.20.norm2.bias", "_orig_mod.layers.20.ff.net.0.weight", "_orig_mod.layers.20.ff.net.0.bias", "_orig_mod.layers.20.ff.net.3.weight", "_orig_mod.layers.20.ff.net.3.bias", "_orig_mod.layers.21.norm1.weight", "_orig_mod.layers.21.norm1.bias", "_orig_mod.layers.21.attn.to_qkv.weight", "_orig_mod.layers.21.attn.to_out.weight", "_orig_mod.layers.21.attn.to_out.bias", "_orig_mod.layers.21.norm2.weight", "_orig_mod.layers.21.norm2.bias", "_orig_mod.layers.21.ff.net.0.weight", "_orig_mod.layers.21.ff.net.0.bias", "_orig_mod.layers.21.ff.net.3.weight", "_orig_mod.layers.21.ff.net.3.bias", "_orig_mod.layers.22.norm1.weight", "_orig_mod.layers.22.norm1.bias", "_orig_mod.layers.22.attn.to_qkv.weight", "_orig_mod.layers.22.attn.to_out.weight", "_orig_mod.layers.22.attn.to_out.bias", "_orig_mod.layers.22.norm2.weight", "_orig_mod.layers.22.norm2.bias", "_orig_mod.layers.22.ff.net.0.weight", "_orig_mod.layers.22.ff.net.0.bias", "_orig_mod.layers.22.ff.net.3.weight", "_orig_mod.layers.22.ff.net.3.bias", "_orig_mod.layers.23.norm1.weight", "_orig_mod.layers.23.norm1.bias", "_orig_mod.layers.23.attn.to_qkv.weight", "_orig_mod.layers.23.attn.to_out.weight", "_orig_mod.layers.23.attn.to_out.bias", "_orig_mod.layers.23.norm2.weight", "_orig_mod.layers.23.norm2.bias", "_orig_mod.layers.23.ff.net.0.weight", "_orig_mod.layers.23.ff.net.0.bias", "_orig_mod.layers.23.ff.net.3.weight", "_orig_mod.layers.23.ff.net.3.bias", "_orig_mod.from_head.0.weight", "_orig_mod.from_head.0.bias", "_orig_mod.from_head.1.weight", "_orig_mod.from_head.1.bias", "_orig_mod.from_head.3.weight", "_orig_mod.from_head.3.bias", "_orig_mod.to_head.0.weight", "_orig_mod.to_head.0.bias", "_orig_mod.to_head.1.weight", "_orig_mod.to_head.1.bias", "_orig_mod.to_head.3.weight", "_orig_mod.to_head.3.bias", "_orig_mod.value_head.0.weight", "_orig_mod.value_head.0.bias", "_orig_mod.value_head.1.weight", "_orig_mod.value_head.1.bias", "_orig_mod.value_head.3.weight", "_orig_mod.value_head.3.bias". 
	Unexpected key(s) in state_dict: "input_proj.0.weight", "input_proj.0.bias", "input_proj.2.weight", "input_proj.2.bias", "pos_encoding.pe_x", "pos_encoding.pe_y", "pos_encoding.pe_z", "layers.0.norm1.weight", "layers.0.norm1.bias", "layers.0.attn.to_qkv.weight", "layers.0.attn.to_out.weight", "layers.0.attn.to_out.bias", "layers.0.norm2.weight", "layers.0.norm2.bias", "layers.0.ff.net.0.weight", "layers.0.ff.net.0.bias", "layers.0.ff.net.3.weight", "layers.0.ff.net.3.bias", "layers.1.norm1.weight", "layers.1.norm1.bias", "layers.1.attn.to_qkv.weight", "layers.1.attn.to_out.weight", "layers.1.attn.to_out.bias", "layers.1.norm2.weight", "layers.1.norm2.bias", "layers.1.ff.net.0.weight", "layers.1.ff.net.0.bias", "layers.1.ff.net.3.weight", "layers.1.ff.net.3.bias", "layers.2.norm1.weight", "layers.2.norm1.bias", "layers.2.attn.to_qkv.weight", "layers.2.attn.to_out.weight", "layers.2.attn.to_out.bias", "layers.2.norm2.weight", "layers.2.norm2.bias", "layers.2.ff.net.0.weight", "layers.2.ff.net.0.bias", "layers.2.ff.net.3.weight", "layers.2.ff.net.3.bias", "layers.3.norm1.weight", "layers.3.norm1.bias", "layers.3.attn.to_qkv.weight", "layers.3.attn.to_out.weight", "layers.3.attn.to_out.bias", "layers.3.norm2.weight", "layers.3.norm2.bias", "layers.3.ff.net.0.weight", "layers.3.ff.net.0.bias", "layers.3.ff.net.3.weight", "layers.3.ff.net.3.bias", "layers.4.norm1.weight", "layers.4.norm1.bias", "layers.4.attn.to_qkv.weight", "layers.4.attn.to_out.weight", "layers.4.attn.to_out.bias", "layers.4.norm2.weight", "layers.4.norm2.bias", "layers.4.ff.net.0.weight", "layers.4.ff.net.0.bias", "layers.4.ff.net.3.weight", "layers.4.ff.net.3.bias", "layers.5.norm1.weight", "layers.5.norm1.bias", "layers.5.attn.to_qkv.weight", "layers.5.attn.to_out.weight", "layers.5.attn.to_out.bias", "layers.5.norm2.weight", "layers.5.norm2.bias", "layers.5.ff.net.0.weight", "layers.5.ff.net.0.bias", "layers.5.ff.net.3.weight", "layers.5.ff.net.3.bias", "layers.6.norm1.weight", "layers.6.norm1.bias", "layers.6.attn.to_qkv.weight", "layers.6.attn.to_out.weight", "layers.6.attn.to_out.bias", "layers.6.norm2.weight", "layers.6.norm2.bias", "layers.6.ff.net.0.weight", "layers.6.ff.net.0.bias", "layers.6.ff.net.3.weight", "layers.6.ff.net.3.bias", "layers.7.norm1.weight", "layers.7.norm1.bias", "layers.7.attn.to_qkv.weight", "layers.7.attn.to_out.weight", "layers.7.attn.to_out.bias", "layers.7.norm2.weight", "layers.7.norm2.bias", "layers.7.ff.net.0.weight", "layers.7.ff.net.0.bias", "layers.7.ff.net.3.weight", "layers.7.ff.net.3.bias", "layers.8.norm1.weight", "layers.8.norm1.bias", "layers.8.attn.to_qkv.weight", "layers.8.attn.to_out.weight", "layers.8.attn.to_out.bias", "layers.8.norm2.weight", "layers.8.norm2.bias", "layers.8.ff.net.0.weight", "layers.8.ff.net.0.bias", "layers.8.ff.net.3.weight", "layers.8.ff.net.3.bias", "layers.9.norm1.weight", "layers.9.norm1.bias", "layers.9.attn.to_qkv.weight", "layers.9.attn.to_out.weight", "layers.9.attn.to_out.bias", "layers.9.norm2.weight", "layers.9.norm2.bias", "layers.9.ff.net.0.weight", "layers.9.ff.net.0.bias", "layers.9.ff.net.3.weight", "layers.9.ff.net.3.bias", "layers.10.norm1.weight", "layers.10.norm1.bias", "layers.10.attn.to_qkv.weight", "layers.10.attn.to_out.weight", "layers.10.attn.to_out.bias", "layers.10.norm2.weight", "layers.10.norm2.bias", "layers.10.ff.net.0.weight", "layers.10.ff.net.0.bias", "layers.10.ff.net.3.weight", "layers.10.ff.net.3.bias", "layers.11.norm1.weight", "layers.11.norm1.bias", "layers.11.attn.to_qkv.weight", "layers.11.attn.to_out.weight", "layers.11.attn.to_out.bias", "layers.11.norm2.weight", "layers.11.norm2.bias", "layers.11.ff.net.0.weight", "layers.11.ff.net.0.bias", "layers.11.ff.net.3.weight", "layers.11.ff.net.3.bias", "layers.12.norm1.weight", "layers.12.norm1.bias", "layers.12.attn.to_qkv.weight", "layers.12.attn.to_out.weight", "layers.12.attn.to_out.bias", "layers.12.norm2.weight", "layers.12.norm2.bias", "layers.12.ff.net.0.weight", "layers.12.ff.net.0.bias", "layers.12.ff.net.3.weight", "layers.12.ff.net.3.bias", "layers.13.norm1.weight", "layers.13.norm1.bias", "layers.13.attn.to_qkv.weight", "layers.13.attn.to_out.weight", "layers.13.attn.to_out.bias", "layers.13.norm2.weight", "layers.13.norm2.bias", "layers.13.ff.net.0.weight", "layers.13.ff.net.0.bias", "layers.13.ff.net.3.weight", "layers.13.ff.net.3.bias", "layers.14.norm1.weight", "layers.14.norm1.bias", "layers.14.attn.to_qkv.weight", "layers.14.attn.to_out.weight", "layers.14.attn.to_out.bias", "layers.14.norm2.weight", "layers.14.norm2.bias", "layers.14.ff.net.0.weight", "layers.14.ff.net.0.bias", "layers.14.ff.net.3.weight", "layers.14.ff.net.3.bias", "layers.15.norm1.weight", "layers.15.norm1.bias", "layers.15.attn.to_qkv.weight", "layers.15.attn.to_out.weight", "layers.15.attn.to_out.bias", "layers.15.norm2.weight", "layers.15.norm2.bias", "layers.15.ff.net.0.weight", "layers.15.ff.net.0.bias", "layers.15.ff.net.3.weight", "layers.15.ff.net.3.bias", "layers.16.norm1.weight", "layers.16.norm1.bias", "layers.16.attn.to_qkv.weight", "layers.16.attn.to_out.weight", "layers.16.attn.to_out.bias", "layers.16.norm2.weight", "layers.16.norm2.bias", "layers.16.ff.net.0.weight", "layers.16.ff.net.0.bias", "layers.16.ff.net.3.weight", "layers.16.ff.net.3.bias", "layers.17.norm1.weight", "layers.17.norm1.bias", "layers.17.attn.to_qkv.weight", "layers.17.attn.to_out.weight", "layers.17.attn.to_out.bias", "layers.17.norm2.weight", "layers.17.norm2.bias", "layers.17.ff.net.0.weight", "layers.17.ff.net.0.bias", "layers.17.ff.net.3.weight", "layers.17.ff.net.3.bias", "layers.18.norm1.weight", "layers.18.norm1.bias", "layers.18.attn.to_qkv.weight", "layers.18.attn.to_out.weight", "layers.18.attn.to_out.bias", "layers.18.norm2.weight", "layers.18.norm2.bias", "layers.18.ff.net.0.weight", "layers.18.ff.net.0.bias", "layers.18.ff.net.3.weight", "layers.18.ff.net.3.bias", "layers.19.norm1.weight", "layers.19.norm1.bias", "layers.19.attn.to_qkv.weight", "layers.19.attn.to_out.weight", "layers.19.attn.to_out.bias", "layers.19.norm2.weight", "layers.19.norm2.bias", "layers.19.ff.net.0.weight", "layers.19.ff.net.0.bias", "layers.19.ff.net.3.weight", "layers.19.ff.net.3.bias", "layers.20.norm1.weight", "layers.20.norm1.bias", "layers.20.attn.to_qkv.weight", "layers.20.attn.to_out.weight", "layers.20.attn.to_out.bias", "layers.20.norm2.weight", "layers.20.norm2.bias", "layers.20.ff.net.0.weight", "layers.20.ff.net.0.bias", "layers.20.ff.net.3.weight", "layers.20.ff.net.3.bias", "layers.21.norm1.weight", "layers.21.norm1.bias", "layers.21.attn.to_qkv.weight", "layers.21.attn.to_out.weight", "layers.21.attn.to_out.bias", "layers.21.norm2.weight", "layers.21.norm2.bias", "layers.21.ff.net.0.weight", "layers.21.ff.net.0.bias", "layers.21.ff.net.3.weight", "layers.21.ff.net.3.bias", "layers.22.norm1.weight", "layers.22.norm1.bias", "layers.22.attn.to_qkv.weight", "layers.22.attn.to_out.weight", "layers.22.attn.to_out.bias", "layers.22.norm2.weight", "layers.22.norm2.bias", "layers.22.ff.net.0.weight", "layers.22.ff.net.0.bias", "layers.22.ff.net.3.weight", "layers.22.ff.net.3.bias", "layers.23.norm1.weight", "layers.23.norm1.bias", "layers.23.attn.to_qkv.weight", "layers.23.attn.to_out.weight", "layers.23.attn.to_out.bias", "layers.23.norm2.weight", "layers.23.norm2.bias", "layers.23.ff.net.0.weight", "layers.23.ff.net.0.bias", "layers.23.ff.net.3.weight", "layers.23.ff.net.3.bias", "from_head.0.weight", "from_head.0.bias", "from_head.1.weight", "from_head.1.bias", "from_head.3.weight", "from_head.3.bias", "to_head.0.weight", "to_head.0.bias", "to_head.1.weight", "to_head.1.bias", "to_head.3.weight", "to_head.3.bias", "value_head.0.weight", "value_head.0.bias", "value_head.1.weight", "value_head.1.bias", "value_head.3.weight", "value_head.3.bias". 
2025-11-28 17:59:54,097 - InferenceServer - INFO - Server shutting down.
2025-11-28 17:59:58,411 - training.parallel_self_play - INFO - Stopping Server...
2025-11-28 17:59:58,656 - __main__ - INFO - Training interrupted by user
2025-11-28 17:59:58,825 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 18:02:06,386 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 18:02:06,386 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:02:06,387 - __main__ - INFO - Testing move generation...
2025-11-28 18:02:06,733 - __main__ - INFO - [OK] Generated 845 moves
2025-11-28 18:02:06,733 - __main__ - INFO - Testing GameState caching...
2025-11-28 18:02:06,733 - __main__ - INFO - [OK] GameState caching works
2025-11-28 18:02:06,734 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 18:02:06,734 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 18:02:06,734 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(845), 'piece_moves_cache_size': 107, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 18:02:08,133 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_180202/temp_model_for_selfplay.pt
2025-11-28 18:02:08,133 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 50 games, 4 workers
2025-11-28 18:02:10,930 - training.parallel_self_play - INFO - Launching workers...
2025-11-28 18:02:17,169 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 4)
2025-11-28 18:02:20,236 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:02:20,237 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140502657438416
2025-11-28 18:02:20,272 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:02:20,273 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140429165999776
2025-11-28 18:02:20,287 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:02:20,288 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140666723865296
2025-11-28 18:02:20,362 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:02:20,363 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140401342067424
2025-11-28 18:02:21,621 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-11-28 18:02:21,625 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-11-28 18:02:21,625 - InferenceServer - INFO - Server Ready. Listening...
2025-11-28 18:03:14,681 - game3d.game.turnmove - INFO - Move 100: WHITE QUEEN [4 5 8]->[4 4 7] (Move)
2025-11-28 18:03:14,792 - game3d.game.turnmove - INFO - Move 100: WHITE KNIGHT31 [4 2 0]->[3 1 3] (Move)
2025-11-28 18:03:15,190 - game3d.game.turnmove - INFO - Move 100: BLACK ORBITER [4 6 5]->[3 6 2] (Capture)
2025-11-28 18:03:15,678 - game3d.game.turnmove - INFO - Move 100: WHITE GEOMANCER [5 8 1]->[8 8 4] (Move)
2025-11-28 18:03:22,160 - game3d.game.turnmove - INFO - Move 200: BLACK PAWN [3 4 6]->[4 3 7] (Move)
2025-11-28 18:03:23,318 - game3d.game.turnmove - INFO - Move 200: WHITE QUEEN [8 5 1]->[7 5 1] (Move)
2025-11-28 18:03:25,453 - game3d.game.turnmove - INFO - Move 200: BLACK SPEEDER [7 3 6]->[6 4 7] (Capture)
2025-11-28 18:03:27,653 - game3d.game.turnmove - INFO - Move 300: BLACK FREEZER [6 4 4]->[6 5 3] (Capture)
2025-11-28 18:03:29,423 - game3d.game.turnmove - INFO - Move 200: WHITE YZQUEEN [3 1 0]->[3 6 5] (Capture)
2025-11-28 18:03:33,150 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:03:33,150 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:03:33,725 - game3d.game.turnmove - INFO - Move 300: BLACK BLACKHOLE [2 1 7]->[4 3 7] (Move)
2025-11-28 18:03:34,123 - game3d.game.turnmove - INFO - Move 400: WHITE WALL [6 2 1]->[6 2 2] (Capture)
2025-11-28 18:03:37,078 - game3d.game.turnmove - INFO - Move 300: BLACK ORBITER [8 4 8]->[5 5 7] (Capture)
2025-11-28 18:03:37,450 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 113 pieces - possible stalemate
2025-11-28 18:03:37,451 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:03:37,451 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:03:40,435 - game3d.game.turnmove - INFO - Move 500: BLACK FREEZER [4 3 0]->[3 3 1] (Move)
2025-11-28 18:03:42,986 - game3d.game.turnmove - INFO - Move 400: BLACK SPEEDER [2 8 5]->[2 8 4] (Move)
2025-11-28 18:03:46,170 - game3d.game.turnmove - INFO - Move 300: WHITE SPIRAL [0 8 0]->[3 8 0] (Move)
2025-11-28 18:03:46,306 - game3d.game.turnmove - INFO - Move 600: BLACK FREEZER [4 4 0]->[3 5 1] (Move)
2025-11-28 18:03:46,345 - training.parallel_self_play - INFO - Stopping Server...
2025-11-28 18:03:46,345 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fef859d71a0>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7fef85ee6200> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 506, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 413, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fef859d71a0>) returned a result with an exception set
2025-11-28 18:03:46,348 - InferenceServer - INFO - Server shutting down.
2025-11-28 18:03:46,347 - worker.0 - ERROR - Worker 0 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fef859d71a0>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7fef85ee6200> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 506, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 413, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fef859d71a0>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 299, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fef859d71a0>) returned a result with an exception set
2025-11-28 18:03:46,365 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:03:46,365 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140661712652128
2025-11-28 18:03:46,632 - __main__ - INFO - Training interrupted by user
2025-11-28 18:03:46,892 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 18:05:11,073 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 18:05:11,074 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:05:11,076 - __main__ - INFO - Testing move generation...
2025-11-28 18:05:18,598 - __main__ - INFO - [OK] Generated 845 moves
2025-11-28 18:05:18,598 - __main__ - INFO - Testing GameState caching...
2025-11-28 18:05:18,598 - __main__ - INFO - [OK] GameState caching works
2025-11-28 18:05:18,598 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 18:05:18,599 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 18:05:18,599 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(845), 'piece_moves_cache_size': 107, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 18:05:19,966 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_180507/temp_model_for_selfplay.pt
2025-11-28 18:05:19,966 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 50 games, 6 workers
2025-11-28 18:05:22,767 - training.parallel_self_play - INFO - Launching workers...
2025-11-28 18:05:31,342 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-11-28 18:05:34,448 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:05:34,449 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140363142206160
2025-11-28 18:05:34,469 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:05:34,470 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139866984544768
2025-11-28 18:05:34,470 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:05:34,471 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139692715488352
2025-11-28 18:05:34,661 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:05:34,662 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140649081410256
2025-11-28 18:05:34,801 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:05:34,802 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139961799316176
2025-11-28 18:05:35,402 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:05:35,403 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139818754258688
2025-11-28 18:05:37,057 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-11-28 18:05:37,061 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-11-28 18:05:37,061 - InferenceServer - INFO - Server Ready. Listening...
2025-11-28 18:06:19,941 - game3d.game.turnmove - INFO - Move 100: BLACK KING [4 4 8]->[3 3 7] (Move)
2025-11-28 18:06:20,049 - game3d.game.turnmove - INFO - Move 100: WHITE KNIGHT32 [5 5 0]->[2 7 2] (Move)
2025-11-28 18:06:20,393 - game3d.game.turnmove - INFO - Move 100: WHITE INFILTRATOR [6 3 1]->[1 2 8] (Capture)
2025-11-28 18:06:22,480 - game3d.game.turnmove - INFO - Move 100: WHITE NEBULA [6 5 0]->[5 4 0] (Capture)
2025-11-28 18:06:26,473 - game3d.game.turnmove - INFO - Move 100: WHITE INFILTRATOR [2 3 1]->[3 3 2] (Move)
2025-11-28 18:06:27,816 - game3d.game.turnmove - INFO - Move 200: WHITE SPIRAL [8 1 0]->[7 1 1] (Move)
2025-11-28 18:06:27,945 - game3d.game.turnmove - INFO - Move 200: BLACK PANEL [4 4 4]->[4 4 3] (Move)
2025-11-28 18:06:28,543 - game3d.game.turnmove - INFO - Move 200: WHITE ARMOUR [5 7 1]->[5 6 2] (Move)
2025-11-28 18:06:28,670 - game3d.game.turnmove - INFO - Move 100: BLACK YZQUEEN [5 3 2]->[5 4 1] (Capture)
2025-11-28 18:06:31,101 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 187 pieces - possible stalemate
2025-11-28 18:06:31,102 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:06:31,103 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:06:34,608 - game3d.game.turnmove - INFO - Move 200: BLACK PANEL [4 4 8]->[4 4 7] (Move)
2025-11-28 18:06:35,790 - game3d.game.turnmove - INFO - Move 200: WHITE PANEL [5 3 1]->[4 4 2] (Move)
2025-11-28 18:06:37,103 - game3d.game.turnmove - INFO - Move 300: WHITE NEBULA [8 5 2]->[8 4 3] (Move)
2025-11-28 18:06:37,412 - game3d.game.turnmove - INFO - Move 300: BLACK XYQUEEN [4 5 7]->[3 4 6] (Move)
2025-11-28 18:06:37,447 - game3d.game.turnmove - INFO - Move 300: BLACK ORBITER [5 1 6]->[5 1 2] (Capture)
2025-11-28 18:06:39,061 - game3d.game.turnmove - INFO - Move 200: WHITE YZQUEEN [5 1 0]->[5 7 6] (Capture)
2025-11-28 18:06:42,314 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:06:42,314 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:06:45,317 - game3d.game.turnmove - INFO - Move 400: WHITE PAWN [6 2 2]->[5 3 3] (Move)
2025-11-28 18:06:45,858 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 178 pieces - possible stalemate
2025-11-28 18:06:45,860 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:06:45,860 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:06:48,411 - game3d.game.turnmove - INFO - Move 400: BLACK ARCHER [2 2 6]->[2 1 7] (Move)
2025-11-28 18:06:51,261 - game3d.game.turnmove - INFO - Move 400: WHITE QUEEN [8 3 1]->[8 1 3] (Move)
2025-11-28 18:06:54,441 - game3d.game.turnmove - INFO - Move 300: BLACK ORBITER [4 5 0]->[6 5 2] (Capture)
2025-11-28 18:06:56,443 - game3d.game.turnmove - INFO - Move 300: WHITE SLOWER [4 7 7]->[4 6 7] (Capture)
2025-11-28 18:06:58,608 - game3d.game.turnmove - INFO - Move 500: BLACK KNIGHT [2 2 6]->[4 1 6] (Move)
2025-11-28 18:07:01,607 - game3d.game.turnmove - INFO - Move 400: BLACK PAWN [7 8 6]->[7 7 6] (Capture)
2025-11-28 18:07:04,876 - game3d.game.turnmove - INFO - Move 500: BLACK PAWN [1 5 6]->[1 4 6] (Move)
2025-11-28 18:07:06,327 - game3d.game.turnmove - INFO - Move 300: WHITE ORBITER [4 0 0]->[3 1 2] (Move)
2025-11-28 18:07:07,004 - game3d.game.turnmove - INFO - Move 500: WHITE ROOK [3 4 8]->[5 4 8] (Move)
2025-11-28 18:07:08,812 - game3d.game.turnmove - INFO - Move 600: BLACK PANEL [4 4 7]->[4 4 6] (Move)
2025-11-28 18:07:08,855 - game3d.game.turnmove - INFO - Move 400: WHITE KNIGHT [5 4 1]->[5 3 3] (Move)
2025-11-28 18:07:09,102 - game3d.game.turnmove - INFO - Move 500: BLACK BLACKHOLE [3 1 4]->[3 1 3] (Capture)
2025-11-28 18:07:16,127 - game3d.game.turnmove - INFO - Move 700: BLACK SLOWER [3 0 5]->[4 1 6] (Move)
2025-11-28 18:07:16,163 - game3d.game.turnmove - INFO - Move 500: WHITE FREEZER [3 8 1]->[3 7 2] (Move)
2025-11-28 18:07:16,675 - game3d.game.turnmove - INFO - Move 600: BLACK PANEL [4 4 1]->[4 4 2] (Capture)
2025-11-28 18:07:16,954 - game3d.game.turnmove - INFO - Move 400: BLACK SPEEDER [3 4 4]->[4 3 4] (Capture)
2025-11-28 18:07:20,424 - game3d.game.turnmove - INFO - Move 600: BLACK SLOWER [4 2 1]->[3 3 1] (Move)
2025-11-28 18:07:22,102 - game3d.game.turnmove - INFO - Move 600: WHITE EDGEROOK [7 8 1]->[8 7 0] (Move)
2025-11-28 18:07:23,073 - game3d.game.turnmove - INFO - Move 800: BLACK MIRROR [1 7 7]->[1 6 6] (Move)
2025-11-28 18:07:24,361 - game3d.game.turnmove - INFO - Move 700: BLACK PANEL [4 3 0]->[5 4 0] (Move)
2025-11-28 18:07:25,200 - game3d.game.turnmove - INFO - Move 500: BLACK PANEL [4 5 0]->[3 4 0] (Move)
2025-11-28 18:07:29,742 - game3d.game.turnmove - INFO - Move 900: BLACK PAWN [8 5 6]->[8 4 6] (Move)
2025-11-28 18:07:29,880 - game3d.game.turnmove - INFO - Move 600: BLACK FREEZER [4 5 5]->[4 5 4] (Capture)
2025-11-28 18:07:30,548 - game3d.game.turnmove - INFO - Move 700: WHITE PANEL [4 4 1]->[4 4 2] (Move)
2025-11-28 18:07:33,049 - game3d.game.turnmove - INFO - Move 600: BLACK PANEL [4 3 0]->[5 4 0] (Move)
2025-11-28 18:07:36,461 - game3d.game.turnmove - INFO - Move 1000: BLACK ECHO [4 1 5]->[3 2 4] (Move)
2025-11-28 18:07:36,596 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 68 pieces - possible stalemate
2025-11-28 18:07:36,597 - game3d.common.state_utils - DEBUG - King for color 1 cached at [6 4 2]
2025-11-28 18:07:36,597 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:07:37,428 - game3d.game.turnmove - INFO - Move 800: WHITE WALL [5 6 1]->[5 6 2] (Move)
2025-11-28 18:07:37,525 - game3d.game.turnmove - INFO - Move 800: BLACK GEOMANCER [3 5 4]->[1 7 4] (Move)
2025-11-28 18:07:40,154 - game3d.game.turnmove - INFO - Move 700: BLACK SLOWER [5 6 3]->[5 5 3] (Move)
2025-11-28 18:07:40,525 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 38 pieces - possible stalemate
2025-11-28 18:07:40,525 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:07:40,526 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:07:41,001 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 38 pieces - possible stalemate
2025-11-28 18:07:41,001 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:07:41,001 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:07:41,267 - game3d.game.turnmove - INFO - Move 700: BLACK PANEL [4 4 1]->[4 3 0] (Move)
2025-11-28 18:07:41,454 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 38 pieces - possible stalemate
2025-11-28 18:07:41,454 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:07:41,454 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:07:41,654 - game3d.game.turnmove - INFO - Move 700: BLACK WHITEHOLE [8 5 6]->[8 5 5] (Move)
2025-11-28 18:07:42,056 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 38 pieces - possible stalemate
2025-11-28 18:07:42,056 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:07:42,056 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:07:43,434 - game3d.game.turnmove - INFO - Move 1100: BLACK XZZIGZAG [4 1 1]->[3 1 2] (Move)
2025-11-28 18:07:43,962 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 37 pieces - possible stalemate
2025-11-28 18:07:43,965 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 37 pieces completely immobilized)
2025-11-28 18:07:43,966 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 37 pieces completely immobilized)
2025-11-28 18:07:43,967 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 37 pieces completely immobilized)
2025-11-28 18:07:43,974 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 37 pieces completely immobilized)
2025-11-28 18:07:43,975 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 37 pieces completely immobilized)
2025-11-28 18:07:44,442 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:07:44,442 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139692688276832
2025-11-28 18:07:47,115 - game3d.game.turnmove - INFO - Move 800: BLACK SLOWER [6 6 4]->[7 5 3] (Move)
2025-11-28 18:07:49,458 - game3d.game.turnmove - INFO - Move 800: BLACK PANEL [5 4 0]->[4 3 0] (Move)
2025-11-28 18:07:50,094 - game3d.game.turnmove - INFO - Move 1200: BLACK PAWN [4 1 6]->[4 2 6] (Move)
2025-11-28 18:07:54,547 - game3d.game.turnmove - INFO - Move 900: BLACK SLOWER [6 6 4]->[5 5 3] (Move)
2025-11-28 18:07:54,575 - game3d.game.turnmove - INFO - Move 100: WHITE ARMOUR [5 1 1]->[6 2 2] (Move)
2025-11-28 18:07:56,369 - game3d.game.turnmove - INFO - Move 800: BLACK SLOWER [2 8 5]->[3 7 5] (Move)
2025-11-28 18:07:57,222 - game3d.game.turnmove - INFO - Move 1300: BLACK WALL [4 4 6]->[5 4 6] (Move)
2025-11-28 18:07:57,272 - game3d.game.turnmove - INFO - Move 900: WHITE BISHOP [3 2 8]->[4 3 8] (Move)
2025-11-28 18:07:57,826 - game3d.game.turnmove - INFO - Move 900: BLACK ARCHER [5 5 7]->[6 4 6] (Move)
2025-11-28 18:08:01,982 - game3d.game.turnmove - INFO - Move 1000: BLACK SLOWER [6 6 2]->[7 5 1] (Move)
2025-11-28 18:08:04,031 - game3d.game.turnmove - INFO - Move 1400: BLACK PAWN [4 2 6]->[4 1 6] (Move)
2025-11-28 18:08:05,750 - game3d.game.turnmove - INFO - Move 1000: BLACK PANEL [4 3 0]->[5 4 0] (Move)
2025-11-28 18:08:08,028 - game3d.game.turnmove - INFO - Move 200: WHITE PAWN [3 1 2]->[4 0 3] (Move)
2025-11-28 18:08:08,920 - game3d.game.turnmove - INFO - Move 1100: BLACK SLOWER [5 6 3]->[5 5 3] (Move)
2025-11-28 18:08:10,488 - game3d.game.turnmove - INFO - Move 900: WHITE HIVE [5 6 1]->[5 6 2] (Move)
2025-11-28 18:08:10,695 - game3d.game.turnmove - INFO - Move 1500: BLACK PAWN [4 1 6]->[4 2 6] (Move)
2025-11-28 18:08:12,586 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:08:12,586 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:08:14,806 - game3d.game.turnmove - INFO - Move 1100: WHITE SPIRAL [3 4 8]->[4 4 7] (Move)
2025-11-28 18:08:15,958 - game3d.game.turnmove - INFO - Move 1200: WHITE SPIRAL [4 5 8]->[3 4 8] (Move)
2025-11-28 18:08:16,228 - game3d.game.turnmove - INFO - Move 1000: WHITE BISHOP [3 2 8]->[4 3 8] (Move)
2025-11-28 18:08:17,420 - game3d.game.turnmove - INFO - Move 1600: BLACK WALL [4 4 6]->[5 4 6] (Move)
2025-11-28 18:08:22,494 - game3d.game.turnmove - INFO - Move 1200: WHITE SPIRAL [3 4 8]->[4 3 8] (Move)
2025-11-28 18:08:22,516 - game3d.game.turnmove - INFO - Move 1000: BLACK NEBULA [4 1 6]->[3 2 5] (Move)
2025-11-28 18:08:22,804 - game3d.game.turnmove - INFO - Move 300: WHITE QUEEN [4 3 8]->[4 5 8] (Move)
2025-11-28 18:08:23,446 - game3d.game.turnmove - INFO - Move 1300: BLACK SLOWER [6 6 2]->[5 5 3] (Move)
2025-11-28 18:08:24,444 - game3d.game.turnmove - INFO - Move 1700: BLACK PAWN [4 2 6]->[4 1 6] (Move)
2025-11-28 18:08:25,083 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 20 pieces - possible stalemate
2025-11-28 18:08:25,086 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 20 pieces completely immobilized)
2025-11-28 18:08:25,086 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 20 pieces completely immobilized)
2025-11-28 18:08:25,087 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 20 pieces completely immobilized)
2025-11-28 18:08:25,102 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 20 pieces completely immobilized)
2025-11-28 18:08:25,103 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 20 pieces completely immobilized)
2025-11-28 18:08:26,201 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:08:26,202 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140358047196800
2025-11-28 18:08:29,853 - game3d.game.turnmove - INFO - Move 1300: WHITE SPIRAL [3 4 8]->[4 3 8] (Move)
2025-11-28 18:08:29,905 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:08:29,905 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:08:30,147 - game3d.game.turnmove - INFO - Move 1400: BLACK SLOWER [6 6 4]->[5 5 3] (Move)
2025-11-28 18:08:32,850 - game3d.game.turnmove - INFO - Move 1100: WHITE BISHOP [3 2 8]->[4 3 8] (Move)
2025-11-28 18:08:33,448 - game3d.game.turnmove - INFO - Move 1100: WHITE TRIGONALBISHOP [8 5 0]->[3 0 5] (Move)
2025-11-28 18:08:35,575 - game3d.game.turnmove - INFO - Move 100: BLACK ARMOUR [3 7 7]->[3 6 6] (Capture)
2025-11-28 18:08:37,150 - game3d.game.turnmove - INFO - Move 1500: BLACK BISHOP [6 4 5]->[6 7 2] (Move)
2025-11-28 18:08:39,864 - game3d.game.turnmove - INFO - Move 1200: WHITE WHITEHOLE [4 4 7]->[3 4 8] (Move)
2025-11-28 18:08:41,108 - game3d.game.turnmove - INFO - Move 400: BLACK PANEL [3 4 0]->[4 3 0] (Move)
2025-11-28 18:08:43,391 - game3d.game.turnmove - INFO - Move 1600: WHITE SPIRAL [3 4 8]->[3 8 8] (Move)
2025-11-28 18:08:45,369 - game3d.game.turnmove - INFO - Move 1300: BLACK YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:08:46,460 - game3d.game.turnmove - INFO - Move 200: BLACK SWAPPER [2 5 5]->[3 5 4] (Move)
2025-11-28 18:08:46,816 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:08:46,816 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:08:47,200 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 32 pieces - possible stalemate
2025-11-28 18:08:47,200 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:08:47,201 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:08:47,353 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:08:47,353 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:08:47,598 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 55 pieces - possible stalemate
2025-11-28 18:08:47,599 - game3d.common.state_utils - DEBUG - King for color 1 cached at [6 4 2]
2025-11-28 18:08:47,599 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:08:48,239 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 25 pieces - possible stalemate
2025-11-28 18:08:48,240 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:08:48,240 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:08:48,813 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:08:48,813 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:08:48,989 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 25 pieces - possible stalemate
2025-11-28 18:08:48,989 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:08:48,989 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:08:49,361 - game3d.game.turnmove - INFO - Move 1700: BLACK SLOWER [5 6 3]->[5 5 3] (Move)
2025-11-28 18:08:49,617 - game3d.game.turnmove - INFO - Move 1400: WHITE SWAPPER [2 7 1]->[2 7 2] (Move)
2025-11-28 18:08:49,703 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 25 pieces - possible stalemate
2025-11-28 18:08:49,703 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:08:49,703 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:08:50,293 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 55 pieces - possible stalemate
2025-11-28 18:08:50,294 - game3d.common.state_utils - DEBUG - King for color 1 cached at [6 4 2]
2025-11-28 18:08:50,294 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:08:50,442 - game3d.game.turnmove - INFO - Move 1400: WHITE BOMB [4 4 7]->[3 5 7] (Move)
2025-11-28 18:08:50,751 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 55 pieces - possible stalemate
2025-11-28 18:08:50,752 - game3d.common.state_utils - DEBUG - King for color 1 cached at [6 4 2]
2025-11-28 18:08:50,752 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:08:52,007 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 25 pieces - possible stalemate
2025-11-28 18:08:52,008 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:08:52,008 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:08:52,397 - game3d.game.turnmove - INFO - Move 1200: WHITE BISHOP [3 2 8]->[4 3 8] (Move)
2025-11-28 18:08:52,625 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 25 pieces - possible stalemate
2025-11-28 18:08:52,626 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:08:52,626 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:08:53,408 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:08:53,408 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:08:53,908 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 38 pieces - possible stalemate
2025-11-28 18:08:53,909 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:08:53,909 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:08:54,261 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:08:54,261 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:08:55,387 - game3d.game.turnmove - INFO - Move 1800: WHITE SPIRAL [5 4 8]->[4 5 8] (Move)
2025-11-28 18:08:55,605 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 38 pieces - possible stalemate
2025-11-28 18:08:55,606 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:08:55,606 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:08:55,980 - game3d.game.turnmove - INFO - Move 1500: WHITE ARCHER [4 4 7]->[5 4 8] (Move)
2025-11-28 18:08:56,314 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 38 pieces - possible stalemate
2025-11-28 18:08:56,315 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:08:56,315 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:08:57,150 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 25 pieces - possible stalemate
2025-11-28 18:08:57,150 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:08:57,150 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:08:58,239 - game3d.game.turnmove - INFO - Move 300: BLACK FRIENDLYTELEPORTER [6 7 6]->[7 8 5] (Capture)
2025-11-28 18:08:58,307 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 38 pieces - possible stalemate
2025-11-28 18:08:58,307 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:08:58,307 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:08:58,497 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 38 pieces - possible stalemate
2025-11-28 18:08:58,498 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:08:58,498 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:08:59,277 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 24 pieces - possible stalemate
2025-11-28 18:08:59,278 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:08:59,278 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:09:00,635 - game3d.game.turnmove - INFO - Move 500: BLACK PANEL [4 3 0]->[5 4 0] (Move)
2025-11-28 18:09:01,120 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 24 pieces - possible stalemate
2025-11-28 18:09:01,120 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:09:01,120 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:09:01,603 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 24 pieces - possible stalemate
2025-11-28 18:09:01,603 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:09:01,604 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:09:01,708 - game3d.game.turnmove - INFO - Move 1900: WHITE SPIRAL [5 7 8]->[1 7 8] (Move)
2025-11-28 18:09:02,169 - game3d.game.turnmove - INFO - Move 1600: BLACK PAWN [7 0 8]->[7 1 7] (Capture)
2025-11-28 18:09:02,346 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 23 pieces - possible stalemate
2025-11-28 18:09:02,346 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:09:02,346 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:09:02,679 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 23 pieces - possible stalemate
2025-11-28 18:09:02,679 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:09:02,679 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:09:04,465 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:09:04,465 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:09:05,303 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:09:05,303 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:09:05,793 - game3d.game.turnmove - INFO - Move 400: BLACK FRIENDLYTELEPORTER [7 2 8]->[7 3 7] (Move)
2025-11-28 18:09:06,045 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:09:06,046 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:09:07,438 - game3d.game.turnmove - INFO - Move 1500: WHITE SLOWER [7 0 1]->[7 0 3] (Capture)
2025-11-28 18:09:09,009 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 22 pieces - possible stalemate
2025-11-28 18:09:09,009 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:09:09,009 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:09:09,044 - game3d.game.turnmove - INFO - Move 1700: WHITE SLOWER [4 5 5]->[5 4 6] (Move)
2025-11-28 18:09:09,088 - game3d.game.turnmove - INFO - Move 2000: WHITE SPIRAL [5 0 8]->[5 4 8] (Move)
2025-11-28 18:09:09,398 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 22 pieces - possible stalemate
2025-11-28 18:09:09,398 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:09:09,399 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:09:09,540 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 22 pieces - possible stalemate
2025-11-28 18:09:09,541 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:09:09,541 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:09:09,711 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 22 pieces - possible stalemate
2025-11-28 18:09:09,711 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:09:09,711 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:09:13,470 - game3d.game.turnmove - INFO - Move 1300: WHITE BISHOP [3 2 8]->[4 3 8] (Move)
2025-11-28 18:09:13,509 - game3d.game.turnmove - INFO - Move 500: BLACK ECHO [5 1 6]->[4 2 5] (Move)
2025-11-28 18:09:15,324 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 120 pieces - possible stalemate
2025-11-28 18:09:15,325 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:09:15,325 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:09:16,105 - game3d.game.turnmove - INFO - Move 1800: BLACK WALL [4 4 1]->[4 4 0] (Move)
2025-11-28 18:09:16,351 - game3d.game.turnmove - INFO - Move 2100: WHITE SPIRAL [4 5 8]->[3 4 8] (Move)
2025-11-28 18:09:17,074 - game3d.game.turnmove - INFO - Move 1600: WHITE SPEEDER [5 7 4]->[6 6 5] (Move)
2025-11-28 18:09:21,632 - game3d.game.turnmove - INFO - Move 600: BLACK SPIRAL [4 7 7]->[4 7 2] (Capture)
2025-11-28 18:09:23,445 - game3d.game.turnmove - INFO - Move 700: BLACK WALL [8 7 8]->[2 7 2] (Capture)
2025-11-28 18:09:24,314 - game3d.game.turnmove - INFO - Move 1900: BLACK PAWN [4 0 3]->[4 1 3] (Move)
2025-11-28 18:09:24,562 - game3d.game.turnmove - INFO - Move 2200: BLACK SLOWER [5 6 1]->[5 5 1] (Move)
2025-11-28 18:09:25,523 - game3d.game.turnmove - INFO - Move 1700: BLACK PAWN [2 0 7]->[3 1 8] (Move)
2025-11-28 18:09:28,319 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 15 pieces - possible stalemate
2025-11-28 18:09:28,322 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 15 pieces completely immobilized)
2025-11-28 18:09:28,323 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 15 pieces completely immobilized)
2025-11-28 18:09:28,324 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 15 pieces completely immobilized)
2025-11-28 18:09:28,334 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 15 pieces completely immobilized)
2025-11-28 18:09:28,335 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 15 pieces completely immobilized)
2025-11-28 18:09:28,517 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 113 pieces - possible stalemate
2025-11-28 18:09:28,518 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:09:28,518 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:09:29,224 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:09:29,225 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139861513220400
2025-11-28 18:09:29,703 - game3d.game.turnmove - INFO - Move 700: BLACK BISHOP [3 5 0]->[4 6 0] (Move)
2025-11-28 18:09:31,442 - game3d.game.turnmove - INFO - Move 800: BLACK ARCHER [1 2 6]->[2 2 6] (Move)
2025-11-28 18:09:32,290 - game3d.game.turnmove - INFO - Move 2000: BLACK PAWN [0 1 7]->[0 0 7] (Move)
2025-11-28 18:09:32,540 - game3d.game.turnmove - INFO - Move 2300: BLACK SLOWER [6 6 0]->[5 5 1] (Move)
2025-11-28 18:09:33,797 - game3d.game.turnmove - INFO - Move 1400: WHITE XZQUEEN [2 1 0]->[8 1 6] (Capture)
2025-11-28 18:09:37,769 - game3d.game.turnmove - INFO - Move 800: BLACK SPIRAL [3 4 0]->[5 4 0] (Move)
2025-11-28 18:09:38,386 - game3d.game.turnmove - INFO - Move 100: WHITE ARMOUR [5 7 1]->[5 7 2] (Capture)
2025-11-28 18:09:38,919 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 69 pieces - possible stalemate
2025-11-28 18:09:38,919 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:09:38,919 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:09:39,591 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 69 pieces - possible stalemate
2025-11-28 18:09:39,591 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:09:39,591 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:09:39,607 - game3d.game.turnmove - INFO - Move 900: BLACK BLACKHOLE [4 6 6]->[4 5 5] (Capture)
2025-11-28 18:09:39,918 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 69 pieces - possible stalemate
2025-11-28 18:09:39,918 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:09:39,918 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:09:40,502 - game3d.game.turnmove - INFO - Move 2100: BLACK PAWN [5 0 8]->[4 0 8] (Move)
2025-11-28 18:09:40,764 - game3d.game.turnmove - INFO - Move 2400: BLACK BISHOP [6 6 2]->[5 5 2] (Capture)
2025-11-28 18:09:44,684 - game3d.game.turnmove - INFO - Move 1500: WHITE SLOWER [7 2 2]->[6 3 3] (Move)
2025-11-28 18:09:46,085 - game3d.game.turnmove - INFO - Move 900: BLACK SPIRAL [4 5 0]->[3 4 0] (Move)
2025-11-28 18:09:46,796 - game3d.game.turnmove - INFO - Move 200: BLACK NEBULA [6 5 8]->[5 5 8] (Capture)
2025-11-28 18:09:47,901 - game3d.game.turnmove - INFO - Move 1000: WHITE BOMB [5 1 5]->[4 1 6] (Move)
2025-11-28 18:09:48,578 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 52 pieces - possible stalemate
2025-11-28 18:09:48,578 - game3d.common.state_utils - DEBUG - King for color 1 cached at [6 4 2]
2025-11-28 18:09:48,578 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:09:48,773 - game3d.game.turnmove - INFO - Move 2200: BLACK PAWN [8 1 5]->[8 0 5] (Move)
2025-11-28 18:09:49,101 - game3d.game.turnmove - INFO - Move 2500: BLACK BISHOP [6 3 3]->[6 2 2] (Move)
2025-11-28 18:09:53,380 - game3d.game.turnmove - INFO - Move 1600: WHITE SLOWER [7 2 2]->[6 3 3] (Move)
2025-11-28 18:09:54,403 - game3d.game.turnmove - INFO - Move 1000: WHITE BISHOP [3 8 7]->[4 8 8] (Move)
2025-11-28 18:09:56,093 - game3d.game.turnmove - INFO - Move 1100: WHITE PANEL [4 3 8]->[3 4 8] (Move)
2025-11-28 18:09:56,838 - game3d.game.turnmove - INFO - Move 2300: BLACK PAWN [0 1 7]->[0 0 7] (Move)
2025-11-28 18:09:57,115 - game3d.game.turnmove - INFO - Move 2600: BLACK BISHOP [2 8 2]->[3 7 2] (Move)
2025-11-28 18:10:00,070 - game3d.game.turnmove - INFO - Move 300: BLACK PANEL [5 4 0]->[4 5 0] (Move)
2025-11-28 18:10:02,768 - game3d.game.turnmove - INFO - Move 1700: BLACK FRIENDLYTELEPORTER [8 5 5]->[8 4 5] (Move)
2025-11-28 18:10:04,150 - game3d.game.turnmove - INFO - Move 1200: WHITE PANEL [3 4 8]->[4 3 8] (Move)
2025-11-28 18:10:04,633 - game3d.game.turnmove - INFO - Move 1100: WHITE BISHOP [3 8 7]->[4 8 8] (Move)
2025-11-28 18:10:05,002 - game3d.game.turnmove - INFO - Move 2400: BLACK PAWN [0 0 7]->[0 1 7] (Move)
2025-11-28 18:10:05,304 - game3d.game.turnmove - INFO - Move 2700: BLACK BISHOP [6 4 5]->[6 1 2] (Move)
2025-11-28 18:10:11,080 - game3d.game.turnmove - INFO - Move 1800: BLACK SLOWER [2 4 5]->[3 5 4] (Move)
2025-11-28 18:10:12,368 - game3d.game.turnmove - INFO - Move 1300: WHITE PANEL [4 3 8]->[3 4 8] (Move)
2025-11-28 18:10:13,156 - game3d.game.turnmove - INFO - Move 2500: BLACK PAWN [0 1 6]->[0 0 6] (Capture)
2025-11-28 18:10:13,444 - game3d.game.turnmove - INFO - Move 2800: BLACK BISHOP [6 1 2]->[6 4 5] (Move)
2025-11-28 18:10:14,918 - game3d.game.turnmove - INFO - Move 1200: WHITE QUEEN [4 8 0]->[4 2 6] (Capture)
2025-11-28 18:10:16,757 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 23 pieces - possible stalemate
2025-11-28 18:10:16,760 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 23 pieces completely immobilized)
2025-11-28 18:10:16,761 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 23 pieces completely immobilized)
2025-11-28 18:10:16,761 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 23 pieces completely immobilized)
2025-11-28 18:10:16,774 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 23 pieces completely immobilized)
2025-11-28 18:10:16,775 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 23 pieces completely immobilized)
2025-11-28 18:10:16,900 - game3d.game.turnmove - INFO - Move 400: BLACK PANEL [4 4 1]->[4 5 0] (Move)
2025-11-28 18:10:17,895 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:10:17,895 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140643895327136
2025-11-28 18:10:19,320 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:10:19,320 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:10:19,893 - game3d.game.turnmove - INFO - Move 1400: WHITE PANEL [3 4 8]->[4 3 8] (Move)
2025-11-28 18:10:20,648 - game3d.game.turnmove - INFO - Move 2600: BLACK PAWN [3 0 5]->[4 1 6] (Move)
2025-11-28 18:10:20,917 - game3d.game.turnmove - INFO - Move 2900: BLACK SLOWER [6 6 4]->[7 5 3] (Move)
2025-11-28 18:10:22,686 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 11 pieces - possible stalemate
2025-11-28 18:10:22,688 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 11 pieces completely immobilized)
2025-11-28 18:10:22,689 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 11 pieces completely immobilized)
2025-11-28 18:10:22,690 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 11 pieces completely immobilized)
2025-11-28 18:10:22,708 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 11 pieces completely immobilized)
2025-11-28 18:10:22,708 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 11 pieces completely immobilized)
2025-11-28 18:10:24,453 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:10:24,453 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139956777464928
2025-11-28 18:10:26,261 - game3d.game.turnmove - INFO - Move 1500: WHITE PANEL [3 4 8]->[4 3 8] (Move)
2025-11-28 18:10:27,318 - game3d.game.turnmove - INFO - Move 3000: BLACK BISHOP [6 5 2]->[6 4 3] (Move)
2025-11-28 18:10:27,470 - game3d.game.turnmove - INFO - Move 100: BLACK KNIGHT32 [6 3 0]->[4 6 2] (Capture)
2025-11-28 18:10:30,066 - game3d.game.turnmove - INFO - Move 1300: BLACK BLACKHOLE [2 8 7]->[3 8 7] (Move)
2025-11-28 18:10:31,739 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 49 pieces - possible stalemate
2025-11-28 18:10:31,740 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:10:31,740 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:10:33,801 - game3d.game.turnmove - INFO - Move 100: WHITE SWAPPER [7 3 0]->[8 4 3] (Move)
2025-11-28 18:10:34,288 - game3d.game.turnmove - INFO - Move 1600: WHITE PANEL [4 3 8]->[3 4 8] (Move)
2025-11-28 18:10:35,308 - game3d.game.turnmove - INFO - Move 500: WHITE INFILTRATOR [6 5 1]->[3 4 8] (Move)
2025-11-28 18:10:35,383 - game3d.game.turnmove - INFO - Move 3100: BLACK BISHOP [6 2 2]->[6 3 3] (Move)
2025-11-28 18:10:35,958 - game3d.game.turnmove - INFO - Move 200: WHITE KNIGHT32 [3 5 3]->[5 7 6] (Capture)
2025-11-28 18:10:36,715 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:10:36,715 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:10:37,549 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 43 pieces - possible stalemate
2025-11-28 18:10:37,549 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:10:37,550 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:10:38,401 - game3d.game.turnmove - INFO - Move 1400: WHITE SPIRAL [4 5 8]->[3 4 8] (Move)
2025-11-28 18:10:40,509 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 43 pieces - possible stalemate
2025-11-28 18:10:40,509 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:10:40,510 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:10:41,348 - game3d.game.turnmove - INFO - Move 1700: WHITE PANEL [3 4 8]->[4 3 8] (Move)
2025-11-28 18:10:42,301 - game3d.game.turnmove - INFO - Move 3200: BLACK BISHOP [7 4 3]->[6 5 3] (Move)
2025-11-28 18:10:43,283 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 43 pieces - possible stalemate
2025-11-28 18:10:43,283 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:10:43,283 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:10:45,324 - game3d.game.turnmove - INFO - Move 1500: WHITE SPIRAL [4 5 8]->[3 4 8] (Move)
2025-11-28 18:10:47,846 - game3d.game.turnmove - INFO - Move 200: BLACK ROOK [4 5 0]->[4 3 0] (Move)
2025-11-28 18:10:47,876 - game3d.game.turnmove - INFO - Move 1800: WHITE PAWN [1 2 4]->[1 4 4] (Move)
2025-11-28 18:10:48,835 - game3d.game.turnmove - INFO - Move 3300: BLACK BISHOP [6 4 3]->[6 5 2] (Move)
2025-11-28 18:10:51,908 - game3d.game.turnmove - INFO - Move 1600: BLACK ECHO [1 5 2]->[0 6 2] (Capture)
2025-11-28 18:10:53,392 - game3d.common.state_utils - DEBUG - King for color 1 cached at [6 4 2]
2025-11-28 18:10:53,392 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:10:53,696 - game3d.game.turnmove - INFO - Move 600: WHITE BLACKHOLE [3 3 2]->[4 3 2] (Capture)
2025-11-28 18:10:54,374 - game3d.game.turnmove - INFO - Move 1900: WHITE BOMB [4 0 3]->[4 1 3] (Move)
2025-11-28 18:10:55,698 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:10:55,699 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:10:55,701 - game3d.game.turnmove - INFO - Move 3400: WHITE SPIRAL [4 5 8]->[4 3 8] (Move)
2025-11-28 18:10:58,332 - game3d.game.turnmove - INFO - Move 1700: BLACK SWAPPER [4 3 0]->[3 4 0] (Move)
2025-11-28 18:11:01,639 - game3d.game.turnmove - INFO - Move 2000: WHITE WALL [5 4 8]->[4 4 8] (Move)
2025-11-28 18:11:03,132 - game3d.game.turnmove - INFO - Move 3500: WHITE FREEZER [6 1 6]->[5 0 5] (Capture)
2025-11-28 18:11:03,998 - game3d.game.turnmove - INFO - Move 700: WHITE QUEEN [0 6 2]->[4 6 6] (Move)
2025-11-28 18:11:06,021 - game3d.game.turnmove - INFO - Move 1800: BLACK PAWN [5 1 6]->[4 2 5] (Move)
2025-11-28 18:11:07,195 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 40 pieces - possible stalemate
2025-11-28 18:11:07,196 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:07,196 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:07,452 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 40 pieces - possible stalemate
2025-11-28 18:11:07,453 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:07,453 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:07,793 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 40 pieces - possible stalemate
2025-11-28 18:11:07,793 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:07,793 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:08,043 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 40 pieces - possible stalemate
2025-11-28 18:11:08,044 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:08,044 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:08,451 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 40 pieces - possible stalemate
2025-11-28 18:11:08,452 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:08,452 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:08,710 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 40 pieces - possible stalemate
2025-11-28 18:11:08,710 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:08,710 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:08,932 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 40 pieces - possible stalemate
2025-11-28 18:11:08,933 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:08,933 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:08,995 - game3d.game.turnmove - INFO - Move 2100: WHITE YZZIGZAG [0 6 8]->[0 6 6] (Move)
2025-11-28 18:11:09,168 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 40 pieces - possible stalemate
2025-11-28 18:11:09,168 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:09,168 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:09,385 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 40 pieces - possible stalemate
2025-11-28 18:11:09,386 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:09,386 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:10,042 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 40 pieces - possible stalemate
2025-11-28 18:11:10,042 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:10,043 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:10,103 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 38 pieces - possible stalemate
2025-11-28 18:11:10,104 - game3d.common.state_utils - DEBUG - King for color 1 cached at [6 4 2]
2025-11-28 18:11:10,104 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:10,291 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 40 pieces - possible stalemate
2025-11-28 18:11:10,292 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:10,292 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:10,342 - game3d.game.turnmove - INFO - Move 3600: BLACK BISHOP [6 4 3]->[6 5 2] (Move)
2025-11-28 18:11:11,127 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 39 pieces - possible stalemate
2025-11-28 18:11:11,128 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:11,128 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:11,249 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 38 pieces - possible stalemate
2025-11-28 18:11:11,250 - game3d.common.state_utils - DEBUG - King for color 1 cached at [6 4 2]
2025-11-28 18:11:11,250 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:11,384 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 39 pieces - possible stalemate
2025-11-28 18:11:11,384 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:11,384 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:11,655 - game3d.game.turnmove - INFO - Move 800: BLACK PANEL [4 5 0]->[3 4 0] (Move)
2025-11-28 18:11:12,233 - game3d.game.turnmove - INFO - Move 300: WHITE PANEL [3 4 8]->[4 5 8] (Move)
2025-11-28 18:11:13,749 - game3d.game.turnmove - INFO - Move 1900: BLACK ARMOUR [4 4 1]->[3 4 0] (Move)
2025-11-28 18:11:14,972 - game3d.common.state_utils - DEBUG - King for color 1 cached at [6 4 2]
2025-11-28 18:11:14,972 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:15,920 - game3d.game.turnmove - INFO - Move 2200: WHITE YZZIGZAG [0 6 6]->[0 6 5] (Move)
2025-11-28 18:11:17,276 - game3d.game.turnmove - INFO - Move 3700: WHITE QUEEN [4 3 8]->[4 5 8] (Move)
2025-11-28 18:11:19,880 - game3d.game.turnmove - INFO - Move 2000: BLACK ARMOUR [4 4 1]->[3 4 0] (Move)
2025-11-28 18:11:21,984 - game3d.game.turnmove - INFO - Move 2300: WHITE WALL [4 4 7]->[4 4 8] (Move)
2025-11-28 18:11:22,296 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:22,296 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:23,417 - game3d.game.turnmove - INFO - Move 3800: WHITE QUEEN [4 5 8]->[4 3 8] (Move)
2025-11-28 18:11:24,961 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 18:11:24,961 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:24,961 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:25,951 - game3d.game.turnmove - INFO - Move 2100: BLACK ARMOUR [4 3 0]->[5 4 0] (Move)
2025-11-28 18:11:28,034 - game3d.game.turnmove - INFO - Move 2400: WHITE YZZIGZAG [0 6 8]->[0 6 6] (Move)
2025-11-28 18:11:29,556 - game3d.game.turnmove - INFO - Move 3900: WHITE QUEEN [5 4 8]->[3 4 8] (Move)
2025-11-28 18:11:29,970 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 18:11:29,971 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:29,971 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:30,576 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 18:11:30,576 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:30,576 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:30,868 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 18:11:30,869 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:30,869 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:31,390 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 18:11:31,390 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:31,390 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:31,656 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 18:11:31,656 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:31,656 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:32,281 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 18:11:32,281 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:32,282 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:32,521 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 28 pieces - possible stalemate
2025-11-28 18:11:32,522 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:32,522 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:32,718 - game3d.game.turnmove - INFO - Move 2200: WHITE EDGEROOK [8 4 8]->[8 4 3] (Move)
2025-11-28 18:11:33,130 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:33,130 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:33,130 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:33,383 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:33,383 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:33,383 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:33,565 - game3d.game.turnmove - INFO - Move 2500: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:11:34,024 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:34,024 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:34,024 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:34,282 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:34,282 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:34,282 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:34,819 - game3d.game.turnmove - INFO - Move 4000: BLACK EDGEROOK [8 4 2]->[8 4 3] (Move)
2025-11-28 18:11:34,909 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:34,909 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:34,909 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:35,161 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:35,161 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:35,161 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:35,409 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:35,409 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:35,409 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:35,692 - game3d.game.turnmove - INFO - Move 400: WHITE NEBULA [2 3 0]->[1 0 0] (Move)
2025-11-28 18:11:36,697 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:36,698 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:36,698 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:39,279 - game3d.game.turnmove - INFO - Move 2600: WHITE WALL [5 4 8]->[4 4 8] (Move)
2025-11-28 18:11:39,315 - game3d.game.turnmove - INFO - Move 2300: BLACK YZZIGZAG [0 0 4]->[0 0 2] (Move)
2025-11-28 18:11:39,884 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:39,885 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:39,885 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:40,635 - game3d.game.turnmove - INFO - Move 4100: BLACK EDGEROOK [8 4 3]->[8 4 2] (Move)
2025-11-28 18:11:45,292 - game3d.game.turnmove - INFO - Move 2700: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:11:45,484 - game3d.game.turnmove - INFO - Move 2400: WHITE EDGEROOK [8 5 5]->[8 5 6] (Move)
2025-11-28 18:11:46,773 - game3d.game.turnmove - INFO - Move 4200: BLACK EDGEROOK [8 4 2]->[8 4 3] (Move)
2025-11-28 18:11:49,870 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:49,870 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:49,870 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:50,840 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:50,841 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:50,841 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:51,095 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:51,096 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:51,096 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:51,260 - game3d.game.turnmove - INFO - Move 2800: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:11:51,709 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:51,710 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:51,710 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:52,170 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:52,171 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:52,171 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:52,525 - game3d.game.turnmove - INFO - Move 4300: BLACK EDGEROOK [8 4 2]->[8 4 3] (Move)
2025-11-28 18:11:52,703 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:52,704 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:52,704 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:53,087 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:53,087 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:53,087 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:53,613 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:53,613 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:53,614 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:54,148 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:54,149 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:54,149 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:54,636 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 4 pieces - possible stalemate
2025-11-28 18:11:54,640 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 4 pieces completely immobilized)
2025-11-28 18:11:54,640 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 4 pieces completely immobilized)
2025-11-28 18:11:54,641 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 4 pieces completely immobilized)
2025-11-28 18:11:54,675 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 4 pieces completely immobilized)
2025-11-28 18:11:54,676 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 4 pieces completely immobilized)
2025-11-28 18:11:54,738 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:54,739 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:54,739 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:54,948 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:54,948 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:54,949 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:55,365 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:55,366 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:55,366 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:55,777 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:55,778 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:55,778 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:56,122 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:56,123 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:56,123 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:56,136 - game3d.game.turnmove - INFO - Move 2900: WHITE WALL [4 4 8]->[4 4 7] (Move)
2025-11-28 18:11:56,482 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:56,482 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:56,482 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:56,785 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:56,785 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:56,785 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:57,150 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:57,150 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:57,151 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:57,478 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:57,478 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:57,478 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:57,502 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:11:57,503 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139818632642416
2025-11-28 18:11:57,705 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:57,706 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:57,706 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:58,438 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:58,438 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:58,438 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:58,654 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:11:58,655 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:11:58,655 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:11:59,000 - game3d.game.turnmove - INFO - Move 500: BLACK PANEL [4 3 7]->[4 4 6] (Move)
2025-11-28 18:11:59,370 - game3d.game.turnmove - INFO - Move 900: BLACK SPIRAL [5 4 0]->[3 4 0] (Move)
2025-11-28 18:12:01,761 - game3d.game.turnmove - INFO - Move 3000: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:12:05,320 - game3d.game.turnmove - INFO - Move 2700: BLACK YZZIGZAG [0 0 1]->[0 0 8] (Move)
2025-11-28 18:12:06,849 - game3d.game.turnmove - INFO - Move 1000: BLACK PANEL [3 4 0]->[4 5 0] (Move)
2025-11-28 18:12:06,895 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 16 pieces - possible stalemate
2025-11-28 18:12:06,903 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 16 pieces - possible stalemate
2025-11-28 18:12:06,903 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 16 pieces completely immobilized)
2025-11-28 18:12:06,903 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 16 pieces completely immobilized)
2025-11-28 18:12:06,904 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 16 pieces completely immobilized)
2025-11-28 18:12:06,928 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 16 pieces completely immobilized)
2025-11-28 18:12:06,929 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 16 pieces completely immobilized)
2025-11-28 18:12:07,480 - game3d.game.turnmove - INFO - Move 100: BLACK NEBULA [2 5 8]->[3 5 8] (Capture)
2025-11-28 18:12:08,308 - game3d.game.turnmove - INFO - Move 3100: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:12:08,817 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:12:08,818 - game3d.cache.manager - DEBUG - Created cache manager #3 for board 140363293962688
2025-11-28 18:12:13,333 - game3d.game.turnmove - INFO - Move 1100: BLACK PANEL [4 3 0]->[5 4 0] (Move)
2025-11-28 18:12:13,421 - game3d.game.turnmove - INFO - Move 300: BLACK TRAILBLAZER [4 5 8]->[3 5 8] (Move)
2025-11-28 18:12:14,439 - game3d.game.turnmove - INFO - Move 3200: WHITE WALL [4 4 8]->[4 5 8] (Move)
2025-11-28 18:12:15,886 - game3d.game.turnmove - INFO - Move 200: BLACK FRIENDLYTELEPORTER [1 6 6]->[2 5 5] (Move)
2025-11-28 18:12:18,751 - game3d.game.turnmove - INFO - Move 100: BLACK KNIGHT [3 2 5]->[5 1 5] (Move)
2025-11-28 18:12:20,443 - game3d.game.turnmove - INFO - Move 1200: BLACK PANEL [4 5 0]->[3 4 0] (Move)
2025-11-28 18:12:21,017 - game3d.game.turnmove - INFO - Move 3300: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:12:21,076 - game3d.game.turnmove - INFO - Move 600: WHITE SWAPPER [1 4 1]->[2 5 2] (Move)
2025-11-28 18:12:23,698 - game3d.game.turnmove - INFO - Move 300: WHITE PAWN [3 7 3]->[3 8 3] (Move)
2025-11-28 18:12:27,320 - game3d.game.turnmove - INFO - Move 1300: BLACK PANEL [4 4 1]->[3 4 0] (Move)
2025-11-28 18:12:27,442 - game3d.game.turnmove - INFO - Move 3400: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:12:30,977 - game3d.game.turnmove - INFO - Move 400: WHITE FREEZER [3 5 2]->[3 5 3] (Capture)
2025-11-28 18:12:31,642 - game3d.game.turnmove - INFO - Move 200: WHITE YZQUEEN [5 1 0]->[5 7 6] (Capture)
2025-11-28 18:12:33,568 - game3d.game.turnmove - INFO - Move 3500: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:12:33,800 - game3d.game.turnmove - INFO - Move 1400: BLACK PANEL [4 5 0]->[3 4 0] (Move)
2025-11-28 18:12:38,536 - game3d.game.turnmove - INFO - Move 3600: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:12:39,500 - game3d.game.turnmove - INFO - Move 700: BLACK YZQUEEN [4 5 7]->[4 5 0] (Move)
2025-11-28 18:12:43,056 - game3d.game.turnmove - INFO - Move 3700: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:12:44,520 - game3d.game.turnmove - INFO - Move 500: WHITE GEOMANCER [8 6 2]->[5 8 4] (Move)
2025-11-28 18:12:44,602 - game3d.game.turnmove - INFO - Move 1500: BLACK PANEL [4 3 0]->[3 4 0] (Move)
2025-11-28 18:12:45,330 - game3d.game.turnmove - INFO - Move 800: WHITE ECHO [3 5 2]->[4 6 3] (Move)
2025-11-28 18:12:48,074 - game3d.game.turnmove - INFO - Move 3800: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:12:52,080 - game3d.game.turnmove - INFO - Move 3900: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:12:54,107 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:12:54,107 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:12:56,169 - game3d.game.turnmove - INFO - Move 300: BLACK PAWN [1 8 6]->[1 7 6] (Move)
2025-11-28 18:12:56,414 - game3d.game.turnmove - INFO - Move 900: WHITE SLOWER [7 2 3]->[6 3 3] (Move)
2025-11-28 18:12:56,423 - game3d.game.turnmove - INFO - Move 4000: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:13:00,337 - game3d.game.turnmove - INFO - Move 4100: WHITE WALL [4 4 8]->[4 4 7] (Move)
2025-11-28 18:13:04,398 - game3d.game.turnmove - INFO - Move 4200: WHITE WALL [4 4 8]->[4 4 7] (Move)
2025-11-28 18:13:06,236 - game3d.game.turnmove - INFO - Move 1000: WHITE PAWN [1 2 2]->[1 3 2] (Move)
2025-11-28 18:13:08,487 - game3d.game.turnmove - INFO - Move 600: WHITE PAWN [4 4 1]->[4 4 2] (Capture)
2025-11-28 18:13:08,892 - game3d.game.turnmove - INFO - Move 4300: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:13:11,187 - game3d.game.turnmove - INFO - Move 1100: WHITE PAWN [0 6 2]->[0 6 6] (Move)
2025-11-28 18:13:12,513 - game3d.game.turnmove - INFO - Move 1600: BLACK ARMOUR [7 4 2]->[6 4 2] (Capture)
2025-11-28 18:13:14,766 - game3d.game.turnmove - INFO - Move 4400: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:13:16,865 - game3d.game.turnmove - INFO - Move 1200: BLACK PAWN [7 2 6]->[7 1 6] (Move)
2025-11-28 18:13:17,383 - game3d.game.turnmove - INFO - Move 400: BLACK QUEEN [4 4 1]->[4 5 0] (Move)
2025-11-28 18:13:18,107 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 18 pieces - possible stalemate
2025-11-28 18:13:18,111 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 18 pieces completely immobilized)
2025-11-28 18:13:18,111 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 18 pieces completely immobilized)
2025-11-28 18:13:18,112 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 18 pieces completely immobilized)
2025-11-28 18:13:18,121 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 18 pieces completely immobilized)
2025-11-28 18:13:18,122 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 18 pieces completely immobilized)
2025-11-28 18:13:18,915 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:13:18,915 - game3d.cache.manager - DEBUG - Created cache manager #3 for board 139961641249632
2025-11-28 18:13:19,206 - game3d.game.turnmove - INFO - Move 1700: BLACK ROOK [5 4 0]->[3 4 0] (Move)
2025-11-28 18:13:19,914 - game3d.game.turnmove - INFO - Move 4500: WHITE WALL [4 4 8]->[3 4 8] (Move)
2025-11-28 18:13:24,212 - game3d.game.turnmove - INFO - Move 1800: BLACK ROOK [5 4 0]->[3 4 0] (Move)
2025-11-28 18:13:25,112 - game3d.game.turnmove - INFO - Move 4600: WHITE WALL [5 4 7]->[4 4 7] (Move)
2025-11-28 18:13:28,619 - game3d.game.turnmove - INFO - Move 100: WHITE BLACKHOLE [6 0 1]->[6 1 1] (Capture)
2025-11-28 18:13:29,977 - game3d.game.turnmove - INFO - Move 1900: BLACK ROOK [3 4 0]->[5 4 0] (Move)
2025-11-28 18:13:30,406 - game3d.game.turnmove - INFO - Move 4700: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:13:35,037 - game3d.game.turnmove - INFO - Move 4800: WHITE WALL [4 4 8]->[4 3 8] (Move)
2025-11-28 18:13:35,168 - game3d.game.turnmove - INFO - Move 2000: BLACK FREEZER [3 6 4]->[2 5 3] (Move)
2025-11-28 18:13:37,129 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 15 pieces - possible stalemate
2025-11-28 18:13:37,133 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 15 pieces completely immobilized)
2025-11-28 18:13:37,133 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 15 pieces completely immobilized)
2025-11-28 18:13:37,134 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 15 pieces completely immobilized)
2025-11-28 18:13:37,154 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 15 pieces completely immobilized)
2025-11-28 18:13:37,154 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 15 pieces completely immobilized)
2025-11-28 18:13:38,540 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:13:38,541 - game3d.cache.manager - DEBUG - Created cache manager #3 for board 139866955665456
2025-11-28 18:13:38,790 - training.parallel_self_play - INFO - Collected 19000 examples...
2025-11-28 18:13:39,385 - game3d.game.turnmove - INFO - Move 4900: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:13:39,759 - game3d.game.turnmove - INFO - Move 500: BLACK QUEEN [3 4 0]->[4 5 0] (Move)
2025-11-28 18:13:43,022 - game3d.game.turnmove - INFO - Move 200: WHITE PANEL [2 2 0]->[3 1 1] (Move)
2025-11-28 18:13:43,631 - game3d.game.turnmove - INFO - Move 5000: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:13:47,494 - game3d.game.turnmove - INFO - Move 5100: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:13:50,488 - game3d.game.turnmove - INFO - Move 100: BLACK ORBITER [4 0 2]->[4 4 2] (Capture)
2025-11-28 18:13:51,250 - game3d.game.turnmove - INFO - Move 5200: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:13:55,068 - game3d.game.turnmove - INFO - Move 5300: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:13:58,981 - game3d.game.turnmove - INFO - Move 5400: WHITE WALL [4 4 8]->[4 3 8] (Move)
2025-11-28 18:14:02,754 - game3d.game.turnmove - INFO - Move 5500: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:14:04,155 - game3d.game.turnmove - INFO - Move 700: WHITE WHITEHOLE [6 7 3]->[5 8 4] (Move)
2025-11-28 18:14:04,628 - game3d.game.turnmove - INFO - Move 600: BLACK QUEEN [5 4 0]->[4 3 0] (Move)
2025-11-28 18:14:07,259 - game3d.game.turnmove - INFO - Move 5600: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:14:07,458 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 53 pieces - possible stalemate
2025-11-28 18:14:07,458 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:14:07,459 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:14:07,670 - game3d.game.turnmove - INFO - Move 300: WHITE PAWN [8 0 2]->[7 1 1] (Capture)
2025-11-28 18:14:07,798 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 53 pieces - possible stalemate
2025-11-28 18:14:07,799 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:14:07,799 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:14:08,159 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 53 pieces - possible stalemate
2025-11-28 18:14:08,160 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:14:08,160 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:14:10,081 - game3d.game.turnmove - INFO - Move 800: BLACK EDGEROOK [8 2 6]->[8 1 2] (Capture)
2025-11-28 18:14:11,485 - game3d.game.turnmove - INFO - Move 5700: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:14:13,084 - game3d.game.turnmove - INFO - Move 200: WHITE PAWN [3 0 2]->[3 1 2] (Capture)
2025-11-28 18:14:15,843 - game3d.game.turnmove - INFO - Move 5800: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:14:18,104 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:14:18,104 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:14:18,367 - game3d.game.turnmove - INFO - Move 900: BLACK PAWN [0 5 6]->[0 4 6] (Move)
2025-11-28 18:14:19,060 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 44 pieces - possible stalemate
2025-11-28 18:14:19,060 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:14:19,060 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:14:19,746 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 44 pieces - possible stalemate
2025-11-28 18:14:19,747 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:14:19,747 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:14:20,835 - game3d.game.turnmove - INFO - Move 5900: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:14:20,906 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 44 pieces - possible stalemate
2025-11-28 18:14:20,907 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:14:20,907 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:14:23,927 - game3d.game.turnmove - INFO - Move 1000: WHITE ARMOUR [4 5 8]->[3 4 8] (Move)
2025-11-28 18:14:25,820 - game3d.game.turnmove - INFO - Move 6000: WHITE WALL [4 4 8]->[4 5 8] (Move)
2025-11-28 18:14:28,191 - game3d.game.turnmove - INFO - Move 400: BLACK PAWN [5 8 6]->[5 7 6] (Move)
2025-11-28 18:14:28,875 - game3d.game.turnmove - INFO - Move 1100: WHITE ARMOUR [3 4 8]->[4 5 8] (Move)
2025-11-28 18:14:29,154 - game3d.game.turnmove - INFO - Move 300: BLACK KNIGHT [5 5 4]->[4 5 2] (Move)
2025-11-28 18:14:30,055 - game3d.game.turnmove - INFO - Move 700: WHITE SLOWER [1 0 2]->[0 0 3] (Capture)
2025-11-28 18:14:30,818 - game3d.game.turnmove - INFO - Move 6100: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:14:34,013 - game3d.game.turnmove - INFO - Move 1200: WHITE ARMOUR [3 4 8]->[4 3 8] (Move)
2025-11-28 18:14:35,951 - game3d.game.turnmove - INFO - Move 6200: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:14:39,287 - game3d.game.turnmove - INFO - Move 1300: WHITE ARMOUR [3 4 8]->[4 3 8] (Move)
2025-11-28 18:14:41,332 - game3d.game.turnmove - INFO - Move 6300: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:14:44,220 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 45 pieces - possible stalemate
2025-11-28 18:14:44,223 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 45 pieces completely immobilized)
2025-11-28 18:14:44,224 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 45 pieces completely immobilized)
2025-11-28 18:14:44,225 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 45 pieces completely immobilized)
2025-11-28 18:14:44,273 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 45 pieces completely immobilized)
2025-11-28 18:14:44,274 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 45 pieces completely immobilized)
2025-11-28 18:14:44,493 - game3d.game.turnmove - INFO - Move 1400: WHITE ARMOUR [4 5 8]->[3 4 8] (Move)
2025-11-28 18:14:44,775 - game3d.game.turnmove - INFO - Move 400: BLACK ARMOUR [3 7 7]->[3 7 5] (Move)
2025-11-28 18:14:45,071 - game3d.game.turnmove - INFO - Move 500: BLACK BOMB [4 5 5]->[6 3 3] (Capture)
2025-11-28 18:14:48,257 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:14:48,258 - game3d.cache.manager - DEBUG - Created cache manager #3 for board 139692689551904
2025-11-28 18:14:48,714 - game3d.game.turnmove - INFO - Move 1500: WHITE ARMOUR [3 4 8]->[4 3 8] (Move)
2025-11-28 18:14:51,248 - game3d.game.turnmove - INFO - Move 800: BLACK SPIRAL [3 4 8]->[8 4 3] (Capture)
2025-11-28 18:14:53,410 - game3d.game.turnmove - INFO - Move 1600: WHITE SLOWER [3 4 8]->[3 3 7] (Move)
2025-11-28 18:14:56,825 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 99 pieces - possible stalemate
2025-11-28 18:14:56,826 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:14:56,827 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:14:57,977 - game3d.game.turnmove - INFO - Move 1700: WHITE PAWN [0 2 3]->[0 4 3] (Move)
2025-11-28 18:14:58,249 - game3d.game.turnmove - INFO - Move 100: WHITE INFILTRATOR [2 5 1]->[3 6 2] (Move)
2025-11-28 18:15:01,305 - game3d.game.turnmove - INFO - Move 500: BLACK ECHO [4 1 6]->[3 2 5] (Move)
2025-11-28 18:15:02,022 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 90 pieces - possible stalemate
2025-11-28 18:15:02,023 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:15:02,023 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:15:02,181 - game3d.game.turnmove - INFO - Move 400: WHITE BISHOP [0 4 1]->[1 4 0] (Capture)
2025-11-28 18:15:02,671 - game3d.game.turnmove - INFO - Move 900: WHITE SLOWER [7 7 1]->[5 7 1] (Capture)
2025-11-28 18:15:04,002 - game3d.game.turnmove - INFO - Move 1800: WHITE FREEZER [3 5 7]->[3 4 8] (Move)
2025-11-28 18:15:04,180 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 88 pieces - possible stalemate
2025-11-28 18:15:04,181 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:15:04,181 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:15:06,079 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:15:06,079 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:15:06,924 - game3d.game.turnmove - INFO - Move 200: BLACK XZQUEEN [2 1 8]->[8 1 2] (Capture)
2025-11-28 18:15:09,337 - game3d.game.turnmove - INFO - Move 1000: WHITE SLOWER [2 6 3]->[3 5 4] (Move)
2025-11-28 18:15:10,036 - game3d.game.turnmove - INFO - Move 1900: WHITE FREEZER [3 4 8]->[3 5 7] (Move)
2025-11-28 18:15:15,238 - game3d.common.state_utils - DEBUG - King for color 1 cached at [1 0 0]
2025-11-28 18:15:15,238 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:15:15,400 - game3d.game.turnmove - INFO - Move 2000: WHITE FREEZER [3 5 7]->[3 4 8] (Move)
2025-11-28 18:15:16,102 - game3d.game.turnmove - INFO - Move 1100: WHITE KING [1 0 0]->[1 1 1] (Move)
2025-11-28 18:15:17,303 - game3d.game.turnmove - INFO - Move 300: WHITE PAWN [2 0 2]->[3 1 1] (Move)
2025-11-28 18:15:18,188 - game3d.game.turnmove - INFO - Move 700: WHITE SPEEDER [5 8 4]->[5 7 4] (Move)
2025-11-28 18:15:20,474 - game3d.game.turnmove - INFO - Move 600: BLACK BLACKHOLE [4 1 6]->[3 2 5] (Move)
2025-11-28 18:15:20,813 - game3d.game.turnmove - INFO - Move 2100: WHITE WALL [4 3 8]->[4 4 8] (Move)
2025-11-28 18:15:21,652 - game3d.game.turnmove - INFO - Move 1200: BLACK PAWN [6 1 7]->[6 0 7] (Move)
2025-11-28 18:15:24,125 - game3d.common.state_utils - DEBUG - King for color 1 cached at [2 0 0]
2025-11-28 18:15:24,125 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:15:25,944 - game3d.game.turnmove - INFO - Move 2200: WHITE WALL [4 3 8]->[4 4 8] (Move)
2025-11-28 18:15:26,981 - game3d.game.turnmove - INFO - Move 1300: BLACK EDGEROOK [2 0 8]->[2 0 7] (Move)
2025-11-28 18:15:28,297 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:15:28,297 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:15:28,698 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:15:28,698 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:15:29,126 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:15:29,126 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:15:29,664 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:15:29,664 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:15:30,375 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:15:30,375 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:15:30,754 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:15:30,754 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:15:31,189 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:15:31,189 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:15:31,208 - game3d.game.turnmove - INFO - Move 2300: WHITE FREEZER [3 4 8]->[3 5 7] (Move)
2025-11-28 18:15:31,475 - game3d.game.turnmove - INFO - Move 800: BLACK FREEZER [5 4 0]->[5 3 1] (Move)
2025-11-28 18:15:32,587 - game3d.game.turnmove - INFO - Move 1400: WHITE SLOWER [3 5 7]->[2 6 6] (Move)
2025-11-28 18:15:33,013 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:15:33,013 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:15:33,425 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:15:33,425 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:15:33,824 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:15:33,824 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:15:34,245 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:15:34,245 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:15:34,701 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:15:34,701 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:15:35,167 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:15:35,167 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:15:35,340 - game3d.game.turnmove - INFO - Move 400: WHITE EDGEROOK [8 5 5]->[8 3 6] (Capture)
2025-11-28 18:15:35,519 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:15:35,519 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:15:36,558 - game3d.game.turnmove - INFO - Move 2400: WHITE FREEZER [3 4 8]->[3 5 7] (Move)
2025-11-28 18:15:36,862 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:15:36,862 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:15:37,985 - game3d.game.turnmove - INFO - Move 1500: WHITE SLOWER [3 5 7]->[3 4 8] (Move)
2025-11-28 18:15:38,524 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 25 pieces - possible stalemate
2025-11-28 18:15:38,527 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 25 pieces completely immobilized)
2025-11-28 18:15:38,527 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 25 pieces completely immobilized)
2025-11-28 18:15:38,528 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 25 pieces completely immobilized)
2025-11-28 18:15:38,540 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 25 pieces completely immobilized)
2025-11-28 18:15:38,542 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 25 pieces completely immobilized)
2025-11-28 18:15:39,367 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:15:39,368 - game3d.cache.manager - DEBUG - Created cache manager #4 for board 140358042424592
2025-11-28 18:15:39,467 - game3d.game.turnmove - INFO - Move 900: WHITE PAWN [2 1 2]->[3 2 1] (Move)
2025-11-28 18:15:41,455 - game3d.game.turnmove - INFO - Move 700: BLACK SLOWER [4 1 6]->[3 2 5] (Move)
2025-11-28 18:15:42,422 - game3d.game.turnmove - INFO - Move 2500: WHITE FREEZER [3 5 7]->[3 4 8] (Move)
2025-11-28 18:15:45,413 - game3d.game.turnmove - INFO - Move 1000: WHITE BISHOP [4 1 8]->[4 4 5] (Move)
2025-11-28 18:15:48,215 - game3d.game.turnmove - INFO - Move 2600: WHITE YZZIGZAG [0 2 2]->[0 2 3] (Move)
2025-11-28 18:15:50,099 - game3d.game.turnmove - INFO - Move 100: BLACK INFILTRATOR [2 3 7]->[3 3 6] (Capture)
2025-11-28 18:15:51,479 - game3d.game.turnmove - INFO - Move 1100: WHITE PAWN [0 5 2]->[0 6 2] (Move)
2025-11-28 18:15:54,132 - game3d.game.turnmove - INFO - Move 2700: WHITE FREEZER [4 3 8]->[3 3 7] (Move)
2025-11-28 18:15:54,730 - game3d.game.turnmove - INFO - Move 500: WHITE SPEEDER [4 2 1]->[5 3 2] (Move)
2025-11-28 18:15:56,933 - game3d.game.turnmove - INFO - Move 800: BLACK PANEL [3 5 4]->[4 4 3] (Capture)
2025-11-28 18:15:57,583 - game3d.game.turnmove - INFO - Move 1200: WHITE PAWN [5 7 4]->[5 8 4] (Move)
2025-11-28 18:15:59,981 - game3d.game.turnmove - INFO - Move 200: BLACK INFILTRATOR [3 3 6]->[4 2 5] (Capture)
2025-11-28 18:16:00,177 - game3d.game.turnmove - INFO - Move 2800: WHITE YZZIGZAG [0 2 4]->[0 2 5] (Move)
2025-11-28 18:16:03,691 - game3d.game.turnmove - INFO - Move 1300: WHITE YZZIGZAG [8 6 8]->[8 6 5] (Move)
2025-11-28 18:16:06,428 - game3d.game.turnmove - INFO - Move 2900: WHITE FREEZER [3 3 7]->[3 2 6] (Move)
2025-11-28 18:16:08,577 - game3d.game.turnmove - INFO - Move 900: WHITE PAWN [1 1 1]->[1 2 1] (Move)
2025-11-28 18:16:08,803 - game3d.game.turnmove - INFO - Move 300: BLACK PAWN [5 4 6]->[5 3 6] (Capture)
2025-11-28 18:16:10,616 - game3d.game.turnmove - INFO - Move 1400: WHITE PAWN [5 8 4]->[5 7 4] (Move)
2025-11-28 18:16:11,855 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 20 pieces - possible stalemate
2025-11-28 18:16:11,861 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 20 pieces - possible stalemate
2025-11-28 18:16:11,861 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 20 pieces completely immobilized)
2025-11-28 18:16:11,862 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 20 pieces completely immobilized)
2025-11-28 18:16:11,863 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 20 pieces completely immobilized)
2025-11-28 18:16:11,890 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 20 pieces completely immobilized)
2025-11-28 18:16:11,892 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 20 pieces completely immobilized)
2025-11-28 18:16:14,148 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:16:14,148 - game3d.cache.manager - DEBUG - Created cache manager #3 for board 139818707132352
2025-11-28 18:16:14,948 - game3d.game.turnmove - INFO - Move 1000: WHITE PAWN [1 0 2]->[0 1 1] (Move)
2025-11-28 18:16:16,385 - game3d.game.turnmove - INFO - Move 600: BLACK PAWN [3 3 7]->[3 4 7] (Move)
2025-11-28 18:16:16,687 - game3d.game.turnmove - INFO - Move 1500: WHITE PAWN [5 8 4]->[5 7 4] (Move)
2025-11-28 18:16:17,275 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 32 pieces - possible stalemate
2025-11-28 18:16:17,278 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 32 pieces completely immobilized)
2025-11-28 18:16:17,278 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 32 pieces completely immobilized)
2025-11-28 18:16:17,279 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 32 pieces completely immobilized)
2025-11-28 18:16:17,289 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 32 pieces completely immobilized)
2025-11-28 18:16:17,290 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 32 pieces completely immobilized)
2025-11-28 18:16:17,739 - game3d.game.turnmove - INFO - Move 400: WHITE FREEZER [5 2 2]->[6 3 3] (Move)
2025-11-28 18:16:18,237 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:16:18,237 - game3d.cache.manager - DEBUG - Created cache manager #4 for board 139956781845952
2025-11-28 18:16:20,988 - game3d.game.turnmove - INFO - Move 1100: WHITE YZZIGZAG [0 6 2]->[0 6 5] (Move)
2025-11-28 18:16:24,303 - game3d.game.turnmove - INFO - Move 100: WHITE GEOMANCER [5 0 1]->[7 0 0] (Move)
2025-11-28 18:16:25,628 - game3d.game.turnmove - INFO - Move 500: BLACK FRIENDLYTELEPORTER [5 4 6]->[5 3 5] (Move)
2025-11-28 18:16:27,338 - game3d.game.turnmove - INFO - Move 1200: WHITE YZZIGZAG [0 6 6]->[0 6 8] (Move)
2025-11-28 18:16:28,162 - game3d.game.turnmove - INFO - Move 100: BLACK ORBITER [3 5 4]->[3 6 1] (Capture)
2025-11-28 18:16:29,348 - game3d.game.turnmove - INFO - Move 700: BLACK SWAPPER [4 5 2]->[4 4 1] (Move)
2025-11-28 18:16:31,257 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:16:31,257 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:16:33,562 - game3d.game.turnmove - INFO - Move 1300: WHITE YZZIGZAG [0 6 8]->[0 6 6] (Move)
2025-11-28 18:16:35,820 - game3d.game.turnmove - INFO - Move 800: BLACK ARMOUR [4 3 0]->[5 4 0] (Move)
2025-11-28 18:16:37,431 - game3d.game.turnmove - INFO - Move 200: WHITE KING [4 4 0]->[4 4 2] (Capture)
2025-11-28 18:16:37,651 - game3d.game.turnmove - INFO - Move 200: WHITE ROOK [5 5 1]->[5 5 8] (Capture)
2025-11-28 18:16:39,106 - game3d.game.turnmove - INFO - Move 1400: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:16:41,261 - game3d.game.turnmove - INFO - Move 600: BLACK EDGEROOK [6 8 8]->[8 4 3] (Capture)
2025-11-28 18:16:41,462 - game3d.game.turnmove - INFO - Move 900: BLACK ARMOUR [5 4 0]->[4 3 0] (Move)
2025-11-28 18:16:45,021 - game3d.game.turnmove - INFO - Move 1500: WHITE YZZIGZAG [0 6 0]->[0 6 5] (Move)
2025-11-28 18:16:45,631 - game3d.game.turnmove - INFO - Move 300: WHITE KNIGHT [3 4 4]->[4 4 6] (Capture)
2025-11-28 18:16:49,787 - game3d.game.turnmove - INFO - Move 1000: WHITE XZZIGZAG [3 8 6]->[7 8 6] (Capture)
2025-11-28 18:16:50,384 - game3d.game.turnmove - INFO - Move 1600: WHITE YZZIGZAG [0 6 8]->[0 6 5] (Move)
2025-11-28 18:16:52,302 - game3d.game.turnmove - INFO - Move 400: WHITE ORBITER [8 0 2]->[8 0 6] (Capture)
2025-11-28 18:16:55,013 - game3d.game.turnmove - INFO - Move 300: WHITE KNIGHT32 [0 5 2]->[2 7 6] (Move)
2025-11-28 18:16:56,510 - game3d.game.turnmove - INFO - Move 1700: WHITE YZZIGZAG [0 6 6]->[0 6 8] (Move)
2025-11-28 18:16:57,029 - game3d.game.turnmove - INFO - Move 500: BLACK EDGEROOK [2 0 8]->[5 4 0] (Move)
2025-11-28 18:16:57,090 - game3d.game.turnmove - INFO - Move 700: WHITE SLOWER [4 2 3]->[4 3 4] (Move)
2025-11-28 18:16:58,907 - game3d.game.turnmove - INFO - Move 1100: WHITE SPIRAL [4 5 8]->[3 4 8] (Move)
2025-11-28 18:17:00,003 - game3d.game.turnmove - INFO - Move 500: BLACK BISHOP [6 7 0]->[5 6 0] (Capture)
2025-11-28 18:17:02,676 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 106 pieces - possible stalemate
2025-11-28 18:17:02,678 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:17:02,678 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:17:03,538 - game3d.game.turnmove - INFO - Move 1800: WHITE YZZIGZAG [0 6 0]->[0 6 5] (Move)
2025-11-28 18:17:04,769 - game3d.game.turnmove - INFO - Move 600: BLACK SLOWER [5 7 5]->[5 6 5] (Move)
2025-11-28 18:17:06,284 - game3d.game.turnmove - INFO - Move 400: WHITE TRIGONALBISHOP [2 3 3]->[4 5 5] (Capture)
2025-11-28 18:17:08,922 - game3d.game.turnmove - INFO - Move 1200: WHITE SPIRAL [3 4 8]->[5 4 8] (Move)
2025-11-28 18:17:08,954 - game3d.game.turnmove - INFO - Move 600: BLACK GEOMANCER [4 6 8]->[5 3 7] (Move)
2025-11-28 18:17:09,909 - game3d.game.turnmove - INFO - Move 800: WHITE ARCHER [6 2 3]->[6 3 3] (Move)
2025-11-28 18:17:11,761 - game3d.game.turnmove - INFO - Move 1900: WHITE YZZIGZAG [0 6 1]->[0 6 2] (Move)
2025-11-28 18:17:12,987 - game3d.game.turnmove - INFO - Move 700: WHITE GEOMANCER [4 6 0]->[5 7 2] (Move)
2025-11-28 18:17:14,530 - game3d.game.turnmove - INFO - Move 500: WHITE ORBITER [0 5 3]->[1 5 6] (Capture)
2025-11-28 18:17:14,956 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:17:14,957 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:17:17,993 - game3d.game.turnmove - INFO - Move 700: WHITE ARCHER [2 6 2]->[3 5 2] (Move)
2025-11-28 18:17:18,374 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:17:18,375 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:17:18,847 - game3d.game.turnmove - INFO - Move 1300: WHITE SPIRAL [5 4 8]->[4 5 8] (Move)
2025-11-28 18:17:18,965 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:17:18,965 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:17:19,436 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:17:19,436 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:17:19,581 - game3d.game.turnmove - INFO - Move 900: WHITE SPEEDER [5 4 1]->[5 5 0] (Move)
2025-11-28 18:17:19,831 - game3d.game.turnmove - INFO - Move 2000: WHITE YZZIGZAG [0 6 1]->[0 6 5] (Move)
2025-11-28 18:17:20,889 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:17:20,889 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:17:21,055 - game3d.game.turnmove - INFO - Move 800: WHITE XZZIGZAG [1 1 0]->[3 1 0] (Move)
2025-11-28 18:17:23,173 - game3d.game.turnmove - INFO - Move 600: WHITE FREEZER [5 7 5]->[6 8 6] (Capture)
2025-11-28 18:17:23,527 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:17:23,528 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:17:25,854 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:17:25,854 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:17:27,734 - game3d.game.turnmove - INFO - Move 800: WHITE BOMB [3 3 7]->[3 3 7] (Capture)
2025-11-28 18:17:28,001 - game3d.game.turnmove - INFO - Move 1400: WHITE SPIRAL [4 5 8]->[3 4 8] (Move)
2025-11-28 18:17:28,399 - game3d.game.turnmove - INFO - Move 1000: WHITE PAWN [1 0 2]->[1 1 2] (Move)
2025-11-28 18:17:28,671 - game3d.game.turnmove - INFO - Move 2100: WHITE YZZIGZAG [0 6 2]->[0 6 3] (Move)
2025-11-28 18:17:29,990 - game3d.game.turnmove - INFO - Move 900: WHITE BISHOP [8 5 0]->[6 3 0] (Move)
2025-11-28 18:17:31,354 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 69 pieces - possible stalemate
2025-11-28 18:17:31,355 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:17:31,355 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:17:31,825 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 68 pieces - possible stalemate
2025-11-28 18:17:31,827 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:17:31,827 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:17:32,720 - game3d.game.turnmove - INFO - Move 700: WHITE SPEEDER [1 2 2]->[2 1 2] (Capture)
2025-11-28 18:17:34,435 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 66 pieces - possible stalemate
2025-11-28 18:17:34,436 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:17:34,436 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:17:36,402 - game3d.game.turnmove - INFO - Move 900: WHITE XZZIGZAG [8 2 1]->[6 2 2] (Move)
2025-11-28 18:17:36,672 - game3d.game.turnmove - INFO - Move 1500: WHITE SPIRAL [4 5 8]->[3 4 8] (Move)
2025-11-28 18:17:37,067 - game3d.game.turnmove - INFO - Move 1100: WHITE PAWN [6 6 0]->[6 7 0] (Move)
2025-11-28 18:17:37,342 - game3d.game.turnmove - INFO - Move 2200: WHITE YZZIGZAG [0 6 0]->[0 6 1] (Move)
2025-11-28 18:17:38,660 - game3d.game.turnmove - INFO - Move 1000: WHITE REFLECTOR [4 6 2]->[7 1 7] (Capture)
2025-11-28 18:17:41,718 - game3d.game.turnmove - INFO - Move 800: BLACK SPIRAL [1 1 0]->[1 7 0] (Capture)
2025-11-28 18:17:42,436 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:17:42,436 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:17:42,926 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:17:42,926 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:17:43,448 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:17:43,448 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:17:44,471 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:17:44,471 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:17:45,000 - game3d.game.turnmove - INFO - Move 1000: WHITE XZZIGZAG [5 0 3]->[4 0 3] (Move)
2025-11-28 18:17:45,261 - game3d.game.turnmove - INFO - Move 1600: WHITE SPIRAL [3 4 8]->[5 4 8] (Move)
2025-11-28 18:17:45,445 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:17:45,445 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:17:45,847 - game3d.game.turnmove - INFO - Move 2300: WHITE YZZIGZAG [0 6 6]->[0 6 8] (Move)
2025-11-28 18:17:46,951 - game3d.game.turnmove - INFO - Move 1200: WHITE SPEEDER [4 3 8]->[5 3 7] (Move)
2025-11-28 18:17:47,076 - game3d.game.turnmove - INFO - Move 1100: BLACK PAWN [6 1 7]->[6 0 7] (Move)
2025-11-28 18:17:50,880 - game3d.game.turnmove - INFO - Move 900: BLACK PAWN [7 0 5]->[7 1 4] (Move)
2025-11-28 18:17:52,964 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 18 pieces - possible stalemate
2025-11-28 18:17:52,967 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 18 pieces completely immobilized)
2025-11-28 18:17:52,968 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 18 pieces completely immobilized)
2025-11-28 18:17:52,968 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 18 pieces completely immobilized)
2025-11-28 18:17:52,974 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 18 pieces completely immobilized)
2025-11-28 18:17:52,975 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 18 pieces completely immobilized)
2025-11-28 18:17:53,499 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:17:53,499 - game3d.cache.manager - DEBUG - Created cache manager #4 for board 139818706124032
2025-11-28 18:17:53,528 - game3d.game.turnmove - INFO - Move 1700: WHITE SPIRAL [5 4 8]->[4 5 8] (Move)
2025-11-28 18:17:54,161 - game3d.game.turnmove - INFO - Move 2400: WHITE YZZIGZAG [0 6 8]->[0 6 6] (Move)
2025-11-28 18:17:54,535 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:17:54,538 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 27 pieces completely immobilized)
2025-11-28 18:17:54,538 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 27 pieces completely immobilized)
2025-11-28 18:17:54,539 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 27 pieces completely immobilized)
2025-11-28 18:17:54,550 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 27 pieces completely immobilized)
2025-11-28 18:17:54,551 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 27 pieces completely immobilized)
2025-11-28 18:17:55,207 - game3d.game.turnmove - INFO - Move 1300: WHITE WHITEHOLE [4 4 7]->[4 6 7] (Move)
2025-11-28 18:17:55,328 - game3d.game.turnmove - INFO - Move 1200: BLACK PAWN [6 1 7]->[6 0 7] (Move)
2025-11-28 18:17:55,377 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:17:55,378 - game3d.cache.manager - DEBUG - Created cache manager #4 for board 139687720364464
2025-11-28 18:17:59,249 - game3d.game.turnmove - INFO - Move 1000: BLACK YZZIGZAG [0 2 7]->[0 2 8] (Move)
2025-11-28 18:18:02,597 - game3d.game.turnmove - INFO - Move 2500: WHITE YZZIGZAG [0 6 6]->[0 6 8] (Move)
2025-11-28 18:18:02,818 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 40 pieces - possible stalemate
2025-11-28 18:18:02,819 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:18:02,819 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:18:03,099 - game3d.game.turnmove - INFO - Move 100: WHITE XZQUEEN [3 0 5]->[4 1 6] (Capture)
2025-11-28 18:18:03,656 - game3d.game.turnmove - INFO - Move 1400: WHITE SPEEDER [3 5 7]->[4 4 7] (Move)
2025-11-28 18:18:03,772 - game3d.game.turnmove - INFO - Move 1300: BLACK EDGEROOK [8 5 5]->[8 4 3] (Move)
2025-11-28 18:18:06,235 - game3d.game.turnmove - INFO - Move 100: WHITE FRIENDLYTELEPORTER [7 2 0]->[0 1 7] (Capture)
2025-11-28 18:18:07,680 - game3d.game.turnmove - INFO - Move 1100: WHITE WHITEHOLE [2 4 6]->[3 3 7] (Move)
2025-11-28 18:18:10,879 - game3d.game.turnmove - INFO - Move 2600: WHITE YZZIGZAG [0 6 6]->[0 6 8] (Move)
2025-11-28 18:18:11,564 - game3d.game.turnmove - INFO - Move 200: WHITE PAWN [6 3 2]->[5 4 1] (Capture)
2025-11-28 18:18:11,965 - game3d.game.turnmove - INFO - Move 1500: WHITE SPEEDER [3 5 7]->[4 5 8] (Move)
2025-11-28 18:18:12,088 - game3d.game.turnmove - INFO - Move 1400: BLACK PAWN [6 0 7]->[6 1 7] (Move)
2025-11-28 18:18:15,983 - game3d.game.turnmove - INFO - Move 1200: WHITE BISHOP [2 5 8]->[4 7 8] (Move)
2025-11-28 18:18:19,075 - game3d.game.turnmove - INFO - Move 2700: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:18:20,104 - game3d.game.turnmove - INFO - Move 1600: WHITE SPEEDER [3 5 7]->[4 5 8] (Move)
2025-11-28 18:18:20,225 - game3d.game.turnmove - INFO - Move 1500: BLACK EDGEROOK [8 4 3]->[8 5 0] (Move)
2025-11-28 18:18:22,483 - game3d.game.turnmove - INFO - Move 200: WHITE INFILTRATOR [3 8 8]->[4 7 7] (Capture)
2025-11-28 18:18:23,996 - game3d.game.turnmove - INFO - Move 1300: WHITE WALL [5 4 8]->[4 4 8] (Move)
2025-11-28 18:18:24,040 - game3d.game.turnmove - INFO - Move 300: BLACK ORBITER [5 7 6]->[5 8 3] (Capture)
2025-11-28 18:18:27,042 - game3d.game.turnmove - INFO - Move 2800: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:18:28,055 - game3d.game.turnmove - INFO - Move 1700: WHITE WHITEHOLE [4 3 8]->[4 5 8] (Move)
2025-11-28 18:18:28,185 - game3d.game.turnmove - INFO - Move 1600: BLACK EDGEROOK [8 4 3]->[8 5 0] (Move)
2025-11-28 18:18:31,863 - game3d.game.turnmove - INFO - Move 1400: WHITE BISHOP [4 4 5]->[4 1 8] (Move)
2025-11-28 18:18:34,887 - game3d.game.turnmove - INFO - Move 2900: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:18:35,933 - game3d.game.turnmove - INFO - Move 1800: WHITE WHITEHOLE [4 3 8]->[5 4 8] (Move)
2025-11-28 18:18:36,043 - game3d.game.turnmove - INFO - Move 1700: BLACK EDGEROOK [8 4 0]->[8 4 3] (Move)
2025-11-28 18:18:39,759 - game3d.game.turnmove - INFO - Move 1500: WHITE BISHOP [4 7 8]->[4 4 5] (Move)
2025-11-28 18:18:39,766 - game3d.game.turnmove - INFO - Move 300: WHITE NEBULA [3 5 1]->[4 4 2] (Move)
2025-11-28 18:18:41,016 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 8 pieces - possible stalemate
2025-11-28 18:18:41,018 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 8 pieces completely immobilized)
2025-11-28 18:18:41,019 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 8 pieces completely immobilized)
2025-11-28 18:18:41,020 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 8 pieces completely immobilized)
2025-11-28 18:18:41,031 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 8 pieces completely immobilized)
2025-11-28 18:18:41,032 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 8 pieces completely immobilized)
2025-11-28 18:18:42,001 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:18:42,001 - game3d.cache.manager - DEBUG - Created cache manager #5 for board 139956767066096
2025-11-28 18:18:42,539 - game3d.game.turnmove - INFO - Move 3000: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:18:43,459 - game3d.game.turnmove - INFO - Move 1900: WHITE PAWN [3 8 1]->[3 7 1] (Move)
2025-11-28 18:18:43,549 - game3d.game.turnmove - INFO - Move 1800: BLACK EDGEROOK [8 4 3]->[8 5 0] (Move)
2025-11-28 18:18:49,825 - game3d.game.turnmove - INFO - Move 3100: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:18:50,656 - game3d.game.turnmove - INFO - Move 2000: WHITE TRAILBLAZER [4 4 7]->[4 4 8] (Move)
2025-11-28 18:18:50,785 - game3d.game.turnmove - INFO - Move 1900: WHITE FREEZER [2 2 8]->[3 3 7] (Move)
2025-11-28 18:18:51,952 - game3d.game.turnmove - INFO - Move 100: WHITE PANEL [6 2 0]->[6 2 8] (Capture)
2025-11-28 18:18:52,147 - game3d.game.turnmove - INFO - Move 400: BLACK INFILTRATOR [5 3 6]->[7 4 0] (Capture)
2025-11-28 18:18:56,824 - game3d.game.turnmove - INFO - Move 400: WHITE TRAILBLAZER [4 5 0]->[4 8 0] (Move)
2025-11-28 18:18:57,099 - game3d.game.turnmove - INFO - Move 3200: WHITE YZZIGZAG [0 6 3]->[0 6 2] (Move)
2025-11-28 18:18:58,009 - game3d.game.turnmove - INFO - Move 2100: WHITE TRAILBLAZER [4 4 7]->[4 4 8] (Move)
2025-11-28 18:18:58,126 - game3d.game.turnmove - INFO - Move 2000: WHITE YZZIGZAG [0 2 3]->[0 2 7] (Move)
2025-11-28 18:18:59,276 - game3d.game.turnmove - INFO - Piece captured by Trailblazer counters at [4 3 7]
2025-11-28 18:19:00,783 - game3d.game.turnmove - INFO - Move 200: BLACK MIRROR [5 0 7]->[5 1 7] (Capture)
2025-11-28 18:19:04,662 - game3d.game.turnmove - INFO - Move 3300: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:19:05,452 - game3d.game.turnmove - INFO - Move 2200: WHITE SPIRAL [4 4 7]->[5 4 8] (Move)
2025-11-28 18:19:05,578 - game3d.game.turnmove - INFO - Move 2100: WHITE YZZIGZAG [0 2 2]->[0 2 3] (Move)
2025-11-28 18:19:10,309 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 147 pieces - possible stalemate
2025-11-28 18:19:10,311 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:10,311 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:10,885 - game3d.game.turnmove - INFO - Move 500: WHITE PAWN [7 0 2]->[7 1 2] (Move)
2025-11-28 18:19:11,932 - game3d.game.turnmove - INFO - Move 300: WHITE WHITEHOLE [0 6 1]->[0 4 3] (Move)
2025-11-28 18:19:12,322 - game3d.game.turnmove - INFO - Move 3400: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:19:12,744 - game3d.game.turnmove - INFO - Move 500: BLACK PANEL [3 4 6]->[4 4 5] (Move)
2025-11-28 18:19:13,369 - game3d.game.turnmove - INFO - Move 2300: WHITE SPIRAL [4 5 8]->[3 4 8] (Move)
2025-11-28 18:19:13,495 - game3d.game.turnmove - INFO - Move 2200: WHITE BISHOP [4 4 7]->[4 5 8] (Move)
2025-11-28 18:19:20,500 - game3d.game.turnmove - INFO - Move 400: WHITE YZZIGZAG [8 2 2]->[8 2 6] (Move)
2025-11-28 18:19:20,790 - game3d.game.turnmove - INFO - Move 3500: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:19:21,370 - game3d.game.turnmove - INFO - Move 600: BLACK PANEL [5 4 0]->[4 3 0] (Move)
2025-11-28 18:19:21,548 - game3d.game.turnmove - INFO - Move 600: WHITE BOMB [3 5 7]->[3 5 7] (Capture)
2025-11-28 18:19:21,762 - game3d.game.turnmove - INFO - Move 2400: WHITE SPIRAL [5 4 8]->[4 5 8] (Move)
2025-11-28 18:19:21,924 - game3d.game.turnmove - INFO - Move 2300: WHITE BISHOP [4 4 7]->[4 5 8] (Move)
2025-11-28 18:19:23,247 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:23,247 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:23,943 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:23,943 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:24,264 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:24,264 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:24,576 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:24,576 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:25,930 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:25,931 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:26,230 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:26,230 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:26,649 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 58 pieces - possible stalemate
2025-11-28 18:19:26,650 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:26,650 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:27,230 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:27,230 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:27,639 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:27,639 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:28,327 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:28,328 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:28,773 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:28,773 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:29,021 - game3d.game.turnmove - INFO - Move 3600: WHITE YZZIGZAG [0 6 6]->[0 6 7] (Move)
2025-11-28 18:19:29,070 - game3d.game.turnmove - INFO - Move 500: WHITE NEBULA [5 4 0]->[4 4 1] (Move)
2025-11-28 18:19:29,180 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:29,180 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:29,691 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:29,691 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:29,906 - game3d.game.turnmove - INFO - Move 2400: WHITE BISHOP [4 5 8]->[4 4 7] (Move)
2025-11-28 18:19:29,954 - game3d.game.turnmove - INFO - Move 700: BLACK KNIGHT [7 4 5]->[7 3 3] (Capture)
2025-11-28 18:19:30,169 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:30,169 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:30,476 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:30,476 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:31,132 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:31,132 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:31,194 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 45 pieces - possible stalemate
2025-11-28 18:19:31,194 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:31,194 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:31,437 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:31,437 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:31,453 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 45 pieces - possible stalemate
2025-11-28 18:19:31,453 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:31,453 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:31,602 - game3d.game.turnmove - INFO - Move 2500: WHITE FREEZER [3 1 8]->[3 2 8] (Move)
2025-11-28 18:19:32,604 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 44 pieces - possible stalemate
2025-11-28 18:19:32,604 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:32,604 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:32,926 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 86 pieces - possible stalemate
2025-11-28 18:19:32,927 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:32,927 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:33,007 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 44 pieces - possible stalemate
2025-11-28 18:19:33,007 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:33,008 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:33,257 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 44 pieces - possible stalemate
2025-11-28 18:19:33,258 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:33,258 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:33,349 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 86 pieces - possible stalemate
2025-11-28 18:19:33,350 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:33,350 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:33,536 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 44 pieces - possible stalemate
2025-11-28 18:19:33,537 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:33,537 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:33,776 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 43 pieces - possible stalemate
2025-11-28 18:19:33,776 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:33,776 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:34,385 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 86 pieces - possible stalemate
2025-11-28 18:19:34,386 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:34,386 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:35,976 - game3d.game.turnmove - INFO - Move 700: BLACK BISHOP [4 4 3]->[4 1 0] (Move)
2025-11-28 18:19:36,839 - game3d.game.turnmove - INFO - Move 3700: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:19:37,718 - game3d.game.turnmove - INFO - Move 2500: WHITE BISHOP [4 5 8]->[4 4 7] (Move)
2025-11-28 18:19:37,722 - game3d.game.turnmove - INFO - Move 600: BLACK SLOWER [5 4 0]->[5 3 1] (Move)
2025-11-28 18:19:37,910 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:37,910 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:38,291 - game3d.game.turnmove - INFO - Move 800: WHITE FREEZER [8 0 1]->[6 2 3] (Move)
2025-11-28 18:19:38,941 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:38,942 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:39,565 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:39,565 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:39,847 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 85 pieces - possible stalemate
2025-11-28 18:19:39,847 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:39,848 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:39,889 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:39,889 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:40,206 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:40,206 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:40,894 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:40,894 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:41,249 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:41,250 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:41,592 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:41,592 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:42,316 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:42,316 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:42,639 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:42,639 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:42,946 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:42,946 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:44,601 - game3d.game.turnmove - INFO - Move 800: BLACK BOMB [2 5 7]->[1 4 6] (Move)
2025-11-28 18:19:45,297 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:45,297 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:45,526 - game3d.game.turnmove - INFO - Move 3800: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:19:45,636 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:45,636 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:46,251 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:46,251 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:46,405 - game3d.game.turnmove - INFO - Move 2600: WHITE BISHOP [4 5 8]->[4 4 7] (Move)
2025-11-28 18:19:46,545 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:46,545 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:46,565 - game3d.game.turnmove - INFO - Move 700: WHITE WALL [1 1 1]->[3 1 1] (Move)
2025-11-28 18:19:46,942 - game3d.game.turnmove - INFO - Move 900: WHITE FREEZER [3 5 7]->[4 4 7] (Move)
2025-11-28 18:19:48,688 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 56 pieces - possible stalemate
2025-11-28 18:19:48,689 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:48,689 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:49,299 - game3d.game.turnmove - INFO - Move 2700: BLACK EDGEROOK [8 4 3]->[8 5 0] (Move)
2025-11-28 18:19:52,253 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:52,253 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:53,065 - game3d.game.turnmove - INFO - Move 900: BLACK FREEZER [5 3 1]->[5 4 0] (Move)
2025-11-28 18:19:53,086 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:53,086 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:53,385 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:53,385 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:53,938 - game3d.game.turnmove - INFO - Move 3900: WHITE YZZIGZAG [0 6 5]->[0 6 6] (Move)
2025-11-28 18:19:54,041 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:54,041 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:54,330 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:54,331 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:54,617 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:19:54,618 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:19:54,820 - game3d.game.turnmove - INFO - Move 2700: WHITE BISHOP [4 4 7]->[4 5 8] (Move)
2025-11-28 18:19:55,417 - game3d.game.turnmove - INFO - Move 1000: WHITE FREEZER [3 4 8]->[3 3 7] (Move)
2025-11-28 18:19:55,689 - game3d.game.turnmove - INFO - Move 800: BLACK SLOWER [3 2 5]->[3 3 4] (Capture)
2025-11-28 18:19:58,301 - game3d.game.turnmove - INFO - Move 2800: BLACK EDGEROOK [8 4 0]->[8 4 3] (Move)
2025-11-28 18:20:01,952 - game3d.game.turnmove - INFO - Move 1000: BLACK WHITEHOLE [4 3 0]->[5 4 0] (Move)
2025-11-28 18:20:02,690 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:02,690 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:02,880 - game3d.game.turnmove - INFO - Move 4000: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:20:03,656 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:03,657 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:03,758 - game3d.game.turnmove - INFO - Move 2800: WHITE BISHOP [4 5 8]->[4 4 7] (Move)
2025-11-28 18:20:04,356 - game3d.game.turnmove - INFO - Move 1100: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:20:04,616 - game3d.game.turnmove - INFO - Move 900: BLACK PAWN [8 5 6]->[8 4 6] (Move)
2025-11-28 18:20:04,669 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:04,669 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:04,956 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:04,956 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:05,255 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:05,256 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:07,034 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:07,034 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:07,291 - game3d.game.turnmove - INFO - Move 2900: BLACK EDGEROOK [8 5 0]->[8 4 0] (Move)
2025-11-28 18:20:08,052 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:08,052 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:08,331 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:08,331 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:08,648 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:08,649 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:10,451 - game3d.game.turnmove - INFO - Move 1100: BLACK WHITEHOLE [4 5 0]->[5 4 0] (Move)
2025-11-28 18:20:11,078 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:11,078 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:11,341 - game3d.game.turnmove - INFO - Move 4100: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:20:12,097 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:12,097 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:12,251 - game3d.game.turnmove - INFO - Move 2900: WHITE FREEZER [3 3 7]->[4 2 7] (Move)
2025-11-28 18:20:12,387 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:12,388 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:12,675 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:12,675 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:12,795 - game3d.game.turnmove - INFO - Move 1200: WHITE FREEZER [3 4 7]->[3 3 7] (Move)
2025-11-28 18:20:13,046 - game3d.game.turnmove - INFO - Move 1000: BLACK SPIRAL [4 4 7]->[4 4 6] (Move)
2025-11-28 18:20:13,463 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:13,463 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:13,778 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:13,778 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:15,553 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:15,553 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:16,173 - game3d.game.turnmove - INFO - Move 3000: BLACK EDGEROOK [8 0 2]->[8 4 3] (Move)
2025-11-28 18:20:16,583 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:16,583 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:17,473 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 19 pieces - possible stalemate
2025-11-28 18:20:17,476 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 19 pieces completely immobilized)
2025-11-28 18:20:17,476 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 19 pieces completely immobilized)
2025-11-28 18:20:17,477 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 19 pieces completely immobilized)
2025-11-28 18:20:17,494 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 19 pieces completely immobilized)
2025-11-28 18:20:17,494 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 19 pieces completely immobilized)
2025-11-28 18:20:18,183 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:18,183 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:18,763 - game3d.game.turnmove - INFO - Move 1200: BLACK WHITEHOLE [4 3 0]->[5 4 0] (Move)
2025-11-28 18:20:18,789 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:18,789 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:19,074 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:19,074 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:19,190 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:20:19,191 - game3d.cache.manager - DEBUG - Created cache manager #3 for board 140643910573056
2025-11-28 18:20:19,368 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:19,368 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:19,565 - game3d.game.turnmove - INFO - Move 4200: WHITE YZZIGZAG [0 6 6]->[0 6 0] (Move)
2025-11-28 18:20:20,988 - game3d.game.turnmove - INFO - Move 1300: WHITE FREEZER [3 4 8]->[3 5 7] (Move)
2025-11-28 18:20:21,238 - game3d.game.turnmove - INFO - Move 1100: BLACK EDGEROOK [8 4 3]->[8 5 0] (Move)
2025-11-28 18:20:21,847 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:21,847 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:22,677 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 9 pieces - possible stalemate
2025-11-28 18:20:22,681 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 9 pieces - possible stalemate
2025-11-28 18:20:22,681 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 9 pieces completely immobilized)
2025-11-28 18:20:22,681 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 9 pieces completely immobilized)
2025-11-28 18:20:22,682 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 9 pieces completely immobilized)
2025-11-28 18:20:22,692 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 9 pieces completely immobilized)
2025-11-28 18:20:22,693 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 9 pieces completely immobilized)
2025-11-28 18:20:22,886 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:22,887 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:23,202 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:23,202 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:23,410 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:20:23,410 - game3d.cache.manager - DEBUG - Created cache manager #5 for board 139813757898416
2025-11-28 18:20:23,509 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:23,510 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:24,130 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:24,130 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:24,433 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:24,433 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:24,731 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:24,731 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:25,137 - game3d.game.turnmove - INFO - Move 3100: BLACK PAWN [0 1 7]->[0 0 7] (Move)
2025-11-28 18:20:25,363 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:25,363 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:25,638 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:25,638 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:25,956 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:25,956 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:26,569 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:26,569 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:26,887 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:26,888 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:27,204 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:27,204 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:27,585 - game3d.game.turnmove - INFO - Move 4300: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:20:27,662 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:27,663 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:27,967 - game3d.game.turnmove - INFO - Move 100: WHITE BLACKHOLE [6 0 1]->[4 0 3] (Move)
2025-11-28 18:20:28,140 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:28,140 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:28,407 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:28,407 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:28,973 - game3d.game.turnmove - INFO - Move 1400: WHITE FREEZER [3 5 7]->[4 4 7] (Move)
2025-11-28 18:20:29,066 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:29,066 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:29,232 - game3d.game.turnmove - INFO - Move 1200: BLACK SPIRAL [6 6 6]->[4 4 6] (Move)
2025-11-28 18:20:29,365 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:29,365 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:29,649 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:29,649 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:29,892 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 12 pieces - possible stalemate
2025-11-28 18:20:29,894 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 12 pieces completely immobilized)
2025-11-28 18:20:29,895 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 12 pieces completely immobilized)
2025-11-28 18:20:29,895 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 12 pieces completely immobilized)
2025-11-28 18:20:29,902 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 12 pieces completely immobilized)
2025-11-28 18:20:29,903 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 12 pieces completely immobilized)
2025-11-28 18:20:30,648 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:20:30,648 - game3d.cache.manager - DEBUG - Created cache manager #6 for board 139961741219952
2025-11-28 18:20:31,370 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:31,370 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:32,378 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:32,378 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:32,779 - game3d.game.turnmove - INFO - Move 100: BLACK ARMOUR [5 1 6]->[5 1 5] (Move)
2025-11-28 18:20:33,396 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:33,396 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:33,678 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:33,679 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:33,982 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:33,982 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:34,282 - game3d.game.turnmove - INFO - Move 3200: WHITE SPEEDER [4 4 7]->[3 3 7] (Move)
2025-11-28 18:20:35,837 - game3d.game.turnmove - INFO - Move 4400: WHITE YZZIGZAG [0 6 6]->[0 6 7] (Move)
2025-11-28 18:20:36,509 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:36,509 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:36,651 - game3d.game.turnmove - INFO - Move 200: BLACK SWAPPER [1 5 8]->[2 5 8] (Move)
2025-11-28 18:20:36,827 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:36,827 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:37,137 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:37,137 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:37,238 - game3d.game.turnmove - INFO - Move 1500: WHITE WALL [5 4 8]->[4 4 8] (Move)
2025-11-28 18:20:39,883 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:39,883 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:39,930 - game3d.game.turnmove - INFO - Move 100: BLACK SPIRAL [8 7 7]->[3 7 2] (Capture)
2025-11-28 18:20:40,199 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:40,199 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:40,486 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:40,486 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:40,804 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:40,804 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:41,378 - game3d.game.turnmove - INFO - Move 200: BLACK PANEL [6 1 6]->[6 2 6] (Move)
2025-11-28 18:20:41,426 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:41,426 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:43,001 - game3d.game.turnmove - INFO - Move 3300: WHITE HIVE [5 1 8]->[5 2 8] (Move)
2025-11-28 18:20:43,159 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:43,159 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:43,441 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:43,441 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:43,730 - game3d.game.turnmove - INFO - Move 4500: WHITE YZZIGZAG [0 6 0]->[0 6 1] (Move)
2025-11-28 18:20:43,783 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:43,783 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:45,112 - game3d.game.turnmove - INFO - Move 1600: WHITE FREEZER [3 4 8]->[3 5 7] (Move)
2025-11-28 18:20:45,914 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:45,914 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:46,866 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:46,866 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:47,508 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:47,508 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:47,815 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:47,815 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:48,133 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:48,133 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:48,462 - game3d.game.turnmove - INFO - Move 300: BLACK PAWN [5 8 6]->[5 7 6] (Move)
2025-11-28 18:20:49,704 - game3d.game.turnmove - INFO - Move 300: BLACK GEOMANCER [2 2 6]->[5 1 3] (Move)
2025-11-28 18:20:51,732 - game3d.game.turnmove - INFO - Move 3400: WHITE FREEZER [4 7 7]->[3 6 8] (Move)
2025-11-28 18:20:51,939 - game3d.game.turnmove - INFO - Move 4600: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:20:52,927 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:52,927 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:53,003 - game3d.game.turnmove - INFO - Move 200: WHITE PANEL [4 5 8]->[4 4 7] (Move)
2025-11-28 18:20:53,196 - game3d.game.turnmove - INFO - Move 1700: WHITE FREEZER [4 4 7]->[3 5 7] (Move)
2025-11-28 18:20:53,245 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:53,246 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:53,538 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:53,538 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:56,718 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:56,718 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:57,030 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:57,030 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:57,304 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:57,304 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:57,880 - game3d.game.turnmove - INFO - Move 400: BLACK ARCHER [4 1 6]->[3 2 5] (Move)
2025-11-28 18:20:57,890 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:57,890 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:58,130 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:58,130 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:58,409 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:20:58,409 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:20:59,478 - game3d.game.turnmove - INFO - Move 400: WHITE WHITEHOLE [1 3 3]->[1 4 4] (Move)
2025-11-28 18:20:59,511 - game3d.game.turnmove - INFO - Move 4700: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:21:00,210 - game3d.game.turnmove - INFO - Move 3500: BLACK EDGEROOK [8 5 0]->[8 4 0] (Move)
2025-11-28 18:21:00,352 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:21:00,352 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:21:00,801 - game3d.game.turnmove - INFO - Move 1800: WHITE FREEZER [3 5 7]->[4 4 7] (Move)
2025-11-28 18:21:02,938 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:21:02,938 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:21:03,895 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:21:03,896 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:21:04,875 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:21:04,876 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:21:05,301 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:21:05,302 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:21:05,874 - game3d.game.turnmove - INFO - Move 500: BLACK SPIRAL [1 0 8]->[3 2 8] (Move)
2025-11-28 18:21:06,397 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:21:06,397 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:21:06,834 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:21:06,834 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:21:07,048 - game3d.game.turnmove - INFO - Move 4800: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:21:07,187 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:21:07,187 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:21:07,400 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 110 pieces - possible stalemate
2025-11-28 18:21:07,402 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:21:07,402 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:21:08,115 - game3d.game.turnmove - INFO - Move 1900: WHITE FREEZER [3 4 8]->[3 5 7] (Move)
2025-11-28 18:21:08,237 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:21:08,238 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:21:08,693 - game3d.game.turnmove - INFO - Move 3600: WHITE FREEZER [5 3 7]->[4 3 8] (Move)
2025-11-28 18:21:09,507 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:21:09,507 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:21:10,767 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:21:10,767 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:21:11,238 - game3d.game.turnmove - INFO - Move 300: WHITE PANEL [5 4 8]->[6 4 8] (Capture)
2025-11-28 18:21:11,705 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:21:11,705 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:21:13,257 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:21:13,257 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:21:13,523 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:21:13,523 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:21:14,192 - game3d.game.turnmove - INFO - Move 4900: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:21:14,359 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:21:14,359 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:21:15,300 - game3d.game.turnmove - INFO - Move 2000: WHITE PAWN [6 4 3]->[6 5 3] (Move)
2025-11-28 18:21:15,491 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:21:15,491 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:21:15,760 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:21:15,760 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:21:15,776 - game3d.game.turnmove - INFO - Move 600: WHITE PAWN [7 1 2]->[6 2 2] (Move)
2025-11-28 18:21:15,887 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 10 pieces - possible stalemate
2025-11-28 18:21:15,890 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 10 pieces completely immobilized)
2025-11-28 18:21:15,891 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 10 pieces completely immobilized)
2025-11-28 18:21:15,891 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 10 pieces completely immobilized)
2025-11-28 18:21:15,919 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 10 pieces completely immobilized)
2025-11-28 18:21:15,920 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 10 pieces completely immobilized)
2025-11-28 18:21:16,328 - game3d.game.turnmove - INFO - Move 500: WHITE PANEL [4 4 1]->[4 4 0] (Move)
2025-11-28 18:21:18,208 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:21:18,208 - game3d.cache.manager - DEBUG - Created cache manager #5 for board 140358043974096
2025-11-28 18:21:19,713 - game3d.game.turnmove - INFO - Move 5000: WHITE YZZIGZAG [0 6 1]->[0 6 7] (Move)
2025-11-28 18:21:20,708 - game3d.game.turnmove - INFO - Move 2100: WHITE FREEZER [4 4 7]->[3 3 7] (Move)
2025-11-28 18:21:25,976 - game3d.game.turnmove - INFO - Move 5100: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:21:27,085 - game3d.game.turnmove - INFO - Move 2200: WHITE MIRROR [3 4 8]->[4 4 7] (Move)
2025-11-28 18:21:27,867 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:21:27,867 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:21:28,246 - game3d.game.turnmove - INFO - Move 100: WHITE ROOK [3 3 2]->[3 3 6] (Capture)
2025-11-28 18:21:28,689 - game3d.game.turnmove - INFO - Move 400: WHITE PANEL [4 3 8]->[5 4 8] (Move)
2025-11-28 18:21:31,185 - game3d.game.turnmove - INFO - Move 700: WHITE WHITEHOLE [8 6 1]->[7 7 2] (Move)
2025-11-28 18:21:31,929 - game3d.game.turnmove - INFO - Move 5200: WHITE YZZIGZAG [0 6 3]->[0 6 4] (Move)
2025-11-28 18:21:32,698 - game3d.game.turnmove - INFO - Move 2300: WHITE MIRROR [3 4 8]->[4 4 7] (Move)
2025-11-28 18:21:32,902 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 103 pieces - possible stalemate
2025-11-28 18:21:32,904 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:21:32,904 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:21:35,994 - game3d.game.turnmove - INFO - Move 600: WHITE BLACKHOLE [4 0 3]->[4 1 4] (Capture)
2025-11-28 18:21:38,425 - game3d.game.turnmove - INFO - Move 5300: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:21:39,613 - game3d.game.turnmove - INFO - Move 2400: WHITE MIRROR [4 4 7]->[3 4 8] (Move)
2025-11-28 18:21:39,675 - game3d.game.turnmove - INFO - Move 800: BLACK PANEL [8 7 7]->[7 7 6] (Move)
2025-11-28 18:21:45,599 - game3d.game.turnmove - INFO - Move 5400: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:21:46,310 - game3d.game.turnmove - INFO - Move 700: WHITE SPIRAL [8 8 0]->[6 6 0] (Move)
2025-11-28 18:21:46,792 - game3d.game.turnmove - INFO - Move 2500: WHITE FREEZER [3 4 8]->[3 5 7] (Move)
2025-11-28 18:21:47,303 - game3d.game.turnmove - INFO - Move 500: WHITE PANEL [5 4 8]->[4 3 8] (Move)
2025-11-28 18:21:47,411 - game3d.game.turnmove - INFO - Move 900: BLACK BOMB [2 7 6]->[3 7 5] (Move)
2025-11-28 18:21:49,713 - game3d.game.turnmove - INFO - Move 200: WHITE ROOK [4 5 8]->[4 3 8] (Move)
2025-11-28 18:21:53,099 - game3d.game.turnmove - INFO - Move 5500: WHITE YZZIGZAG [0 6 3]->[0 6 4] (Move)
2025-11-28 18:21:54,336 - game3d.game.turnmove - INFO - Move 2600: WHITE PAWN [6 5 3]->[6 6 3] (Move)
2025-11-28 18:21:54,944 - game3d.game.turnmove - INFO - Move 1000: WHITE SLOWER [4 4 7]->[3 3 7] (Move)
2025-11-28 18:21:55,700 - game3d.game.turnmove - INFO - Move 800: WHITE BLACKHOLE [5 2 8]->[4 3 8] (Move)
2025-11-28 18:21:56,935 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 38 pieces - possible stalemate
2025-11-28 18:21:56,935 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:21:56,935 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:21:59,821 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:21:59,821 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:22:00,580 - game3d.game.turnmove - INFO - Move 5600: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:22:01,876 - game3d.game.turnmove - INFO - Move 2700: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:22:02,634 - game3d.game.turnmove - INFO - Move 1100: BLACK PAWN [4 0 6]->[5 1 5] (Move)
2025-11-28 18:22:03,879 - game3d.game.turnmove - INFO - Move 600: BLACK PANEL [5 4 0]->[4 3 0] (Move)
2025-11-28 18:22:03,962 - game3d.game.turnmove - INFO - Move 900: WHITE BLACKHOLE [5 2 8]->[4 3 8] (Move)
2025-11-28 18:22:08,574 - game3d.game.turnmove - INFO - Move 5700: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:22:08,793 - game3d.game.turnmove - INFO - Move 300: WHITE ROOK [4 5 8]->[4 3 8] (Move)
2025-11-28 18:22:09,757 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 14 pieces - possible stalemate
2025-11-28 18:22:09,759 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 14 pieces completely immobilized)
2025-11-28 18:22:09,759 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 14 pieces completely immobilized)
2025-11-28 18:22:09,760 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 14 pieces completely immobilized)
2025-11-28 18:22:09,768 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 14 pieces completely immobilized)
2025-11-28 18:22:09,769 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 14 pieces completely immobilized)
2025-11-28 18:22:09,877 - game3d.game.turnmove - INFO - Move 2800: WHITE FREEZER [3 5 7]->[3 6 6] (Move)
2025-11-28 18:22:10,502 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:22:10,503 - game3d.cache.manager - DEBUG - Created cache manager #6 for board 139813763823456
2025-11-28 18:22:12,071 - game3d.game.turnmove - INFO - Move 1000: WHITE BLACKHOLE [4 4 7]->[5 4 8] (Move)
2025-11-28 18:22:15,480 - game3d.game.turnmove - INFO - Move 5800: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:22:16,541 - game3d.game.turnmove - INFO - Move 2900: WHITE PAWN [5 7 4]->[5 8 4] (Move)
2025-11-28 18:22:19,809 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:22:19,809 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:22:20,182 - game3d.game.turnmove - INFO - Move 700: WHITE PANEL [4 4 7]->[3 4 8] (Move)
2025-11-28 18:22:20,299 - game3d.game.turnmove - INFO - Move 100: WHITE SLOWER [7 7 2]->[6 8 3] (Capture)
2025-11-28 18:22:21,910 - game3d.game.turnmove - INFO - Move 5900: WHITE YZZIGZAG [0 6 4]->[0 6 5] (Move)
2025-11-28 18:22:22,750 - game3d.game.turnmove - INFO - Move 1100: BLACK PANEL [4 6 0]->[4 5 0] (Move)
2025-11-28 18:22:23,033 - game3d.game.turnmove - INFO - Move 3000: WHITE MIRROR [3 4 8]->[2 5 8] (Move)
2025-11-28 18:22:28,850 - game3d.game.turnmove - INFO - Move 200: BLACK INFILTRATOR [5 6 8]->[5 6 7] (Move)
2025-11-28 18:22:29,131 - game3d.game.turnmove - INFO - Move 6000: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:22:30,392 - game3d.game.turnmove - INFO - Move 3100: WHITE FREEZER [3 5 7]->[3 4 8] (Move)
2025-11-28 18:22:30,839 - game3d.game.turnmove - INFO - Move 1200: BLACK PANEL [5 8 1]->[4 8 0] (Move)
2025-11-28 18:22:33,074 - game3d.game.turnmove - INFO - Move 400: WHITE ROOK [4 5 8]->[4 3 8] (Move)
2025-11-28 18:22:35,877 - game3d.game.turnmove - INFO - Move 800: WHITE PANEL [2 5 7]->[3 4 8] (Move)
2025-11-28 18:22:36,809 - game3d.game.turnmove - INFO - Move 6100: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:22:37,099 - game3d.game.turnmove - INFO - Move 300: BLACK WHITEHOLE [8 2 6]->[7 3 7] (Move)
2025-11-28 18:22:38,101 - game3d.game.turnmove - INFO - Move 3200: WHITE FREEZER [4 4 8]->[5 4 7] (Move)
2025-11-28 18:22:38,869 - game3d.game.turnmove - INFO - Move 1300: BLACK PANEL [4 7 0]->[4 6 0] (Move)
2025-11-28 18:22:44,590 - game3d.game.turnmove - INFO - Move 6200: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:22:45,043 - game3d.game.turnmove - INFO - Move 400: BLACK SPIRAL [3 6 2]->[6 6 2] (Capture)
2025-11-28 18:22:45,756 - game3d.game.turnmove - INFO - Move 3300: WHITE MIRROR [3 4 8]->[4 4 7] (Move)
2025-11-28 18:22:47,259 - game3d.game.turnmove - INFO - Move 1400: BLACK BISHOP [6 6 0]->[5 5 0] (Move)
2025-11-28 18:22:50,677 - game3d.game.turnmove - INFO - Move 6300: WHITE YZZIGZAG [0 6 5]->[0 6 6] (Move)
2025-11-28 18:22:51,670 - game3d.game.turnmove - INFO - Move 3400: WHITE FREEZER [4 4 7]->[3 5 7] (Move)
2025-11-28 18:22:55,575 - game3d.game.turnmove - INFO - Move 500: BLACK PAWN [2 3 6]->[3 2 5] (Capture)
2025-11-28 18:22:56,525 - game3d.game.turnmove - INFO - Move 6400: WHITE YZZIGZAG [0 6 4]->[0 6 5] (Move)
2025-11-28 18:22:56,853 - game3d.game.turnmove - INFO - Move 900: WHITE PANEL [4 6 8]->[4 5 8] (Move)
2025-11-28 18:22:57,071 - game3d.game.turnmove - INFO - Move 1500: BLACK BISHOP [6 6 0]->[5 5 0] (Move)
2025-11-28 18:22:57,427 - game3d.game.turnmove - INFO - Move 3500: WHITE FREEZER [3 4 8]->[3 5 7] (Move)
2025-11-28 18:23:02,589 - game3d.game.turnmove - INFO - Move 6500: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:23:03,567 - game3d.game.turnmove - INFO - Move 3600: WHITE WALL [5 4 8]->[4 4 8] (Move)
2025-11-28 18:23:05,331 - game3d.game.turnmove - INFO - Move 500: BLACK SPIRAL [4 3 0]->[5 4 0] (Move)
2025-11-28 18:23:06,431 - game3d.game.turnmove - INFO - Move 1600: BLACK BISHOP [6 6 0]->[5 5 0] (Move)
2025-11-28 18:23:08,597 - game3d.game.turnmove - INFO - Move 6600: WHITE YZZIGZAG [0 6 3]->[0 6 4] (Move)
2025-11-28 18:23:09,560 - game3d.game.turnmove - INFO - Move 3700: WHITE PAWN [6 8 1]->[5 7 0] (Move)
2025-11-28 18:23:14,409 - game3d.game.turnmove - INFO - Move 600: BLACK ARCHER [1 5 6]->[2 5 5] (Move)
2025-11-28 18:23:14,678 - game3d.game.turnmove - INFO - Move 6700: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:23:15,677 - game3d.game.turnmove - INFO - Move 3800: WHITE FREEZER [3 4 8]->[3 5 7] (Move)
2025-11-28 18:23:15,980 - game3d.game.turnmove - INFO - Move 1700: BLACK BISHOP [6 6 0]->[5 5 0] (Move)
2025-11-28 18:23:18,706 - game3d.game.turnmove - INFO - Move 1000: WHITE QUEEN [3 4 8]->[4 4 7] (Move)
2025-11-28 18:23:20,747 - game3d.game.turnmove - INFO - Move 6800: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:23:21,770 - game3d.game.turnmove - INFO - Move 3900: WHITE MIRROR [3 3 8]->[4 4 7] (Move)
2025-11-28 18:23:23,737 - game3d.game.turnmove - INFO - Move 600: BLACK SPIRAL [4 5 0]->[5 5 0] (Capture)
2025-11-28 18:23:24,996 - game3d.game.turnmove - INFO - Move 1800: BLACK BISHOP [6 6 0]->[5 5 0] (Move)
2025-11-28 18:23:26,488 - game3d.game.turnmove - INFO - Move 6900: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:23:27,365 - game3d.game.turnmove - INFO - Move 4000: WHITE FREEZER [3 3 7]->[3 4 8] (Move)
2025-11-28 18:23:32,390 - game3d.game.turnmove - INFO - Move 7000: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:23:33,350 - game3d.game.turnmove - INFO - Move 4100: WHITE WALL [5 4 8]->[4 4 8] (Move)
2025-11-28 18:23:33,430 - game3d.game.turnmove - INFO - Move 1900: BLACK BISHOP [6 6 0]->[5 5 0] (Move)
2025-11-28 18:23:38,244 - game3d.game.turnmove - INFO - Move 7100: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:23:39,278 - game3d.game.turnmove - INFO - Move 4200: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:23:41,709 - game3d.game.turnmove - INFO - Move 2000: BLACK BISHOP [6 6 0]->[5 5 0] (Move)
2025-11-28 18:23:43,088 - game3d.game.turnmove - INFO - Move 1100: WHITE QUEEN [4 3 8]->[5 4 8] (Move)
2025-11-28 18:23:43,314 - game3d.game.turnmove - INFO - Move 700: BLACK SPIRAL [3 4 0]->[4 5 0] (Move)
2025-11-28 18:23:43,972 - game3d.game.turnmove - INFO - Move 700: WHITE PAWN [0 7 1]->[1 8 2] (Move)
2025-11-28 18:23:44,367 - game3d.game.turnmove - INFO - Move 7200: WHITE YZZIGZAG [0 6 5]->[0 6 6] (Move)
2025-11-28 18:23:45,302 - game3d.game.turnmove - INFO - Move 4300: WHITE WALL [3 4 7]->[4 4 7] (Move)
2025-11-28 18:23:48,924 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:23:48,925 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:23:49,689 - game3d.game.turnmove - INFO - Move 2100: BLACK BISHOP [6 6 0]->[5 5 0] (Move)
2025-11-28 18:23:50,152 - game3d.game.turnmove - INFO - Move 7300: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:23:50,852 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:23:50,852 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:23:50,905 - game3d.game.turnmove - INFO - Move 4400: WHITE FREEZER [4 4 7]->[3 5 7] (Move)
2025-11-28 18:23:56,050 - game3d.game.turnmove - INFO - Move 7400: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:23:57,013 - game3d.game.turnmove - INFO - Move 4500: WHITE FREEZER [3 5 7]->[3 4 8] (Move)
2025-11-28 18:23:58,706 - game3d.game.turnmove - INFO - Move 2200: WHITE BISHOP [4 1 8]->[4 4 5] (Move)
2025-11-28 18:24:02,270 - game3d.game.turnmove - INFO - Move 7500: WHITE YZZIGZAG [0 6 5]->[0 6 6] (Move)
2025-11-28 18:24:02,481 - game3d.game.turnmove - INFO - Move 800: BLACK SPIRAL [5 4 0]->[4 5 0] (Move)
2025-11-28 18:24:02,707 - game3d.game.turnmove - INFO - Move 800: BLACK KNIGHT [4 4 0]->[6 5 0] (Capture)
2025-11-28 18:24:03,508 - game3d.game.turnmove - INFO - Move 4600: WHITE FREEZER [3 4 8]->[3 5 7] (Move)
2025-11-28 18:24:07,801 - game3d.game.turnmove - INFO - Move 2300: WHITE SPIRAL [4 5 8]->[3 4 8] (Move)
2025-11-28 18:24:08,142 - game3d.game.turnmove - INFO - Move 7600: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:24:09,193 - game3d.game.turnmove - INFO - Move 4700: WHITE MIRROR [3 4 8]->[4 4 7] (Move)
2025-11-28 18:24:12,451 - game3d.game.turnmove - INFO - Move 1200: WHITE QUEEN [4 5 8]->[4 3 8] (Move)
2025-11-28 18:24:14,808 - game3d.game.turnmove - INFO - Move 900: BLACK GEOMANCER [0 1 3]->[2 3 3] (Move)
2025-11-28 18:24:15,593 - game3d.game.turnmove - INFO - Move 7700: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:24:15,721 - game3d.game.turnmove - INFO - Move 2400: WHITE SPIRAL [5 4 8]->[4 5 8] (Move)
2025-11-28 18:24:16,914 - game3d.game.turnmove - INFO - Move 4800: WHITE FREEZER [4 4 7]->[3 3 7] (Move)
2025-11-28 18:24:17,506 - game3d.game.turnmove - INFO - Move 900: WHITE SPEEDER [5 8 4]->[6 8 5] (Capture)
2025-11-28 18:24:22,942 - game3d.game.turnmove - INFO - Move 1000: BLACK SPIRAL [5 4 0]->[4 5 0] (Move)
2025-11-28 18:24:23,745 - game3d.game.turnmove - INFO - Move 7800: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:24:23,882 - game3d.game.turnmove - INFO - Move 2500: WHITE SPIRAL [3 4 8]->[4 5 8] (Move)
2025-11-28 18:24:25,025 - game3d.game.turnmove - INFO - Move 4900: WHITE WALL [5 4 8]->[4 4 8] (Move)
2025-11-28 18:24:25,098 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 118 pieces - possible stalemate
2025-11-28 18:24:25,099 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:24:25,099 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:24:25,603 - game3d.game.turnmove - INFO - Move 1000: WHITE WALL [6 6 2]->[6 5 2] (Move)
2025-11-28 18:24:31,772 - game3d.game.turnmove - INFO - Move 1100: WHITE EDGEROOK [8 6 4]->[8 6 6] (Move)
2025-11-28 18:24:31,811 - game3d.game.turnmove - INFO - Move 7900: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:24:31,972 - game3d.game.turnmove - INFO - Move 2600: WHITE REFLECTOR [6 0 6]->[5 1 5] (Move)
2025-11-28 18:24:33,159 - game3d.game.turnmove - INFO - Move 5000: WHITE FREEZER [3 5 7]->[4 4 7] (Move)
2025-11-28 18:24:33,387 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 51 pieces - possible stalemate
2025-11-28 18:24:33,388 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:24:33,388 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:24:33,641 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 50 pieces - possible stalemate
2025-11-28 18:24:33,642 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:24:33,642 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:24:33,840 - game3d.game.turnmove - INFO - Move 1100: BLACK FRIENDLYTELEPORTER [4 1 6]->[3 1 5] (Move)
2025-11-28 18:24:33,915 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 50 pieces - possible stalemate
2025-11-28 18:24:33,916 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:24:33,916 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:24:34,289 - game3d.game.turnmove - INFO - Move 1300: WHITE QUEEN [4 4 7]->[5 4 8] (Move)
2025-11-28 18:24:39,935 - game3d.game.turnmove - INFO - Move 8000: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:24:39,938 - game3d.game.turnmove - INFO - Move 1200: WHITE PANEL [3 4 8]->[4 5 8] (Move)
2025-11-28 18:24:40,386 - game3d.game.turnmove - INFO - Move 2700: BLACK FRIENDLYTELEPORTER [4 3 0]->[5 4 0] (Move)
2025-11-28 18:24:41,266 - game3d.game.turnmove - INFO - Move 5100: WHITE MIRROR [3 4 8]->[4 4 7] (Move)
2025-11-28 18:24:42,003 - game3d.game.turnmove - INFO - Move 1200: WHITE SPEEDER [0 3 4]->[0 4 5] (Move)
2025-11-28 18:24:48,153 - game3d.game.turnmove - INFO - Move 8100: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:24:48,153 - game3d.game.turnmove - INFO - Move 1300: WHITE PANEL [4 5 8]->[3 4 8] (Move)
2025-11-28 18:24:48,593 - game3d.game.turnmove - INFO - Move 2800: BLACK PAWN [8 3 5]->[8 2 5] (Move)
2025-11-28 18:24:49,493 - game3d.game.turnmove - INFO - Move 5200: WHITE WALL [4 4 8]->[5 4 8] (Move)
2025-11-28 18:24:50,237 - game3d.game.turnmove - INFO - Move 1300: BLACK BISHOP [3 3 0]->[6 6 0] (Move)
2025-11-28 18:24:56,297 - game3d.game.turnmove - INFO - Move 8200: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:24:56,299 - game3d.game.turnmove - INFO - Move 1400: WHITE PANEL [4 5 8]->[3 4 8] (Move)
2025-11-28 18:24:56,739 - game3d.game.turnmove - INFO - Move 2900: BLACK YZZIGZAG [8 2 0]->[8 2 1] (Move)
2025-11-28 18:24:57,646 - game3d.game.turnmove - INFO - Move 5300: WHITE WALL [5 4 8]->[4 4 8] (Move)
2025-11-28 18:24:57,934 - game3d.game.turnmove - INFO - Move 1400: WHITE QUEEN [4 4 7]->[3 4 8] (Move)
2025-11-28 18:24:58,362 - game3d.game.turnmove - INFO - Move 1400: BLACK FRIENDLYTELEPORTER [5 4 0]->[6 3 0] (Move)
2025-11-28 18:25:04,449 - game3d.game.turnmove - INFO - Move 8300: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:25:04,449 - game3d.game.turnmove - INFO - Move 1500: WHITE PANEL [5 4 8]->[4 5 8] (Move)
2025-11-28 18:25:04,922 - game3d.game.turnmove - INFO - Move 3000: BLACK YZZIGZAG [8 2 1]->[8 2 4] (Move)
2025-11-28 18:25:05,841 - game3d.game.turnmove - INFO - Move 5400: WHITE FREEZER [3 5 7]->[3 4 8] (Move)
2025-11-28 18:25:06,589 - game3d.game.turnmove - INFO - Move 1500: BLACK PAWN [8 5 5]->[7 6 4] (Move)
2025-11-28 18:25:12,648 - game3d.game.turnmove - INFO - Move 8400: WHITE YZZIGZAG [0 6 4]->[0 6 5] (Move)
2025-11-28 18:25:12,651 - game3d.game.turnmove - INFO - Move 1600: WHITE PANEL [4 5 8]->[5 4 8] (Move)
2025-11-28 18:25:13,107 - game3d.game.turnmove - INFO - Move 3100: BLACK YZZIGZAG [8 2 0]->[8 2 1] (Move)
2025-11-28 18:25:13,995 - game3d.game.turnmove - INFO - Move 5500: WHITE FREEZER [3 5 8]->[3 5 7] (Move)
2025-11-28 18:25:14,689 - game3d.game.turnmove - INFO - Move 1600: BLACK FREEZER [5 6 0]->[4 7 0] (Move)
2025-11-28 18:25:17,608 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:25:17,608 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:25:19,318 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 8 pieces - possible stalemate
2025-11-28 18:25:19,321 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 8 pieces completely immobilized)
2025-11-28 18:25:19,321 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 8 pieces completely immobilized)
2025-11-28 18:25:19,322 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 8 pieces completely immobilized)
2025-11-28 18:25:19,337 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 8 pieces completely immobilized)
2025-11-28 18:25:19,338 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 8 pieces completely immobilized)
2025-11-28 18:25:19,694 - game3d.game.turnmove - INFO - Move 8500: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:25:20,094 - game3d.game.turnmove - INFO - Move 3200: BLACK YZZIGZAG [8 2 0]->[8 2 1] (Move)
2025-11-28 18:25:20,514 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:25:20,514 - game3d.cache.manager - DEBUG - Created cache manager #6 for board 140358127663856
2025-11-28 18:25:20,747 - game3d.game.turnmove - INFO - Move 5600: WHITE MIRROR [4 4 7]->[3 4 8] (Move)
2025-11-28 18:25:23,671 - game3d.game.turnmove - INFO - Move 1500: BLACK XZQUEEN [6 1 8]->[5 1 7] (Move)
2025-11-28 18:25:26,533 - game3d.game.turnmove - INFO - Move 8600: WHITE YZZIGZAG [0 6 5]->[0 6 6] (Move)
2025-11-28 18:25:26,959 - game3d.game.turnmove - INFO - Move 3300: BLACK YZZIGZAG [8 2 1]->[8 2 0] (Move)
2025-11-28 18:25:27,710 - game3d.game.turnmove - INFO - Move 5700: WHITE FREEZER [3 3 7]->[2 3 7] (Move)
2025-11-28 18:25:31,745 - game3d.game.turnmove - INFO - Move 100: WHITE ARMOUR [5 1 1]->[5 1 2] (Capture)
2025-11-28 18:25:32,781 - game3d.game.turnmove - INFO - Move 1700: BLACK BISHOP [4 7 0]->[4 4 3] (Move)
2025-11-28 18:25:33,606 - game3d.game.turnmove - INFO - Move 8700: WHITE YZZIGZAG [0 6 6]->[0 6 7] (Move)
2025-11-28 18:25:34,288 - game3d.game.turnmove - INFO - Move 3400: BLACK YZZIGZAG [8 2 0]->[8 2 1] (Move)
2025-11-28 18:25:34,909 - game3d.game.turnmove - INFO - Move 5800: WHITE FREEZER [5 3 7]->[6 2 7] (Move)
2025-11-28 18:25:40,690 - game3d.game.turnmove - INFO - Move 200: WHITE KNIGHT31 [7 4 7]->[4 5 8] (Capture)
2025-11-28 18:25:40,937 - game3d.game.turnmove - INFO - Move 8800: WHITE YZZIGZAG [0 6 2]->[0 6 3] (Move)
2025-11-28 18:25:41,722 - game3d.game.turnmove - INFO - Move 3500: BLACK YZZIGZAG [8 2 3]->[8 2 4] (Move)
2025-11-28 18:25:42,213 - game3d.game.turnmove - INFO - Move 5900: WHITE FREEZER [3 4 8]->[3 5 7] (Move)
2025-11-28 18:25:48,249 - game3d.game.turnmove - INFO - Move 8900: WHITE YZZIGZAG [0 6 3]->[0 6 4] (Move)
2025-11-28 18:25:49,177 - game3d.game.turnmove - INFO - Move 3600: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-11-28 18:25:49,521 - game3d.game.turnmove - INFO - Move 1800: BLACK FREEZER [1 6 6]->[2 5 5] (Move)
2025-11-28 18:25:49,654 - game3d.game.turnmove - INFO - Move 300: WHITE ORBITER [8 4 0]->[8 4 5] (Capture)
2025-11-28 18:25:49,733 - game3d.game.turnmove - INFO - Move 6000: WHITE FREEZER [3 3 7]->[2 2 6] (Move)
2025-11-28 18:25:51,326 - game3d.game.turnmove - INFO - Move 1600: BLACK SPIRAL [3 4 0]->[4 3 0] (Move)
2025-11-28 18:25:55,687 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 57 pieces - possible stalemate
2025-11-28 18:25:55,688 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:25:55,688 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 6]
2025-11-28 18:25:56,186 - game3d.game.turnmove - INFO - Move 9000: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:25:57,094 - game3d.game.turnmove - INFO - Move 3700: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:25:57,601 - game3d.game.turnmove - INFO - Move 6100: WHITE WALL [5 4 8]->[4 4 8] (Move)
2025-11-28 18:25:57,647 - game3d.game.turnmove - INFO - Move 1900: WHITE BLACKHOLE [3 8 1]->[3 7 2] (Move)
2025-11-28 18:26:03,953 - game3d.game.turnmove - INFO - Move 9100: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:26:04,863 - game3d.game.turnmove - INFO - Move 3800: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-11-28 18:26:05,381 - game3d.game.turnmove - INFO - Move 6200: WHITE WALL [5 4 8]->[4 4 8] (Move)
2025-11-28 18:26:05,735 - game3d.game.turnmove - INFO - Move 2000: BLACK ECHO [4 0 6]->[5 1 5] (Move)
2025-11-28 18:26:07,632 - game3d.game.turnmove - INFO - Move 400: WHITE QUEEN [4 3 8]->[4 4 7] (Move)
2025-11-28 18:26:08,996 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 27 pieces - possible stalemate
2025-11-28 18:26:09,001 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 27 pieces completely immobilized)
2025-11-28 18:26:09,001 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 27 pieces completely immobilized)
2025-11-28 18:26:09,002 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 27 pieces completely immobilized)
2025-11-28 18:26:09,054 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 27 pieces completely immobilized)
2025-11-28 18:26:09,055 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 27 pieces completely immobilized)
2025-11-28 18:26:11,009 - game3d.game.turnmove - INFO - Move 9200: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:26:11,768 - game3d.game.turnmove - INFO - Move 3900: BLACK YZZIGZAG [8 2 0]->[8 2 1] (Move)
2025-11-28 18:26:13,601 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:26:13,601 - game3d.cache.manager - DEBUG - Created cache manager #5 for board 139687715420672
2025-11-28 18:26:14,229 - game3d.game.turnmove - INFO - Move 2100: WHITE BOMB [6 3 4]->[5 3 5] (Move)
2025-11-28 18:26:17,674 - game3d.game.turnmove - INFO - Move 9300: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:26:18,462 - game3d.game.turnmove - INFO - Move 1700: BLACK NEBULA [5 5 8]->[4 5 8] (Move)
2025-11-28 18:26:18,709 - game3d.game.turnmove - INFO - Move 4000: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-11-28 18:26:21,564 - game3d.game.turnmove - INFO - Move 2200: WHITE BOMB [6 3 4]->[5 3 5] (Move)
2025-11-28 18:26:23,204 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 21 pieces - possible stalemate
2025-11-28 18:26:23,205 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:26:23,205 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 6]
2025-11-28 18:26:24,118 - game3d.game.turnmove - INFO - Move 100: WHITE YZQUEEN [3 1 0]->[3 1 6] (Capture)
2025-11-28 18:26:24,836 - game3d.game.turnmove - INFO - Move 9400: WHITE YZZIGZAG [0 6 4]->[0 6 5] (Move)
2025-11-28 18:26:25,865 - game3d.game.turnmove - INFO - Move 4100: BLACK YZZIGZAG [8 2 1]->[8 2 2] (Move)
2025-11-28 18:26:27,759 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:26:27,759 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:26:28,077 - game3d.game.turnmove - INFO - Move 500: BLACK PANEL [5 4 0]->[4 3 0] (Move)
2025-11-28 18:26:28,702 - game3d.game.turnmove - INFO - Move 2300: BLACK KNIGHT [2 3 0]->[3 5 0] (Move)
2025-11-28 18:26:32,028 - game3d.game.turnmove - INFO - Move 9500: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:26:33,134 - game3d.game.turnmove - INFO - Move 4200: BLACK YZZIGZAG [8 2 6]->[8 2 7] (Move)
2025-11-28 18:26:34,242 - game3d.game.turnmove - INFO - Move 200: WHITE FRIENDLYTELEPORTER [5 2 7]->[4 3 8] (Capture)
2025-11-28 18:26:36,380 - game3d.game.turnmove - INFO - Move 2400: BLACK EDGEROOK [8 5 0]->[8 4 7] (Move)
2025-11-28 18:26:39,551 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 14 pieces - possible stalemate
2025-11-28 18:26:39,554 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 14 pieces completely immobilized)
2025-11-28 18:26:39,554 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 14 pieces completely immobilized)
2025-11-28 18:26:39,555 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 14 pieces completely immobilized)
2025-11-28 18:26:39,573 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 14 pieces completely immobilized)
2025-11-28 18:26:39,574 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 14 pieces completely immobilized)
2025-11-28 18:26:39,724 - game3d.game.turnmove - INFO - Move 9600: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:26:40,434 - game3d.game.turnmove - INFO - Move 4300: BLACK YZZIGZAG [8 2 5]->[8 2 6] (Move)
2025-11-28 18:26:40,985 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:26:40,985 - game3d.cache.manager - DEBUG - Created cache manager #7 for board 139818632302112
2025-11-28 18:26:44,029 - game3d.game.turnmove - INFO - Move 1800: BLACK QUEEN [5 4 0]->[4 5 0] (Move)
2025-11-28 18:26:44,994 - game3d.game.turnmove - INFO - Move 300: WHITE PANEL [4 4 1]->[4 4 0] (Move)
2025-11-28 18:26:45,174 - game3d.game.turnmove - INFO - Move 9700: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:26:45,980 - game3d.game.turnmove - INFO - Move 4400: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-11-28 18:26:46,622 - game3d.game.turnmove - INFO - Move 600: BLACK PANEL [4 3 0]->[5 4 0] (Move)
2025-11-28 18:26:50,912 - game3d.game.turnmove - INFO - Move 100: WHITE XZQUEEN [6 1 0]->[6 1 1] (Capture)
2025-11-28 18:26:51,249 - game3d.game.turnmove - INFO - Move 9800: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:26:52,376 - game3d.game.turnmove - INFO - Move 4500: BLACK YZZIGZAG [8 2 0]->[8 2 1] (Move)
2025-11-28 18:26:56,667 - game3d.game.turnmove - INFO - Move 400: WHITE ECHO [3 8 1]->[3 7 1] (Move)
2025-11-28 18:26:58,917 - game3d.game.turnmove - INFO - Move 9900: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:26:59,095 - game3d.game.turnmove - INFO - Move 200: BLACK BISHOP [3 4 3]->[3 5 2] (Capture)
2025-11-28 18:26:59,989 - game3d.game.turnmove - INFO - Move 4600: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-11-28 18:27:03,527 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:27:03,527 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:27:04,589 - game3d.game.turnmove - INFO - Move 500: WHITE ECHO [4 8 0]->[4 7 0] (Move)
2025-11-28 18:27:05,204 - game3d.game.turnmove - INFO - Move 700: WHITE BISHOP [5 3 6]->[5 4 7] (Move)
2025-11-28 18:27:06,531 - game3d.game.turnmove - INFO - Move 10000: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:27:07,095 - game3d.game.turnmove - INFO - Move 300: BLACK MIRROR [4 7 8]->[4 6 8] (Move)
2025-11-28 18:27:07,675 - game3d.game.turnmove - INFO - Move 4700: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-11-28 18:27:09,450 - game3d.game.turnmove - INFO - Move 1900: BLACK SPIRAL [4 5 0]->[3 4 0] (Move)
2025-11-28 18:27:12,462 - game3d.game.turnmove - INFO - Move 10100: WHITE YZZIGZAG [0 6 5]->[0 6 6] (Move)
2025-11-28 18:27:13,296 - game3d.game.turnmove - INFO - Move 4800: BLACK YZZIGZAG [8 2 4]->[8 2 5] (Move)
2025-11-28 18:27:16,272 - game3d.game.turnmove - INFO - Move 400: BLACK SPEEDER [0 1 7]->[0 2 7] (Capture)
2025-11-28 18:27:18,286 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:27:18,286 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:27:18,315 - game3d.game.turnmove - INFO - Move 10200: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:27:19,220 - game3d.game.turnmove - INFO - Move 4900: BLACK YZZIGZAG [8 2 5]->[8 2 6] (Move)
2025-11-28 18:27:22,972 - game3d.game.turnmove - INFO - Move 500: WHITE TRAILBLAZER [4 5 0]->[6 5 0] (Move)
2025-11-28 18:27:23,787 - game3d.game.turnmove - INFO - Move 800: WHITE QUEEN [5 4 8]->[3 4 8] (Move)
2025-11-28 18:27:24,597 - game3d.game.turnmove - INFO - Move 10300: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:27:25,591 - game3d.game.turnmove - INFO - Move 5000: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-11-28 18:27:29,782 - game3d.game.turnmove - INFO - Move 600: WHITE HIVE [3 3 2]->[5 5 4] (Move)
2025-11-28 18:27:30,225 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 79 pieces - possible stalemate
2025-11-28 18:27:30,226 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:27:30,226 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:27:30,535 - game3d.game.turnmove - INFO - Move 10400: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:27:31,440 - game3d.game.turnmove - INFO - Move 5100: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:27:34,190 - game3d.game.turnmove - INFO - Move 600: WHITE BLACKHOLE [3 7 4]->[3 7 5] (Capture)
2025-11-28 18:27:35,488 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:27:35,489 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:27:36,402 - game3d.game.turnmove - INFO - Move 10500: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:27:36,705 - game3d.game.turnmove - INFO - Move 700: BLACK GEOMANCER [8 8 7]->[8 5 7] (Move)
2025-11-28 18:27:37,411 - game3d.game.turnmove - INFO - Move 5200: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-11-28 18:27:42,624 - game3d.game.turnmove - INFO - Move 10600: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:27:43,190 - game3d.game.turnmove - INFO - Move 800: BLACK PAWN [1 6 6]->[1 5 6] (Move)
2025-11-28 18:27:43,600 - game3d.game.turnmove - INFO - Move 900: BLACK PANEL [4 3 0]->[5 4 0] (Move)
2025-11-28 18:27:43,719 - game3d.game.turnmove - INFO - Move 5300: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-11-28 18:27:49,091 - game3d.game.turnmove - INFO - Move 10700: WHITE YZZIGZAG [0 6 5]->[0 6 6] (Move)
2025-11-28 18:27:49,710 - game3d.game.turnmove - INFO - Move 900: BLACK SWAPPER [6 6 8]->[6 5 8] (Move)
2025-11-28 18:27:50,242 - game3d.game.turnmove - INFO - Move 5400: BLACK YZZIGZAG [8 2 2]->[8 2 3] (Move)
2025-11-28 18:27:52,783 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:27:52,783 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:27:53,083 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:27:53,084 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:27:53,927 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:27:53,927 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:27:55,250 - game3d.game.turnmove - INFO - Move 10800: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:27:56,417 - game3d.game.turnmove - INFO - Move 5500: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:27:56,452 - game3d.game.turnmove - INFO - Move 1000: WHITE PAWN [8 5 2]->[8 6 2] (Move)
2025-11-28 18:27:59,964 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 33 pieces - possible stalemate
2025-11-28 18:27:59,965 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:27:59,965 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:28:00,895 - game3d.game.turnmove - INFO - Move 1000: BLACK PANEL [3 4 0]->[4 3 0] (Move)
2025-11-28 18:28:01,355 - game3d.game.turnmove - INFO - Move 10900: WHITE YZZIGZAG [0 6 6]->[0 6 7] (Move)
2025-11-28 18:28:02,577 - game3d.game.turnmove - INFO - Move 5600: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-11-28 18:28:03,609 - game3d.game.turnmove - INFO - Move 1100: BLACK PAWN [7 1 5]->[7 0 5] (Move)
2025-11-28 18:28:05,804 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 26 pieces - possible stalemate
2025-11-28 18:28:05,809 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 26 pieces completely immobilized)
2025-11-28 18:28:05,809 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 26 pieces completely immobilized)
2025-11-28 18:28:05,810 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 26 pieces completely immobilized)
2025-11-28 18:28:05,818 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 26 pieces completely immobilized)
2025-11-28 18:28:05,819 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 26 pieces completely immobilized)
2025-11-28 18:28:06,456 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:28:06,457 - game3d.cache.manager - DEBUG - Created cache manager #8 for board 139813756014976
2025-11-28 18:28:07,244 - game3d.game.turnmove - INFO - Move 11000: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:28:08,307 - game3d.game.turnmove - INFO - Move 5700: BLACK YZZIGZAG [8 2 6]->[8 2 7] (Move)
2025-11-28 18:28:11,290 - game3d.game.turnmove - INFO - Move 2000: WHITE QUEEN [4 5 7]->[4 5 8] (Move)
2025-11-28 18:28:12,697 - game3d.game.turnmove - INFO - Move 11100: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:28:14,001 - game3d.game.turnmove - INFO - Move 5800: BLACK YZZIGZAG [8 2 5]->[8 2 6] (Move)
2025-11-28 18:28:16,671 - game3d.game.turnmove - INFO - Move 100: BLACK YZQUEEN [5 1 8]->[5 0 7] (Move)
2025-11-28 18:28:16,852 - game3d.game.turnmove - INFO - Move 700: WHITE BLACKHOLE [4 5 8]->[3 4 8] (Move)
2025-11-28 18:28:18,336 - game3d.game.turnmove - INFO - Move 11200: WHITE YZZIGZAG [0 6 7]->[0 6 3] (Move)
2025-11-28 18:28:19,607 - game3d.game.turnmove - INFO - Move 5900: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:28:19,912 - game3d.game.turnmove - INFO - Move 1100: BLACK SPIRAL [5 4 0]->[4 5 0] (Move)
2025-11-28 18:28:24,082 - game3d.game.turnmove - INFO - Move 11300: WHITE YZZIGZAG [0 6 4]->[0 6 0] (Move)
2025-11-28 18:28:25,052 - game3d.game.turnmove - INFO - Move 200: WHITE REFLECTOR [8 0 0]->[0 8 8] (Capture)
2025-11-28 18:28:25,581 - game3d.game.turnmove - INFO - Move 6000: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:28:29,982 - game3d.game.turnmove - INFO - Move 11400: WHITE YZZIGZAG [0 6 8]->[0 6 4] (Move)
2025-11-28 18:28:31,653 - game3d.game.turnmove - INFO - Move 6100: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:28:32,861 - game3d.game.turnmove - INFO - Move 300: WHITE BOMB [8 5 0]->[7 5 0] (Capture)
2025-11-28 18:28:35,983 - game3d.game.turnmove - INFO - Move 11500: WHITE YZZIGZAG [0 6 4]->[0 6 5] (Move)
2025-11-28 18:28:37,815 - game3d.game.turnmove - INFO - Move 6200: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:28:39,159 - game3d.game.turnmove - INFO - Move 1200: WHITE QUEEN [3 5 7]->[3 4 8] (Move)
2025-11-28 18:28:41,595 - game3d.game.turnmove - INFO - Move 400: WHITE PAWN [3 2 7]->[3 3 7] (Move)
2025-11-28 18:28:41,680 - game3d.game.turnmove - INFO - Move 11600: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:28:43,429 - game3d.game.turnmove - INFO - Move 6300: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:28:47,589 - game3d.game.turnmove - INFO - Move 11700: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:28:49,138 - game3d.game.turnmove - INFO - Move 500: WHITE YZQUEEN [3 5 0]->[3 3 2] (Move)
2025-11-28 18:28:49,553 - game3d.game.turnmove - INFO - Move 6400: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:28:53,256 - game3d.game.turnmove - INFO - Move 11800: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:28:54,929 - game3d.game.turnmove - INFO - Move 6500: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:28:58,388 - game3d.game.turnmove - INFO - Move 11900: WHITE YZZIGZAG [0 6 0]->[0 6 1] (Move)
2025-11-28 18:28:58,751 - game3d.game.turnmove - INFO - Move 800: WHITE BLACKHOLE [3 4 8]->[4 4 7] (Move)
2025-11-28 18:28:59,030 - game3d.game.turnmove - INFO - Move 2100: WHITE QUEEN [4 3 8]->[3 4 8] (Move)
2025-11-28 18:29:00,062 - game3d.game.turnmove - INFO - Move 6600: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-11-28 18:29:00,287 - game3d.game.turnmove - INFO - Move 1300: WHITE QUEEN [3 5 7]->[3 4 8] (Move)
2025-11-28 18:29:00,727 - game3d.game.turnmove - INFO - Move 600: WHITE MIRROR [4 5 0]->[5 4 1] (Move)
2025-11-28 18:29:03,424 - game3d.game.turnmove - INFO - Move 12000: WHITE YZZIGZAG [0 6 6]->[0 6 7] (Move)
2025-11-28 18:29:05,117 - game3d.game.turnmove - INFO - Move 6700: BLACK YZZIGZAG [8 2 6]->[8 2 7] (Move)
2025-11-28 18:29:08,528 - game3d.game.turnmove - INFO - Move 12100: WHITE YZZIGZAG [0 6 4]->[0 6 5] (Move)
2025-11-28 18:29:10,186 - game3d.game.turnmove - INFO - Move 6800: BLACK YZZIGZAG [8 2 4]->[8 2 5] (Move)
2025-11-28 18:29:13,411 - game3d.game.turnmove - INFO - Move 12200: WHITE YZZIGZAG [0 6 6]->[0 6 7] (Move)
2025-11-28 18:29:15,089 - game3d.game.turnmove - INFO - Move 6900: BLACK YZZIGZAG [8 2 2]->[8 2 3] (Move)
2025-11-28 18:29:15,311 - game3d.game.turnmove - INFO - Move 700: BLACK NEBULA [3 3 8]->[4 2 8] (Capture)
2025-11-28 18:29:18,455 - game3d.game.turnmove - INFO - Move 12300: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:29:20,212 - game3d.game.turnmove - INFO - Move 7000: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-11-28 18:29:21,115 - game3d.game.turnmove - INFO - Move 1400: WHITE BISHOP [4 5 7]->[3 5 8] (Move)
2025-11-28 18:29:23,480 - game3d.game.turnmove - INFO - Move 12400: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:29:25,333 - game3d.game.turnmove - INFO - Move 7100: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:29:28,457 - game3d.game.turnmove - INFO - Move 12500: WHITE YZZIGZAG [0 6 2]->[0 6 3] (Move)
2025-11-28 18:29:29,762 - game3d.game.turnmove - INFO - Move 800: WHITE MIRROR [3 4 0]->[4 3 1] (Move)
2025-11-28 18:29:30,454 - game3d.game.turnmove - INFO - Move 7200: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:29:33,443 - game3d.game.turnmove - INFO - Move 12600: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:29:35,436 - game3d.game.turnmove - INFO - Move 7300: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-11-28 18:29:38,776 - game3d.game.turnmove - INFO - Move 12700: WHITE YZZIGZAG [0 6 4]->[0 6 5] (Move)
2025-11-28 18:29:40,872 - game3d.game.turnmove - INFO - Move 7400: BLACK YZZIGZAG [8 2 8]->[8 2 6] (Move)
2025-11-28 18:29:41,295 - game3d.game.turnmove - INFO - Move 1500: WHITE BISHOP [4 8 4]->[4 7 5] (Move)
2025-11-28 18:29:42,989 - game3d.game.turnmove - INFO - Move 900: BLACK WHITEHOLE [6 4 7]->[8 4 5] (Capture)
2025-11-28 18:29:43,921 - game3d.game.turnmove - INFO - Move 12800: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:29:45,440 - game3d.game.turnmove - INFO - Move 2200: WHITE QUEEN [5 4 8]->[4 4 7] (Move)
2025-11-28 18:29:46,149 - game3d.game.turnmove - INFO - Move 7500: BLACK YZZIGZAG [8 2 5]->[8 2 6] (Move)
2025-11-28 18:29:49,299 - game3d.game.turnmove - INFO - Move 12900: WHITE YZZIGZAG [0 6 2]->[0 6 3] (Move)
2025-11-28 18:29:51,664 - game3d.game.turnmove - INFO - Move 7600: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:29:52,449 - game3d.game.turnmove - INFO - Move 1000: BLACK EDGEROOK [7 4 0]->[8 2 1] (Capture)
2025-11-28 18:29:54,609 - game3d.game.turnmove - INFO - Move 900: WHITE FREEZER [0 0 1]->[1 0 0] (Move)
2025-11-28 18:29:55,420 - game3d.game.turnmove - INFO - Move 13000: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:29:57,998 - game3d.game.turnmove - INFO - Move 7700: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-11-28 18:29:58,738 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 39 pieces - possible stalemate
2025-11-28 18:29:58,740 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 39 pieces completely immobilized)
2025-11-28 18:29:58,741 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 39 pieces completely immobilized)
2025-11-28 18:29:58,742 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 39 pieces completely immobilized)
2025-11-28 18:29:58,751 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 39 pieces completely immobilized)
2025-11-28 18:29:58,752 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: WHITE, Reason: 39 pieces completely immobilized)
2025-11-28 18:29:59,475 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:29:59,476 - game3d.cache.manager - DEBUG - Created cache manager #9 for board 139818632302064
2025-11-28 18:29:59,988 - game3d.game.turnmove - INFO - Move 1600: WHITE BISHOP [4 3 7]->[5 3 8] (Move)
2025-11-28 18:30:01,046 - game3d.game.turnmove - INFO - Move 13100: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:30:03,248 - game3d.game.turnmove - INFO - Move 7800: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-11-28 18:30:06,357 - game3d.game.turnmove - INFO - Move 13200: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:30:08,980 - game3d.game.turnmove - INFO - Move 7900: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:30:09,964 - game3d.game.turnmove - INFO - Move 100: BLACK ORBITER [3 6 1]->[3 2 1] (Capture)
2025-11-28 18:30:12,136 - game3d.game.turnmove - INFO - Move 13300: WHITE YZZIGZAG [0 6 4]->[0 6 5] (Move)
2025-11-28 18:30:14,456 - game3d.game.turnmove - INFO - Move 8000: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-11-28 18:30:17,379 - game3d.game.turnmove - INFO - Move 13400: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:30:19,466 - game3d.game.turnmove - INFO - Move 8100: BLACK YZZIGZAG [8 2 7]->[8 2 2] (Move)
2025-11-28 18:30:21,780 - game3d.game.turnmove - INFO - Move 1700: WHITE BISHOP [4 6 8]->[5 5 8] (Move)
2025-11-28 18:30:22,450 - game3d.game.turnmove - INFO - Move 13500: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:30:24,225 - game3d.game.turnmove - INFO - Move 200: WHITE ORBITER [3 3 2]->[3 3 6] (Capture)
2025-11-28 18:30:25,077 - game3d.game.turnmove - INFO - Move 8200: BLACK YZZIGZAG [8 2 4]->[8 2 5] (Move)
2025-11-28 18:30:28,436 - game3d.game.turnmove - INFO - Move 13600: WHITE YZZIGZAG [0 6 0]->[0 6 6] (Move)
2025-11-28 18:30:29,187 - game3d.game.turnmove - INFO - Move 1800: WHITE BISHOP [4 3 7]->[5 3 8] (Move)
2025-11-28 18:30:31,086 - game3d.game.turnmove - INFO - Move 8300: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:30:34,217 - game3d.game.turnmove - INFO - Move 13700: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:30:35,128 - game3d.game.turnmove - INFO - Move 2300: WHITE ARMOUR [5 5 3]->[5 4 4] (Move)
2025-11-28 18:30:36,583 - game3d.game.turnmove - INFO - Move 1900: WHITE BISHOP [3 5 8]->[5 3 8] (Move)
2025-11-28 18:30:37,254 - game3d.game.turnmove - INFO - Move 8400: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-11-28 18:30:40,051 - game3d.game.turnmove - INFO - Move 1000: WHITE BLACKHOLE [4 4 7]->[5 4 8] (Move)
2025-11-28 18:30:40,144 - game3d.game.turnmove - INFO - Move 13800: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:30:41,232 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 144 pieces - possible stalemate
2025-11-28 18:30:41,233 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:30:41,234 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:30:42,769 - game3d.game.turnmove - INFO - Move 8500: BLACK YZZIGZAG [8 2 5]->[8 2 6] (Move)
2025-11-28 18:30:45,661 - game3d.game.turnmove - INFO - Move 13900: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:30:45,768 - game3d.game.turnmove - INFO - Move 2000: BLACK SPIRAL [4 5 0]->[3 4 0] (Move)
2025-11-28 18:30:48,802 - game3d.game.turnmove - INFO - Move 8600: BLACK YZZIGZAG [8 2 7]->[8 2 4] (Move)
2025-11-28 18:30:50,812 - game3d.game.turnmove - INFO - Move 300: WHITE PAWN [6 3 3]->[6 4 3] (Move)
2025-11-28 18:30:51,075 - game3d.game.turnmove - INFO - Move 14000: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:30:53,772 - game3d.game.turnmove - INFO - Move 8700: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-11-28 18:30:55,797 - game3d.game.turnmove - INFO - Move 2100: BLACK BISHOP [4 6 1]->[4 5 0] (Move)
2025-11-28 18:30:56,363 - game3d.game.turnmove - INFO - Move 14100: WHITE YZZIGZAG [0 6 0]->[0 6 1] (Move)
2025-11-28 18:30:59,790 - game3d.game.turnmove - INFO - Move 8800: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-11-28 18:31:02,394 - game3d.game.turnmove - INFO - Move 14200: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:31:03,007 - game3d.game.turnmove - INFO - Move 2200: BLACK BISHOP [4 6 1]->[4 5 0] (Move)
2025-11-28 18:31:06,233 - game3d.game.turnmove - INFO - Move 8900: BLACK YZZIGZAG [8 2 5]->[8 2 6] (Move)
2025-11-28 18:31:08,607 - game3d.game.turnmove - INFO - Move 400: WHITE SPEEDER [0 7 1]->[1 7 2] (Move)
2025-11-28 18:31:09,013 - game3d.game.turnmove - INFO - Move 14300: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:31:09,723 - game3d.game.turnmove - INFO - Move 2300: WHITE SPIRAL [4 5 8]->[5 4 8] (Move)
2025-11-28 18:31:13,521 - game3d.game.turnmove - INFO - Move 9000: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:31:16,324 - game3d.game.turnmove - INFO - Move 500: WHITE FREEZER [3 3 7]->[4 4 8] (Capture)
2025-11-28 18:31:16,644 - game3d.game.turnmove - INFO - Move 14400: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:31:17,338 - game3d.game.turnmove - INFO - Move 2400: WHITE BISHOP [4 7 8]->[4 4 5] (Move)
2025-11-28 18:31:18,229 - game3d.game.turnmove - INFO - Move 1100: WHITE BISHOP [4 4 5]->[4 1 8] (Move)
2025-11-28 18:31:21,132 - game3d.game.turnmove - INFO - Move 9100: BLACK YZZIGZAG [8 2 5]->[8 2 6] (Move)
2025-11-28 18:31:24,031 - game3d.game.turnmove - INFO - Move 600: BLACK SPIRAL [7 2 8]->[6 2 8] (Move)
2025-11-28 18:31:24,290 - game3d.game.turnmove - INFO - Move 14500: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:31:25,030 - game3d.game.turnmove - INFO - Move 2500: WHITE BISHOP [4 8 8]->[4 4 4] (Move)
2025-11-28 18:31:25,948 - game3d.game.turnmove - INFO - Move 2400: WHITE QUEEN [4 4 7]->[5 4 8] (Move)
2025-11-28 18:31:26,566 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 69 pieces - possible stalemate
2025-11-28 18:31:26,566 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:31:26,566 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:31:28,655 - game3d.game.turnmove - INFO - Move 9200: BLACK YZZIGZAG [8 2 2]->[8 2 3] (Move)
2025-11-28 18:31:28,858 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:31:28,858 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:31:31,711 - game3d.game.turnmove - INFO - Move 14600: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:31:32,106 - game3d.game.turnmove - INFO - Move 700: WHITE SPEEDER [3 4 8]->[3 3 7] (Move)
2025-11-28 18:31:32,524 - game3d.game.turnmove - INFO - Move 2600: BLACK BISHOP [4 6 1]->[4 5 0] (Move)
2025-11-28 18:31:33,499 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:31:33,500 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:31:35,496 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:31:35,496 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:31:36,186 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:31:36,186 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:31:36,481 - game3d.game.turnmove - INFO - Move 9300: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:31:36,879 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:31:36,879 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:31:37,254 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 64 pieces - possible stalemate
2025-11-28 18:31:37,255 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:31:37,256 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:31:37,842 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 63 pieces - possible stalemate
2025-11-28 18:31:37,843 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:31:37,843 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:31:38,158 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:31:38,158 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:31:38,844 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:31:38,844 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:31:38,880 - game3d.game.turnmove - INFO - Move 14700: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:31:39,537 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 63 pieces - possible stalemate
2025-11-28 18:31:39,538 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:31:39,538 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:31:39,996 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 63 pieces - possible stalemate
2025-11-28 18:31:39,998 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:31:39,998 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:31:40,019 - game3d.game.turnmove - INFO - Move 2700: BLACK BISHOP [4 6 1]->[4 5 0] (Move)
2025-11-28 18:31:40,289 - game3d.game.turnmove - INFO - Move 800: BLACK HIVE [4 3 0]->[5 4 0] (Move)
2025-11-28 18:31:40,289 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:31:40,289 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:31:40,618 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 63 pieces - possible stalemate
2025-11-28 18:31:40,619 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:31:40,620 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:31:41,074 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 62 pieces - possible stalemate
2025-11-28 18:31:41,076 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:31:41,076 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:31:41,476 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:31:41,476 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:31:42,089 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 61 pieces - possible stalemate
2025-11-28 18:31:42,090 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:31:42,091 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:31:43,041 - game3d.game.turnmove - INFO - Move 9400: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-11-28 18:31:45,683 - game3d.game.turnmove - INFO - Move 14800: WHITE YZZIGZAG [0 6 0]->[0 6 7] (Move)
2025-11-28 18:31:47,616 - game3d.game.turnmove - INFO - Move 2800: BLACK BISHOP [4 4 3]->[4 7 0] (Move)
2025-11-28 18:31:48,405 - game3d.game.turnmove - INFO - Move 900: BLACK BOMB [0 5 8]->[0 5 8] (Capture)
2025-11-28 18:31:50,704 - game3d.game.turnmove - INFO - Move 9500: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:31:50,925 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 26 pieces - possible stalemate
2025-11-28 18:31:50,927 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 26 pieces completely immobilized)
2025-11-28 18:31:50,928 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 26 pieces completely immobilized)
2025-11-28 18:31:50,928 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 26 pieces completely immobilized)
2025-11-28 18:31:50,935 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 26 pieces completely immobilized)
2025-11-28 18:31:50,935 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 26 pieces completely immobilized)
2025-11-28 18:31:51,507 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:31:51,508 - game3d.cache.manager - DEBUG - Created cache manager #10 for board 139813765917152
2025-11-28 18:31:52,619 - game3d.game.turnmove - INFO - Move 1200: WHITE BISHOP [4 4 5]->[4 1 8] (Move)
2025-11-28 18:31:52,834 - game3d.game.turnmove - INFO - Move 14900: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:31:54,983 - game3d.game.turnmove - INFO - Move 2900: BLACK BISHOP [4 4 3]->[4 7 0] (Move)
2025-11-28 18:31:57,144 - game3d.game.turnmove - INFO - Move 9600: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:31:59,579 - game3d.game.turnmove - INFO - Move 15000: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:32:01,197 - game3d.game.turnmove - INFO - Move 100: BLACK YZQUEEN [4 3 0]->[4 4 1] (Move)
2025-11-28 18:32:02,489 - game3d.game.turnmove - INFO - Move 3000: BLACK BISHOP [4 7 0]->[4 4 3] (Move)
2025-11-28 18:32:04,114 - game3d.game.turnmove - INFO - Move 9700: BLACK YZZIGZAG [8 2 2]->[8 2 3] (Move)
2025-11-28 18:32:06,611 - game3d.game.turnmove - INFO - Move 15100: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:32:09,940 - game3d.game.turnmove - INFO - Move 3100: BLACK BISHOP [4 4 3]->[4 7 0] (Move)
2025-11-28 18:32:09,956 - game3d.game.turnmove - INFO - Move 200: WHITE PANEL [4 4 0]->[4 4 1] (Move)
2025-11-28 18:32:11,031 - game3d.game.turnmove - INFO - Move 9800: BLACK YZZIGZAG [8 2 5]->[8 2 6] (Move)
2025-11-28 18:32:13,454 - game3d.game.turnmove - INFO - Move 15200: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:32:16,806 - game3d.game.turnmove - INFO - Move 2500: WHITE QUEEN [4 4 7]->[5 4 8] (Move)
2025-11-28 18:32:17,364 - game3d.game.turnmove - INFO - Move 3200: BLACK BISHOP [4 7 0]->[4 4 3] (Move)
2025-11-28 18:32:17,932 - game3d.game.turnmove - INFO - Move 9900: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-11-28 18:32:18,666 - game3d.game.turnmove - INFO - Move 300: WHITE XZQUEEN [5 7 6]->[3 7 8] (Capture)
2025-11-28 18:32:20,538 - game3d.game.turnmove - INFO - Move 15300: WHITE YZZIGZAG [0 6 4]->[0 6 8] (Move)
2025-11-28 18:32:25,139 - game3d.game.turnmove - INFO - Move 3300: BLACK XZQUEEN [6 7 8]->[1 7 3] (Move)
2025-11-28 18:32:25,435 - game3d.game.turnmove - INFO - Move 10000: BLACK YZZIGZAG [8 2 4]->[8 2 5] (Move)
2025-11-28 18:32:26,554 - game3d.game.turnmove - INFO - Move 400: BLACK PAWN [3 5 7]->[4 4 7] (Move)
2025-11-28 18:32:27,904 - game3d.game.turnmove - INFO - Move 15400: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:32:31,835 - game3d.game.turnmove - INFO - Move 1300: WHITE BLACKHOLE [4 4 7]->[5 4 8] (Move)
2025-11-28 18:32:32,411 - game3d.game.turnmove - INFO - Move 10100: BLACK YZZIGZAG [8 2 3]->[8 2 7] (Move)
2025-11-28 18:32:33,301 - game3d.game.turnmove - INFO - Move 3400: BLACK FREEZER [5 4 8]->[4 5 8] (Capture)
2025-11-28 18:32:34,514 - game3d.game.turnmove - INFO - Move 15500: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:32:37,920 - game3d.game.turnmove - INFO - Move 500: BLACK BLACKHOLE [5 7 6]->[4 6 5] (Capture)
2025-11-28 18:32:38,884 - game3d.game.turnmove - INFO - Move 10200: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:32:39,993 - game3d.game.turnmove - INFO - Move 3500: BLACK PAWN [5 5 5]->[4 5 4] (Capture)
2025-11-28 18:32:40,832 - game3d.game.turnmove - INFO - Move 15600: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:32:45,305 - game3d.game.turnmove - INFO - Move 10300: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:32:46,638 - game3d.game.turnmove - INFO - Move 3600: BLACK SLOWER [1 4 3]->[0 3 2] (Capture)
2025-11-28 18:32:47,061 - game3d.game.turnmove - INFO - Move 15700: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:32:50,754 - game3d.game.turnmove - INFO - Move 10400: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:32:51,739 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 52 pieces - possible stalemate
2025-11-28 18:32:51,740 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:32:51,740 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:32:52,066 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 51 pieces - possible stalemate
2025-11-28 18:32:52,066 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:32:52,066 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:32:52,136 - game3d.game.turnmove - INFO - Move 15800: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:32:54,998 - game3d.game.turnmove - INFO - Move 3700: BLACK SLOWER [5 3 1]->[5 4 0] (Move)
2025-11-28 18:32:56,625 - game3d.game.turnmove - INFO - Move 10500: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:32:58,245 - game3d.game.turnmove - INFO - Move 15900: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:32:59,038 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 41 pieces - possible stalemate
2025-11-28 18:32:59,039 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:32:59,039 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:32:59,524 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 40 pieces - possible stalemate
2025-11-28 18:32:59,525 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:32:59,525 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:32:59,869 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 40 pieces - possible stalemate
2025-11-28 18:32:59,869 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:32:59,869 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:33:01,422 - game3d.game.turnmove - INFO - Move 600: BLACK INFILTRATOR [4 3 8]->[4 4 7] (Move)
2025-11-28 18:33:01,687 - game3d.game.turnmove - INFO - Move 3800: WHITE FRIENDLYTELEPORTER [1 4 6]->[2 5 7] (Move)
2025-11-28 18:33:02,201 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:33:02,201 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:33:02,890 - game3d.game.turnmove - INFO - Move 10600: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:33:04,420 - game3d.game.turnmove - INFO - Move 16000: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:33:08,121 - game3d.game.turnmove - INFO - Move 3900: WHITE SPIRAL [4 3 8]->[4 5 8] (Move)
2025-11-28 18:33:09,560 - game3d.game.turnmove - INFO - Move 10700: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-11-28 18:33:10,868 - game3d.game.turnmove - INFO - Move 16100: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:33:14,735 - game3d.game.turnmove - INFO - Move 4000: BLACK YZZIGZAG [0 2 0]->[0 2 2] (Move)
2025-11-28 18:33:15,220 - game3d.game.turnmove - INFO - Move 700: BLACK QUEEN [8 3 7]->[7 2 7] (Move)
2025-11-28 18:33:16,369 - game3d.game.turnmove - INFO - Move 10800: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:33:17,625 - game3d.game.turnmove - INFO - Move 16200: WHITE YZZIGZAG [0 6 8]->[0 6 3] (Move)
2025-11-28 18:33:21,559 - game3d.game.turnmove - INFO - Move 4100: BLACK YZZIGZAG [8 2 0]->[8 2 1] (Move)
2025-11-28 18:33:22,130 - game3d.game.turnmove - INFO - Move 1400: WHITE ROOK [5 5 8]->[5 4 8] (Move)
2025-11-28 18:33:23,280 - game3d.game.turnmove - INFO - Move 10900: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:33:24,555 - game3d.game.turnmove - INFO - Move 16300: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:33:26,593 - game3d.game.turnmove - INFO - Move 800: BLACK ARCHER [7 4 7]->[7 6 7] (Move)
2025-11-28 18:33:27,673 - game3d.game.turnmove - INFO - Move 2600: WHITE QUEEN [3 4 8]->[4 5 8] (Move)
2025-11-28 18:33:27,764 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:33:27,764 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:33:28,772 - game3d.game.turnmove - INFO - Move 4200: BLACK YZZIGZAG [8 2 1]->[8 2 0] (Move)
2025-11-28 18:33:30,622 - game3d.game.turnmove - INFO - Move 11000: BLACK YZZIGZAG [8 2 6]->[8 2 7] (Move)
2025-11-28 18:33:32,077 - game3d.game.turnmove - INFO - Move 16400: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:33:32,283 - game3d.game.turnmove - INFO - Move 1500: WHITE YZZIGZAG [0 6 0]->[0 6 1] (Move)
2025-11-28 18:33:36,614 - game3d.game.turnmove - INFO - Move 900: BLACK TRIGONALBISHOP [0 5 3]->[1 6 4] (Capture)
2025-11-28 18:33:36,690 - game3d.game.turnmove - INFO - Move 4300: WHITE SPIRAL [5 4 8]->[4 5 8] (Move)
2025-11-28 18:33:37,106 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 50 pieces - possible stalemate
2025-11-28 18:33:37,106 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:33:37,107 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:33:37,833 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:33:37,833 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:33:38,514 - game3d.game.turnmove - INFO - Move 11100: BLACK YZZIGZAG [8 2 2]->[8 2 8] (Move)
2025-11-28 18:33:40,005 - game3d.game.turnmove - INFO - Move 16500: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:33:40,363 - game3d.game.turnmove - INFO - Move 1600: BLACK FREEZER [5 5 1]->[5 4 0] (Move)
2025-11-28 18:33:41,141 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 45 pieces - possible stalemate
2025-11-28 18:33:41,142 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:33:41,142 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:33:42,614 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 45 pieces - possible stalemate
2025-11-28 18:33:42,614 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:33:42,614 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:33:43,173 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 45 pieces - possible stalemate
2025-11-28 18:33:43,174 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:33:43,174 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:33:44,615 - game3d.game.turnmove - INFO - Move 4400: BLACK YZZIGZAG [0 2 1]->[0 2 0] (Move)
2025-11-28 18:33:44,754 - game3d.game.turnmove - INFO - Move 1000: WHITE PAWN [1 3 3]->[1 4 3] (Move)
2025-11-28 18:33:46,470 - game3d.game.turnmove - INFO - Move 11200: BLACK YZZIGZAG [8 2 3]->[8 2 4] (Move)
2025-11-28 18:33:46,844 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 42 pieces - possible stalemate
2025-11-28 18:33:46,845 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:33:46,845 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:33:47,972 - game3d.game.turnmove - INFO - Move 16600: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:33:48,849 - game3d.game.turnmove - INFO - Move 1700: BLACK PAWN [8 5 6]->[8 4 6] (Move)
2025-11-28 18:33:52,745 - game3d.game.turnmove - INFO - Move 4500: BLACK YZZIGZAG [0 2 2]->[0 2 1] (Move)
2025-11-28 18:33:52,950 - game3d.game.turnmove - INFO - Move 1100: WHITE XZZIGZAG [4 7 7]->[8 7 7] (Move)
2025-11-28 18:33:54,629 - game3d.game.turnmove - INFO - Move 11300: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:33:56,135 - game3d.game.turnmove - INFO - Move 16700: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:33:57,027 - game3d.game.turnmove - INFO - Move 1800: BLACK XZZIGZAG [3 7 0]->[4 7 0] (Move)
2025-11-28 18:34:00,850 - game3d.game.turnmove - INFO - Move 4600: BLACK YZZIGZAG [0 2 2]->[0 2 1] (Move)
2025-11-28 18:34:01,057 - game3d.game.turnmove - INFO - Move 1200: WHITE XZZIGZAG [4 7 7]->[8 7 7] (Move)
2025-11-28 18:34:02,726 - game3d.game.turnmove - INFO - Move 11400: BLACK YZZIGZAG [8 2 5]->[8 2 6] (Move)
2025-11-28 18:34:04,217 - game3d.game.turnmove - INFO - Move 16800: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:34:05,119 - game3d.game.turnmove - INFO - Move 1900: BLACK XZZIGZAG [2 7 2]->[6 7 0] (Move)
2025-11-28 18:34:05,358 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 13 pieces - possible stalemate
2025-11-28 18:34:05,362 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 13 pieces completely immobilized)
2025-11-28 18:34:05,362 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 13 pieces completely immobilized)
2025-11-28 18:34:05,363 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 13 pieces completely immobilized)
2025-11-28 18:34:05,376 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 13 pieces completely immobilized)
2025-11-28 18:34:05,377 - game3d.game.terminal - WARNING - Game over: Stalemate - Material Blocked (Player: BLACK, Reason: 13 pieces completely immobilized)
2025-11-28 18:34:07,616 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:34:07,617 - game3d.cache.manager - DEBUG - Created cache manager #6 for board 139687715419424
2025-11-28 18:34:09,214 - game3d.game.turnmove - INFO - Move 4700: BLACK YZZIGZAG [0 2 0]->[0 2 1] (Move)
2025-11-28 18:34:09,328 - game3d.game.turnmove - INFO - Move 1300: WHITE XZZIGZAG [5 1 5]->[4 1 6] (Move)
2025-11-28 18:34:10,968 - game3d.game.turnmove - INFO - Move 11500: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:34:12,442 - game3d.game.turnmove - INFO - Move 16900: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:34:17,227 - game3d.game.turnmove - INFO - Move 4800: WHITE FRIENDLYTELEPORTER [5 4 6]->[6 5 6] (Move)
2025-11-28 18:34:17,345 - game3d.game.turnmove - INFO - Move 1400: WHITE XZZIGZAG [4 1 2]->[5 1 1] (Move)
2025-11-28 18:34:18,457 - game3d.game.turnmove - INFO - Move 100: BLACK ARMOUR [5 7 7]->[5 7 6] (Move)
2025-11-28 18:34:18,998 - game3d.game.turnmove - INFO - Move 11600: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-11-28 18:34:20,469 - game3d.game.turnmove - INFO - Move 17000: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:34:23,859 - game3d.game.turnmove - INFO - Move 2700: WHITE QUEEN [4 4 7]->[3 4 8] (Move)
2025-11-28 18:34:25,178 - game3d.game.turnmove - INFO - Move 4900: WHITE SPIRAL [5 4 8]->[4 5 8] (Move)
2025-11-28 18:34:25,295 - game3d.game.turnmove - INFO - Move 1500: WHITE XZZIGZAG [8 7 7]->[4 7 7] (Move)
2025-11-28 18:34:26,910 - game3d.game.turnmove - INFO - Move 11700: BLACK YZZIGZAG [8 2 1]->[8 2 2] (Move)
2025-11-28 18:34:28,393 - game3d.game.turnmove - INFO - Move 17100: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:34:29,314 - game3d.game.turnmove - INFO - Move 200: BLACK KNIGHT [2 4 7]->[4 5 7] (Capture)
2025-11-28 18:34:33,258 - game3d.game.turnmove - INFO - Move 5000: WHITE SPIRAL [4 5 8]->[3 4 8] (Move)
2025-11-28 18:34:33,378 - game3d.game.turnmove - INFO - Move 1600: WHITE XZZIGZAG [4 1 2]->[1 1 5] (Move)
2025-11-28 18:34:35,876 - game3d.game.turnmove - INFO - Move 11800: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:34:37,373 - game3d.game.turnmove - INFO - Move 17200: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:34:40,253 - game3d.game.turnmove - INFO - Move 300: WHITE XYQUEEN [3 4 1]->[4 3 0] (Move)
2025-11-28 18:34:43,772 - game3d.game.turnmove - INFO - Move 5100: WHITE FREEZER [4 4 7]->[3 3 7] (Move)
2025-11-28 18:34:43,894 - game3d.game.turnmove - INFO - Move 1700: WHITE YZZIGZAG [8 6 8]->[8 6 7] (Move)
2025-11-28 18:34:45,549 - game3d.game.turnmove - INFO - Move 11900: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:34:47,046 - game3d.game.turnmove - INFO - Move 17300: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:34:49,968 - game3d.game.turnmove - INFO - Move 400: BLACK BLACKHOLE [5 3 1]->[5 4 0] (Capture)
2025-11-28 18:34:51,779 - game3d.game.turnmove - INFO - Move 5200: BLACK YZZIGZAG [0 2 0]->[0 2 1] (Move)
2025-11-28 18:34:51,896 - game3d.game.turnmove - INFO - Move 1800: WHITE XZZIGZAG [4 7 5]->[7 7 2] (Move)
2025-11-28 18:34:53,524 - game3d.game.turnmove - INFO - Move 12000: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Move)
2025-11-28 18:34:54,291 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 121 pieces - possible stalemate
2025-11-28 18:34:54,292 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:34:54,292 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:34:54,945 - game3d.game.turnmove - INFO - Move 17400: WHITE YZZIGZAG [0 6 8]->[0 6 7] (Move)
2025-11-28 18:35:00,277 - game3d.game.turnmove - INFO - Move 5300: BLACK YZZIGZAG [8 2 0]->[8 2 1] (Move)
2025-11-28 18:35:00,389 - game3d.game.turnmove - INFO - Move 1900: WHITE XZZIGZAG [3 1 8]->[5 1 6] (Move)
2025-11-28 18:35:02,103 - game3d.game.turnmove - INFO - Move 12100: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:35:03,775 - game3d.game.turnmove - INFO - Move 17500: WHITE YZZIGZAG [0 6 7]->[0 6 8] (Move)
2025-11-28 18:35:04,045 - game3d.game.turnmove - INFO - Move 500: WHITE FREEZER [8 0 1]->[7 1 1] (Move)
2025-11-28 18:35:08,414 - game3d.game.turnmove - INFO - Move 5400: BLACK YZZIGZAG [0 2 2]->[0 2 1] (Move)
2025-11-28 18:35:08,534 - game3d.game.turnmove - INFO - Move 2000: WHITE XZZIGZAG [4 1 8]->[3 1 8] (Move)
2025-11-28 18:35:10,133 - game3d.game.turnmove - INFO - Move 12200: BLACK YZZIGZAG [8 2 7]->[8 2 8] (Move)
2025-11-28 18:35:11,577 - game3d.game.turnmove - INFO - Move 17600: WHITE YZZIGZAG [0 6 7]->[0 6 2] (Move)
2025-11-28 18:35:13,763 - InferenceServer - INFO - Server shutting down.
2025-11-28 18:35:13,762 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7feb610c7100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7feb615e6160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 495, in update_legal_moves_incremental
    new_moves = generate_pseudolegal_moves_batch(state, regenerate_coords, debuffed_coords, ignore_occupancy=False)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 83, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(check_positions)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7feb610c7100>) returned a result with an exception set
2025-11-28 18:35:13,763 - training.parallel_self_play - INFO - Stopping Server...
2025-11-28 18:35:13,765 - worker.4 - ERROR - Worker 4 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7feb610c7100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7feb615e6160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 495, in update_legal_moves_incremental
    new_moves = generate_pseudolegal_moves_batch(state, regenerate_coords, debuffed_coords, ignore_occupancy=False)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 83, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(check_positions)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7feb610c7100>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 299, in _game_worker_client
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7feb610c7100>) returned a result with an exception set
2025-11-28 18:35:13,762 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f0cc01d3100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f0cc06f2160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 506, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 413, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f0cc01d3100>) returned a result with an exception set
2025-11-28 18:35:13,771 - worker.2 - ERROR - Worker 2 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f0cc01d3100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f0cc06f2160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 506, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 413, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f0cc01d3100>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 299, in _game_worker_client
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f0cc01d3100>) returned a result with an exception set
2025-11-28 18:35:13,786 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:35:13,787 - game3d.cache.manager - DEBUG - Created cache manager #7 for board 139687720361296
2025-11-28 18:35:13,821 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:35:13,822 - game3d.cache.manager - DEBUG - Created cache manager #4 for board 140643886225088
2025-11-28 18:35:14,045 - __main__ - INFO - Training interrupted by user
2025-11-28 18:35:14,292 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 18:35:40,123 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 18:35:40,124 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:35:40,125 - __main__ - INFO - Testing move generation...
2025-11-28 18:35:47,979 - __main__ - INFO - [OK] Generated 845 moves
2025-11-28 18:35:47,979 - __main__ - INFO - Testing GameState caching...
2025-11-28 18:35:47,980 - __main__ - INFO - [OK] GameState caching works
2025-11-28 18:35:47,980 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 18:35:47,980 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 18:35:47,980 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(845), 'piece_moves_cache_size': 107, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 18:35:49,626 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_183535/temp_model_for_selfplay.pt
2025-11-28 18:35:49,626 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 50 games, 6 workers
2025-11-28 18:35:52,552 - training.parallel_self_play - INFO - Launching workers...
2025-11-28 18:36:01,907 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-11-28 18:36:05,742 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:36:05,743 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139696776590864
2025-11-28 18:36:05,775 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:36:05,776 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140195984642768
2025-11-28 18:36:05,798 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:36:05,799 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140634637275856
2025-11-28 18:36:05,981 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:36:05,982 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140704878570240
2025-11-28 18:36:05,995 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:36:05,996 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140306851722960
2025-11-28 18:36:06,142 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:36:06,142 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140571499706304
2025-11-28 18:36:07,845 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-11-28 18:36:07,849 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-11-28 18:36:07,849 - InferenceServer - INFO - Server Ready. Listening...
2025-11-28 18:36:32,892 - game3d.game.turnmove - INFO - Move 100: WHITE FREEZER [0 8 1]->[1 7 1] (Move)
2025-11-28 18:36:33,589 - game3d.game.turnmove - INFO - Move 100: BLACK KNIGHT [4 6 7]->[4 5 5] (Capture)
2025-11-28 18:36:33,754 - game3d.game.turnmove - INFO - Move 100: WHITE SPIRAL [8 1 0]->[8 0 0] (Move)
2025-11-28 18:36:33,775 - game3d.game.turnmove - INFO - Move 100: BLACK PRIEST [5 4 5]->[4 5 4] (Move)
2025-11-28 18:36:33,832 - game3d.game.turnmove - INFO - Move 100: WHITE SPIRAL [0 7 0]->[0 6 0] (Move)
2025-11-28 18:36:39,632 - game3d.game.turnmove - INFO - Move 100: WHITE ECHO [2 7 0]->[3 7 0] (Move)
2025-11-28 18:36:41,880 - game3d.game.turnmove - INFO - Move 200: BLACK TRAILBLAZER [3 4 8]->[3 3 8] (Capture)
2025-11-28 18:36:45,066 - game3d.game.turnmove - INFO - Move 200: WHITE YZZIGZAG [8 2 0]->[8 2 6] (Capture)
2025-11-28 18:36:47,376 - game3d.game.turnmove - INFO - Move 200: WHITE SPIRAL [8 0 0]->[7 0 0] (Move)
2025-11-28 18:36:47,511 - game3d.game.turnmove - INFO - Move 200: WHITE NEBULA [6 3 0]->[5 4 1] (Capture)
2025-11-28 18:36:49,318 - game3d.game.turnmove - INFO - Move 300: BLACK FRIENDLYTELEPORTER [2 2 7]->[5 7 2] (Capture)
2025-11-28 18:36:49,476 - training.parallel_self_play - INFO - Stopping Server...
2025-11-28 18:36:49,477 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fd95bbc3100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7fd95c0e2160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 506, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 418, in _apply_all_filters
    _, piece_types = occ_cache.batch_get_attributes(moves[:, :3])
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fd95bbc3100>) returned a result with an exception set
2025-11-28 18:36:49,476 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f9bbd7c7100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f9bbdce6160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 506, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 413, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 83, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(check_positions)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f9bbd7c7100>) returned a result with an exception set
2025-11-28 18:36:49,479 - worker.0 - ERROR - Worker 0 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fd95bbc3100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7fd95c0e2160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 506, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 418, in _apply_all_filters
    _, piece_types = occ_cache.batch_get_attributes(moves[:, :3])
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fd95bbc3100>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fd95bbc3100>) returned a result with an exception set
2025-11-28 18:36:49,480 - worker.4 - ERROR - Worker 4 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f9bbd7c7100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f9bbdce6160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 506, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 413, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 83, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(check_positions)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f9bbd7c7100>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f9bbd7c7100>) returned a result with an exception set
2025-11-28 18:36:49,486 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:36:49,486 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140566514697408
2025-11-28 18:36:49,491 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:36:49,491 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140301852238960
2025-11-28 18:36:49,505 - InferenceServer - INFO - Server shutting down.
2025-11-28 18:36:49,803 - __main__ - INFO - Training interrupted by user
2025-11-28 18:36:50,042 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 18:37:26,771 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 18:37:26,772 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:37:26,773 - __main__ - INFO - Testing move generation...
2025-11-28 18:37:27,131 - __main__ - INFO - [OK] Generated 845 moves
2025-11-28 18:37:27,131 - __main__ - INFO - Testing GameState caching...
2025-11-28 18:37:27,131 - __main__ - INFO - [OK] GameState caching works
2025-11-28 18:37:27,131 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 18:37:27,132 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 18:37:27,132 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(845), 'piece_moves_cache_size': 107, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 18:37:28,637 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_183722/temp_model_for_selfplay.pt
2025-11-28 18:37:28,637 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 2 games, 6 workers
2025-11-28 18:37:31,523 - training.parallel_self_play - INFO - Launching workers...
2025-11-28 18:37:37,220 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-11-28 18:37:39,599 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:37:39,600 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139681629893248
2025-11-28 18:37:39,705 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:37:39,706 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140347901375488
2025-11-28 18:37:41,623 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-11-28 18:37:41,628 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-11-28 18:37:41,628 - InferenceServer - INFO - Server Ready. Listening...
2025-11-28 18:37:51,798 - game3d.game.turnmove - INFO - Move 100: WHITE GEOMANCER [5 0 1]->[5 1 3] (Move)
2025-11-28 18:37:53,552 - game3d.game.turnmove - INFO - Move 100: WHITE ROOK [3 5 2]->[3 4 2] (Capture)
2025-11-28 18:37:56,014 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:37:56,014 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:37:56,953 - game3d.game.turnmove - INFO - Move 200: BLACK SLOWER [6 8 7]->[6 8 6] (Capture)
2025-11-28 18:38:00,565 - game3d.game.turnmove - INFO - Move 200: WHITE KNIGHT31 [4 3 8]->[1 2 7] (Capture)
2025-11-28 18:38:01,316 - game3d.game.turnmove - INFO - Move 300: WHITE ORBITER [4 0 0]->[3 3 0] (Capture)
2025-11-28 18:38:02,689 - InferenceServer - INFO - Server shutting down.
2025-11-28 18:38:02,689 - training.parallel_self_play - INFO - Stopping Server...
2025-11-28 18:38:02,690 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f0a2b5c7100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f0a2bae6160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 491, in update_legal_moves_incremental
    raw_moves = generate_pseudolegal_moves_batch(state, regenerate_coords, debuffed_coords, ignore_occupancy=True)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f0a2b5c7100>) returned a result with an exception set
2025-11-28 18:38:02,692 - worker.0 - ERROR - Worker 0 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f0a2b5c7100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f0a2bae6160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 491, in update_legal_moves_incremental
    raw_moves = generate_pseudolegal_moves_batch(state, regenerate_coords, debuffed_coords, ignore_occupancy=True)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f0a2b5c7100>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f0a2b5c7100>) returned a result with an exception set
2025-11-28 18:38:02,966 - __main__ - INFO - Training interrupted by user
2025-11-28 18:38:03,193 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 18:38:45,700 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 18:38:45,700 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:38:45,701 - __main__ - INFO - Testing move generation...
2025-11-28 18:38:46,050 - __main__ - INFO - [OK] Generated 845 moves
2025-11-28 18:38:46,050 - __main__ - INFO - Testing GameState caching...
2025-11-28 18:38:46,050 - __main__ - INFO - [OK] GameState caching works
2025-11-28 18:38:46,050 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 18:38:46,051 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 18:38:46,051 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(845), 'piece_moves_cache_size': 107, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 18:38:47,554 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_183841/temp_model_for_selfplay.pt
2025-11-28 18:38:47,554 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 12 games, 6 workers
2025-11-28 18:38:50,358 - training.parallel_self_play - INFO - Launching workers...
2025-11-28 18:38:58,250 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-11-28 18:39:01,962 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:39:01,963 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139735626564800
2025-11-28 18:39:02,338 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:39:02,339 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140700387537776
2025-11-28 18:39:02,636 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:39:02,637 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139871368352464
2025-11-28 18:39:02,709 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:39:02,710 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139811582841552
2025-11-28 18:39:02,833 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:39:02,834 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140371952341712
2025-11-28 18:39:02,956 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:39:02,957 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139837923324640
2025-11-28 18:39:03,577 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-11-28 18:39:03,582 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-11-28 18:39:03,582 - InferenceServer - INFO - Server Ready. Listening...
2025-11-28 18:39:25,222 - game3d.game.turnmove - INFO - Move 100: WHITE CONESLIDER [4 4 7]->[3 4 8] (Capture)
2025-11-28 18:39:27,543 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:39:27,543 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:39:27,596 - game3d.game.turnmove - INFO - Move 100: BLACK PANEL [3 2 7]->[3 3 7] (Capture)
2025-11-28 18:39:28,318 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:39:28,318 - game3d.common.state_utils - DEBUG - King for color 2 cached at [5 3 7]
2025-11-28 18:39:30,011 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:39:30,011 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:39:31,301 - game3d.game.turnmove - INFO - Move 100: WHITE BLACKHOLE [6 0 4]->[6 0 5] (Capture)
2025-11-28 18:39:32,781 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 205 pieces - possible stalemate
2025-11-28 18:39:32,783 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:39:32,783 - game3d.common.state_utils - DEBUG - King for color 2 cached at [5 3 7]
2025-11-28 18:39:34,103 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 199 pieces - possible stalemate
2025-11-28 18:39:34,105 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:39:34,105 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:39:37,381 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 197 pieces - possible stalemate
2025-11-28 18:39:37,382 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:39:37,383 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:39:37,715 - game3d.game.turnmove - INFO - Move 100: WHITE PANEL [4 5 6]->[4 4 6] (Capture)
2025-11-28 18:39:38,749 - game3d.game.turnmove - INFO - Move 100: BLACK CONESLIDER [4 6 2]->[3 4 0] (Capture)
2025-11-28 18:39:41,222 - game3d.game.turnmove - INFO - Move 100: BLACK QUEEN [4 5 1]->[5 5 0] (Capture)
2025-11-28 18:39:42,591 - game3d.game.turnmove - INFO - Move 200: WHITE KNIGHT32 [3 5 0]->[1 3 3] (Move)
2025-11-28 18:39:48,181 - game3d.game.turnmove - INFO - Move 200: WHITE PAWN [4 3 2]->[3 4 3] (Capture)
2025-11-28 18:39:52,252 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 189 pieces - possible stalemate
2025-11-28 18:39:52,254 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:39:52,254 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:39:54,495 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 212 pieces - possible stalemate
2025-11-28 18:39:54,497 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:39:54,497 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:40:00,659 - game3d.game.turnmove - INFO - Move 300: BLACK ECHO [3 2 6]->[3 2 5] (Capture)
2025-11-28 18:40:05,807 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 198 pieces - possible stalemate
2025-11-28 18:40:05,809 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:40:05,809 - game3d.common.state_utils - DEBUG - King for color 2 cached at [5 3 7]
2025-11-28 18:40:07,972 - game3d.game.turnmove - INFO - Move 200: BLACK CONESLIDER [4 3 0]->[4 4 0] (Capture)
2025-11-28 18:40:11,335 - game3d.game.turnmove - INFO - Move 200: BLACK GEOMANCER [3 7 6]->[1 7 5] (Move)
2025-11-28 18:40:11,422 - game3d.game.turnmove - INFO - Move 400: WHITE YZQUEEN [5 3 8]->[5 3 7] (Capture)
2025-11-28 18:40:12,625 - game3d.game.turnmove - INFO - Move 300: WHITE XYQUEEN [5 4 1]->[4 4 1] (Capture)
2025-11-28 18:40:13,684 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 214 pieces - possible stalemate
2025-11-28 18:40:13,686 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:40:13,686 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:40:16,278 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 189 pieces - possible stalemate
2025-11-28 18:40:16,279 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:40:16,279 - game3d.common.state_utils - DEBUG - King for color 2 cached at [5 3 7]
2025-11-28 18:40:17,503 - game3d.game.turnmove - INFO - Move 500: WHITE ROOK [4 5 7]->[4 6 7] (Capture)
2025-11-28 18:40:19,061 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 215 pieces - possible stalemate
2025-11-28 18:40:19,063 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:40:19,063 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:40:19,763 - game3d.game.turnmove - INFO - Move 300: WHITE HIVE [3 6 0]->[4 5 0] (Capture)
2025-11-28 18:40:21,429 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:40:21,430 - game3d.common.state_utils - DEBUG - King for color 2 cached at [5 3 7]
2025-11-28 18:40:22,969 - game3d.game.turnmove - INFO - Move 200: WHITE FREEZER [8 0 1]->[7 0 2] (Capture)
2025-11-28 18:40:28,184 - game3d.game.turnmove - INFO - Move 200: BLACK QUEEN [3 4 1]->[3 4 0] (Capture)
2025-11-28 18:40:30,179 - game3d.game.turnmove - INFO - Move 600: BLACK PANEL [3 3 1]->[4 3 0] (Move)
2025-11-28 18:40:31,734 - game3d.game.turnmove - INFO - Move 400: BLACK ROOK [3 4 0]->[5 4 0] (Move)
2025-11-28 18:40:38,151 - game3d.game.turnmove - INFO - Move 500: BLACK ROOK [5 4 0]->[3 4 0] (Move)
2025-11-28 18:40:41,758 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 167 pieces - possible stalemate
2025-11-28 18:40:41,760 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:40:41,760 - game3d.common.state_utils - DEBUG - King for color 2 cached at [5 3 7]
2025-11-28 18:40:44,100 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 112 pieces - possible stalemate
2025-11-28 18:40:44,101 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:40:44,101 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:40:46,907 - game3d.game.turnmove - INFO - Move 600: WHITE QUEEN [5 3 8]->[6 3 7] (Move)
2025-11-28 18:40:50,522 - game3d.game.turnmove - INFO - Move 400: WHITE ROOK [5 4 8]->[3 4 8] (Move)
2025-11-28 18:40:51,915 - game3d.game.turnmove - INFO - Move 700: WHITE MIRROR [7 4 0]->[6 5 0] (Move)
2025-11-28 18:40:53,092 - game3d.game.turnmove - INFO - Move 700: WHITE QUEEN [5 0 4]->[5 3 4] (Move)
2025-11-28 18:40:55,273 - game3d.game.turnmove - INFO - Move 300: WHITE INFILTRATOR [5 2 1]->[4 3 0] (Capture)
2025-11-28 18:40:56,918 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:40:56,918 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:41:04,326 - game3d.game.turnmove - INFO - Move 300: BLACK SPEEDER [8 6 6]->[6 8 4] (Capture)
2025-11-28 18:41:05,272 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:41:05,273 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:41:14,743 - game3d.game.turnmove - INFO - Move 800: BLACK PANEL [4 5 0]->[5 4 0] (Move)
2025-11-28 18:41:15,378 - game3d.game.turnmove - INFO - Move 400: BLACK QUEEN [5 4 0]->[4 5 0] (Move)
2025-11-28 18:41:33,407 - game3d.game.turnmove - INFO - Move 300: WHITE PAWN [3 4 1]->[4 5 2] (Capture)
2025-11-28 18:41:36,640 - game3d.game.turnmove - INFO - Move 900: BLACK GEOMANCER [2 5 4]->[5 2 7] (Move)
2025-11-28 18:41:39,483 - game3d.game.turnmove - INFO - Move 500: BLACK QUEEN [4 4 1]->[4 5 0] (Move)
2025-11-28 18:41:50,962 - game3d.game.turnmove - INFO - Move 400: BLACK PANEL [4 4 6]->[4 4 5] (Capture)
2025-11-28 18:41:53,021 - game3d.game.turnmove - INFO - Move 500: WHITE ROOK [4 3 8]->[4 5 8] (Move)
2025-11-28 18:41:57,833 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 118 pieces - possible stalemate
2025-11-28 18:41:57,835 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:41:57,835 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:41:58,851 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 157 pieces - possible stalemate
2025-11-28 18:41:58,852 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:41:58,852 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:42:01,092 - game3d.game.turnmove - INFO - Move 1000: BLACK PANEL [5 4 0]->[4 4 1] (Move)
2025-11-28 18:42:01,805 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:42:01,805 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:42:10,952 - game3d.game.turnmove - INFO - Move 600: BLACK QUEEN [4 5 0]->[4 3 0] (Move)
2025-11-28 18:42:12,260 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 164 pieces - possible stalemate
2025-11-28 18:42:12,261 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:42:12,261 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:42:12,686 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:42:12,686 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:42:15,882 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 113 pieces - possible stalemate
2025-11-28 18:42:15,883 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:42:15,883 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:42:23,752 - game3d.game.turnmove - INFO - Move 500: BLACK ROOK [3 8 3]->[3 7 3] (Move)
2025-11-28 18:42:24,191 - game3d.game.turnmove - INFO - Move 1100: BLACK GEOMANCER [5 2 7]->[6 5 8] (Move)
2025-11-28 18:42:31,255 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 88 pieces - possible stalemate
2025-11-28 18:42:31,256 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:42:31,256 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:42:33,507 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:42:33,508 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:42:34,198 - game3d.game.turnmove - INFO - Move 1200: WHITE FRIENDLYTELEPORTER [1 2 0]->[2 2 1] (Move)
2025-11-28 18:42:34,446 - game3d.game.turnmove - INFO - Move 700: WHITE QUEEN [5 4 8]->[4 3 8] (Move)
2025-11-28 18:42:48,908 - game3d.game.turnmove - INFO - Move 600: WHITE ARMOUR [5 8 1]->[4 7 1] (Move)
2025-11-28 18:42:49,985 - game3d.game.turnmove - INFO - Move 1300: WHITE PANEL [4 5 8]->[3 4 8] (Move)
2025-11-28 18:42:53,294 - game3d.game.turnmove - INFO - Move 400: WHITE QUEEN [4 4 4]->[4 4 6] (Move)
2025-11-28 18:42:54,570 - game3d.game.turnmove - INFO - Move 1400: WHITE FRIENDLYTELEPORTER [3 4 8]->[4 3 8] (Move)
2025-11-28 18:42:55,544 - InferenceServer - INFO - Server shutting down.
2025-11-28 18:42:55,544 - training.parallel_self_play - INFO - Stopping Server...
2025-11-28 18:42:55,544 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7faae3dc7100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7faae42e2160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 506, in update_legal_moves_incremental
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 413, in _apply_all_filters
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7faae3dc7100>) returned a result with an exception set
2025-11-28 18:42:55,544 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f16bddc3100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f16be2e6160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 506, in update_legal_moves_incremental
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 413, in _apply_all_filters
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f16bddc3100>) returned a result with an exception set
2025-11-28 18:42:55,547 - worker.1 - ERROR - Worker 1 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7faae3dc7100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7faae42e2160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 506, in update_legal_moves_incremental
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 413, in _apply_all_filters
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7faae3dc7100>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7faae3dc7100>) returned a result with an exception set
2025-11-28 18:42:55,547 - worker.0 - ERROR - Worker 0 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f16bddc3100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f16be2e6160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 506, in update_legal_moves_incremental
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 413, in _apply_all_filters
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f16bddc3100>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f16bddc3100>) returned a result with an exception set
2025-11-28 18:42:55,546 - worker.5 - ERROR - Worker 5 failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f2e8f2c7100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f2e8f7ea160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 113, in submit_move
    is_game_over=_terminal_is_game_over(new_state),
                 ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/usr/lib/python3.13/contextlib.py", line 85, in inner
    return func(*args, **kwds)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/terminal.py", line 229, in is_game_over
    legal_moves = game_state.legal_moves
                  ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/gamestate.py", line 231, in legal_moves
    return turnmove.legal_moves(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 54, in legal_moves
    structured_moves = generate_legal_moves(game_state)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 549, in generate_legal_moves
    """Initializes the singleton generator instance."""
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 161, in generate
    return self.generate_fused(state)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 272, in generate_fused
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f2e8f2c7100>) returned a result with an exception set
2025-11-28 18:42:55,546 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f364dbcb100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f364e0ea160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 506, in update_legal_moves_incremental
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 413, in _apply_all_filters
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f364dbcb100>) returned a result with an exception set
2025-11-28 18:42:55,550 - worker.2 - ERROR - Worker 2 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f364dbcb100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f364e0ea160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 303, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 506, in update_legal_moves_incremental
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 413, in _apply_all_filters
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f364dbcb100>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f364dbcb100>) returned a result with an exception set
2025-11-28 18:42:55,567 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:42:55,568 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139866198043152
2025-11-28 18:42:55,569 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:42:55,569 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140371949684672
2025-11-28 18:42:55,571 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:42:55,571 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139735649558944
2025-11-28 18:42:55,572 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:42:55,572 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139837922517456
2025-11-28 18:42:55,872 - __main__ - INFO - Training interrupted by user
2025-11-28 18:42:56,116 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 18:43:10,788 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 18:43:10,789 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:43:10,790 - __main__ - INFO - Testing move generation...
2025-11-28 18:43:11,135 - __main__ - INFO - [OK] Generated 845 moves
2025-11-28 18:43:11,135 - __main__ - INFO - Testing GameState caching...
2025-11-28 18:43:11,135 - __main__ - INFO - [OK] GameState caching works
2025-11-28 18:43:11,135 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 18:43:11,136 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 18:43:11,136 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(845), 'piece_moves_cache_size': 107, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 18:43:12,550 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_184306/temp_model_for_selfplay.pt
2025-11-28 18:43:12,550 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 12 games, 6 workers
2025-11-28 18:43:15,359 - training.parallel_self_play - INFO - Launching workers...
2025-11-28 18:43:24,020 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-11-28 18:43:27,207 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:43:27,208 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139688686825920
2025-11-28 18:43:27,279 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:43:27,280 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139866229618288
2025-11-28 18:43:27,414 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:43:27,415 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140380456514944
2025-11-28 18:43:27,567 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:43:27,568 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140633997256272
2025-11-28 18:43:27,653 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:43:27,654 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140187138724560
2025-11-28 18:43:27,670 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:43:27,672 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140229954385760
2025-11-28 18:43:29,770 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-11-28 18:43:29,775 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-11-28 18:43:29,775 - InferenceServer - INFO - Server Ready. Listening...
2025-11-28 18:43:50,912 - game3d.game.turnmove - INFO - Move 100: BLACK QUEEN [8 5 7]->[8 6 6] (Capture)
2025-11-28 18:43:51,042 - game3d.game.turnmove - INFO - Move 100: WHITE ROOK [5 5 6]->[4 5 6] (Capture)
2025-11-28 18:43:51,246 - game3d.game.turnmove - INFO - Move 100: WHITE ORBITER [2 4 5]->[3 3 7] (Capture)
2025-11-28 18:43:51,319 - game3d.game.turnmove - INFO - Move 100: WHITE BISHOP [3 4 6]->[5 4 8] (Capture)
2025-11-28 18:43:51,508 - game3d.game.turnmove - INFO - Move 100: WHITE ROOK [5 5 1]->[5 5 6] (Capture)
2025-11-28 18:43:52,383 - game3d.game.turnmove - INFO - Move 100: WHITE ECHO [6 0 0]->[7 1 1] (Move)
2025-11-28 18:43:59,632 - game3d.game.turnmove - INFO - Move 200: WHITE ECHO [3 8 2]->[3 8 3] (Capture)
2025-11-28 18:43:59,718 - game3d.game.turnmove - INFO - Move 200: WHITE SPIRAL [7 7 0]->[8 8 0] (Move)
2025-11-28 18:43:59,797 - game3d.game.turnmove - INFO - Move 200: BLACK KNIGHT [6 1 5]->[5 1 2] (Capture)
2025-11-28 18:44:00,152 - game3d.game.turnmove - INFO - Move 200: BLACK KNIGHT [3 6 5]->[4 8 5] (Capture)
2025-11-28 18:44:02,968 - game3d.game.turnmove - INFO - Move 200: WHITE TRIGONALBISHOP [1 4 1]->[3 2 3] (Move)
2025-11-28 18:44:06,542 - game3d.game.turnmove - INFO - Move 200: WHITE ROOK [5 4 8]->[3 4 8] (Move)
2025-11-28 18:44:07,669 - game3d.game.turnmove - INFO - Move 300: BLACK ROOK [3 4 0]->[5 4 0] (Move)
2025-11-28 18:44:07,717 - game3d.game.turnmove - INFO - Move 300: BLACK BISHOP [4 0 7]->[5 1 7] (Capture)
2025-11-28 18:44:08,146 - game3d.game.turnmove - INFO - Move 300: BLACK PANEL [2 6 8]->[4 4 6] (Move)
2025-11-28 18:44:08,795 - game3d.game.turnmove - INFO - Move 300: BLACK ORBITER [0 6 0]->[3 6 1] (Capture)
2025-11-28 18:44:15,023 - game3d.game.turnmove - INFO - Move 400: BLACK ROOK [3 4 0]->[5 4 0] (Move)
2025-11-28 18:44:15,130 - game3d.game.turnmove - INFO - Move 400: WHITE SPIRAL [4 4 1]->[4 4 7] (Move)
2025-11-28 18:44:15,529 - game3d.game.turnmove - INFO - Move 400: BLACK PANEL [3 4 0]->[2 4 0] (Move)
2025-11-28 18:44:16,528 - game3d.movement.generator - DEBUG - Generator: All moves filtered by Check/Safety
2025-11-28 18:44:16,528 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 164 pieces (Priests: 0) - possible stalemate
2025-11-28 18:44:16,529 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:44:16,529 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:44:17,811 - game3d.game.turnmove - INFO - Move 300: BLACK YZZIGZAG [0 2 8]->[0 2 6] (Capture)
2025-11-28 18:44:18,827 - game3d.movement.generator - DEBUG - Generator: All moves filtered by Check/Safety
2025-11-28 18:44:18,827 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 164 pieces (Priests: 0) - possible stalemate
2025-11-28 18:44:18,827 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:44:18,827 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:44:22,419 - game3d.game.turnmove - INFO - Move 500: BLACK ROOK [3 4 0]->[5 4 0] (Move)
2025-11-28 18:44:22,801 - game3d.game.turnmove - INFO - Move 500: BLACK PANEL [4 4 6]->[4 4 5] (Move)
2025-11-28 18:44:24,632 - game3d.game.turnmove - INFO - Move 500: WHITE SPIRAL [4 5 8]->[5 4 8] (Move)
2025-11-28 18:44:25,488 - game3d.game.turnmove - INFO - Move 400: BLACK XZQUEEN [6 7 8]->[5 6 7] (Capture)
2025-11-28 18:44:25,831 - game3d.movement.generator - DEBUG - Generator: All moves filtered by Check/Safety
2025-11-28 18:44:25,831 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 163 pieces (Priests: 0) - possible stalemate
2025-11-28 18:44:25,833 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 18:44:25,833 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 18:44:29,884 - game3d.game.turnmove - INFO - Move 600: BLACK ROOK [5 4 0]->[2 4 0] (Capture)
2025-11-28 18:44:31,350 - game3d.game.turnmove - INFO - Move 600: WHITE SPIRAL [3 4 8]->[5 4 8] (Move)
2025-11-28 18:44:32,002 - game3d.game.turnmove - INFO - Move 400: BLACK PANEL [4 4 3]->[4 4 2] (Move)
2025-11-28 18:44:33,056 - game3d.game.turnmove - INFO - Move 500: BLACK YZZIGZAG [0 2 6]->[0 2 2] (Capture)
2025-11-28 18:44:33,450 - training.parallel_self_play - INFO - Stopping Server...
2025-11-28 18:44:33,452 - InferenceServer - INFO - Server shutting down.
2025-11-28 18:44:33,450 - worker.0 - ERROR - Worker 0 failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f0bcffc7100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f0bd04e6160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 113, in submit_move
    is_game_over=_terminal_is_game_over(new_state),
                 ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/usr/lib/python3.13/contextlib.py", line 85, in inner
    return func(*args, **kwds)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/terminal.py", line 229, in is_game_over
    legal_moves = game_state.legal_moves
                  ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/gamestate.py", line 231, in legal_moves
    return turnmove.legal_moves(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 54, in legal_moves
    structured_moves = generate_legal_moves(game_state)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 562, in generate_legal_moves
    return _generator.generate(state)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 161, in generate
    return self.generate_fused(state)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 281, in generate_fused
    final_moves = filter_safe_moves_optimized(state, final_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f0bcffc7100>) returned a result with an exception set
2025-11-28 18:44:33,466 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 462 pieces
2025-11-28 18:44:33,466 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139688661407616
2025-11-28 18:44:33,828 - __main__ - INFO - Training interrupted by user
2025-11-28 18:44:34,091 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 20:18:16,557 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 20:18:16,558 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:18:16,560 - __main__ - INFO - Testing move generation...
2025-11-28 20:18:23,948 - __main__ - INFO - [OK] Generated 624 moves
2025-11-28 20:18:23,948 - __main__ - INFO - Testing GameState caching...
2025-11-28 20:18:23,949 - __main__ - INFO - [OK] GameState caching works
2025-11-28 20:18:23,949 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 20:18:23,949 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 20:18:23,949 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(624), 'piece_moves_cache_size': 27, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 20:18:25,402 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_201812/temp_model_for_selfplay.pt
2025-11-28 20:18:25,402 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 12 games, 6 workers
2025-11-28 20:18:28,185 - training.parallel_self_play - INFO - Launching workers...
2025-11-28 20:18:35,939 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-11-28 20:18:39,812 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:18:39,813 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140268883105280
2025-11-28 20:18:39,852 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:18:39,853 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139706312340672
2025-11-28 20:18:39,914 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:18:39,916 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140429956657360
2025-11-28 20:18:40,207 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:18:40,208 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140512416690480
2025-11-28 20:18:40,219 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:18:40,220 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140661270394288
2025-11-28 20:18:40,822 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:18:40,823 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140000988393728
2025-11-28 20:18:41,099 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-11-28 20:18:41,103 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-11-28 20:18:41,103 - InferenceServer - INFO - Server Ready. Listening...
2025-11-28 20:19:07,565 - game3d.game.turnmove - INFO - Move 100: BLACK TRAILBLAZER [4 3 8]->[4 2 8] (Move)
2025-11-28 20:19:07,782 - game3d.game.turnmove - INFO - Move 100: BLACK YZQUEEN [3 7 8]->[4 6 7] (Capture)
2025-11-28 20:19:07,981 - game3d.game.turnmove - INFO - Move 100: WHITE GEOMANCER [3 5 4]->[5 8 5] (Move)
2025-11-28 20:19:09,280 - game3d.game.turnmove - INFO - Move 100: BLACK ORBITER [5 1 2]->[3 2 1] (Capture)
2025-11-28 20:19:09,928 - game3d.game.turnmove - INFO - Move 100: WHITE XZZIGZAG [2 8 5]->[3 8 5] (Move)
2025-11-28 20:19:13,693 - game3d.game.turnmove - INFO - Move 100: BLACK YZQUEEN [4 5 0]->[4 4 1] (Capture)
2025-11-28 20:19:17,000 - game3d.game.turnmove - INFO - Move 200: WHITE ECHO [3 8 0]->[3 8 1] (Capture)
2025-11-28 20:19:17,687 - game3d.game.turnmove - INFO - Move 200: BLACK ORBITER [5 8 1]->[6 5 1] (Capture)
2025-11-28 20:19:17,992 - game3d.game.turnmove - INFO - Move 200: WHITE ROOK [3 4 5]->[4 4 5] (Move)
2025-11-28 20:19:19,180 - game3d.game.turnmove - INFO - Move 200: WHITE FRIENDLYTELEPORTER [1 6 0]->[2 6 0] (Capture)
2025-11-28 20:19:25,109 - game3d.game.turnmove - INFO - Move 300: WHITE TRAILBLAZER [4 3 1]->[4 3 2] (Capture)
2025-11-28 20:19:25,314 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 182 pieces (Priests: 0) - possible stalemate
2025-11-28 20:19:25,315 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 20:19:25,315 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 20:19:25,616 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: index 9 is out of bounds for axis 1 with size 9
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 217, in make_move
    cache_manager.occupancy_cache.batch_set_positions(changed_coords, pieces_data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 338, in batch_set_positions
    self._occ[x, y, z] = pieces[:, 1]  # colors
    ~~~~~~~~~^^^^^^^^^
IndexError: index 9 is out of bounds for axis 1 with size 9
2025-11-28 20:19:25,617 - worker.2 - ERROR - Worker 2 failed: Move execution failed: index 9 is out of bounds for axis 1 with size 9
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 217, in make_move
    cache_manager.occupancy_cache.batch_set_positions(changed_coords, pieces_data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 338, in batch_set_positions
    self._occ[x, y, z] = pieces[:, 1]  # colors
    ~~~~~~~~~^^^^^^^^^
IndexError: index 9 is out of bounds for axis 1 with size 9

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: index 9 is out of bounds for axis 1 with size 9
2025-11-28 20:19:25,621 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:19:25,621 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140263821967568
2025-11-28 20:19:25,838 - game3d.game.turnmove - INFO - Move 200: WHITE BOMB [7 4 0]->[7 4 1] (Move)
2025-11-28 20:19:26,406 - game3d.game.turnmove - INFO - Piece captured by Trailblazer counters at [4 3 2]
2025-11-28 20:19:26,856 - game3d.game.turnmove - INFO - Move 300: WHITE PAWN [8 5 1]->[8 5 6] (Capture)
2025-11-28 20:19:28,368 - game3d.game.turnmove - INFO - Move 200: BLACK ORBITER [0 5 4]->[0 4 1] (Capture)
2025-11-28 20:19:28,482 - game3d.game.turnmove - INFO - Piece captured by Trailblazer counters at [4 3 2]
2025-11-28 20:19:29,123 - game3d.game.turnmove - INFO - Move 300: WHITE HIVE [5 6 0]->[4 5 0] (Capture)
2025-11-28 20:19:29,436 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 20:19:29,436 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 20:19:31,141 - game3d.game.turnmove - INFO - Piece captured by Trailblazer counters at [4 3 5]
2025-11-28 20:19:32,581 - game3d.game.turnmove - INFO - Move 400: WHITE EDGEROOK [2 0 1]->[4 0 5] (Capture)
2025-11-28 20:19:34,372 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 168 pieces (Priests: 0) - possible stalemate
2025-11-28 20:19:34,374 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 20:19:34,374 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 20:19:35,981 - game3d.game.turnmove - INFO - Move 100: BLACK ROOK [5 5 6]->[5 5 2] (Capture)
2025-11-28 20:19:37,208 - game3d.game.turnmove - INFO - Move 400: WHITE QUEEN [4 5 8]->[5 4 8] (Move)
2025-11-28 20:19:38,122 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 169 pieces (Priests: 0) - possible stalemate
2025-11-28 20:19:38,124 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 20:19:38,124 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 20:19:39,262 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 169 pieces (Priests: 0) - possible stalemate
2025-11-28 20:19:39,264 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 20:19:39,264 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 20:19:39,798 - game3d.game.turnmove - INFO - Move 500: WHITE PAWN [4 4 2]->[4 4 3] (Capture)
2025-11-28 20:19:40,071 - game3d.game.turnmove - INFO - Move 300: BLACK ARMOUR [3 5 6]->[3 5 5] (Capture)
2025-11-28 20:19:40,123 - game3d.game.turnmove - INFO - Move 400: BLACK PANEL [4 4 7]->[4 4 8] (Move)
2025-11-28 20:19:41,625 - InferenceServer - INFO - Server shutting down.
2025-11-28 20:19:41,625 - training.parallel_self_play - INFO - Stopping Server...
2025-11-28 20:19:41,625 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fcb9a1c3100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: wall_move_dispatcher() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7fcb9a6e6160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 333, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 471, in update_legal_moves_incremental
    new_moves = generate_pseudolegal_moves_batch(state, regenerate_coords, debuffed_coords, ignore_occupancy=False)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/wall.py", line 215, in wall_move_dispatcher
    return generate_wall_moves(state.cache_manager, state.color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/wall.py", line 168, in generate_wall_moves
    colors, types = cache_manager.occupancy_cache.batch_get_attributes(target_squares)
                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fcb9a1c3100>) returned a result with an exception set
2025-11-28 20:19:41,627 - worker.3 - ERROR - Worker 3 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fcb9a1c3100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: wall_move_dispatcher() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7fcb9a6e6160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 333, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 471, in update_legal_moves_incremental
    new_moves = generate_pseudolegal_moves_batch(state, regenerate_coords, debuffed_coords, ignore_occupancy=False)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/wall.py", line 215, in wall_move_dispatcher
    return generate_wall_moves(state.cache_manager, state.color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/wall.py", line 168, in generate_wall_moves
    colors, types = cache_manager.occupancy_cache.batch_get_attributes(target_squares)
                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fcb9a1c3100>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fcb9a1c3100>) returned a result with an exception set
2025-11-28 20:19:41,627 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f0fea8bf100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: infiltrator_move_dispatcher() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f0feade2160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 333, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 482, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 355, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 112, in infiltrator_move_dispatcher
    return generate_infiltrator_moves(state.cache_manager, state.color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 38, in generate_infiltrator_moves
    teleport_dirs = _get_pawn_front_directions(cache_manager, color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 75, in _get_pawn_front_directions
    _, piece_types = cache_manager.occupancy_cache.batch_get_attributes(enemy_coords)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f0fea8bf100>) returned a result with an exception set
2025-11-28 20:19:41,630 - worker.1 - ERROR - Worker 1 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f0fea8bf100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: infiltrator_move_dispatcher() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f0feade2160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 333, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 482, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 355, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 97, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 261, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 343, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 112, in infiltrator_move_dispatcher
    return generate_infiltrator_moves(state.cache_manager, state.color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 38, in generate_infiltrator_moves
    teleport_dirs = _get_pawn_front_directions(cache_manager, color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 75, in _get_pawn_front_directions
    _, piece_types = cache_manager.occupancy_cache.batch_get_attributes(enemy_coords)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f0fea8bf100>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f0fea8bf100>) returned a result with an exception set
2025-11-28 20:19:41,642 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:19:41,642 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140507424230272
2025-11-28 20:19:41,643 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:19:41,643 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139701314032192
2025-11-28 20:19:41,862 - __main__ - INFO - Training interrupted by user
2025-11-28 20:19:42,064 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 20:23:07,767 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 20:23:07,767 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:23:07,768 - __main__ - INFO - Testing move generation...
2025-11-28 20:23:08,118 - __main__ - INFO - [OK] Generated 624 moves
2025-11-28 20:23:08,118 - __main__ - INFO - Testing GameState caching...
2025-11-28 20:23:08,118 - __main__ - INFO - [OK] GameState caching works
2025-11-28 20:23:08,118 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 20:23:08,119 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 20:23:08,119 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(624), 'piece_moves_cache_size': 27, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 20:23:09,594 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_202303/temp_model_for_selfplay.pt
2025-11-28 20:23:09,594 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 12 games, 6 workers
2025-11-28 20:23:12,394 - training.parallel_self_play - INFO - Launching workers...
2025-11-28 20:23:20,192 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-11-28 20:23:24,133 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:23:24,135 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140544045156288
2025-11-28 20:23:24,499 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:23:24,500 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139628301399088
2025-11-28 20:23:24,647 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:23:24,648 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139703056529248
2025-11-28 20:23:24,681 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:23:24,683 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140033134622128
2025-11-28 20:23:24,728 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:23:24,729 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140601368393424
2025-11-28 20:23:24,885 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:23:24,886 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140105704084176
2025-11-28 20:23:25,523 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-11-28 20:23:25,528 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-11-28 20:23:25,528 - InferenceServer - INFO - Server Ready. Listening...
2025-11-28 20:23:47,805 - game3d.game.turnmove - INFO - Move 100: WHITE YZQUEEN [3 7 1]->[3 6 1] (Move)
2025-11-28 20:23:48,077 - game3d.game.turnmove - INFO - Move 100: WHITE ROOK [3 3 6]->[3 2 6] (Capture)
2025-11-28 20:23:48,113 - game3d.game.turnmove - INFO - Move 100: WHITE ROOK [5 5 2]->[5 5 3] (Capture)
2025-11-28 20:23:48,174 - game3d.game.turnmove - INFO - Move 100: BLACK ORBITER [5 2 4]->[5 2 0] (Capture)
2025-11-28 20:23:48,962 - game3d.game.turnmove - INFO - Move 100: WHITE PAWN [2 0 2]->[3 1 1] (Capture)
2025-11-28 20:23:49,787 - game3d.game.turnmove - INFO - Move 100: WHITE MIRROR [4 1 0]->[5 2 1] (Capture)
2025-11-28 20:23:58,565 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 20:23:58,565 - game3d.common.state_utils - DEBUG - King for color 2 cached at [5 4 8]
2025-11-28 20:23:58,929 - game3d.game.turnmove - INFO - Move 200: BLACK XYQUEEN [4 5 7]->[4 4 7] (Capture)
2025-11-28 20:24:00,373 - game3d.game.turnmove - INFO - Move 200: WHITE GEOMANCER [4 3 2]->[1 2 4] (Move)
2025-11-28 20:24:01,835 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 20:24:01,835 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 20:24:02,035 - game3d.game.turnmove - INFO - Move 200: BLACK TRAILBLAZER [2 4 8]->[4 4 8] (Move)
2025-11-28 20:24:05,942 - game3d.game.turnmove - INFO - Move 200: WHITE TRAILBLAZER [3 4 0]->[4 4 0] (Capture)
2025-11-28 20:24:09,114 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 20:24:09,114 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 20:24:10,607 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 192 pieces (Priests: 0) - possible stalemate
2025-11-28 20:24:10,609 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 20:24:10,609 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 20:24:10,910 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 183 pieces (Priests: 0) - possible stalemate
2025-11-28 20:24:10,912 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 20:24:10,912 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 20:24:13,456 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 188 pieces (Priests: 0) - possible stalemate
2025-11-28 20:24:13,457 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 20:24:13,457 - game3d.common.state_utils - DEBUG - King for color 2 cached at [5 4 8]
2025-11-28 20:24:14,318 - game3d.game.turnmove - INFO - Move 200: BLACK ROOK [4 3 0]->[4 5 0] (Move)
2025-11-28 20:24:17,824 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 187 pieces (Priests: 0) - possible stalemate
2025-11-28 20:24:17,825 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 20:24:17,825 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 20:24:18,283 - game3d.game.turnmove - INFO - Move 300: BLACK ROOK [4 3 0]->[4 5 0] (Move)
2025-11-28 20:24:22,970 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 20:24:22,970 - game3d.common.state_utils - DEBUG - King for color 2 cached at [5 4 8]
2025-11-28 20:24:22,995 - game3d.game.turnmove - INFO - Piece captured by Trailblazer counters at [5 4 8]
2025-11-28 20:24:23,076 - game3d.game.turnmove - INFO - Move 200: BLACK YZQUEEN [5 7 8]->[5 6 7] (Move)
2025-11-28 20:24:26,850 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 20:24:26,850 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 20:24:27,043 - game3d.game.turnmove - INFO - Move 300: WHITE PAWN [5 8 1]->[3 6 4] (Capture)
2025-11-28 20:24:27,274 - game3d.game.turnmove - INFO - Move 400: WHITE ROOK [5 3 8]->[5 5 8] (Move)
2025-11-28 20:24:29,718 - game3d.game.turnmove - INFO - Move 300: BLACK QUEEN [4 5 0]->[3 4 0] (Move)
2025-11-28 20:24:33,553 - game3d.game.turnmove - INFO - Move 300: WHITE ROOK [3 4 8]->[5 4 8] (Move)
2025-11-28 20:24:34,493 - game3d.game.turnmove - INFO - Move 500: WHITE ROOK [5 5 8]->[5 3 8] (Move)
2025-11-28 20:24:34,739 - game3d.game.turnmove - INFO - Move 300: WHITE FREEZER [3 1 1]->[4 2 0] (Move)
2025-11-28 20:24:35,689 - game3d.game.turnmove - INFO - Piece captured by Trailblazer counters at [3 4 8]
2025-11-28 20:24:40,499 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 163 pieces (Priests: 0) - possible stalemate
2025-11-28 20:24:40,500 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 20:24:40,500 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 20:24:40,637 - game3d.game.turnmove - INFO - Move 400: WHITE ROOK [5 4 8]->[3 4 8] (Move)
2025-11-28 20:24:41,715 - game3d.game.turnmove - INFO - Move 600: WHITE ROOK [5 5 8]->[5 3 8] (Move)
2025-11-28 20:24:42,664 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 161 pieces (Priests: 0) - possible stalemate
2025-11-28 20:24:42,665 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 20:24:42,665 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 20:24:42,975 - game3d.game.turnmove - INFO - Move 400: BLACK XZQUEEN [3 5 1]->[4 4 2] (Capture)
2025-11-28 20:24:43,226 - game3d.cache.caches.movecache - WARNING - Storing empty legal moves for 166 pieces (Priests: 0) - possible stalemate
2025-11-28 20:24:43,228 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 20:24:43,228 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 20:24:47,072 - game3d.game.turnmove - INFO - Move 300: WHITE PANEL [3 5 7]->[4 6 8] (Capture)
2025-11-28 20:24:47,462 - training.parallel_self_play - INFO - Stopping Server...
2025-11-28 20:24:47,473 - InferenceServer - INFO - Server shutting down.
2025-11-28 20:24:55,893 - __main__ - INFO - Training interrupted by user
2025-11-28 20:24:56,130 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 20:35:00,542 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 20:35:00,543 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:35:00,544 - __main__ - INFO - Testing move generation...
2025-11-28 20:35:00,874 - game3d.movement.generator - DEBUG - Generator: 644 pseudolegal moves generated
2025-11-28 20:35:00,877 - game3d.movement.generator - DEBUG - Generator: 644 moves passed validation
2025-11-28 20:35:00,879 - game3d.movement.generator - DEBUG - Generator: 624 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:00,879 - __main__ - INFO - [OK] Generated 624 moves
2025-11-28 20:35:00,879 - __main__ - INFO - Testing GameState caching...
2025-11-28 20:35:00,880 - __main__ - INFO - [OK] GameState caching works
2025-11-28 20:35:00,880 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 20:35:00,880 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 20:35:00,880 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(624), 'piece_moves_cache_size': 27, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 20:35:02,306 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_203456/temp_model_for_selfplay.pt
2025-11-28 20:35:02,306 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 12 games, 6 workers
2025-11-28 20:35:05,101 - training.parallel_self_play - INFO - Launching workers...
2025-11-28 20:35:12,818 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-11-28 20:35:16,655 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:35:16,656 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140171024478608
2025-11-28 20:35:16,777 - game3d.movement.generator - DEBUG - Generator: 644 pseudolegal moves generated
2025-11-28 20:35:16,780 - game3d.movement.generator - DEBUG - Generator: 644 moves passed validation
2025-11-28 20:35:16,784 - game3d.movement.generator - DEBUG - Generator: 624 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:16,792 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:35:16,793 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140051137591088
2025-11-28 20:35:16,819 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:35:16,820 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140421251172288
2025-11-28 20:35:16,917 - game3d.movement.generator - DEBUG - Generator: 644 pseudolegal moves generated
2025-11-28 20:35:16,920 - game3d.movement.generator - DEBUG - Generator: 644 moves passed validation
2025-11-28 20:35:16,923 - game3d.movement.generator - DEBUG - Generator: 624 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:16,940 - game3d.movement.generator - DEBUG - Generator: 644 pseudolegal moves generated
2025-11-28 20:35:16,943 - game3d.movement.generator - DEBUG - Generator: 644 moves passed validation
2025-11-28 20:35:16,946 - game3d.movement.generator - DEBUG - Generator: 624 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:17,023 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:35:17,024 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139951473433696
2025-11-28 20:35:17,126 - game3d.movement.generator - DEBUG - Generator: 644 pseudolegal moves generated
2025-11-28 20:35:17,128 - game3d.movement.generator - DEBUG - Generator: 644 moves passed validation
2025-11-28 20:35:17,131 - game3d.movement.generator - DEBUG - Generator: 624 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:17,602 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:35:17,603 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139977816930096
2025-11-28 20:35:17,699 - game3d.movement.generator - DEBUG - Generator: 644 pseudolegal moves generated
2025-11-28 20:35:17,701 - game3d.movement.generator - DEBUG - Generator: 644 moves passed validation
2025-11-28 20:35:17,703 - game3d.movement.generator - DEBUG - Generator: 624 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:17,812 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:35:17,813 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140508245391680
2025-11-28 20:35:17,916 - game3d.movement.generator - DEBUG - Generator: 644 pseudolegal moves generated
2025-11-28 20:35:17,918 - game3d.movement.generator - DEBUG - Generator: 644 moves passed validation
2025-11-28 20:35:17,921 - game3d.movement.generator - DEBUG - Generator: 624 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:18,076 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-11-28 20:35:18,080 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-11-28 20:35:18,080 - InferenceServer - INFO - Server Ready. Listening...
2025-11-28 20:35:22,832 - game3d.movement.generator - DEBUG - Generator: 665 pseudolegal moves generated
2025-11-28 20:35:22,833 - game3d.movement.generator - DEBUG - Generator: 665 moves passed validation
2025-11-28 20:35:22,833 - game3d.movement.generator - DEBUG - Generator: 645 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:25,085 - game3d.movement.generator - DEBUG - Generator: 652 pseudolegal moves generated
2025-11-28 20:35:25,085 - game3d.movement.generator - DEBUG - Generator: 652 pseudolegal moves generated
2025-11-28 20:35:25,086 - game3d.movement.generator - DEBUG - Generator: 652 pseudolegal moves generated
2025-11-28 20:35:25,086 - game3d.movement.generator - DEBUG - Generator: 652 moves passed validation
2025-11-28 20:35:25,086 - game3d.movement.generator - DEBUG - Generator: 652 moves passed validation
2025-11-28 20:35:25,087 - game3d.movement.generator - DEBUG - Generator: 652 moves passed validation
2025-11-28 20:35:25,087 - game3d.movement.generator - DEBUG - Generator: 635 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:25,087 - game3d.movement.generator - DEBUG - Generator: 635 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:25,088 - game3d.movement.generator - DEBUG - Generator: 635 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:25,090 - game3d.movement.generator - DEBUG - Generator: 652 pseudolegal moves generated
2025-11-28 20:35:25,090 - game3d.movement.generator - DEBUG - Generator: 652 moves passed validation
2025-11-28 20:35:25,091 - game3d.movement.generator - DEBUG - Generator: 635 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:25,091 - game3d.movement.generator - DEBUG - Generator: 652 pseudolegal moves generated
2025-11-28 20:35:25,092 - game3d.movement.generator - DEBUG - Generator: 652 moves passed validation
2025-11-28 20:35:25,092 - game3d.movement.generator - DEBUG - Generator: 635 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:30,706 - game3d.movement.generator - DEBUG - Generator: 644 pseudolegal moves generated
2025-11-28 20:35:30,706 - game3d.movement.generator - DEBUG - Generator: 644 moves passed validation
2025-11-28 20:35:30,707 - game3d.movement.generator - DEBUG - Generator: 635 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:30,789 - game3d.movement.generator - DEBUG - Generator: 637 pseudolegal moves generated
2025-11-28 20:35:30,790 - game3d.movement.generator - DEBUG - Generator: 637 moves passed validation
2025-11-28 20:35:30,791 - game3d.movement.generator - DEBUG - Generator: 631 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:30,918 - game3d.movement.generator - DEBUG - Generator: 637 pseudolegal moves generated
2025-11-28 20:35:30,919 - game3d.movement.generator - DEBUG - Generator: 637 moves passed validation
2025-11-28 20:35:30,920 - game3d.movement.generator - DEBUG - Generator: 631 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:30,935 - game3d.movement.generator - DEBUG - Generator: 637 pseudolegal moves generated
2025-11-28 20:35:30,935 - game3d.movement.generator - DEBUG - Generator: 637 moves passed validation
2025-11-28 20:35:30,936 - game3d.movement.generator - DEBUG - Generator: 631 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:31,002 - game3d.movement.generator - DEBUG - Generator: 637 pseudolegal moves generated
2025-11-28 20:35:31,002 - game3d.movement.generator - DEBUG - Generator: 637 moves passed validation
2025-11-28 20:35:31,003 - game3d.movement.generator - DEBUG - Generator: 631 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:31,015 - game3d.movement.generator - DEBUG - Generator: 637 pseudolegal moves generated
2025-11-28 20:35:31,015 - game3d.movement.generator - DEBUG - Generator: 637 moves passed validation
2025-11-28 20:35:31,016 - game3d.movement.generator - DEBUG - Generator: 631 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:31,219 - game3d.movement.generator - DEBUG - Generator: 838 pseudolegal moves generated
2025-11-28 20:35:31,220 - game3d.movement.generator - DEBUG - Generator: 838 moves passed validation
2025-11-28 20:35:31,220 - game3d.movement.generator - DEBUG - Generator: 829 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:31,356 - game3d.movement.generator - DEBUG - Generator: 830 pseudolegal moves generated
2025-11-28 20:35:31,358 - game3d.movement.generator - DEBUG - Generator: 830 moves passed validation
2025-11-28 20:35:31,359 - game3d.movement.generator - DEBUG - Generator: 821 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:31,455 - game3d.movement.generator - DEBUG - Generator: 720 pseudolegal moves generated
2025-11-28 20:35:31,455 - game3d.movement.generator - DEBUG - Generator: 720 moves passed validation
2025-11-28 20:35:31,456 - game3d.movement.generator - DEBUG - Generator: 714 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:31,609 - game3d.movement.generator - DEBUG - Generator: 706 pseudolegal moves generated
2025-11-28 20:35:31,611 - game3d.movement.generator - DEBUG - Generator: 706 moves passed validation
2025-11-28 20:35:31,612 - game3d.movement.generator - DEBUG - Generator: 700 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:31,689 - game3d.movement.generator - DEBUG - Generator: 706 pseudolegal moves generated
2025-11-28 20:35:31,690 - game3d.movement.generator - DEBUG - Generator: 706 moves passed validation
2025-11-28 20:35:31,690 - game3d.movement.generator - DEBUG - Generator: 700 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:31,697 - game3d.movement.generator - DEBUG - Generator: 801 pseudolegal moves generated
2025-11-28 20:35:31,697 - game3d.movement.generator - DEBUG - Generator: 801 moves passed validation
2025-11-28 20:35:31,698 - game3d.movement.generator - DEBUG - Generator: 795 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:31,712 - game3d.movement.generator - DEBUG - Generator: 812 pseudolegal moves generated
2025-11-28 20:35:31,713 - game3d.movement.generator - DEBUG - Generator: 812 moves passed validation
2025-11-28 20:35:31,713 - game3d.movement.generator - DEBUG - Generator: 806 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:31,815 - game3d.movement.generator - DEBUG - Generator: 657 pseudolegal moves generated
2025-11-28 20:35:31,817 - game3d.movement.generator - DEBUG - Generator: 657 moves passed validation
2025-11-28 20:35:31,818 - game3d.movement.generator - DEBUG - Generator: 651 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:31,898 - game3d.movement.generator - DEBUG - Generator: 783 pseudolegal moves generated
2025-11-28 20:35:31,898 - game3d.movement.generator - DEBUG - Generator: 783 moves passed validation
2025-11-28 20:35:31,899 - game3d.movement.generator - DEBUG - Generator: 768 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:32,079 - game3d.movement.generator - DEBUG - Generator: 674 pseudolegal moves generated
2025-11-28 20:35:32,079 - game3d.movement.generator - DEBUG - Generator: 674 moves passed validation
2025-11-28 20:35:32,080 - game3d.movement.generator - DEBUG - Generator: 644 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:32,108 - game3d.movement.generator - DEBUG - Generator: 684 pseudolegal moves generated
2025-11-28 20:35:32,109 - game3d.movement.generator - DEBUG - Generator: 684 moves passed validation
2025-11-28 20:35:32,110 - game3d.movement.generator - DEBUG - Generator: 681 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:32,141 - game3d.movement.generator - DEBUG - Generator: 751 pseudolegal moves generated
2025-11-28 20:35:32,142 - game3d.movement.generator - DEBUG - Generator: 751 moves passed validation
2025-11-28 20:35:32,142 - game3d.movement.generator - DEBUG - Generator: 745 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:32,265 - game3d.movement.generator - DEBUG - Generator: 680 pseudolegal moves generated
2025-11-28 20:35:32,265 - game3d.movement.generator - DEBUG - Generator: 680 moves passed validation
2025-11-28 20:35:32,266 - game3d.movement.generator - DEBUG - Generator: 680 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:32,475 - game3d.movement.generator - DEBUG - Generator: 697 pseudolegal moves generated
2025-11-28 20:35:32,476 - game3d.movement.generator - DEBUG - Generator: 697 moves passed validation
2025-11-28 20:35:32,477 - game3d.movement.generator - DEBUG - Generator: 694 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:32,486 - game3d.movement.generator - DEBUG - Generator: 682 pseudolegal moves generated
2025-11-28 20:35:32,486 - game3d.movement.generator - DEBUG - Generator: 682 moves passed validation
2025-11-28 20:35:32,487 - game3d.movement.generator - DEBUG - Generator: 679 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:32,524 - game3d.movement.generator - DEBUG - Generator: 678 pseudolegal moves generated
2025-11-28 20:35:32,525 - game3d.movement.generator - DEBUG - Generator: 678 moves passed validation
2025-11-28 20:35:32,525 - game3d.movement.generator - DEBUG - Generator: 675 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:32,663 - game3d.movement.generator - DEBUG - Generator: 692 pseudolegal moves generated
2025-11-28 20:35:32,665 - game3d.movement.generator - DEBUG - Generator: 692 moves passed validation
2025-11-28 20:35:32,665 - game3d.movement.generator - DEBUG - Generator: 689 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:32,722 - game3d.movement.generator - DEBUG - Generator: 710 pseudolegal moves generated
2025-11-28 20:35:32,722 - game3d.movement.generator - DEBUG - Generator: 710 moves passed validation
2025-11-28 20:35:32,723 - game3d.movement.generator - DEBUG - Generator: 697 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:32,737 - game3d.movement.generator - DEBUG - Generator: 660 pseudolegal moves generated
2025-11-28 20:35:32,738 - game3d.movement.generator - DEBUG - Generator: 660 moves passed validation
2025-11-28 20:35:32,738 - game3d.movement.generator - DEBUG - Generator: 649 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:32,745 - game3d.movement.generator - DEBUG - Generator: 482 pseudolegal moves generated
2025-11-28 20:35:32,746 - game3d.movement.generator - DEBUG - Generator: 482 moves passed validation
2025-11-28 20:35:32,746 - game3d.movement.generator - DEBUG - Generator: 479 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:32,841 - game3d.movement.generator - DEBUG - Generator: 705 pseudolegal moves generated
2025-11-28 20:35:32,843 - game3d.movement.generator - DEBUG - Generator: 705 moves passed validation
2025-11-28 20:35:32,845 - game3d.movement.generator - DEBUG - Generator: 705 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:32,855 - game3d.movement.generator - DEBUG - Generator: 691 pseudolegal moves generated
2025-11-28 20:35:32,856 - game3d.movement.generator - DEBUG - Generator: 691 moves passed validation
2025-11-28 20:35:32,857 - game3d.movement.generator - DEBUG - Generator: 688 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:33,036 - game3d.movement.generator - DEBUG - Generator: 666 pseudolegal moves generated
2025-11-28 20:35:33,037 - game3d.movement.generator - DEBUG - Generator: 666 moves passed validation
2025-11-28 20:35:33,038 - game3d.movement.generator - DEBUG - Generator: 655 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:33,047 - game3d.movement.generator - DEBUG - Generator: 492 pseudolegal moves generated
2025-11-28 20:35:33,047 - game3d.movement.generator - DEBUG - Generator: 492 moves passed validation
2025-11-28 20:35:33,048 - game3d.movement.generator - DEBUG - Generator: 489 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:33,077 - game3d.movement.generator - DEBUG - Generator: 719 pseudolegal moves generated
2025-11-28 20:35:33,078 - game3d.movement.generator - DEBUG - Generator: 719 moves passed validation
2025-11-28 20:35:33,078 - game3d.movement.generator - DEBUG - Generator: 719 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:33,235 - game3d.movement.generator - DEBUG - Generator: 665 pseudolegal moves generated
2025-11-28 20:35:33,238 - game3d.movement.generator - DEBUG - Generator: 665 moves passed validation
2025-11-28 20:35:33,238 - game3d.movement.generator - DEBUG - Generator: 650 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:33,297 - game3d.movement.generator - DEBUG - Generator: 660 pseudolegal moves generated
2025-11-28 20:35:33,297 - game3d.movement.generator - DEBUG - Generator: 660 moves passed validation
2025-11-28 20:35:33,298 - game3d.movement.generator - DEBUG - Generator: 660 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:33,498 - game3d.movement.generator - DEBUG - Generator: 565 pseudolegal moves generated
2025-11-28 20:35:33,498 - game3d.movement.generator - DEBUG - Generator: 565 moves passed validation
2025-11-28 20:35:33,501 - game3d.movement.generator - DEBUG - Generator: 554 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:33,747 - game3d.movement.generator - DEBUG - Generator: 660 pseudolegal moves generated
2025-11-28 20:35:33,747 - game3d.movement.generator - DEBUG - Generator: 660 moves passed validation
2025-11-28 20:35:33,748 - game3d.movement.generator - DEBUG - Generator: 660 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:34,044 - game3d.movement.generator - DEBUG - Generator: 817 pseudolegal moves generated
2025-11-28 20:35:34,045 - game3d.movement.generator - DEBUG - Generator: 817 moves passed validation
2025-11-28 20:35:34,126 - game3d.movement.generator - DEBUG - Generator: 817 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:34,308 - game3d.movement.generator - DEBUG - Generator: 487 pseudolegal moves generated
2025-11-28 20:35:34,308 - game3d.movement.generator - DEBUG - Generator: 487 moves passed validation
2025-11-28 20:35:34,309 - game3d.movement.generator - DEBUG - Generator: 487 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:34,571 - game3d.movement.generator - DEBUG - Generator: 808 pseudolegal moves generated
2025-11-28 20:35:34,571 - game3d.movement.generator - DEBUG - Generator: 808 moves passed validation
2025-11-28 20:35:34,572 - game3d.movement.generator - DEBUG - Generator: 782 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:35,127 - game3d.movement.generator - DEBUG - Generator: 574 pseudolegal moves generated
2025-11-28 20:35:35,130 - game3d.movement.generator - DEBUG - Generator: 574 moves passed validation
2025-11-28 20:35:35,130 - game3d.movement.generator - DEBUG - Generator: 566 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:35,145 - game3d.movement.generator - DEBUG - Generator: 442 pseudolegal moves generated
2025-11-28 20:35:35,146 - game3d.movement.generator - DEBUG - Generator: 442 moves passed validation
2025-11-28 20:35:35,146 - game3d.movement.generator - DEBUG - Generator: 442 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:35,283 - game3d.movement.generator - DEBUG - Generator: 493 pseudolegal moves generated
2025-11-28 20:35:35,284 - game3d.movement.generator - DEBUG - Generator: 493 moves passed validation
2025-11-28 20:35:35,285 - game3d.movement.generator - DEBUG - Generator: 493 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:35,566 - game3d.movement.generator - DEBUG - Generator: 447 pseudolegal moves generated
2025-11-28 20:35:35,566 - game3d.movement.generator - DEBUG - Generator: 447 moves passed validation
2025-11-28 20:35:35,567 - game3d.movement.generator - DEBUG - Generator: 447 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:35,579 - game3d.movement.generator - DEBUG - Generator: 420 pseudolegal moves generated
2025-11-28 20:35:35,579 - game3d.movement.generator - DEBUG - Generator: 420 moves passed validation
2025-11-28 20:35:35,580 - game3d.movement.generator - DEBUG - Generator: 420 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:35,700 - game3d.movement.generator - DEBUG - Generator: 457 pseudolegal moves generated
2025-11-28 20:35:35,701 - game3d.movement.generator - DEBUG - Generator: 457 moves passed validation
2025-11-28 20:35:35,702 - game3d.movement.generator - DEBUG - Generator: 456 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:35,768 - game3d.movement.generator - DEBUG - Generator: 487 pseudolegal moves generated
2025-11-28 20:35:35,768 - game3d.movement.generator - DEBUG - Generator: 487 moves passed validation
2025-11-28 20:35:35,768 - game3d.movement.generator - DEBUG - Generator: 486 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:36,008 - game3d.movement.generator - DEBUG - Generator: 481 pseudolegal moves generated
2025-11-28 20:35:36,008 - game3d.movement.generator - DEBUG - Generator: 481 moves passed validation
2025-11-28 20:35:36,011 - game3d.movement.generator - DEBUG - Generator: 410 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:36,255 - game3d.movement.generator - DEBUG - Generator: 491 pseudolegal moves generated
2025-11-28 20:35:36,255 - game3d.movement.generator - DEBUG - Generator: 491 moves passed validation
2025-11-28 20:35:36,255 - game3d.movement.generator - DEBUG - Generator: 490 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:36,285 - game3d.movement.generator - DEBUG - Generator: 474 pseudolegal moves generated
2025-11-28 20:35:36,287 - game3d.movement.generator - DEBUG - Generator: 474 moves passed validation
2025-11-28 20:35:36,287 - game3d.movement.generator - DEBUG - Generator: 473 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:36,797 - game3d.movement.generator - DEBUG - Generator: 678 pseudolegal moves generated
2025-11-28 20:35:36,797 - game3d.movement.generator - DEBUG - Generator: 678 moves passed validation
2025-11-28 20:35:36,798 - game3d.movement.generator - DEBUG - Generator: 678 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:37,023 - game3d.movement.generator - DEBUG - Generator: 643 pseudolegal moves generated
2025-11-28 20:35:37,024 - game3d.movement.generator - DEBUG - Generator: 643 moves passed validation
2025-11-28 20:35:37,024 - game3d.movement.generator - DEBUG - Generator: 625 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:37,233 - game3d.movement.generator - DEBUG - Generator: 481 pseudolegal moves generated
2025-11-28 20:35:37,235 - game3d.movement.generator - DEBUG - Generator: 481 moves passed validation
2025-11-28 20:35:37,236 - game3d.movement.generator - DEBUG - Generator: 480 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:38,001 - game3d.movement.generator - DEBUG - Generator: 507 pseudolegal moves generated
2025-11-28 20:35:38,002 - game3d.movement.generator - DEBUG - Generator: 507 moves passed validation
2025-11-28 20:35:38,003 - game3d.movement.generator - DEBUG - Generator: 505 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:38,233 - game3d.movement.generator - DEBUG - Generator: 519 pseudolegal moves generated
2025-11-28 20:35:38,234 - game3d.movement.generator - DEBUG - Generator: 519 moves passed validation
2025-11-28 20:35:38,237 - game3d.movement.generator - DEBUG - Generator: 517 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:38,295 - game3d.movement.generator - DEBUG - Generator: 572 pseudolegal moves generated
2025-11-28 20:35:38,296 - game3d.movement.generator - DEBUG - Generator: 572 moves passed validation
2025-11-28 20:35:38,296 - game3d.movement.generator - DEBUG - Generator: 572 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:40,005 - game3d.movement.generator - DEBUG - Generator: 597 pseudolegal moves generated
2025-11-28 20:35:40,006 - game3d.movement.generator - DEBUG - Generator: 597 moves passed validation
2025-11-28 20:35:40,006 - game3d.movement.generator - DEBUG - Generator: 597 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:40,506 - game3d.movement.generator - DEBUG - Generator: 604 pseudolegal moves generated
2025-11-28 20:35:40,506 - game3d.movement.generator - DEBUG - Generator: 604 moves passed validation
2025-11-28 20:35:40,508 - game3d.movement.generator - DEBUG - Generator: 600 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:40,846 - game3d.game.turnmove - INFO - Move 100: BLACK INFILTRATOR [2 5 7]->[3 6 7] (Capture)
2025-11-28 20:35:40,986 - game3d.movement.generator - DEBUG - Generator: 604 pseudolegal moves generated
2025-11-28 20:35:40,987 - game3d.movement.generator - DEBUG - Generator: 604 moves passed validation
2025-11-28 20:35:40,987 - game3d.movement.generator - DEBUG - Generator: 586 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:41,854 - game3d.movement.generator - DEBUG - Generator: 598 pseudolegal moves generated
2025-11-28 20:35:41,855 - game3d.movement.generator - DEBUG - Generator: 598 moves passed validation
2025-11-28 20:35:41,856 - game3d.movement.generator - DEBUG - Generator: 598 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:42,055 - game3d.movement.generator - DEBUG - Generator: 599 pseudolegal moves generated
2025-11-28 20:35:42,056 - game3d.movement.generator - DEBUG - Generator: 599 moves passed validation
2025-11-28 20:35:42,058 - game3d.movement.generator - DEBUG - Generator: 581 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:42,414 - game3d.movement.generator - DEBUG - Generator: 316 pseudolegal moves generated
2025-11-28 20:35:42,415 - game3d.movement.generator - DEBUG - Generator: 316 moves passed validation
2025-11-28 20:35:42,418 - game3d.movement.generator - DEBUG - Generator: 316 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:43,502 - game3d.movement.generator - DEBUG - Generator: 686 pseudolegal moves generated
2025-11-28 20:35:43,503 - game3d.movement.generator - DEBUG - Generator: 686 moves passed validation
2025-11-28 20:35:43,506 - game3d.movement.generator - DEBUG - Generator: 686 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:43,513 - game3d.game.turnmove - INFO - Move 100: WHITE BISHOP [5 8 2]->[6 8 3] (Move)
2025-11-28 20:35:44,943 - game3d.movement.generator - DEBUG - Generator: 758 pseudolegal moves generated
2025-11-28 20:35:44,946 - game3d.movement.generator - DEBUG - Generator: 758 moves passed validation
2025-11-28 20:35:44,947 - game3d.movement.generator - DEBUG - Generator: 754 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:45,338 - game3d.movement.generator - DEBUG - Generator: 639 pseudolegal moves generated
2025-11-28 20:35:45,341 - game3d.movement.generator - DEBUG - Generator: 639 moves passed validation
2025-11-28 20:35:45,341 - game3d.movement.generator - DEBUG - Generator: 639 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:45,525 - game3d.movement.generator - DEBUG - Generator: 642 pseudolegal moves generated
2025-11-28 20:35:45,527 - game3d.movement.generator - DEBUG - Generator: 642 moves passed validation
2025-11-28 20:35:45,527 - game3d.movement.generator - DEBUG - Generator: 642 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:45,739 - game3d.movement.generator - DEBUG - Generator: 653 pseudolegal moves generated
2025-11-28 20:35:45,742 - game3d.movement.generator - DEBUG - Generator: 653 moves passed validation
2025-11-28 20:35:45,743 - game3d.movement.generator - DEBUG - Generator: 653 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:46,004 - game3d.movement.generator - DEBUG - Generator: 797 pseudolegal moves generated
2025-11-28 20:35:46,004 - game3d.movement.generator - DEBUG - Generator: 797 moves passed validation
2025-11-28 20:35:46,005 - game3d.movement.generator - DEBUG - Generator: 793 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:46,100 - game3d.movement.generator - DEBUG - Generator: 650 pseudolegal moves generated
2025-11-28 20:35:46,101 - game3d.movement.generator - DEBUG - Generator: 650 moves passed validation
2025-11-28 20:35:46,102 - game3d.movement.generator - DEBUG - Generator: 650 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:46,973 - game3d.movement.generator - DEBUG - Generator: 724 pseudolegal moves generated
2025-11-28 20:35:46,973 - game3d.movement.generator - DEBUG - Generator: 724 moves passed validation
2025-11-28 20:35:46,975 - game3d.movement.generator - DEBUG - Generator: 720 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:47,067 - game3d.movement.generator - DEBUG - Generator: 666 pseudolegal moves generated
2025-11-28 20:35:47,068 - game3d.movement.generator - DEBUG - Generator: 666 moves passed validation
2025-11-28 20:35:47,068 - game3d.movement.generator - DEBUG - Generator: 666 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:47,238 - game3d.movement.generator - DEBUG - Generator: 665 pseudolegal moves generated
2025-11-28 20:35:47,239 - game3d.movement.generator - DEBUG - Generator: 665 moves passed validation
2025-11-28 20:35:47,240 - game3d.movement.generator - DEBUG - Generator: 665 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:47,347 - game3d.movement.generator - DEBUG - Generator: 749 pseudolegal moves generated
2025-11-28 20:35:47,348 - game3d.movement.generator - DEBUG - Generator: 749 moves passed validation
2025-11-28 20:35:47,348 - game3d.movement.generator - DEBUG - Generator: 739 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:47,527 - game3d.movement.generator - DEBUG - Generator: 755 pseudolegal moves generated
2025-11-28 20:35:47,528 - game3d.movement.generator - DEBUG - Generator: 755 moves passed validation
2025-11-28 20:35:47,529 - game3d.movement.generator - DEBUG - Generator: 733 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:48,273 - game3d.movement.generator - DEBUG - Generator: 724 pseudolegal moves generated
2025-11-28 20:35:48,274 - game3d.movement.generator - DEBUG - Generator: 724 moves passed validation
2025-11-28 20:35:48,275 - game3d.movement.generator - DEBUG - Generator: 714 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:48,875 - game3d.movement.generator - DEBUG - Generator: 701 pseudolegal moves generated
2025-11-28 20:35:48,877 - game3d.movement.generator - DEBUG - Generator: 701 moves passed validation
2025-11-28 20:35:48,877 - game3d.movement.generator - DEBUG - Generator: 691 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:49,037 - game3d.movement.generator - DEBUG - Generator: 765 pseudolegal moves generated
2025-11-28 20:35:49,038 - game3d.movement.generator - DEBUG - Generator: 765 moves passed validation
2025-11-28 20:35:49,038 - game3d.movement.generator - DEBUG - Generator: 746 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:49,182 - game3d.game.turnmove - INFO - Move 200: BLACK TRIGONALBISHOP [4 1 7]->[3 2 6] (Capture)
2025-11-28 20:35:49,210 - game3d.movement.generator - DEBUG - Generator: 774 pseudolegal moves generated
2025-11-28 20:35:49,211 - game3d.movement.generator - DEBUG - Generator: 774 moves passed validation
2025-11-28 20:35:49,214 - game3d.movement.generator - DEBUG - Generator: 764 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:50,150 - game3d.movement.generator - DEBUG - Generator: 876 pseudolegal moves generated
2025-11-28 20:35:50,151 - game3d.movement.generator - DEBUG - Generator: 876 moves passed validation
2025-11-28 20:35:50,152 - game3d.movement.generator - DEBUG - Generator: 865 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:51,490 - game3d.movement.generator - DEBUG - Generator: 679 pseudolegal moves generated
2025-11-28 20:35:51,492 - game3d.movement.generator - DEBUG - Generator: 679 moves passed validation
2025-11-28 20:35:51,680 - game3d.movement.generator - DEBUG - Generator: 665 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:53,810 - game3d.movement.generator - DEBUG - Generator: 671 pseudolegal moves generated
2025-11-28 20:35:53,811 - game3d.movement.generator - DEBUG - Generator: 671 moves passed validation
2025-11-28 20:35:53,993 - game3d.movement.generator - DEBUG - Generator: 660 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:55,700 - game3d.movement.generator - DEBUG - Generator: 531 pseudolegal moves generated
2025-11-28 20:35:55,701 - game3d.movement.generator - DEBUG - Generator: 531 moves passed validation
2025-11-28 20:35:55,701 - game3d.movement.generator - DEBUG - Generator: 531 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:56,551 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-11-28 20:35:56,601 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 20:35:56,648 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 20:35:56,739 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 20:35:56,781 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 20:35:56,863 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 20:35:56,932 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:35:56,933 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140503857911008
2025-11-28 20:35:57,045 - game3d.movement.generator - DEBUG - Generator: 644 pseudolegal moves generated
2025-11-28 20:35:57,046 - game3d.movement.generator - DEBUG - Generator: 644 moves passed validation
2025-11-28 20:35:57,046 - game3d.movement.generator - DEBUG - Generator: 624 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:57,400 - game3d.movement.generator - DEBUG - Generator: 652 pseudolegal moves generated
2025-11-28 20:35:57,402 - game3d.movement.generator - DEBUG - Generator: 652 moves passed validation
2025-11-28 20:35:57,402 - game3d.movement.generator - DEBUG - Generator: 635 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:58,020 - game3d.movement.generator - DEBUG - Generator: 637 pseudolegal moves generated
2025-11-28 20:35:58,021 - game3d.movement.generator - DEBUG - Generator: 637 moves passed validation
2025-11-28 20:35:58,021 - game3d.movement.generator - DEBUG - Generator: 631 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:58,658 - game3d.movement.generator - DEBUG - Generator: 552 pseudolegal moves generated
2025-11-28 20:35:58,660 - game3d.movement.generator - DEBUG - Generator: 552 moves passed validation
2025-11-28 20:35:58,661 - game3d.movement.generator - DEBUG - Generator: 552 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:59,059 - game3d.movement.generator - DEBUG - Generator: 814 pseudolegal moves generated
2025-11-28 20:35:59,060 - game3d.movement.generator - DEBUG - Generator: 814 moves passed validation
2025-11-28 20:35:59,061 - game3d.movement.generator - DEBUG - Generator: 808 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:59,232 - game3d.movement.generator - DEBUG - Generator: 805 pseudolegal moves generated
2025-11-28 20:35:59,233 - game3d.movement.generator - DEBUG - Generator: 805 moves passed validation
2025-11-28 20:35:59,234 - game3d.movement.generator - DEBUG - Generator: 799 moves passed all filters (Final Legal Moves)
2025-11-28 20:35:59,416 - game3d.movement.generator - DEBUG - Generator: 799 pseudolegal moves generated
2025-11-28 20:35:59,417 - game3d.movement.generator - DEBUG - Generator: 799 moves passed validation
2025-11-28 20:35:59,418 - game3d.movement.generator - DEBUG - Generator: 793 moves passed all filters (Final Legal Moves)
2025-11-28 20:36:00,001 - game3d.movement.generator - DEBUG - Generator: 767 pseudolegal moves generated
2025-11-28 20:36:00,002 - game3d.movement.generator - DEBUG - Generator: 767 moves passed validation
2025-11-28 20:36:00,005 - game3d.movement.generator - DEBUG - Generator: 764 moves passed all filters (Final Legal Moves)
2025-11-28 20:36:00,026 - game3d.movement.generator - DEBUG - Generator: 577 pseudolegal moves generated
2025-11-28 20:36:00,028 - game3d.movement.generator - DEBUG - Generator: 577 moves passed validation
2025-11-28 20:36:00,029 - game3d.movement.generator - DEBUG - Generator: 577 moves passed all filters (Final Legal Moves)
2025-11-28 20:36:00,173 - game3d.movement.generator - DEBUG - Generator: 704 pseudolegal moves generated
2025-11-28 20:36:00,174 - game3d.movement.generator - DEBUG - Generator: 704 moves passed validation
2025-11-28 20:36:00,175 - game3d.movement.generator - DEBUG - Generator: 674 moves passed all filters (Final Legal Moves)
2025-11-28 20:36:00,361 - game3d.movement.generator - DEBUG - Generator: 581 pseudolegal moves generated
2025-11-28 20:36:00,361 - game3d.movement.generator - DEBUG - Generator: 581 moves passed validation
2025-11-28 20:36:00,362 - game3d.movement.generator - DEBUG - Generator: 581 moves passed all filters (Final Legal Moves)
2025-11-28 20:36:00,747 - game3d.movement.generator - DEBUG - Generator: 590 pseudolegal moves generated
2025-11-28 20:36:00,748 - game3d.movement.generator - DEBUG - Generator: 590 moves passed validation
2025-11-28 20:36:00,750 - game3d.movement.generator - DEBUG - Generator: 590 moves passed all filters (Final Legal Moves)
2025-11-28 20:36:01,640 - game3d.movement.generator - DEBUG - Generator: 413 pseudolegal moves generated
2025-11-28 20:36:01,640 - game3d.movement.generator - DEBUG - Generator: 413 moves passed validation
2025-11-28 20:36:01,641 - game3d.movement.generator - DEBUG - Generator: 413 moves passed all filters (Final Legal Moves)
2025-11-28 20:36:01,901 - game3d.movement.generator - DEBUG - Generator: 479 pseudolegal moves generated
2025-11-28 20:36:01,902 - game3d.movement.generator - DEBUG - Generator: 479 moves passed validation
2025-11-28 20:36:01,967 - game3d.movement.generator - DEBUG - Generator: 561 pseudolegal moves generated
2025-11-28 20:36:01,968 - game3d.movement.generator - DEBUG - Generator: 561 moves passed validation
2025-11-28 20:36:02,002 - game3d.movement.generator - DEBUG - Generator: 440 moves passed all filters (Final Legal Moves)
2025-11-28 20:36:02,042 - InferenceServer - INFO - Server shutting down.
2025-11-28 20:36:02,042 - training.parallel_self_play - INFO - Stopping Server...
2025-11-28 20:36:02,042 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f4f217c3100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f4f21ce2160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 472, in update_legal_moves_incremental
    raw_moves = generate_pseudolegal_moves_batch(state, regenerate_coords, debuffed_coords, ignore_occupancy=True)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f4f217c3100>) returned a result with an exception set
2025-11-28 20:36:02,042 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f6033bc3100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: infiltrator_move_dispatcher() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f60340e2160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 266, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 338, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 112, in infiltrator_move_dispatcher
    return generate_infiltrator_moves(state.cache_manager, state.color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 38, in generate_infiltrator_moves
    teleport_dirs = _get_pawn_front_directions(cache_manager, color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 75, in _get_pawn_front_directions
    _, piece_types = cache_manager.occupancy_cache.batch_get_attributes(enemy_coords)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f6033bc3100>) returned a result with an exception set
2025-11-28 20:36:02,042 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fb65edc3100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7fb65f2de160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 266, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 338, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fb65edc3100>) returned a result with an exception set
2025-11-28 20:36:02,042 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f48fdec7100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: wall_move_dispatcher() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f48fe3ea160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 266, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 338, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/wall.py", line 215, in wall_move_dispatcher
    return generate_wall_moves(state.cache_manager, state.color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/wall.py", line 168, in generate_wall_moves
    colors, types = cache_manager.occupancy_cache.batch_get_attributes(target_squares)
                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f48fdec7100>) returned a result with an exception set
2025-11-28 20:36:02,044 - worker.5 - ERROR - Worker 5 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f4f217c3100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f4f21ce2160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 472, in update_legal_moves_incremental
    raw_moves = generate_pseudolegal_moves_batch(state, regenerate_coords, debuffed_coords, ignore_occupancy=True)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f4f217c3100>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f4f217c3100>) returned a result with an exception set
2025-11-28 20:36:02,044 - worker.3 - ERROR - Worker 3 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f6033bc3100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: infiltrator_move_dispatcher() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f60340e2160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 266, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 338, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 112, in infiltrator_move_dispatcher
    return generate_infiltrator_moves(state.cache_manager, state.color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 38, in generate_infiltrator_moves
    teleport_dirs = _get_pawn_front_directions(cache_manager, color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 75, in _get_pawn_front_directions
    _, piece_types = cache_manager.occupancy_cache.batch_get_attributes(enemy_coords)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f6033bc3100>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f6033bc3100>) returned a result with an exception set
2025-11-28 20:36:02,044 - worker.2 - ERROR - Worker 2 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fb65edc3100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7fb65f2de160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 266, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 338, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes(push_pos)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fb65edc3100>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7fb65edc3100>) returned a result with an exception set
2025-11-28 20:36:02,045 - worker.1 - ERROR - Worker 1 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f48fdec7100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: wall_move_dispatcher() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f48fe3ea160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 266, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 338, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/wall.py", line 215, in wall_move_dispatcher
    return generate_wall_moves(state.cache_manager, state.color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/wall.py", line 168, in generate_wall_moves
    colors, types = cache_manager.occupancy_cache.batch_get_attributes(target_squares)
                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f48fdec7100>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f48fdec7100>) returned a result with an exception set
2025-11-28 20:36:02,069 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:36:02,069 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:36:02,069 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:36:02,069 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139977722117376
2025-11-28 20:36:02,069 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140051125731184
2025-11-28 20:36:02,070 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140421256714736
2025-11-28 20:36:02,070 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:36:02,070 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139946574200544
2025-11-28 20:36:02,163 - game3d.movement.generator - DEBUG - Generator: 644 pseudolegal moves generated
2025-11-28 20:36:02,164 - game3d.movement.generator - DEBUG - Generator: 644 moves passed validation
2025-11-28 20:36:02,164 - game3d.movement.generator - DEBUG - Generator: 644 pseudolegal moves generated
2025-11-28 20:36:02,164 - game3d.movement.generator - DEBUG - Generator: 624 moves passed all filters (Final Legal Moves)
2025-11-28 20:36:02,165 - game3d.movement.generator - DEBUG - Generator: 644 moves passed validation
2025-11-28 20:36:02,165 - game3d.movement.generator - DEBUG - Generator: 624 moves passed all filters (Final Legal Moves)
2025-11-28 20:36:02,166 - game3d.movement.generator - DEBUG - Generator: 644 pseudolegal moves generated
2025-11-28 20:36:02,167 - game3d.movement.generator - DEBUG - Generator: 644 moves passed validation
2025-11-28 20:36:02,167 - game3d.movement.generator - DEBUG - Generator: 624 moves passed all filters (Final Legal Moves)
2025-11-28 20:36:02,170 - game3d.movement.generator - DEBUG - Generator: 644 pseudolegal moves generated
2025-11-28 20:36:02,170 - game3d.movement.generator - DEBUG - Generator: 644 moves passed validation
2025-11-28 20:36:02,171 - game3d.movement.generator - DEBUG - Generator: 624 moves passed all filters (Final Legal Moves)
2025-11-28 20:36:02,294 - __main__ - INFO - Training interrupted by user
2025-11-28 20:36:02,520 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 20:37:00,519 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 20:37:00,520 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:37:00,521 - __main__ - INFO - Testing move generation...
2025-11-28 20:37:00,860 - __main__ - INFO - [OK] Generated 624 moves
2025-11-28 20:37:00,860 - __main__ - INFO - Testing GameState caching...
2025-11-28 20:37:00,861 - __main__ - INFO - [OK] GameState caching works
2025-11-28 20:37:00,861 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 20:37:00,861 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 20:37:00,861 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(624), 'piece_moves_cache_size': 27, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 20:37:02,333 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_203656/temp_model_for_selfplay.pt
2025-11-28 20:37:02,333 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 12 games, 6 workers
2025-11-28 20:37:05,137 - training.parallel_self_play - INFO - Launching workers...
2025-11-28 20:37:13,630 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-11-28 20:37:16,772 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:37:16,773 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140234375214608
2025-11-28 20:37:16,837 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:37:16,838 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140676489491072
2025-11-28 20:37:17,074 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:37:17,075 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139883642222672
2025-11-28 20:37:17,142 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:37:17,143 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140059247241456
2025-11-28 20:37:17,548 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:37:17,549 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139778436527632
2025-11-28 20:37:17,634 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:37:17,635 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140194888938976
2025-11-28 20:37:18,936 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-11-28 20:37:18,941 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-11-28 20:37:18,941 - InferenceServer - INFO - Server Ready. Listening...
2025-11-28 20:37:41,567 - game3d.game.turnmove - INFO - Move 100: WHITE MIRROR [7 4 0]->[7 4 1] (Capture)
2025-11-28 20:38:11,595 - game3d.game.turnmove - INFO - Move 100: WHITE ECHO [3 8 0]->[3 7 1] (Move)
2025-11-28 20:39:23,242 - game3d.game.turnmove - INFO - Move 100: WHITE GEOMANCER [3 0 1]->[3 1 4] (Move)
2025-11-28 20:39:36,589 - game3d.game.turnmove - INFO - Move 200: BLACK WHITEHOLE [0 2 6]->[0 2 5] (Capture)
2025-11-28 20:39:47,662 - game3d.game.turnmove - INFO - Move 200: BLACK PAWN [3 8 6]->[4 7 5] (Capture)
2025-11-28 20:40:02,512 - game3d.game.turnmove - INFO - Move 200: WHITE NEBULA [2 5 0]->[3 5 0] (Capture)
2025-11-28 20:40:28,491 - game3d.game.turnmove - INFO - Move 100: BLACK PANEL [2 6 8]->[3 6 8] (Capture)
2025-11-28 20:41:00,857 - game3d.game.turnmove - INFO - Move 100: BLACK KNIGHT32 [5 5 8]->[7 3 5] (Move)
2025-11-28 20:41:06,367 - game3d.game.turnmove - INFO - Move 100: WHITE XZQUEEN [8 2 6]->[8 2 8] (Capture)
2025-11-28 20:41:39,881 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-11-28 20:41:39,919 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 20:41:39,967 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 20:41:40,044 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 20:41:40,092 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 20:41:40,175 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 20:41:40,425 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:41:40,426 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140195072774624
2025-11-28 20:42:20,734 - game3d.game.turnmove - INFO - Move 300: WHITE REFLECTOR [0 0 0]->[6 6 6] (Capture)
2025-11-28 20:42:36,308 - game3d.game.turnmove - INFO - Move 100: BLACK PAWN [3 1 6]->[2 0 5] (Capture)
2025-11-28 20:43:02,659 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-11-28 20:43:02,712 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 20:43:02,746 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 20:43:02,853 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 20:43:02,892 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 20:43:02,969 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 20:43:03,265 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:43:03,265 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139778629143376
2025-11-28 20:43:14,296 - game3d.game.turnmove - INFO - Move 100: WHITE TRIGONALBISHOP [6 7 6]->[5 6 7] (Capture)
2025-11-28 20:43:22,963 - game3d.game.turnmove - INFO - Move 200: WHITE XYQUEEN [4 3 1]->[3 4 0] (Move)
2025-11-28 20:43:31,855 - game3d.game.turnmove - INFO - Move 300: WHITE ECHO [2 1 7]->[2 2 6] (Capture)
2025-11-28 20:44:55,571 - game3d.game.turnmove - INFO - Move 200: WHITE KNIGHT32 [5 5 3]->[7 3 6] (Capture)
2025-11-28 20:46:19,098 - InferenceServer - INFO - Server shutting down.
2025-11-28 20:46:19,098 - training.parallel_self_play - INFO - Stopping Server...
2025-11-28 20:46:19,098 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f39343c3100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f39348e2160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 266, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 338, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    # âœ… OPTIMIZATION: Use unsafe access
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f39343c3100>) returned a result with an exception set
2025-11-28 20:46:19,098 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f8add6c7100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: wall_move_dispatcher() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f8addbe6160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 266, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 338, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/wall.py", line 215, in wall_move_dispatcher
    return generate_wall_moves(state.cache_manager, state.color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/wall.py", line 168, in generate_wall_moves
    colors, types = cache_manager.occupancy_cache.batch_get_attributes(target_squares)
                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f8add6c7100>) returned a result with an exception set
2025-11-28 20:46:19,100 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7ff1cd1cf100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7ff1cd6ee160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 266, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 338, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    # âœ… OPTIMIZATION: Use unsafe access
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7ff1cd1cf100>) returned a result with an exception set
2025-11-28 20:46:19,101 - worker.2 - ERROR - Worker 2 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f39343c3100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f39348e2160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 266, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 338, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    # âœ… OPTIMIZATION: Use unsafe access
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f39343c3100>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f39343c3100>) returned a result with an exception set
2025-11-28 20:46:19,102 - worker.1 - ERROR - Worker 1 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f8add6c7100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: wall_move_dispatcher() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f8addbe6160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 266, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 338, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/wall.py", line 215, in wall_move_dispatcher
    return generate_wall_moves(state.cache_manager, state.color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/wall.py", line 168, in generate_wall_moves
    colors, types = cache_manager.occupancy_cache.batch_get_attributes(target_squares)
                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f8add6c7100>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f8add6c7100>) returned a result with an exception set
2025-11-28 20:46:19,102 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f62171c3100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: wall_move_dispatcher() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f62176de160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 266, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 338, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/wall.py", line 215, in wall_move_dispatcher
    return generate_wall_moves(state.cache_manager, state.color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/wall.py", line 168, in generate_wall_moves
    colors, types = cache_manager.occupancy_cache.batch_get_attributes(target_squares)
                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f62171c3100>) returned a result with an exception set
2025-11-28 20:46:19,103 - worker.0 - ERROR - Worker 0 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7ff1cd1cf100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7ff1cd6ee160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 266, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 338, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 96, in generate_pawn_moves
    # âœ… OPTIMIZATION: Use unsafe access
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7ff1cd1cf100>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7ff1cd1cf100>) returned a result with an exception set
2025-11-28 20:46:19,105 - worker.3 - ERROR - Worker 3 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f62171c3100>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: wall_move_dispatcher() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f62176de160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 266, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 338, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/wall.py", line 215, in wall_move_dispatcher
    return generate_wall_moves(state.cache_manager, state.color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/wall.py", line 168, in generate_wall_moves
    colors, types = cache_manager.occupancy_cache.batch_get_attributes(target_squares)
                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 206, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f62171c3100>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f62171c3100>) returned a result with an exception set
2025-11-28 20:46:19,122 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:46:19,122 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140054263116608
2025-11-28 20:46:19,124 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:46:19,125 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139883616337440
2025-11-28 20:46:19,125 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:46:19,125 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140229496782176
2025-11-28 20:46:19,125 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:46:19,125 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140671604702416
2025-11-28 20:46:19,392 - __main__ - INFO - Training interrupted by user
2025-11-28 20:46:19,629 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 20:46:35,116 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 20:46:35,117 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:46:35,118 - __main__ - INFO - Testing move generation...
2025-11-28 20:46:35,480 - __main__ - INFO - [OK] Generated 624 moves
2025-11-28 20:46:35,480 - __main__ - INFO - Testing GameState caching...
2025-11-28 20:46:35,481 - __main__ - INFO - [OK] GameState caching works
2025-11-28 20:46:35,481 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 20:46:35,481 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 20:46:35,481 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(624), 'piece_moves_cache_size': 27, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 20:46:36,991 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_204631/temp_model_for_selfplay.pt
2025-11-28 20:46:36,991 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 12 games, 6 workers
2025-11-28 20:46:39,809 - training.parallel_self_play - INFO - Launching workers...
2025-11-28 20:46:48,256 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-11-28 20:46:52,667 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:46:52,669 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139760019322192
2025-11-28 20:46:52,681 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:46:52,683 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140680956391824
2025-11-28 20:46:52,783 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:46:52,784 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139646871664816
2025-11-28 20:46:53,079 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:46:53,080 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140359139981728
2025-11-28 20:46:53,244 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:46:53,245 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139947081737280
2025-11-28 20:46:53,351 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:46:53,352 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140551534034416
2025-11-28 20:46:54,304 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-11-28 20:46:54,309 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-11-28 20:46:54,309 - InferenceServer - INFO - Server Ready. Listening...
2025-11-28 20:49:05,930 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-28 20:49:06,051 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 20:49:06,135 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 20:49:06,345 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 20:49:06,432 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 20:49:06,599 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 20:49:06,705 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:49:06,705 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140680928656160
2025-11-28 20:49:52,450 - game3d.game.turnmove - INFO - Move 100: WHITE ORBITER [0 2 6]->[3 1 6] (Capture)
2025-11-28 20:50:31,493 - InferenceServer - INFO - Server shutting down.
2025-11-28 20:50:31,493 - training.parallel_self_play - INFO - Stopping Server...
2025-11-28 20:50:31,493 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes_unsafe at 0x7fa7ea1c3380>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7fa7ea6de160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 266, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 338, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 122, in generate_pawn_moves
    dest_colors, dest_types = cache_manager.occupancy_cache.batch_get_attributes_unsafe(valid_capture_dests)
                              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 222, in batch_get_attributes_unsafe
    Use ONLY for pre-validated coordinates from trusted sources.
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SystemError: CPUDispatcher(<function _vectorized_batch_attributes_unsafe at 0x7fa7ea1c3380>) returned a result with an exception set
2025-11-28 20:50:31,493 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes_unsafe at 0x7f1c6bbbf380>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f1c6c0de160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 266, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 338, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 122, in generate_pawn_moves
    dest_colors, dest_types = cache_manager.occupancy_cache.batch_get_attributes_unsafe(valid_capture_dests)
                              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 222, in batch_get_attributes_unsafe
    Use ONLY for pre-validated coordinates from trusted sources.
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SystemError: CPUDispatcher(<function _vectorized_batch_attributes_unsafe at 0x7f1c6bbbf380>) returned a result with an exception set
2025-11-28 20:50:31,493 - worker.5 - ERROR - Worker 5 failed: CPUDispatcher(<function _vectorized_batch_attributes_unsafe at 0x7f47f79c3380>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f47f7ede160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 113, in submit_move
    is_game_over=_terminal_is_game_over(new_state),
                 ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/usr/lib/python3.13/contextlib.py", line 85, in inner
    return func(*args, **kwds)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/terminal.py", line 229, in is_game_over
    legal_moves = game_state.legal_moves
                  ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/gamestate.py", line 231, in legal_moves
    return turnmove.legal_moves(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 54, in legal_moves
    structured_moves = generate_legal_moves(game_state)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 530, in generate_legal_moves
    return _generator.generate(state)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 161, in generate
    return self.generate_fused(state)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 258, in generate_fused
    final_moves = self._apply_all_filters(state, final_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 266, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 338, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 83, in generate_pawn_moves
    colors, _ = cache_manager.occupancy_cache.batch_get_attributes_unsafe(check_positions)
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 222, in batch_get_attributes_unsafe
    Use ONLY for pre-validated coordinates from trusted sources.
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SystemError: CPUDispatcher(<function _vectorized_batch_attributes_unsafe at 0x7f47f79c3380>) returned a result with an exception set
2025-11-28 20:50:31,496 - worker.3 - ERROR - Worker 3 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes_unsafe at 0x7fa7ea1c3380>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7fa7ea6de160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 266, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 338, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 122, in generate_pawn_moves
    dest_colors, dest_types = cache_manager.occupancy_cache.batch_get_attributes_unsafe(valid_capture_dests)
                              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 222, in batch_get_attributes_unsafe
    Use ONLY for pre-validated coordinates from trusted sources.
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SystemError: CPUDispatcher(<function _vectorized_batch_attributes_unsafe at 0x7fa7ea1c3380>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes_unsafe at 0x7fa7ea1c3380>) returned a result with an exception set
2025-11-28 20:50:31,496 - worker.0 - ERROR - Worker 0 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes_unsafe at 0x7f1c6bbbf380>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: generate_pseudolegal_moves_batch.<locals>.<lambda>() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f1c6c0de160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 266, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 338, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 270, in <lambda>
    dispatcher = lambda s, p: generate_pawn_moves(s.cache_manager, s.color, p)
                              ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/pawn.py", line 122, in generate_pawn_moves
    dest_colors, dest_types = cache_manager.occupancy_cache.batch_get_attributes_unsafe(valid_capture_dests)
                              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 222, in batch_get_attributes_unsafe
    Use ONLY for pre-validated coordinates from trusted sources.
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SystemError: CPUDispatcher(<function _vectorized_batch_attributes_unsafe at 0x7f1c6bbbf380>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes_unsafe at 0x7f1c6bbbf380>) returned a result with an exception set
2025-11-28 20:50:31,522 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:50:31,523 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:50:31,523 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140354161096064
2025-11-28 20:50:31,523 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139947024209744
2025-11-28 20:50:31,526 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:50:31,526 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139759896229488
2025-11-28 20:50:31,839 - __main__ - INFO - Training interrupted by user
2025-11-28 20:50:32,092 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 20:50:45,997 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 20:50:45,998 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:50:45,998 - __main__ - INFO - Testing move generation...
2025-11-28 20:50:46,262 - __main__ - CRITICAL - [ALERT] GAME SYSTEM VALIDATION FAILED: too many indices for array: array is 1-dimensional, but 2 were indexed
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/main_parallel.py", line 249, in validate_game_system
    moves1 = game.state.legal_moves
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/gamestate.py", line 231, in legal_moves
    return turnmove.legal_moves(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 54, in legal_moves
    structured_moves = generate_legal_moves(game_state)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 530, in generate_legal_moves
    return _generator.generate(state)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 161, in generate
    return self.generate_fused(state)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 228, in generate_fused
    raw_moves = generate_pseudolegal_moves_batch(state, regenerate_coords, debuffed_coords, ignore_occupancy=True)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/reflector.py", line 158, in reflector_move_dispatcher
    return generate_reflecting_bishop_moves(
        cache_manager=state.cache_manager,
    ...<3 lines>...
        ignore_occupancy=ignore_occupancy
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/reflector.py", line 112, in generate_reflecting_bishop_moves
    if not CoordinateUtils.in_bounds(origin):
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/common/coord_utils.py", line 163, in in_bounds
    x = coords[:, 0]
        ~~~~~~^^^^^^
IndexError: too many indices for array: array is 1-dimensional, but 2 were indexed
2025-11-28 20:50:46,264 - __main__ - CRITICAL - Cannot start training due to validation failures
2025-11-28 20:52:05,297 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 20:52:05,298 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:52:05,299 - __main__ - INFO - Testing move generation...
2025-11-28 20:52:07,222 - __main__ - INFO - [OK] Generated 624 moves
2025-11-28 20:52:07,222 - __main__ - INFO - Testing GameState caching...
2025-11-28 20:52:07,222 - __main__ - INFO - [OK] GameState caching works
2025-11-28 20:52:07,223 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 20:52:07,223 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 20:52:07,223 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(624), 'piece_moves_cache_size': 27, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 20:52:08,718 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_205201/temp_model_for_selfplay.pt
2025-11-28 20:52:08,718 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 12 games, 6 workers
2025-11-28 20:52:11,541 - training.parallel_self_play - INFO - Launching workers...
2025-11-28 20:52:20,441 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-11-28 20:52:24,197 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:52:24,199 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140556167509712
2025-11-28 20:52:24,262 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:52:24,263 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140708458443296
2025-11-28 20:52:24,267 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:52:24,268 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139848050467712
2025-11-28 20:52:24,286 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:52:24,287 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140160606893200
2025-11-28 20:52:24,347 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:52:24,348 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140043930505936
2025-11-28 20:52:24,738 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:52:24,739 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140425253795104
2025-11-28 20:52:25,907 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-11-28 20:52:25,912 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-11-28 20:52:25,912 - InferenceServer - INFO - Server Ready. Listening...
2025-11-28 20:52:50,019 - game3d.game.turnmove - INFO - Move 100: BLACK KNIGHT [5 4 5]->[6 4 3] (Capture)
2025-11-28 20:52:50,249 - game3d.game.turnmove - INFO - Move 100: BLACK PAWN [7 6 6]->[8 5 5] (Capture)
2025-11-28 20:52:59,522 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-28 20:52:59,561 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 20:52:59,590 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 20:52:59,657 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 20:52:59,689 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 20:52:59,762 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 20:52:59,811 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:52:59,811 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139842588685984
2025-11-28 20:53:07,436 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-11-28 20:53:07,476 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 20:53:07,511 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 20:53:07,580 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 20:53:07,623 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 20:53:07,691 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 20:53:07,733 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:53:07,734 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140160482714112
2025-11-28 20:53:08,886 - game3d.game.turnmove - INFO - Move 100: WHITE ROOK [3 5 2]->[3 5 8] (Capture)
2025-11-28 20:53:09,299 - game3d.game.turnmove - INFO - Move 100: BLACK ORBITER [8 4 8]->[8 3 5] (Move)
2025-11-28 20:53:10,184 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-28 20:53:10,226 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 20:53:10,255 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 20:53:10,319 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 20:53:10,359 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 20:53:10,422 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 20:53:10,491 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:53:10,492 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140703477623216
2025-11-28 20:53:17,022 - game3d.game.turnmove - INFO - Move 200: WHITE PAWN [2 0 2]->[3 1 1] (Capture)
2025-11-28 20:53:19,924 - game3d.game.turnmove - INFO - Move 100: BLACK YZQUEEN [3 1 8]->[4 2 7] (Move)
2025-11-28 20:53:29,384 - game3d.game3d - ERROR - âŒ MOVE REJECTED - Wall move to [2 8 2] would place part of the wall out of bounds
2025-11-28 20:53:29,384 - worker.5 - ERROR - Worker 5 failed: Wall move to [2 8 2] would place part of the wall out of bounds
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 82, in submit_move
    raise InvalidMoveError(validation_error)
game3d.game3d.InvalidMoveError: Wall move to [2 8 2] would place part of the wall out of bounds
2025-11-28 20:53:29,390 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:53:29,390 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140419792413760
2025-11-28 20:53:35,095 - game3d.game.turnmove - INFO - Move 100: WHITE ROOK [5 5 2]->[5 5 6] (Capture)
2025-11-28 20:53:39,252 - InferenceServer - INFO - Server shutting down.
2025-11-28 20:53:39,253 - training.parallel_self_play - INFO - Stopping Server...
2025-11-28 20:53:39,783 - __main__ - INFO - Training interrupted by user
2025-11-28 20:53:40,056 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 20:53:42,478 - __main__ - INFO - Final model saved to model_checkpoints/train_huge_20251128_205201/model_final.pt
2025-11-28 20:55:13,908 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 20:55:13,908 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:55:13,911 - __main__ - INFO - Testing move generation...
2025-11-28 20:55:21,639 - __main__ - INFO - [OK] Generated 624 moves
2025-11-28 20:55:21,639 - __main__ - INFO - Testing GameState caching...
2025-11-28 20:55:21,639 - __main__ - INFO - [OK] GameState caching works
2025-11-28 20:55:21,639 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 20:55:21,640 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 20:55:21,640 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(624), 'piece_moves_cache_size': 27, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 20:55:23,155 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_205509/temp_model_for_selfplay.pt
2025-11-28 20:55:23,155 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 12 games, 6 workers
2025-11-28 20:55:25,991 - training.parallel_self_play - INFO - Launching workers...
2025-11-28 20:55:34,980 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-11-28 20:55:39,100 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:55:39,102 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139834091779936
2025-11-28 20:55:39,129 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:55:39,130 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140204782302544
2025-11-28 20:55:39,268 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:55:39,269 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139659049826960
2025-11-28 20:55:39,398 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:55:39,399 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139841556608144
2025-11-28 20:55:39,446 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:55:39,447 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140569303426688
2025-11-28 20:55:39,567 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 20:55:39,568 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140345709867408
2025-11-28 20:55:41,014 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-11-28 20:55:41,019 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-11-28 20:55:41,019 - InferenceServer - INFO - Server Ready. Listening...
2025-11-28 20:55:57,887 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 20:55:57,887 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 20:56:08,061 - game3d.game.turnmove - INFO - Move 100: BLACK PAWN [7 2 5]->[6 1 4] (Capture)
2025-11-28 20:56:08,280 - game3d.game.turnmove - INFO - Move 100: WHITE PAWN [6 4 1]->[6 3 3] (Move)
2025-11-28 20:56:15,999 - game3d.game.turnmove - INFO - Move 200: BLACK BLACKHOLE [5 8 1]->[5 7 1] (Capture)
2025-11-28 20:56:23,074 - game3d.game.turnmove - INFO - Move 300: BLACK FRIENDLYTELEPORTER [7 6 8]->[4 5 0] (Capture)
2025-11-28 20:56:28,417 - game3d.game.turnmove - INFO - Move 100: WHITE PAWN [1 2 2]->[2 3 1] (Capture)
2025-11-28 20:57:53,952 - game3d.game.turnmove - INFO - Move 100: BLACK PAWN [1 3 5]->[2 2 4] (Capture)
2025-11-28 20:58:24,646 - game3d.game.turnmove - INFO - Move 100: BLACK BLACKHOLE [5 7 4]->[4 7 3] (Capture)
2025-11-28 20:58:41,290 - game3d.game.turnmove - INFO - Move 100: BLACK ECHO [3 8 8]->[6 8 3] (Capture)
2025-11-28 21:00:14,677 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-11-28 21:00:14,713 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 21:00:14,731 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 21:00:14,785 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 21:00:14,825 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 21:00:14,885 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 21:00:15,047 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 21:00:15,047 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139828292912080
2025-11-28 21:00:25,176 - game3d.game.turnmove - INFO - Move 100: WHITE INFILTRATOR [3 3 2]->[4 4 1] (Move)
2025-11-28 21:00:30,990 - game3d.game.turnmove - INFO - Piece captured by Trailblazer counters at [3 4 4]
2025-11-28 21:00:36,186 - game3d.game.turnmove - INFO - Move 200: BLACK ROOK [3 2 1]->[3 3 1] (Capture)
2025-11-28 21:00:41,899 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-28 21:00:41,976 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 21:00:42,037 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 21:00:42,155 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 21:00:42,224 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 21:00:42,327 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 21:00:42,512 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 21:00:42,513 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140204073065664
2025-11-28 21:00:53,943 - game3d.game.turnmove - INFO - Move 100: WHITE ROOK [5 5 6]->[5 5 7] (Capture)
2025-11-28 21:02:41,527 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-11-28 21:02:41,555 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 21:02:41,576 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 21:02:41,620 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 21:02:41,648 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 21:02:41,706 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 21:02:41,998 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 21:02:41,999 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140340712183248
2025-11-28 21:02:48,204 - game3d.game.turnmove - INFO - Move 200: BLACK FRIENDLYTELEPORTER [0 5 2]->[0 5 1] (Capture)
2025-11-28 21:02:51,546 - game3d.game.turnmove - INFO - Move 100: WHITE FRIENDLYTELEPORTER [2 3 1]->[3 3 2] (Capture)
2025-11-28 21:03:18,305 - game3d.game.turnmove - INFO - Move 200: WHITE ORBITER [5 2 1]->[6 3 3] (Move)
2025-11-28 21:10:54,217 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 21:10:54,218 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 21:10:54,219 - __main__ - INFO - Testing move generation...
2025-11-28 21:10:54,569 - __main__ - INFO - [OK] Generated 624 moves
2025-11-28 21:10:54,570 - __main__ - INFO - Testing GameState caching...
2025-11-28 21:10:54,570 - __main__ - INFO - [OK] GameState caching works
2025-11-28 21:10:54,570 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 21:10:54,570 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 21:10:54,571 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(624), 'piece_moves_cache_size': 27, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 21:10:56,096 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_211050/temp_model_for_selfplay.pt
2025-11-28 21:10:56,096 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 12 games, 6 workers
2025-11-28 21:10:58,945 - training.parallel_self_play - INFO - Launching workers...
2025-11-28 21:11:08,048 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-11-28 21:11:12,040 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 21:11:12,041 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139893392726032
2025-11-28 21:11:12,211 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 21:11:12,212 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 21:11:12,212 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140388414173872
2025-11-28 21:11:12,214 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139805793840208
2025-11-28 21:11:12,237 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 21:11:12,238 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140111583814192
2025-11-28 21:11:12,282 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 21:11:12,284 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140167984609504
2025-11-28 21:11:12,351 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 21:11:12,352 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140673322759648
2025-11-28 21:11:13,644 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-11-28 21:11:13,648 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-11-28 21:11:13,648 - InferenceServer - INFO - Server Ready. Listening...
2025-11-28 21:11:35,479 - game3d.game.turnmove - INFO - Move 100: WHITE XZZIGZAG [2 8 5]->[3 8 5] (Move)
2025-11-28 21:11:35,781 - game3d.game.turnmove - INFO - Move 100: WHITE GEOMANCER [3 0 1]->[6 3 4] (Move)
2025-11-28 21:11:36,398 - game3d.game.turnmove - INFO - Move 100: BLACK KNIGHT32 [3 1 5]->[5 3 2] (Capture)
2025-11-28 21:11:42,563 - game3d.game.turnmove - INFO - Move 200: BLACK YZQUEEN [5 0 1]->[5 1 1] (Capture)
2025-11-28 21:11:44,223 - game3d.game.turnmove - INFO - Move 200: BLACK YZQUEEN [3 7 6]->[3 7 2] (Capture)
2025-11-28 21:12:00,425 - game3d.game.turnmove - INFO - Move 200: BLACK KNIGHT32 [5 5 5]->[3 7 2] (Capture)
2025-11-28 21:12:49,496 - game3d.game3d - ERROR - âŒ MOVE REJECTED - Wall move to [5 8 2] would place part of the wall out of bounds
2025-11-28 21:12:49,496 - worker.4 - ERROR - Worker 4 failed: Wall move to [5 8 2] would place part of the wall out of bounds
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 82, in submit_move
    raise InvalidMoveError(validation_error)
game3d.game3d.InvalidMoveError: Wall move to [5 8 2] would place part of the wall out of bounds
2025-11-28 21:12:49,501 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 21:12:49,501 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140383426365904
2025-11-28 21:12:53,639 - game3d.game.turnmove - INFO - Move 300: BLACK GEOMANCER [5 0 7]->[4 0 4] (Move)
2025-11-28 21:13:00,172 - game3d.game.turnmove - INFO - Move 100: WHITE XZZIGZAG [2 0 5]->[4 0 4] (Capture)
2025-11-28 21:13:09,717 - game3d.game.turnmove - INFO - Move 200: WHITE PAWN [8 6 2]->[8 7 2] (Move)
2025-11-28 21:13:43,249 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-28 21:13:43,334 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 21:13:43,334 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 21:13:43,334 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 21:13:43,334 - game3d.game.terminal - WARNING -   - Attackers: CONESLIDER at (5,4,8)
2025-11-28 21:13:43,408 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 21:13:43,408 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 21:13:43,408 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 21:13:43,408 - game3d.game.terminal - WARNING -   - Attackers: CONESLIDER at (5,4,8)
2025-11-28 21:13:43,541 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 21:13:43,542 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 21:13:43,542 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 21:13:43,542 - game3d.game.terminal - WARNING -   - Attackers: CONESLIDER at (5,4,8)
2025-11-28 21:13:43,625 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 21:13:43,625 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 21:13:43,625 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 21:13:43,625 - game3d.game.terminal - WARNING -   - Attackers: CONESLIDER at (5,4,8)
2025-11-28 21:13:43,737 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 21:13:43,737 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 21:13:43,737 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 21:13:43,737 - game3d.game.terminal - WARNING -   - Attackers: CONESLIDER at (5,4,8)
2025-11-28 21:13:43,802 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 21:13:43,803 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139889034562960
2025-11-28 21:13:53,665 - game3d.game.turnmove - INFO - Move 100: WHITE SWAPPER [6 5 1]->[7 4 0] (Move)
2025-11-28 21:13:54,973 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: index 9 is out of bounds for axis 1 with size 9
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 225, in make_move
    cache_manager.occupancy_cache.batch_set_positions(changed_coords, pieces_data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 351, in batch_set_positions
    self._occ[x, y, z] = pieces[:, 1]  # colors
    ~~~~~~~~~^^^^^^^^^
IndexError: index 9 is out of bounds for axis 1 with size 9
2025-11-28 21:13:54,974 - worker.1 - ERROR - Worker 1 failed: Move execution failed: index 9 is out of bounds for axis 1 with size 9
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 225, in make_move
    cache_manager.occupancy_cache.batch_set_positions(changed_coords, pieces_data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 351, in batch_set_positions
    self._occ[x, y, z] = pieces[:, 1]  # colors
    ~~~~~~~~~^^^^^^^^^
IndexError: index 9 is out of bounds for axis 1 with size 9

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: index 9 is out of bounds for axis 1 with size 9
2025-11-28 21:13:54,983 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 21:13:54,983 - game3d.cache.manager - DEBUG - Created cache manager #3 for board 139888374351184
2025-11-28 21:14:05,317 - game3d.game.turnmove - INFO - Move 100: WHITE ROOK [3 3 2]->[3 3 6] (Capture)
2025-11-28 21:14:13,053 - game3d.game.turnmove - INFO - Move 200: WHITE YZZIGZAG [0 6 1]->[0 6 2] (Capture)
2025-11-28 21:14:57,004 - game3d.game.turnmove - INFO - Move 100: BLACK ROOK [3 3 2]->[4 3 2] (Capture)
2025-11-28 21:16:05,869 - game3d.game.turnmove - INFO - Move 300: BLACK ROOK [5 4 2]->[4 4 2] (Move)
2025-11-28 21:16:41,656 - game3d.game3d - ERROR - âŒ MOVE REJECTED - Wall move to [8 2 2] would place part of the wall out of bounds
2025-11-28 21:16:41,656 - worker.3 - ERROR - Worker 3 failed: Wall move to [8 2 2] would place part of the wall out of bounds
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 82, in submit_move
    raise InvalidMoveError(validation_error)
game3d.game3d.InvalidMoveError: Wall move to [8 2 2] would place part of the wall out of bounds
2025-11-28 21:16:41,661 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 21:16:41,661 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140162998807296
2025-11-28 21:16:51,403 - game3d.game.turnmove - INFO - Move 100: WHITE ROOK [3 3 1]->[3 3 2] (Capture)
2025-11-28 21:16:59,831 - game3d.game.turnmove - INFO - Move 200: WHITE KING [5 5 1]->[6 4 2] (Move)
2025-11-28 21:17:07,108 - game3d.game.turnmove - INFO - Move 300: WHITE ORBITER [0 2 6]->[3 2 7] (Capture)
2025-11-28 21:17:21,019 - InferenceServer - INFO - Server shutting down.
2025-11-28 21:17:21,019 - training.parallel_self_play - INFO - Stopping Server...
2025-11-28 21:17:21,019 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f7b685c31a0>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: infiltrator_move_dispatcher() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f7b68ade160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 266, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 338, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 112, in infiltrator_move_dispatcher
    return generate_infiltrator_moves(state.cache_manager, state.color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 38, in generate_infiltrator_moves
    teleport_dirs = _get_pawn_front_directions(cache_manager, color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 75, in _get_pawn_front_directions
    _, piece_types = cache_manager.occupancy_cache.batch_get_attributes(enemy_coords)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 209, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f7b685c31a0>) returned a result with an exception set
2025-11-28 21:17:21,022 - worker.3 - ERROR - Worker 3 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f7b685c31a0>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: infiltrator_move_dispatcher() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f7b68ade160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 266, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 338, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 112, in infiltrator_move_dispatcher
    return generate_infiltrator_moves(state.cache_manager, state.color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 38, in generate_infiltrator_moves
    teleport_dirs = _get_pawn_front_directions(cache_manager, color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 75, in _get_pawn_front_directions
    _, piece_types = cache_manager.occupancy_cache.batch_get_attributes(enemy_coords)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 209, in batch_get_attributes
    return _vectorized_batch_attributes(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f7b685c31a0>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes at 0x7f7b685c31a0>) returned a result with an exception set
2025-11-28 21:17:21,050 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 21:17:21,050 - game3d.cache.manager - DEBUG - Created cache manager #3 for board 140167866460832
2025-11-28 21:17:21,604 - __main__ - INFO - Training interrupted by user
2025-11-28 21:17:21,799 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 22:05:57,051 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 22:05:57,052 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 22:05:57,053 - __main__ - INFO - Testing move generation...
2025-11-28 22:05:57,383 - __main__ - INFO - [OK] Generated 624 moves
2025-11-28 22:05:57,383 - __main__ - INFO - Testing GameState caching...
2025-11-28 22:05:57,383 - __main__ - INFO - [OK] GameState caching works
2025-11-28 22:05:57,383 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 22:05:57,384 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 22:05:57,384 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(624), 'piece_moves_cache_size': 27, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 22:05:58,879 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_220553/temp_model_for_selfplay.pt
2025-11-28 22:05:58,879 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 12 games, 6 workers
2025-11-28 22:06:01,712 - training.parallel_self_play - INFO - Launching workers...
2025-11-28 22:06:10,147 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-11-28 22:06:15,398 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 22:06:15,401 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140524161667792
2025-11-28 22:06:15,452 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 22:06:15,454 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140407879728048
2025-11-28 22:06:15,600 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 22:06:15,601 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139905995847616
2025-11-28 22:06:15,610 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 22:06:15,612 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140088146076976
2025-11-28 22:06:15,861 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 22:06:15,862 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140538065909408
2025-11-28 22:06:15,891 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 22:06:15,892 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140592207050592
2025-11-28 22:06:17,892 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-11-28 22:06:17,900 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-11-28 22:06:17,901 - InferenceServer - INFO - Server Ready. Listening...
2025-11-28 22:06:38,772 - game3d.game.turnmove - INFO - Move 100: WHITE ROOK [3 3 1]->[3 3 2] (Capture)
2025-11-28 22:06:47,029 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-11-28 22:06:47,095 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:06:47,095 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:06:47,095 - game3d.game.terminal - WARNING -   - Black: Priests=2, King=(4,4,8)
2025-11-28 22:06:47,095 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,3,7), VECTORSLIDER at (3,6,1)
2025-11-28 22:06:47,158 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:06:47,158 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:06:47,159 - game3d.game.terminal - WARNING -   - Black: Priests=2, King=(4,4,8)
2025-11-28 22:06:47,159 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,3,7), VECTORSLIDER at (3,6,1)
2025-11-28 22:06:47,247 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:06:47,247 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:06:47,247 - game3d.game.terminal - WARNING -   - Black: Priests=2, King=(4,4,8)
2025-11-28 22:06:47,247 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,3,7), VECTORSLIDER at (3,6,1)
2025-11-28 22:06:47,309 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:06:47,309 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:06:47,309 - game3d.game.terminal - WARNING -   - Black: Priests=2, King=(4,4,8)
2025-11-28 22:06:47,309 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,3,7), VECTORSLIDER at (3,6,1)
2025-11-28 22:06:47,385 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:06:47,385 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:06:47,385 - game3d.game.terminal - WARNING -   - Black: Priests=2, King=(4,4,8)
2025-11-28 22:06:47,385 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,3,7), VECTORSLIDER at (3,6,1)
2025-11-28 22:06:47,444 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 22:06:47,444 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139905959646816
2025-11-28 22:06:50,817 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-11-28 22:06:50,886 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:06:50,886 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:06:50,887 - game3d.game.terminal - WARNING -   - Black: Priests=3, King=(4,4,8)
2025-11-28 22:06:50,887 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,3,7), VECTORSLIDER at (3,6,1)
2025-11-28 22:06:50,947 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:06:50,948 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:06:50,948 - game3d.game.terminal - WARNING -   - Black: Priests=3, King=(4,4,8)
2025-11-28 22:06:50,948 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,3,7), VECTORSLIDER at (3,6,1)
2025-11-28 22:06:51,038 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:06:51,038 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:06:51,038 - game3d.game.terminal - WARNING -   - Black: Priests=3, King=(4,4,8)
2025-11-28 22:06:51,038 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,3,7), VECTORSLIDER at (3,6,1)
2025-11-28 22:06:51,093 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:06:51,093 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:06:51,093 - game3d.game.terminal - WARNING -   - Black: Priests=3, King=(4,4,8)
2025-11-28 22:06:51,093 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,3,7), VECTORSLIDER at (3,6,1)
2025-11-28 22:06:51,186 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:06:51,186 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:06:51,186 - game3d.game.terminal - WARNING -   - Black: Priests=3, King=(4,4,8)
2025-11-28 22:06:51,186 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,3,7), VECTORSLIDER at (3,6,1)
2025-11-28 22:06:51,242 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 22:06:51,242 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140523953102688
2025-11-28 22:06:52,782 - game3d.game.turnmove - INFO - Move 100: BLACK XZZIGZAG [5 8 2]->[4 8 2] (Capture)
2025-11-28 22:07:02,718 - game3d.game.turnmove - INFO - Move 100: BLACK SPIRAL [0 7 8]->[0 7 7] (Capture)
2025-11-28 22:07:12,293 - game3d.game.turnmove - INFO - Move 100: WHITE XZZIGZAG [2 0 5]->[7 0 5] (Move)
2025-11-28 22:07:16,452 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-11-28 22:07:16,527 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:07:16,528 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:07:16,528 - game3d.game.terminal - WARNING -   - Black: Priests=3, King=(4,4,8)
2025-11-28 22:07:16,528 - game3d.game.terminal - WARNING -   - Attackers: CONESLIDER at (4,5,0), CONESLIDER at (8,6,4)
2025-11-28 22:07:16,594 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:07:16,594 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:07:16,595 - game3d.game.terminal - WARNING -   - Black: Priests=3, King=(4,4,8)
2025-11-28 22:07:16,595 - game3d.game.terminal - WARNING -   - Attackers: CONESLIDER at (4,5,0), CONESLIDER at (8,6,4)
2025-11-28 22:07:16,699 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:07:16,700 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:07:16,700 - game3d.game.terminal - WARNING -   - Black: Priests=3, King=(4,4,8)
2025-11-28 22:07:16,700 - game3d.game.terminal - WARNING -   - Attackers: CONESLIDER at (4,5,0), CONESLIDER at (8,6,4)
2025-11-28 22:07:16,761 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:07:16,761 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:07:16,761 - game3d.game.terminal - WARNING -   - Black: Priests=3, King=(4,4,8)
2025-11-28 22:07:16,761 - game3d.game.terminal - WARNING -   - Attackers: CONESLIDER at (4,5,0), CONESLIDER at (8,6,4)
2025-11-28 22:07:16,850 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:07:16,850 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:07:16,850 - game3d.game.terminal - WARNING -   - Black: Priests=3, King=(4,4,8)
2025-11-28 22:07:16,850 - game3d.game.terminal - WARNING -   - Attackers: CONESLIDER at (4,5,0), CONESLIDER at (8,6,4)
2025-11-28 22:07:16,903 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 22:07:16,903 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140083758286256
2025-11-28 22:07:49,734 - game3d.game.turnmove - INFO - Move 100: WHITE KING [4 4 0]->[4 5 1] (Move)
2025-11-28 22:08:18,941 - game3d.game3d - ERROR - âŒ MOVE REJECTED - Wall move to [8 2 7] would place part of the wall out of bounds
2025-11-28 22:08:18,941 - worker.5 - ERROR - Worker 5 failed: Wall move to [8 2 7] would place part of the wall out of bounds
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 82, in submit_move
    raise InvalidMoveError(validation_error)
game3d.game3d.InvalidMoveError: Wall move to [8 2 7] would place part of the wall out of bounds
2025-11-28 22:08:18,953 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 22:08:18,953 - game3d.cache.manager - DEBUG - Created cache manager #3 for board 139905947569168
2025-11-28 22:08:40,061 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-11-28 22:08:40,128 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:08:40,128 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:08:40,128 - game3d.game.terminal - WARNING -   - Black: Priests=2, King=(4,4,8)
2025-11-28 22:08:40,128 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,3,7), VECTORSLIDER at (5,2,1)
2025-11-28 22:08:40,201 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:08:40,201 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:08:40,201 - game3d.game.terminal - WARNING -   - Black: Priests=2, King=(4,4,8)
2025-11-28 22:08:40,201 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,3,7), VECTORSLIDER at (5,2,1)
2025-11-28 22:08:40,288 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:08:40,288 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:08:40,288 - game3d.game.terminal - WARNING -   - Black: Priests=2, King=(4,4,8)
2025-11-28 22:08:40,288 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,3,7), VECTORSLIDER at (5,2,1)
2025-11-28 22:08:40,345 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:08:40,345 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:08:40,345 - game3d.game.terminal - WARNING -   - Black: Priests=2, King=(4,4,8)
2025-11-28 22:08:40,345 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,3,7), VECTORSLIDER at (5,2,1)
2025-11-28 22:08:40,430 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:08:40,430 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:08:40,430 - game3d.game.terminal - WARNING -   - Black: Priests=2, King=(4,4,8)
2025-11-28 22:08:40,430 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,3,7), VECTORSLIDER at (5,2,1)
2025-11-28 22:08:40,497 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 22:08:40,497 - game3d.cache.manager - DEBUG - Created cache manager #4 for board 139905944138752
2025-11-28 22:08:41,777 - game3d.common.state_utils - DEBUG - King for color 1 cached at [4 4 0]
2025-11-28 22:08:41,777 - game3d.common.state_utils - DEBUG - King for color 2 cached at [4 4 8]
2025-11-28 22:08:59,393 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-11-28 22:08:59,489 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:08:59,489 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:08:59,489 - game3d.game.terminal - WARNING -   - Black: Priests=2, King=(4,4,8)
2025-11-28 22:08:59,489 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,3,7), VECTORSLIDER at (3,6,1)
2025-11-28 22:08:59,586 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:08:59,586 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:08:59,586 - game3d.game.terminal - WARNING -   - Black: Priests=2, King=(4,4,8)
2025-11-28 22:08:59,587 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,3,7), VECTORSLIDER at (3,6,1)
2025-11-28 22:08:59,697 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:08:59,698 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:08:59,698 - game3d.game.terminal - WARNING -   - Black: Priests=2, King=(4,4,8)
2025-11-28 22:08:59,698 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,3,7), VECTORSLIDER at (3,6,1)
2025-11-28 22:08:59,775 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:08:59,776 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:08:59,776 - game3d.game.terminal - WARNING -   - Black: Priests=2, King=(4,4,8)
2025-11-28 22:08:59,776 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,3,7), VECTORSLIDER at (3,6,1)
2025-11-28 22:08:59,909 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:08:59,909 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:08:59,909 - game3d.game.terminal - WARNING -   - Black: Priests=2, King=(4,4,8)
2025-11-28 22:08:59,909 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,3,7), VECTORSLIDER at (3,6,1)
2025-11-28 22:08:59,975 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 22:08:59,975 - game3d.cache.manager - DEBUG - Created cache manager #5 for board 139905944105504
2025-11-28 22:09:15,461 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-28 22:09:15,530 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 22:09:15,530 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:09:15,530 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 22:09:15,530 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-28 22:09:15,593 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 22:09:15,594 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:09:15,594 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 22:09:15,594 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-28 22:09:15,672 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 22:09:15,672 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:09:15,672 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 22:09:15,672 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-28 22:09:15,724 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 22:09:15,724 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:09:15,724 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 22:09:15,724 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-28 22:09:15,801 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 22:09:15,801 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:09:15,801 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 22:09:15,801 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-28 22:10:26,005 - game3d.game.turnmove - INFO - Move 200: BLACK MIRROR [4 7 8]->[4 6 8] (Capture)
2025-11-28 22:10:43,652 - game3d.game.turnmove - INFO - Move 100: BLACK KNIGHT31 [6 4 8]->[5 3 4] (Move)
2025-11-28 22:10:51,775 - game3d.game.turnmove - INFO - Move 200: WHITE ECHO [3 8 0]->[3 8 1] (Capture)
2025-11-28 22:11:33,326 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-28 22:11:33,368 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 22:11:33,368 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:11:33,368 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 22:11:33,368 - game3d.game.terminal - WARNING -   - Attackers: FREEZER at (5,5,7)
2025-11-28 22:11:33,402 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 22:11:33,402 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:11:33,402 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 22:11:33,402 - game3d.game.terminal - WARNING -   - Attackers: FREEZER at (5,5,7)
2025-11-28 22:11:33,449 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 22:11:33,449 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:11:33,449 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 22:11:33,449 - game3d.game.terminal - WARNING -   - Attackers: FREEZER at (5,5,7)
2025-11-28 22:11:33,487 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 22:11:33,487 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:11:33,487 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 22:11:33,487 - game3d.game.terminal - WARNING -   - Attackers: FREEZER at (5,5,7)
2025-11-28 22:11:33,545 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 22:11:33,545 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:11:33,545 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 22:11:33,545 - game3d.game.terminal - WARNING -   - Attackers: FREEZER at (5,5,7)
2025-11-28 22:11:58,834 - game3d.game.turnmove - INFO - Move 300: WHITE ROOK [3 3 2]->[3 3 6] (Capture)
2025-11-28 22:12:26,648 - game3d.game.turnmove - INFO - Move 100: BLACK INFILTRATOR [7 5 0]->[6 4 0] (Capture)
2025-11-28 22:13:17,515 - game3d.game.turnmove - INFO - Move 200: BLACK ROOK [5 3 6]->[5 3 4] (Capture)
2025-11-28 22:14:09,777 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-11-28 22:14:09,825 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:14:09,825 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(3,3,0)
2025-11-28 22:14:09,825 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,3,8)
2025-11-28 22:14:09,825 - game3d.game.terminal - WARNING -   - Attackers: EDGEROOK at (2,0,8), BLACKHOLE at (3,3,1)
2025-11-28 22:14:09,872 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:14:09,872 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(3,3,0)
2025-11-28 22:14:09,872 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,3,8)
2025-11-28 22:14:09,872 - game3d.game.terminal - WARNING -   - Attackers: EDGEROOK at (2,0,8), BLACKHOLE at (3,3,1)
2025-11-28 22:14:09,946 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:14:09,946 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(3,3,0)
2025-11-28 22:14:09,946 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,3,8)
2025-11-28 22:14:09,946 - game3d.game.terminal - WARNING -   - Attackers: EDGEROOK at (2,0,8), BLACKHOLE at (3,3,1)
2025-11-28 22:14:09,987 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:14:09,987 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(3,3,0)
2025-11-28 22:14:09,987 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,3,8)
2025-11-28 22:14:09,987 - game3d.game.terminal - WARNING -   - Attackers: EDGEROOK at (2,0,8), BLACKHOLE at (3,3,1)
2025-11-28 22:14:10,059 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:14:10,059 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(3,3,0)
2025-11-28 22:14:10,059 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,3,8)
2025-11-28 22:14:10,059 - game3d.game.terminal - WARNING -   - Attackers: EDGEROOK at (2,0,8), BLACKHOLE at (3,3,1)
2025-11-28 22:14:13,631 - game3d.game.turnmove - INFO - Move 400: BLACK NEBULA [2 3 8]->[3 4 7] (Capture)
2025-11-28 22:14:27,159 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-28 22:14:27,192 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 22:14:27,192 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(2,5,0)
2025-11-28 22:14:27,193 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(3,4,8)
2025-11-28 22:14:27,193 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (3,4,7)
2025-11-28 22:14:27,219 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 22:14:27,219 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(2,5,0)
2025-11-28 22:14:27,219 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(3,4,8)
2025-11-28 22:14:27,219 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (3,4,7)
2025-11-28 22:14:27,254 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 22:14:27,254 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(2,5,0)
2025-11-28 22:14:27,254 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(3,4,8)
2025-11-28 22:14:27,254 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (3,4,7)
2025-11-28 22:14:27,278 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 22:14:27,278 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(2,5,0)
2025-11-28 22:14:27,278 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(3,4,8)
2025-11-28 22:14:27,278 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (3,4,7)
2025-11-28 22:14:27,315 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-28 22:14:27,316 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(2,5,0)
2025-11-28 22:14:27,316 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(3,4,8)
2025-11-28 22:14:27,316 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (3,4,7)
2025-11-28 22:15:29,966 - InferenceServer - INFO - Server shutting down.
2025-11-28 22:15:29,967 - training.parallel_self_play - INFO - Stopping Server...
2025-11-28 22:15:29,966 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _generate_all_slider_moves at 0x7fb34327d440>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 266, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 338, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/trigonalbishop.py", line 52, in trigonal_bishop_move_dispatcher
    return generate_trigonal_bishop_moves(state.cache_manager, state.color, pos, ignore_occupancy=ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/trigonalbishop.py", line 38, in generate_trigonal_bishop_moves
    moves = slider_engine.generate_slider_moves_array(
        cache_manager=cache_manager,
    ...<4 lines>...
        ignore_occupancy=ignore_occupancy
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/slider_engine.py", line 150, in generate_slider_moves_array
    destinations, captures = self.generate_slider_moves_vectorized(
                             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        cache_manager, color, pos, directions, max_distance, ignore_occupancy
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/slider_engine.py", line 119, in generate_slider_moves_vectorized
    return _generate_all_slider_moves(
        color, pos_arr, directions, max_distance, flattened, ignore_occupancy
    )
SystemError: CPUDispatcher(<function _generate_all_slider_moves at 0x7fb34327d440>) returned a result with an exception set
2025-11-28 22:15:29,972 - worker.1 - ERROR - Worker 1 failed: Move execution failed: CPUDispatcher(<function _generate_all_slider_moves at 0x7fb34327d440>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 266, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 338, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/trigonalbishop.py", line 52, in trigonal_bishop_move_dispatcher
    return generate_trigonal_bishop_moves(state.cache_manager, state.color, pos, ignore_occupancy=ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/trigonalbishop.py", line 38, in generate_trigonal_bishop_moves
    moves = slider_engine.generate_slider_moves_array(
        cache_manager=cache_manager,
    ...<4 lines>...
        ignore_occupancy=ignore_occupancy
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/slider_engine.py", line 150, in generate_slider_moves_array
    destinations, captures = self.generate_slider_moves_vectorized(
                             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        cache_manager, color, pos, directions, max_distance, ignore_occupancy
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/slider_engine.py", line 119, in generate_slider_moves_vectorized
    return _generate_all_slider_moves(
        color, pos_arr, directions, max_distance, flattened, ignore_occupancy
    )
SystemError: CPUDispatcher(<function _generate_all_slider_moves at 0x7fb34327d440>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _generate_all_slider_moves at 0x7fb34327d440>) returned a result with an exception set
2025-11-28 22:15:30,280 - __main__ - INFO - Training interrupted by user
2025-11-28 22:15:30,523 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 22:28:13,203 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 22:28:13,203 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 22:28:13,204 - __main__ - INFO - Testing move generation...
2025-11-28 22:28:13,496 - __main__ - CRITICAL - [ALERT] GAME SYSTEM VALIDATION FAILED: index -19322 is out of bounds for axis 0 with size 729
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 136, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: swapper_move_dispatcher() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/main_parallel.py", line 249, in validate_game_system
    moves1 = game.state.legal_moves
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/gamestate.py", line 231, in legal_moves
    return turnmove.legal_moves(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 54, in legal_moves
    structured_moves = generate_legal_moves(game_state)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 530, in generate_legal_moves
    return _generator.generate(state)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 161, in generate
    return self.generate_fused(state)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 228, in generate_fused
    raw_moves = generate_pseudolegal_moves_batch(state, regenerate_coords, debuffed_coords, ignore_occupancy=True)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 278, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 139, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/swapper.py", line 93, in swapper_move_dispatcher
    return generate_swapper_moves(state.cache_manager, state.color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/swapper.py", line 50, in generate_swapper_moves
    swap_moves = jump_engine.generate_jump_moves(
        cache_manager=cache_manager,
    ...<3 lines>...
        allow_capture=False,  # Swaps don't capture
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/jump_engine.py", line 173, in generate_jump_moves
    occs = flattened[idxs]
           ~~~~~~~~~^^^^^^
IndexError: index -19322 is out of bounds for axis 0 with size 729
2025-11-28 22:28:13,498 - __main__ - CRITICAL - Cannot start training due to validation failures
2025-11-28 22:52:20,754 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 22:52:20,755 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 22:52:20,756 - __main__ - INFO - Testing move generation...
2025-11-28 22:52:21,751 - __main__ - INFO - [OK] Generated 624 moves
2025-11-28 22:52:21,751 - __main__ - INFO - Testing GameState caching...
2025-11-28 22:52:21,751 - __main__ - INFO - [OK] GameState caching works
2025-11-28 22:52:21,751 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 22:52:21,752 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 22:52:21,752 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(624), 'piece_moves_cache_size': 27, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 22:52:23,302 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_225216/temp_model_for_selfplay.pt
2025-11-28 22:52:23,302 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 12 games, 6 workers
2025-11-28 22:52:26,194 - training.parallel_self_play - INFO - Launching workers...
2025-11-28 22:52:35,179 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-11-28 22:52:39,913 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 22:52:39,915 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140064187385600
2025-11-28 22:52:40,421 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 22:52:40,422 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140117439910608
2025-11-28 22:52:40,436 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 22:52:40,437 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140450546509392
2025-11-28 22:52:40,572 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 22:52:40,573 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139799928183232
2025-11-28 22:52:40,675 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 22:52:40,676 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140301415938656
2025-11-28 22:52:40,791 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 22:52:40,792 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140610690028240
2025-11-28 22:52:42,321 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-11-28 22:52:42,327 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-11-28 22:52:42,327 - InferenceServer - INFO - Server Ready. Listening...
2025-11-28 22:53:07,666 - game3d.game.turnmove - INFO - Move 100: BLACK PAWN [2 4 6]->[3 3 7] (Capture)
2025-11-28 22:53:07,804 - game3d.game.turnmove - INFO - Move 100: WHITE QUEEN [3 5 6]->[4 5 6] (Capture)
2025-11-28 22:53:08,026 - game3d.game.turnmove - INFO - Move 100: WHITE NEBULA [6 5 0]->[5 5 1] (Capture)
2025-11-28 22:53:13,288 - game3d.game.turnmove - INFO - Move 200: BLACK ROOK [3 3 6]->[3 3 2] (Capture)
2025-11-28 22:53:18,577 - game3d.game.turnmove - INFO - Move 100: BLACK BOMB [0 3 8]->[0 3 7] (Capture)
2025-11-28 22:53:23,691 - game3d.game.turnmove - INFO - Move 100: WHITE ECHO [3 5 6]->[4 4 7] (Capture)
2025-11-28 22:53:36,749 - game3d.game.turnmove - INFO - Move 300: BLACK ROOK [5 4 6]->[5 4 2] (Capture)
2025-11-28 22:53:51,063 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-11-28 22:53:51,100 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:53:51,100 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:53:51,100 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 22:53:51,100 - game3d.game.terminal - WARNING -   - Attackers: QUEEN at (4,4,1)
2025-11-28 22:53:51,132 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:53:51,132 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:53:51,132 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 22:53:51,132 - game3d.game.terminal - WARNING -   - Attackers: QUEEN at (4,4,1)
2025-11-28 22:53:51,175 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:53:51,176 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:53:51,176 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 22:53:51,176 - game3d.game.terminal - WARNING -   - Attackers: QUEEN at (4,4,1)
2025-11-28 22:53:51,206 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:53:51,206 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:53:51,206 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 22:53:51,206 - game3d.game.terminal - WARNING -   - Attackers: QUEEN at (4,4,1)
2025-11-28 22:53:51,245 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:53:51,245 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:53:51,245 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 22:53:51,245 - game3d.game.terminal - WARNING -   - Attackers: QUEEN at (4,4,1)
2025-11-28 22:53:51,299 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 22:53:51,299 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140445565666496
2025-11-28 22:54:03,281 - game3d.game.turnmove - INFO - Move 200: BLACK FRIENDLYTELEPORTER [5 6 1]->[4 5 0] (Capture)
2025-11-28 22:54:05,981 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-11-28 22:54:06,019 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:54:06,020 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:54:06,020 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 22:54:06,020 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (2,5,7), CONESLIDER at (7,1,2)
2025-11-28 22:54:06,057 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:54:06,057 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:54:06,057 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 22:54:06,057 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (2,5,7), CONESLIDER at (7,1,2)
2025-11-28 22:54:06,097 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:54:06,097 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:54:06,097 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 22:54:06,097 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (2,5,7), CONESLIDER at (7,1,2)
2025-11-28 22:54:06,121 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:54:06,121 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:54:06,121 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 22:54:06,121 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (2,5,7), CONESLIDER at (7,1,2)
2025-11-28 22:54:06,155 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-28 22:54:06,155 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-28 22:54:06,155 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-28 22:54:06,155 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (2,5,7), CONESLIDER at (7,1,2)
2025-11-28 22:54:06,203 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 22:54:06,204 - game3d.cache.manager - DEBUG - Created cache manager #3 for board 140445558400784
2025-11-28 22:54:12,994 - game3d.game.turnmove - INFO - Move 200: WHITE QUEEN [0 6 2]->[4 6 6] (Capture)
2025-11-28 22:54:13,525 - game3d.game.turnmove - INFO - Move 100: WHITE BLACKHOLE [2 1 6]->[3 1 6] (Capture)
2025-11-28 22:54:19,861 - game3d.game.turnmove - INFO - Move 200: WHITE ROOK [2 6 2]->[2 6 3] (Capture)
2025-11-28 22:54:57,782 - InferenceServer - INFO - Server shutting down.
2025-11-28 22:54:57,782 - training.parallel_self_play - INFO - Stopping Server...
2025-11-28 22:54:58,446 - __main__ - INFO - Training interrupted by user
2025-11-28 22:54:58,681 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 23:37:12,555 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-28 23:37:12,556 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 23:37:12,557 - __main__ - INFO - Testing move generation...
2025-11-28 23:37:15,503 - __main__ - INFO - [OK] Generated 624 moves
2025-11-28 23:37:15,503 - __main__ - INFO - Testing GameState caching...
2025-11-28 23:37:15,503 - __main__ - INFO - [OK] GameState caching works
2025-11-28 23:37:15,503 - __main__ - INFO - Testing MoveCache persistence...
2025-11-28 23:37:15,504 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-28 23:37:15,504 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(624), 'piece_moves_cache_size': 27, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-28 23:37:17,029 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251128_233708/temp_model_for_selfplay.pt
2025-11-28 23:37:17,029 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 12 games, 6 workers
2025-11-28 23:37:19,872 - training.parallel_self_play - INFO - Launching workers...
2025-11-28 23:37:28,806 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-11-28 23:37:32,875 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 23:37:32,877 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140687483764064
2025-11-28 23:37:32,991 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 23:37:32,993 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140030579260384
2025-11-28 23:37:33,028 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 23:37:33,029 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139748017371840
2025-11-28 23:37:33,296 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 23:37:33,297 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139986408979760
2025-11-28 23:37:33,352 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 23:37:33,353 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140457146203440
2025-11-28 23:37:33,449 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 23:37:33,450 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140490077798064
2025-11-28 23:37:34,994 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-11-28 23:37:34,999 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-11-28 23:37:34,999 - InferenceServer - INFO - Server Ready. Listening...
2025-11-28 23:38:00,037 - game3d.game.turnmove - INFO - Move 100: BLACK YZZIGZAG [8 2 8]->[8 2 7] (Capture)
2025-11-28 23:38:00,077 - game3d.game.turnmove - INFO - Move 100: WHITE XYQUEEN [3 4 1]->[5 4 1] (Capture)
2025-11-28 23:38:00,280 - game3d.game.turnmove - INFO - Move 100: WHITE ECHO [5 0 0]->[5 1 0] (Capture)
2025-11-28 23:38:00,314 - game3d.game.turnmove - INFO - Move 100: BLACK PAWN [5 3 6]->[6 3 7] (Move)
2025-11-28 23:38:00,444 - game3d.game.turnmove - INFO - Move 100: WHITE XZQUEEN [6 1 0]->[1 1 5] (Capture)
2025-11-28 23:38:00,517 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: name 'MOVE_DTYPE' is not defined
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 283, in square_attacked_by_incremental
    old_affected_moves = np.concatenate(old_affected_moves_list, axis=0) if old_affected_moves_list else np.empty((0, 6), dtype=MOVE_DTYPE)
                                                                                                                                ^^^^^^^^^^
NameError: name 'MOVE_DTYPE' is not defined. Did you mean: 'BOOL_DTYPE'?
2025-11-28 23:38:00,520 - worker.1 - ERROR - Worker 1 failed: Move execution failed: name 'MOVE_DTYPE' is not defined
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 104, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 283, in square_attacked_by_incremental
    old_affected_moves = np.concatenate(old_affected_moves_list, axis=0) if old_affected_moves_list else np.empty((0, 6), dtype=MOVE_DTYPE)
                                                                                                                                ^^^^^^^^^^
NameError: name 'MOVE_DTYPE' is not defined. Did you mean: 'BOOL_DTYPE'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: name 'MOVE_DTYPE' is not defined
2025-11-28 23:38:00,526 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-28 23:38:00,527 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139747899414304
2025-11-28 23:38:03,670 - training.parallel_self_play - INFO - Stopping Server...
2025-11-28 23:38:03,686 - InferenceServer - INFO - Server shutting down.
2025-11-28 23:38:04,165 - __main__ - INFO - Training interrupted by user
2025-11-28 23:38:04,451 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-28 23:38:06,762 - __main__ - INFO - Final model saved to model_checkpoints/train_huge_20251128_233708/model_final.pt
2025-11-29 13:08:02,440 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-29 13:08:02,441 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:08:02,442 - __main__ - INFO - Testing move generation...
2025-11-29 13:08:02,852 - __main__ - INFO - [OK] Generated 624 moves
2025-11-29 13:08:02,852 - __main__ - INFO - Testing GameState caching...
2025-11-29 13:08:02,852 - __main__ - INFO - [OK] GameState caching works
2025-11-29 13:08:02,852 - __main__ - INFO - Testing MoveCache persistence...
2025-11-29 13:08:02,852 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-29 13:08:02,852 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(624), 'piece_moves_cache_size': 27, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-29 13:08:04,297 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251129_130757/temp_model_for_selfplay.pt
2025-11-29 13:08:04,297 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 12 games, 6 workers
2025-11-29 13:08:07,112 - training.parallel_self_play - INFO - Launching workers...
2025-11-29 13:08:14,771 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-11-29 13:08:18,868 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:08:18,870 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140443148794896
2025-11-29 13:08:19,125 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:08:19,126 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140086938041504
2025-11-29 13:08:19,246 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:08:19,248 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140134585351472
2025-11-29 13:08:19,250 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:08:19,251 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140692257946400
2025-11-29 13:08:19,337 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:08:19,338 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140491388517488
2025-11-29 13:08:19,578 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:08:19,579 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139680620100960
2025-11-29 13:08:20,092 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-11-29 13:08:20,096 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-11-29 13:08:20,096 - InferenceServer - INFO - Server Ready. Listening...
2025-11-29 13:09:36,069 - game3d.game.turnmove - INFO - Move 100: BLACK KNIGHT [4 2 7]->[4 4 8] (Capture)
2025-11-29 13:09:36,109 - game3d.game.turnmove - INFO - Move 100: WHITE SPIRAL [8 1 0]->[8 1 8] (Capture)
2025-11-29 13:09:36,150 - game3d.game.turnmove - INFO - Move 100: WHITE ROOK [5 5 1]->[5 5 2] (Capture)
2025-11-29 13:09:36,150 - game3d.game.turnmove - INFO - Move 100: WHITE BOMB [0 3 0]->[0 3 1] (Capture)
2025-11-29 13:09:36,186 - game3d.game.turnmove - INFO - Move 100: WHITE XYQUEEN [4 5 1]->[3 5 1] (Capture)
2025-11-29 13:09:36,353 - game3d.game.turnmove - INFO - Move 100: BLACK PAWN [0 8 6]->[0 7 6] (Move)
2025-11-29 13:09:43,769 - game3d.game.turnmove - INFO - Move 200: WHITE NEBULA [2 5 0]->[3 5 0] (Capture)
2025-11-29 13:09:43,845 - game3d.game.turnmove - INFO - Move 200: WHITE GEOMANCER [5 8 1]->[3 6 4] (Move)
2025-11-29 13:09:43,887 - game3d.game.turnmove - INFO - Move 200: BLACK ARMOUR [5 7 7]->[5 7 6] (Capture)
2025-11-29 13:09:44,051 - game3d.game.turnmove - INFO - Move 200: BLACK BISHOP [4 8 7]->[4 3 2] (Capture)
2025-11-29 13:09:50,049 - game3d.game.turnmove - INFO - Move 300: WHITE XZZIGZAG [5 8 5]->[2 8 7] (Capture)
2025-11-29 13:09:55,196 - game3d.game.turnmove - INFO - Move 300: WHITE ARCHER [1 5 1]->[2 4 1] (Move)
2025-11-29 13:10:09,893 - game3d.game.turnmove - INFO - Move 200: WHITE SPIRAL [3 1 7]->[5 1 7] (Capture)
2025-11-29 13:10:13,368 - game3d.game.turnmove - INFO - Move 200: WHITE ORBITER [8 4 0]->[8 3 3] (Capture)
2025-11-29 13:10:16,534 - game3d.game3d - ERROR - âŒ MOVE REJECTED - Wall move to [8 0 6] would place part of the wall out of bounds
2025-11-29 13:10:16,534 - worker.2 - ERROR - Worker 2 failed: Wall move to [8 0 6] would place part of the wall out of bounds
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 82, in submit_move
    raise InvalidMoveError(validation_error)
game3d.game3d.InvalidMoveError: Wall move to [8 0 6] would place part of the wall out of bounds
2025-11-29 13:10:16,542 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:10:16,542 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140491363118256
2025-11-29 13:10:18,797 - InferenceServer - INFO - Server shutting down.
2025-11-29 13:10:18,798 - training.parallel_self_play - INFO - Stopping Server...
2025-11-29 13:10:19,067 - __main__ - INFO - Training interrupted by user
2025-11-29 13:10:19,285 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-29 13:10:21,963 - __main__ - INFO - Final model saved to model_checkpoints/train_huge_20251129_130757/model_final.pt
2025-11-29 13:15:39,008 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-29 13:15:39,008 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:15:39,009 - __main__ - INFO - Testing move generation...
2025-11-29 13:15:39,618 - __main__ - INFO - [OK] Generated 624 moves
2025-11-29 13:15:39,618 - __main__ - INFO - Testing GameState caching...
2025-11-29 13:15:39,619 - __main__ - INFO - [OK] GameState caching works
2025-11-29 13:15:39,619 - __main__ - INFO - Testing MoveCache persistence...
2025-11-29 13:15:39,619 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-29 13:15:39,619 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(624), 'piece_moves_cache_size': 27, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-29 13:15:41,041 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251129_131535/temp_model_for_selfplay.pt
2025-11-29 13:15:41,041 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 12 games, 6 workers
2025-11-29 13:15:43,875 - training.parallel_self_play - INFO - Launching workers...
2025-11-29 13:15:51,945 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-11-29 13:15:55,563 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:15:55,565 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140033842635504
2025-11-29 13:15:55,857 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:15:55,859 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140521368337952
2025-11-29 13:15:56,053 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:15:56,054 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139821417627600
2025-11-29 13:15:56,113 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:15:56,114 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140195679567344
2025-11-29 13:15:56,366 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:15:56,367 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140429201686048
2025-11-29 13:15:56,485 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:15:56,486 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139641135971872
2025-11-29 13:15:57,882 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-11-29 13:15:57,887 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-11-29 13:15:57,887 - InferenceServer - INFO - Server Ready. Listening...
2025-11-29 13:16:50,318 - game3d.game.turnmove - INFO - Move 100: WHITE CONESLIDER [2 0 8]->[6 4 7] (Capture)
2025-11-29 13:17:00,269 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-29 13:17:00,308 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:17:00,308 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:17:00,308 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(3,3,8)
2025-11-29 13:17:00,308 - game3d.game.terminal - WARNING -   - Attackers: CONESLIDER at (3,4,8)
2025-11-29 13:17:00,335 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:17:00,335 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:17:00,335 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(3,3,8)
2025-11-29 13:17:00,335 - game3d.game.terminal - WARNING -   - Attackers: CONESLIDER at (3,4,8)
2025-11-29 13:17:00,378 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:17:00,378 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:17:00,378 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(3,3,8)
2025-11-29 13:17:00,378 - game3d.game.terminal - WARNING -   - Attackers: CONESLIDER at (3,4,8)
2025-11-29 13:17:00,407 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:17:00,407 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:17:00,407 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(3,3,8)
2025-11-29 13:17:00,407 - game3d.game.terminal - WARNING -   - Attackers: CONESLIDER at (3,4,8)
2025-11-29 13:17:00,446 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:17:00,446 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:17:00,446 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(3,3,8)
2025-11-29 13:17:00,446 - game3d.game.terminal - WARNING -   - Attackers: CONESLIDER at (3,4,8)
2025-11-29 13:17:00,490 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:17:00,490 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140424813958224
2025-11-29 13:17:02,517 - game3d.game.turnmove - INFO - Move 100: BLACK PAWN [1 6 6]->[2 5 7] (Capture)
2025-11-29 13:17:31,559 - game3d.game.turnmove - INFO - Move 100: BLACK YZZIGZAG [8 6 7]->[8 6 5] (Move)
2025-11-29 13:17:40,400 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-29 13:17:40,439 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:17:40,440 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:17:40,440 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:17:40,440 - game3d.game.terminal - WARNING -   - Attackers: QUEEN at (4,4,7)
2025-11-29 13:17:40,467 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:17:40,467 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:17:40,467 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:17:40,467 - game3d.game.terminal - WARNING -   - Attackers: QUEEN at (4,4,7)
2025-11-29 13:17:40,503 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:17:40,503 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:17:40,503 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:17:40,503 - game3d.game.terminal - WARNING -   - Attackers: QUEEN at (4,4,7)
2025-11-29 13:17:40,526 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:17:40,526 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:17:40,526 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:17:40,526 - game3d.game.terminal - WARNING -   - Attackers: QUEEN at (4,4,7)
2025-11-29 13:17:40,564 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:17:40,564 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:17:40,564 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:17:40,564 - game3d.game.terminal - WARNING -   - Attackers: QUEEN at (4,4,7)
2025-11-29 13:17:40,612 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:17:40,612 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140195668251728
2025-11-29 13:17:47,226 - game3d.game.turnmove - INFO - Move 100: BLACK QUEEN [4 6 2]->[5 6 1] (Capture)
2025-11-29 13:17:52,595 - game3d.game.turnmove - INFO - Move 200: WHITE ECHO [5 2 4]->[4 2 5] (Capture)
2025-11-29 13:17:54,607 - game3d.game.turnmove - INFO - Move 100: WHITE TRAILBLAZER [5 4 0]->[4 4 0] (Capture)
2025-11-29 13:18:08,078 - game3d.game.turnmove - INFO - Move 300: WHITE PANEL [4 4 2]->[4 4 3] (Move)
2025-11-29 13:18:30,266 - game3d.game.turnmove - INFO - Move 200: BLACK TRAILBLAZER [4 5 8]->[5 5 8] (Capture)
2025-11-29 13:18:35,328 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-29 13:18:35,356 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:18:35,356 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,0)
2025-11-29 13:18:35,356 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:18:35,356 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:18:35,387 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:18:35,387 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,0)
2025-11-29 13:18:35,387 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:18:35,387 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:18:35,423 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:18:35,423 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,0)
2025-11-29 13:18:35,423 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:18:35,423 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:18:35,449 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:18:35,449 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,0)
2025-11-29 13:18:35,449 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:18:35,449 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:18:35,485 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:18:35,485 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,0)
2025-11-29 13:18:35,485 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:18:35,485 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:18:35,606 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:18:35,606 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139821388093312
2025-11-29 13:18:41,937 - game3d.game.turnmove - INFO - Move 100: BLACK PAWN [7 7 6]->[8 6 5] (Capture)
2025-11-29 13:18:47,021 - game3d.game.turnmove - INFO - Move 200: BLACK XZZIGZAG [6 8 3]->[7 8 2] (Capture)
2025-11-29 13:18:51,142 - game3d.game.turnmove - INFO - Move 200: BLACK WALL [6 1 7]->[5 1 7] (Capture)
2025-11-29 13:18:52,375 - game3d.game.turnmove - INFO - Move 300: WHITE HIVE [2 3 0]->[3 3 0] (Move)
2025-11-29 13:19:02,531 - game3d.game.turnmove - INFO - Move 400: WHITE QUEEN [0 6 8]->[1 6 8] (Capture)
2025-11-29 13:19:17,654 - game3d.game.turnmove - INFO - Move 100: WHITE ROOK [5 5 1]->[4 5 1] (Capture)
2025-11-29 13:19:29,453 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-29 13:19:29,481 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:19:29,481 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(5,5,0)
2025-11-29 13:19:29,481 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:19:29,481 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (4,4,7)
2025-11-29 13:19:29,505 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:19:29,505 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(5,5,0)
2025-11-29 13:19:29,505 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:19:29,505 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (4,4,7)
2025-11-29 13:19:29,540 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:19:29,540 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(5,5,0)
2025-11-29 13:19:29,540 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:19:29,540 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (4,4,7)
2025-11-29 13:19:29,564 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:19:29,564 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(5,5,0)
2025-11-29 13:19:29,564 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:19:29,564 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (4,4,7)
2025-11-29 13:19:29,599 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:19:29,599 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(5,5,0)
2025-11-29 13:19:29,599 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:19:29,599 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (4,4,7)
2025-11-29 13:19:29,614 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-11-29 13:19:29,644 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:19:29,645 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:19:29,645 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-11-29 13:19:29,645 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,5,0)
2025-11-29 13:19:29,670 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:19:29,670 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:19:29,670 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-11-29 13:19:29,670 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,5,0)
2025-11-29 13:19:29,707 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:19:29,707 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:19:29,707 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-11-29 13:19:29,707 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,5,0)
2025-11-29 13:19:29,739 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:19:29,740 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:19:29,740 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-11-29 13:19:29,740 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,5,0)
2025-11-29 13:19:29,776 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:19:29,776 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:19:29,776 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-11-29 13:19:29,776 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,5,0)
2025-11-29 13:19:29,803 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:19:29,804 - game3d.cache.manager - DEBUG - Created cache manager #3 for board 140195863410864
2025-11-29 13:19:30,074 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:19:30,074 - game3d.cache.manager - DEBUG - Created cache manager #3 for board 139821391773216
2025-11-29 13:19:46,178 - game3d.game.turnmove - INFO - Move 100: BLACK WHITEHOLE [8 6 7]->[8 6 5] (Capture)
2025-11-29 13:20:07,767 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-11-29 13:20:07,791 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:20:07,791 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(5,4,0)
2025-11-29 13:20:07,791 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:20:07,791 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (5,4,1)
2025-11-29 13:20:07,811 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:20:07,811 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(5,4,0)
2025-11-29 13:20:07,811 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:20:07,811 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (5,4,1)
2025-11-29 13:20:07,838 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:20:07,838 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(5,4,0)
2025-11-29 13:20:07,838 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:20:07,838 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (5,4,1)
2025-11-29 13:20:07,858 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:20:07,858 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(5,4,0)
2025-11-29 13:20:07,859 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:20:07,859 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (5,4,1)
2025-11-29 13:20:07,887 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:20:07,887 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(5,4,0)
2025-11-29 13:20:07,887 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:20:07,887 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (5,4,1)
2025-11-29 13:20:07,970 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:20:07,970 - game3d.cache.manager - DEBUG - Created cache manager #3 for board 140424222808176
2025-11-29 13:20:17,468 - game3d.game.turnmove - INFO - Move 200: BLACK XZQUEEN [3 7 8]->[2 7 8] (Move)
2025-11-29 13:20:41,479 - game3d.game.turnmove - INFO - Move 100: BLACK KNIGHT31 [6 4 8]->[3 5 7] (Capture)
2025-11-29 13:21:02,315 - game3d.game.turnmove - INFO - Move 300: BLACK ROOK [3 5 7]->[3 7 7] (Capture)
2025-11-29 13:21:07,720 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-29 13:21:07,760 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:21:07,761 - game3d.game.terminal - WARNING -   - White: Priests=2, King=(4,4,0)
2025-11-29 13:21:07,761 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,5,7)
2025-11-29 13:21:07,761 - game3d.game.terminal - WARNING -   - Attackers: ECHO at (6,2,4)
2025-11-29 13:21:07,785 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:21:07,785 - game3d.game.terminal - WARNING -   - White: Priests=2, King=(4,4,0)
2025-11-29 13:21:07,785 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,5,7)
2025-11-29 13:21:07,785 - game3d.game.terminal - WARNING -   - Attackers: ECHO at (6,2,4)
2025-11-29 13:21:07,834 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:21:07,834 - game3d.game.terminal - WARNING -   - White: Priests=2, King=(4,4,0)
2025-11-29 13:21:07,834 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,5,7)
2025-11-29 13:21:07,834 - game3d.game.terminal - WARNING -   - Attackers: ECHO at (6,2,4)
2025-11-29 13:21:07,868 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:21:07,868 - game3d.game.terminal - WARNING -   - White: Priests=2, King=(4,4,0)
2025-11-29 13:21:07,868 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,5,7)
2025-11-29 13:21:07,869 - game3d.game.terminal - WARNING -   - Attackers: ECHO at (6,2,4)
2025-11-29 13:21:07,920 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:21:07,920 - game3d.game.terminal - WARNING -   - White: Priests=2, King=(4,4,0)
2025-11-29 13:21:07,921 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(5,5,7)
2025-11-29 13:21:07,921 - game3d.game.terminal - WARNING -   - Attackers: ECHO at (6,2,4)
2025-11-29 13:21:10,088 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: index 9 is out of bounds for axis 1 with size 9
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 225, in make_move
    cache_manager.occupancy_cache.batch_set_positions(changed_coords, pieces_data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 391, in batch_set_positions
    self._occ[x, y, z] = pieces[:, 1]  # colors
    ~~~~~~~~~^^^^^^^^^
IndexError: index 9 is out of bounds for axis 1 with size 9
2025-11-29 13:21:10,089 - worker.0 - ERROR - Worker 0 failed: Move execution failed: index 9 is out of bounds for axis 1 with size 9
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 225, in make_move
    cache_manager.occupancy_cache.batch_set_positions(changed_coords, pieces_data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 391, in batch_set_positions
    self._occ[x, y, z] = pieces[:, 1]  # colors
    ~~~~~~~~~^^^^^^^^^
IndexError: index 9 is out of bounds for axis 1 with size 9

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: index 9 is out of bounds for axis 1 with size 9
2025-11-29 13:21:17,340 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-29 13:21:45,599 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-29 13:21:45,630 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:21:45,630 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:21:45,630 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(3,2,5)
2025-11-29 13:21:45,630 - game3d.game.terminal - WARNING -   - Attackers: SPIRAL at (3,2,4), SPIRAL at (3,2,4), SPIRAL at (3,2,4), WHITEHOLE at (4,1,5)
2025-11-29 13:21:45,660 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:21:45,660 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:21:45,660 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(3,2,5)
2025-11-29 13:21:45,660 - game3d.game.terminal - WARNING -   - Attackers: SPIRAL at (3,2,4), SPIRAL at (3,2,4), SPIRAL at (3,2,4), WHITEHOLE at (4,1,5)
2025-11-29 13:21:45,692 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:21:45,692 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:21:45,692 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(3,2,5)
2025-11-29 13:21:45,692 - game3d.game.terminal - WARNING -   - Attackers: SPIRAL at (3,2,4), SPIRAL at (3,2,4), SPIRAL at (3,2,4), WHITEHOLE at (4,1,5)
2025-11-29 13:21:45,716 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:21:45,716 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:21:45,716 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(3,2,5)
2025-11-29 13:21:45,716 - game3d.game.terminal - WARNING -   - Attackers: SPIRAL at (3,2,4), SPIRAL at (3,2,4), SPIRAL at (3,2,4), WHITEHOLE at (4,1,5)
2025-11-29 13:21:45,755 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:21:45,755 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:21:45,755 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(3,2,5)
2025-11-29 13:21:45,755 - game3d.game.terminal - WARNING -   - Attackers: SPIRAL at (3,2,4), SPIRAL at (3,2,4), SPIRAL at (3,2,4), WHITEHOLE at (4,1,5)
2025-11-29 13:22:42,632 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-11-29 13:22:42,651 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:22:42,652 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:22:42,652 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,1,8)
2025-11-29 13:22:42,652 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (4,4,1)
2025-11-29 13:22:42,668 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:22:42,668 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:22:42,668 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,1,8)
2025-11-29 13:22:42,668 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (4,4,1)
2025-11-29 13:22:42,693 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:22:42,693 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:22:42,693 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,1,8)
2025-11-29 13:22:42,693 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (4,4,1)
2025-11-29 13:22:42,712 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:22:42,712 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:22:42,712 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,1,8)
2025-11-29 13:22:42,712 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (4,4,1)
2025-11-29 13:22:42,734 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:22:42,734 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:22:42,734 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,1,8)
2025-11-29 13:22:42,734 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (4,4,1)
2025-11-29 13:23:12,077 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-29 13:23:12,109 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:23:12,109 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:23:12,109 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(0,3,4)
2025-11-29 13:23:12,109 - game3d.game.terminal - WARNING -   - Attackers: CONESLIDER at (1,3,4)
2025-11-29 13:23:12,130 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:23:12,130 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:23:12,130 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(0,3,4)
2025-11-29 13:23:12,131 - game3d.game.terminal - WARNING -   - Attackers: CONESLIDER at (1,3,4)
2025-11-29 13:23:12,159 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:23:12,159 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:23:12,159 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(0,3,4)
2025-11-29 13:23:12,159 - game3d.game.terminal - WARNING -   - Attackers: CONESLIDER at (1,3,4)
2025-11-29 13:23:12,180 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:23:12,180 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:23:12,180 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(0,3,4)
2025-11-29 13:23:12,180 - game3d.game.terminal - WARNING -   - Attackers: CONESLIDER at (1,3,4)
2025-11-29 13:23:12,209 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:23:12,209 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:23:12,209 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(0,3,4)
2025-11-29 13:23:12,209 - game3d.game.terminal - WARNING -   - Attackers: CONESLIDER at (1,3,4)
2025-11-29 13:24:24,850 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-11-29 13:24:24,867 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:24:24,867 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(7,3,3)
2025-11-29 13:24:24,867 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,6,5)
2025-11-29 13:24:24,867 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (7,3,4)
2025-11-29 13:24:24,882 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:24:24,882 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(7,3,3)
2025-11-29 13:24:24,882 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,6,5)
2025-11-29 13:24:24,882 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (7,3,4)
2025-11-29 13:24:24,903 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:24:24,903 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(7,3,3)
2025-11-29 13:24:24,903 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,6,5)
2025-11-29 13:24:24,903 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (7,3,4)
2025-11-29 13:24:24,920 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:24:24,920 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(7,3,3)
2025-11-29 13:24:24,920 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,6,5)
2025-11-29 13:24:24,920 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (7,3,4)
2025-11-29 13:24:24,941 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:24:24,941 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(7,3,3)
2025-11-29 13:24:24,941 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,6,5)
2025-11-29 13:24:24,941 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (7,3,4)
2025-11-29 13:24:25,103 - training.parallel_self_play - INFO - Stopping Server...
2025-11-29 13:24:25,638 - InferenceServer - INFO - Server shutting down.
2025-11-29 13:27:40,187 - __main__ - ERROR - [ERROR] Unexpected error in iteration 0: cannot access local variable 'tracer_output' where it is not associated with a value
2025-11-29 13:27:40,187 - __main__ - CRITICAL - [ALERT] TRAINING CRASHED: cannot access local variable 'tracer_output' where it is not associated with a value
2025-11-29 13:27:40,496 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-29 13:28:48,898 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-29 13:28:48,899 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:28:48,900 - __main__ - INFO - Testing move generation...
2025-11-29 13:28:49,899 - __main__ - INFO - [OK] Generated 624 moves
2025-11-29 13:28:49,899 - __main__ - INFO - Testing GameState caching...
2025-11-29 13:28:49,899 - __main__ - INFO - [OK] GameState caching works
2025-11-29 13:28:49,900 - __main__ - INFO - Testing MoveCache persistence...
2025-11-29 13:28:49,900 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-29 13:28:49,900 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(624), 'piece_moves_cache_size': 27, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-29 13:28:51,394 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251129_132844/temp_model_for_selfplay.pt
2025-11-29 13:28:51,394 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 12 games, 6 workers
2025-11-29 13:28:54,212 - training.parallel_self_play - INFO - Launching workers...
2025-11-29 13:29:02,965 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-11-29 13:29:06,901 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:29:06,903 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139689042088656
2025-11-29 13:29:07,001 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:29:07,003 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140545307360848
2025-11-29 13:29:07,019 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:29:07,020 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140103291665760
2025-11-29 13:29:07,226 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:29:07,227 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140654820233936
2025-11-29 13:29:07,593 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:29:07,594 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140529346968496
2025-11-29 13:29:07,837 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:29:07,838 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140466470190048
2025-11-29 13:29:08,425 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-11-29 13:29:08,429 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-11-29 13:29:08,429 - InferenceServer - INFO - Server Ready. Listening...
2025-11-29 13:29:30,939 - game3d.game.turnmove - INFO - Move 100: WHITE BISHOP [6 0 3]->[3 0 6] (Capture)
2025-11-29 13:29:31,015 - game3d.game.turnmove - INFO - Move 100: WHITE XZZIGZAG [2 8 5]->[4 8 4] (Move)
2025-11-29 13:29:31,035 - game3d.game.turnmove - INFO - Move 100: WHITE ROOK [3 5 7]->[3 6 7] (Capture)
2025-11-29 13:29:36,429 - game3d.game.turnmove - INFO - Move 200: WHITE PAWN [4 1 2]->[5 2 1] (Capture)
2025-11-29 13:29:37,504 - game3d.game.turnmove - INFO - Move 100: WHITE EDGEROOK [2 0 0]->[3 1 0] (Capture)
2025-11-29 13:29:42,937 - game3d.game.turnmove - INFO - Move 200: BLACK FREEZER [1 0 7]->[2 1 6] (Move)
2025-11-29 13:29:57,965 - game3d.game.turnmove - INFO - Move 100: WHITE INFILTRATOR [2 3 1]->[3 4 2] (Move)
2025-11-29 13:30:09,309 - game3d.game.turnmove - INFO - Move 300: WHITE PAWN [2 1 2]->[3 2 1] (Capture)
2025-11-29 13:30:10,421 - game3d.game.turnmove - INFO - Move 200: BLACK QUEEN [2 3 7]->[2 3 0] (Move)
2025-11-29 13:30:15,490 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-29 13:30:15,516 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:30:15,516 - game3d.game.terminal - WARNING -   - White: Priests=2, King=(4,4,0)
2025-11-29 13:30:15,516 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:30:15,516 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:30:15,540 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:30:15,540 - game3d.game.terminal - WARNING -   - White: Priests=2, King=(4,4,0)
2025-11-29 13:30:15,540 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:30:15,540 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:30:15,575 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:30:15,575 - game3d.game.terminal - WARNING -   - White: Priests=2, King=(4,4,0)
2025-11-29 13:30:15,575 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:30:15,575 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:30:15,607 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:30:15,608 - game3d.game.terminal - WARNING -   - White: Priests=2, King=(4,4,0)
2025-11-29 13:30:15,608 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:30:15,608 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:30:15,634 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:30:15,634 - game3d.game.terminal - WARNING -   - White: Priests=2, King=(4,4,0)
2025-11-29 13:30:15,634 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:30:15,634 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:30:15,816 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:30:15,817 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140524364195600
2025-11-29 13:30:21,713 - game3d.game.turnmove - INFO - Move 100: WHITE KNIGHT31 [4 6 0]->[5 5 3] (Move)
2025-11-29 13:30:26,801 - game3d.game.turnmove - INFO - Move 200: WHITE MIRROR [4 7 0]->[4 7 1] (Move)
2025-11-29 13:30:27,948 - game3d.game.turnmove - INFO - Move 200: BLACK ROOK [5 5 7]->[5 5 3] (Capture)
2025-11-29 13:30:29,947 - game3d.game.turnmove - INFO - Move 100: WHITE XZQUEEN [8 0 5]->[7 0 6] (Capture)
2025-11-29 13:30:57,414 - game3d.game.turnmove - INFO - Move 200: WHITE WHITEHOLE [8 6 2]->[8 6 3] (Capture)
2025-11-29 13:31:02,944 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-11-29 13:31:02,964 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:31:02,964 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:31:02,964 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:31:02,964 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,1)
2025-11-29 13:31:02,981 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:31:02,981 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:31:02,982 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:31:02,982 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,1)
2025-11-29 13:31:03,008 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:31:03,008 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:31:03,008 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:31:03,008 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,1)
2025-11-29 13:31:03,028 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:31:03,028 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:31:03,029 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:31:03,029 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,1)
2025-11-29 13:31:03,056 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:31:03,056 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:31:03,056 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:31:03,056 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,1)
2025-11-29 13:31:03,265 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:31:03,265 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140466437740752
2025-11-29 13:31:08,886 - game3d.game.turnmove - INFO - Move 100: WHITE XZZIGZAG [1 8 7]->[2 8 7] (Capture)
2025-11-29 13:31:13,460 - game3d.game.turnmove - INFO - Piece captured by Trailblazer counters at [3 5 3]
2025-11-29 13:31:13,511 - game3d.game.turnmove - INFO - Move 200: WHITE MIRROR [7 4 0]->[8 5 1] (Move)
2025-11-29 13:31:24,907 - game3d.game.turnmove - INFO - Move 300: WHITE FREEZER [3 2 7]->[3 3 7] (Capture)
2025-11-29 13:31:29,690 - game3d.game.turnmove - INFO - Move 300: BLACK QUEEN [4 3 3]->[4 4 2] (Capture)
2025-11-29 13:31:40,742 - game3d.game.turnmove - INFO - Move 300: BLACK HIVE [4 1 7]->[3 2 6] (Capture)
2025-11-29 13:31:55,157 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-11-29 13:31:55,181 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:31:55,181 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,2,4)
2025-11-29 13:31:55,181 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-11-29 13:31:55,181 - game3d.game.terminal - WARNING -   - Attackers: KNIGHT31 at (3,1,7), KNIGHT31 at (5,1,7)
2025-11-29 13:31:55,198 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:31:55,198 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,2,4)
2025-11-29 13:31:55,198 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-11-29 13:31:55,198 - game3d.game.terminal - WARNING -   - Attackers: KNIGHT31 at (3,1,7), KNIGHT31 at (5,1,7)
2025-11-29 13:31:55,223 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:31:55,223 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,2,4)
2025-11-29 13:31:55,223 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-11-29 13:31:55,223 - game3d.game.terminal - WARNING -   - Attackers: KNIGHT31 at (3,1,7), KNIGHT31 at (5,1,7)
2025-11-29 13:31:55,244 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:31:55,244 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,2,4)
2025-11-29 13:31:55,244 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-11-29 13:31:55,244 - game3d.game.terminal - WARNING -   - Attackers: KNIGHT31 at (3,1,7), KNIGHT31 at (5,1,7)
2025-11-29 13:31:55,268 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 13:31:55,268 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,2,4)
2025-11-29 13:31:55,268 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-11-29 13:31:55,268 - game3d.game.terminal - WARNING -   - Attackers: KNIGHT31 at (3,1,7), KNIGHT31 at (5,1,7)
2025-11-29 13:31:55,459 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:31:55,460 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140103263755408
2025-11-29 13:31:59,831 - InferenceServer - INFO - Server shutting down.
2025-11-29 13:31:59,831 - training.parallel_self_play - INFO - Stopping Server...
2025-11-29 13:31:59,830 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _trace_reflector_ray at 0x7fcf89d2c900>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 105, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 305, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 358, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 312, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 170, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/reflector.py", line 158, in reflector_move_dispatcher
    return generate_reflecting_bishop_moves(
        cache_manager=state.cache_manager,
    ...<3 lines>...
        ignore_occupancy=ignore_occupancy
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/reflector.py", line 125, in generate_reflecting_bishop_moves
    coords, captures = _trace_reflector_ray(
                       ~~~~~~~~~~~~~~~~~~~~^
        occupancy=occupancy_flat,
        ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        ignore_occupancy=ignore_occupancy
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
SystemError: CPUDispatcher(<function _trace_reflector_ray at 0x7fcf89d2c900>) returned a result with an exception set
2025-11-29 13:31:59,831 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f0be33ec0e0>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 170, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: infiltrator_move_dispatcher() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f0be38ea160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 105, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 305, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 358, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 312, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 173, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 114, in infiltrator_move_dispatcher
    return generate_infiltrator_moves(state.cache_manager, state.color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 38, in generate_infiltrator_moves
    teleport_dirs = _get_pawn_front_directions(cache_manager, color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 77, in _get_pawn_front_directions
    _, piece_types = cache_manager.occupancy_cache.batch_get_attributes_unsafe(enemy_coords)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 259, in batch_get_attributes_unsafe
    return _vectorized_batch_attributes_unsafe_parallel(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f0be33ec0e0>) returned a result with an exception set
2025-11-29 13:31:59,835 - worker.5 - ERROR - Worker 5 failed: Move execution failed: CPUDispatcher(<function _trace_reflector_ray at 0x7fcf89d2c900>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 105, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 305, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 358, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 312, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 170, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/reflector.py", line 158, in reflector_move_dispatcher
    return generate_reflecting_bishop_moves(
        cache_manager=state.cache_manager,
    ...<3 lines>...
        ignore_occupancy=ignore_occupancy
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/reflector.py", line 125, in generate_reflecting_bishop_moves
    coords, captures = _trace_reflector_ray(
                       ~~~~~~~~~~~~~~~~~~~~^
        occupancy=occupancy_flat,
        ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        ignore_occupancy=ignore_occupancy
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
SystemError: CPUDispatcher(<function _trace_reflector_ray at 0x7fcf89d2c900>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _trace_reflector_ray at 0x7fcf89d2c900>) returned a result with an exception set
2025-11-29 13:31:59,835 - worker.1 - ERROR - Worker 1 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f0be33ec0e0>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 170, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: infiltrator_move_dispatcher() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f0be38ea160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 105, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 305, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 358, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 312, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 173, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 114, in infiltrator_move_dispatcher
    return generate_infiltrator_moves(state.cache_manager, state.color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 38, in generate_infiltrator_moves
    teleport_dirs = _get_pawn_front_directions(cache_manager, color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 77, in _get_pawn_front_directions
    _, piece_types = cache_manager.occupancy_cache.batch_get_attributes_unsafe(enemy_coords)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 259, in batch_get_attributes_unsafe
    return _vectorized_batch_attributes_unsafe_parallel(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f0be33ec0e0>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f0be33ec0e0>) returned a result with an exception set
2025-11-29 13:31:59,853 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:31:59,854 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139684024281136
2025-11-29 13:31:59,856 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:31:59,857 - game3d.cache.manager - DEBUG - Created cache manager #3 for board 140524361134384
2025-11-29 13:32:00,158 - __main__ - INFO - Training interrupted by user
2025-11-29 13:32:00,470 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-29 13:32:02,452 - __main__ - INFO - Final model saved to model_checkpoints/train_huge_20251129_132844/model_final.pt
2025-11-29 13:37:28,200 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-29 13:37:28,201 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:37:28,204 - __main__ - INFO - Testing move generation...
2025-11-29 13:37:35,950 - __main__ - INFO - [OK] Generated 624 moves
2025-11-29 13:37:35,950 - __main__ - INFO - Testing GameState caching...
2025-11-29 13:37:35,950 - __main__ - INFO - [OK] GameState caching works
2025-11-29 13:37:35,950 - __main__ - INFO - Testing MoveCache persistence...
2025-11-29 13:37:35,951 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-29 13:37:35,951 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(624), 'piece_moves_cache_size': 27, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-29 13:37:37,423 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251129_133724/temp_model_for_selfplay.pt
2025-11-29 13:37:37,423 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 12 games, 6 workers
2025-11-29 13:37:40,292 - training.parallel_self_play - INFO - Launching workers...
2025-11-29 13:37:49,793 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-11-29 13:37:53,271 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:37:53,273 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140023250490064
2025-11-29 13:37:53,387 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:37:53,388 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140179971931536
2025-11-29 13:37:53,608 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:37:53,609 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140244790737696
2025-11-29 13:37:53,643 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:37:53,644 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140045624179488
2025-11-29 13:37:53,670 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:37:53,671 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140335352020368
2025-11-29 13:37:53,695 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:37:53,696 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140656876911248
2025-11-29 13:37:55,100 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-11-29 13:37:55,105 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-11-29 13:37:55,105 - InferenceServer - INFO - Server Ready. Listening...
2025-11-29 13:38:17,403 - game3d.game.turnmove - INFO - Move 100: WHITE ROOK [6 2 4]->[6 2 6] (Capture)
2025-11-29 13:38:17,548 - game3d.game.turnmove - INFO - Move 100: WHITE ROOK [3 5 1]->[3 5 2] (Capture)
2025-11-29 13:38:17,589 - game3d.game.turnmove - INFO - Move 100: WHITE INFILTRATOR [3 3 1]->[3 3 2] (Capture)
2025-11-29 13:38:22,887 - game3d.game.turnmove - INFO - Move 200: BLACK PAWN [6 3 6]->[5 2 5] (Capture)
2025-11-29 13:38:30,616 - game3d.game.turnmove - INFO - Move 100: WHITE ECHO [3 8 0]->[4 7 0] (Move)
2025-11-29 13:38:34,934 - game3d.game.turnmove - INFO - Move 100: WHITE SPIRAL [8 0 5]->[8 0 6] (Capture)
2025-11-29 13:38:39,507 - game3d.game.turnmove - INFO - Move 200: WHITE MIRROR [1 4 0]->[2 5 0] (Move)
2025-11-29 13:39:05,622 - game3d.game.turnmove - INFO - Move 300: WHITE ROOK [3 6 2]->[3 6 6] (Capture)
2025-11-29 13:39:09,500 - game3d.game.turnmove - INFO - Move 200: WHITE YZZIGZAG [0 2 6]->[0 2 7] (Capture)
2025-11-29 13:39:21,090 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-29 13:39:21,131 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:39:21,131 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:39:21,131 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:39:21,132 - game3d.game.terminal - WARNING -   - Attackers: QUEEN at (4,4,7)
2025-11-29 13:39:21,167 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:39:21,167 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:39:21,167 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:39:21,167 - game3d.game.terminal - WARNING -   - Attackers: QUEEN at (4,4,7)
2025-11-29 13:39:21,209 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:39:21,209 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:39:21,209 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:39:21,209 - game3d.game.terminal - WARNING -   - Attackers: QUEEN at (4,4,7)
2025-11-29 13:39:21,237 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:39:21,237 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:39:21,237 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:39:21,237 - game3d.game.terminal - WARNING -   - Attackers: QUEEN at (4,4,7)
2025-11-29 13:39:21,285 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:39:21,285 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:39:21,285 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:39:21,285 - game3d.game.terminal - WARNING -   - Attackers: QUEEN at (4,4,7)
2025-11-29 13:39:21,347 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:39:21,348 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140330359870160
2025-11-29 13:39:27,245 - game3d.game.turnmove - INFO - Move 100: WHITE ROOK [3 5 1]->[3 5 2] (Capture)
2025-11-29 13:39:32,251 - game3d.game.turnmove - INFO - Move 200: WHITE ROOK [3 5 7]->[4 5 7] (Capture)
2025-11-29 13:39:36,529 - game3d.game.turnmove - INFO - Move 200: WHITE EDGEROOK [2 1 0]->[3 0 1] (Capture)
2025-11-29 13:39:37,355 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-29 13:39:37,378 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:39:37,378 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:39:37,378 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:39:37,378 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (4,4,7)
2025-11-29 13:39:37,400 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:39:37,400 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:39:37,400 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:39:37,400 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (4,4,7)
2025-11-29 13:39:37,434 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:39:37,434 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:39:37,434 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:39:37,434 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (4,4,7)
2025-11-29 13:39:37,460 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:39:37,460 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:39:37,460 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:39:37,460 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (4,4,7)
2025-11-29 13:39:37,491 - game3d.game.turnmove - INFO - Move 300: BLACK KNIGHT32 [3 5 5]->[5 7 2] (Capture)
2025-11-29 13:39:37,497 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:39:37,497 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:39:37,497 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:39:37,497 - game3d.game.terminal - WARNING -   - Attackers: PANEL at (4,4,7)
2025-11-29 13:39:37,605 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:39:37,605 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140651887677152
2025-11-29 13:39:43,382 - game3d.game.turnmove - INFO - Move 100: WHITE ORBITER [4 0 0]->[5 0 3] (Capture)
2025-11-29 13:39:54,789 - game3d.game.turnmove - INFO - Move 200: WHITE ECHO [3 8 0]->[3 8 1] (Move)
2025-11-29 13:40:02,646 - game3d.game.turnmove - INFO - Move 300: BLACK BLACKHOLE [6 0 7]->[6 1 7] (Capture)
2025-11-29 13:40:04,172 - game3d.game.turnmove - INFO - Move 400: WHITE YZQUEEN [4 6 7]->[4 5 8] (Move)
2025-11-29 13:40:13,316 - InferenceServer - INFO - Server shutting down.
2025-11-29 13:40:13,316 - training.parallel_self_play - INFO - Stopping Server...
2025-11-29 13:40:13,316 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f8d4a5e80e0>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f8d4aae6160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 105, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 305, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 358, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 232, in generate_pseudolegal_moves_batch
    colors_batch, types_batch = state.cache_manager.occupancy_cache.batch_get_attributes_unsafe(batch_coords)
                                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 259, in batch_get_attributes_unsafe
    return _vectorized_batch_attributes_unsafe_parallel(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f8d4a5e80e0>) returned a result with an exception set
2025-11-29 13:40:13,319 - worker.5 - ERROR - Worker 5 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f8d4a5e80e0>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f8d4aae6160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 105, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 305, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 358, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 232, in generate_pseudolegal_moves_batch
    colors_batch, types_batch = state.cache_manager.occupancy_cache.batch_get_attributes_unsafe(batch_coords)
                                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 259, in batch_get_attributes_unsafe
    return _vectorized_batch_attributes_unsafe_parallel(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f8d4a5e80e0>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f8d4a5e80e0>) returned a result with an exception set
2025-11-29 13:40:13,340 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:40:13,340 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140239202506624
2025-11-29 13:40:15,592 - __main__ - INFO - Training interrupted by user
2025-11-29 13:40:15,821 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-29 13:40:15,824 - torch._subclasses.fake_tensor - INFO - FakeTensor cache stats:
2025-11-29 13:40:15,824 - torch._subclasses.fake_tensor - INFO -   cache_hits: 0
2025-11-29 13:40:15,824 - torch._subclasses.fake_tensor - INFO -   cache_misses: 0
2025-11-29 13:40:17,842 - __main__ - INFO - Final model saved to model_checkpoints/train_huge_20251129_133724/model_final.pt
2025-11-29 13:49:42,258 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-29 13:49:42,259 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:49:42,260 - __main__ - INFO - Testing move generation...
2025-11-29 13:49:42,587 - __main__ - INFO - [OK] Generated 624 moves
2025-11-29 13:49:42,587 - __main__ - INFO - Testing GameState caching...
2025-11-29 13:49:42,587 - __main__ - INFO - [OK] GameState caching works
2025-11-29 13:49:42,587 - __main__ - INFO - Testing MoveCache persistence...
2025-11-29 13:49:42,588 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-29 13:49:42,588 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(624), 'piece_moves_cache_size': 27, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-29 13:49:44,030 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251129_134938/temp_model_for_selfplay.pt
2025-11-29 13:49:44,030 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 12 games, 6 workers
2025-11-29 13:49:46,826 - training.parallel_self_play - INFO - Launching workers...
2025-11-29 13:49:54,502 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-11-29 13:49:58,902 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:49:58,904 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140504766217136
2025-11-29 13:49:59,091 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:49:59,092 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140193236434032
2025-11-29 13:49:59,133 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:49:59,134 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140347659221792
2025-11-29 13:49:59,180 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:49:59,181 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140648100281744
2025-11-29 13:49:59,588 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:49:59,589 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139662642327520
2025-11-29 13:50:00,016 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:50:00,017 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140565111798704
2025-11-29 13:50:00,321 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-11-29 13:50:00,325 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-11-29 13:50:00,326 - InferenceServer - INFO - Server Ready. Listening...
2025-11-29 13:50:18,808 - game3d.game.turnmove - INFO - Move 100: BLACK PAWN [1 7 6]->[2 8 5] (Capture)
2025-11-29 13:50:19,024 - game3d.game.turnmove - INFO - Move 100: WHITE QUEEN [4 5 8]->[4 5 7] (Capture)
2025-11-29 13:50:46,348 - game3d.game.turnmove - INFO - Move 100: BLACK BLACKHOLE [2 8 5]->[2 7 4] (Capture)
2025-11-29 13:50:49,742 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-29 13:50:54,949 - game3d.game.turnmove - INFO - Move 100: WHITE TRIGONALBISHOP [5 6 2]->[1 2 6] (Capture)
2025-11-29 13:50:56,228 - game3d.game.turnmove - INFO - Move 200: BLACK YZQUEEN [3 7 8]->[3 7 7] (Capture)
2025-11-29 13:51:02,718 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-29 13:51:02,741 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:51:02,741 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:51:02,741 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:51:02,742 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:51:02,764 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:51:02,764 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:51:02,764 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:51:02,764 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:51:02,801 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:51:02,801 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:51:02,801 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:51:02,801 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:51:02,823 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:51:02,823 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:51:02,823 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:51:02,823 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:51:02,852 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:51:02,852 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 13:51:02,852 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:51:02,852 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:51:02,958 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:51:02,958 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140643108044368
2025-11-29 13:51:20,088 - game3d.game.turnmove - INFO - Move 100: WHITE INFILTRATOR [2 3 1]->[4 7 8] (Capture)
2025-11-29 13:51:28,352 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-29 13:51:28,397 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:51:28,397 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:51:28,397 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:51:28,397 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (3,4,8)
2025-11-29 13:51:28,420 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:51:28,421 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:51:28,421 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:51:28,421 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (3,4,8)
2025-11-29 13:51:28,466 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:51:28,466 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:51:28,466 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:51:28,467 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (3,4,8)
2025-11-29 13:51:28,491 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:51:28,491 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:51:28,491 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:51:28,491 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (3,4,8)
2025-11-29 13:51:28,533 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:51:28,533 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:51:28,533 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:51:28,533 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (3,4,8)
2025-11-29 13:51:28,715 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:51:28,715 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139662609124224
2025-11-29 13:51:33,530 - game3d.game.turnmove - INFO - Move 200: BLACK SLOWER [7 8 7]->[7 8 6] (Capture)
2025-11-29 13:51:53,826 - game3d.game.turnmove - INFO - Move 100: WHITE ROOK [3 4 7]->[4 4 7] (Move)
2025-11-29 13:52:22,310 - game3d.game.turnmove - INFO - Move 200: BLACK WHITEHOLE [8 6 7]->[8 6 6] (Capture)
2025-11-29 13:52:31,173 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-29 13:52:31,204 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:52:31,204 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:52:31,204 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:52:31,204 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:52:31,233 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:52:31,233 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:52:31,233 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:52:31,233 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:52:31,280 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:52:31,280 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:52:31,280 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:52:31,280 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:52:31,321 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:52:31,321 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:52:31,321 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:52:31,321 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:52:31,353 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:52:31,353 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:52:31,353 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:52:31,353 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:52:31,400 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:52:31,400 - game3d.cache.manager - DEBUG - Created cache manager #3 for board 139662609471024
2025-11-29 13:52:35,319 - game3d.game.turnmove - INFO - Move 200: WHITE PANEL [3 5 0]->[4 4 0] (Move)
2025-11-29 13:52:38,030 - game3d.game.turnmove - INFO - Move 100: WHITE ROOK [5 3 2]->[5 3 6] (Capture)
2025-11-29 13:53:10,395 - game3d.game.turnmove - INFO - Move 100: BLACK QUEEN [8 3 7]->[2 3 1] (Capture)
2025-11-29 13:53:26,382 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-29 13:53:26,416 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:53:26,416 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,0)
2025-11-29 13:53:26,416 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:53:26,416 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (5,4,8)
2025-11-29 13:53:26,435 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:53:26,435 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,0)
2025-11-29 13:53:26,435 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:53:26,435 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (5,4,8)
2025-11-29 13:53:26,466 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:53:26,466 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,0)
2025-11-29 13:53:26,466 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:53:26,466 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (5,4,8)
2025-11-29 13:53:26,492 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:53:26,492 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,0)
2025-11-29 13:53:26,492 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:53:26,492 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (5,4,8)
2025-11-29 13:53:26,519 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:53:26,519 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,5,0)
2025-11-29 13:53:26,519 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:53:26,519 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (5,4,8)
2025-11-29 13:53:26,654 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:53:26,655 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140499783760192
2025-11-29 13:53:37,986 - game3d.game.turnmove - INFO - Move 100: WHITE ROOK [5 3 2]->[5 3 6] (Capture)
2025-11-29 13:53:50,800 - game3d.game.turnmove - INFO - Move 200: BLACK TRAILBLAZER [4 4 8]->[4 5 8] (Capture)
2025-11-29 13:53:50,831 - game3d.game.turnmove - INFO - Move 300: WHITE ROOK [5 5 8]->[3 5 8] (Capture)
2025-11-29 13:54:09,339 - game3d.cache.caches.movecache - INFO - Checkmate detected for BLACK (Priests: 0)
2025-11-29 13:54:09,371 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:54:09,371 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:54:09,371 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:54:09,371 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:54:09,400 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:54:09,400 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:54:09,400 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:54:09,400 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:54:09,432 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:54:09,432 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:54:09,432 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:54:09,432 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:54:09,455 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:54:09,455 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:54:09,455 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:54:09,455 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:54:09,497 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: WHITE)
2025-11-29 13:54:09,497 - game3d.game.terminal - WARNING -   - White: Priests=1, King=(4,4,0)
2025-11-29 13:54:09,497 - game3d.game.terminal - WARNING -   - Black: Priests=0, King=(4,4,8)
2025-11-29 13:54:09,497 - game3d.game.terminal - WARNING -   - Attackers: ROOK at (4,4,7)
2025-11-29 13:54:09,594 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 13:54:09,594 - game3d.cache.manager - DEBUG - Created cache manager #3 for board 140499783760768
2025-11-29 13:54:15,247 - InferenceServer - INFO - Server shutting down.
2025-11-29 13:54:15,247 - training.parallel_self_play - INFO - Stopping Server...
2025-11-29 13:54:16,172 - __main__ - INFO - Training interrupted by user
2025-11-29 13:54:16,466 - __main__ - INFO - ðŸ§¹ Clearing all caches...
2025-11-29 13:54:18,512 - __main__ - INFO - Final model saved to model_checkpoints/train_huge_20251129_134938/model_final.pt
2025-11-29 14:03:38,729 - __main__ - INFO - [SEARCH] Validating game system integrity...
2025-11-29 14:03:38,730 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 14:03:38,731 - __main__ - INFO - Testing move generation...
2025-11-29 14:03:42,125 - __main__ - INFO - [OK] Generated 624 moves
2025-11-29 14:03:42,125 - __main__ - INFO - Testing GameState caching...
2025-11-29 14:03:42,125 - __main__ - INFO - [OK] GameState caching works
2025-11-29 14:03:42,125 - __main__ - INFO - Testing MoveCache persistence...
2025-11-29 14:03:42,126 - __main__ - INFO - [OK] MoveCache works correctly
2025-11-29 14:03:42,126 - __main__ - INFO - Final cache stats: {'legal_hit_rate': np.float64(0.6666666666666666), 'pseudolegal_hit_rate': np.float64(0.0), 'raw_hit_rate': np.float64(0.0), 'piece_hit_rate': np.float64(0.0), 'total_moves_cached': np.int32(624), 'piece_moves_cache_size': 27, 'prune_operations': 0, 'cache_hits': np.int32(2), 'cache_misses': np.int32(1)}
2025-11-29 14:03:43,654 - __main__ - INFO - Saved temporary checkpoint: model_checkpoints/train_huge_20251129_140334/temp_model_for_selfplay.pt
2025-11-29 14:03:43,654 - training.parallel_self_play - INFO - Starting Client-Server Self-Play: 12 games, 6 workers
2025-11-29 14:03:46,497 - training.parallel_self_play - INFO - Launching workers...
2025-11-29 14:03:55,953 - InferenceServer - INFO - Starting Server on cuda (Batch Size: 6)
2025-11-29 14:03:59,310 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 14:03:59,312 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139700931032112
2025-11-29 14:03:59,370 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 14:03:59,371 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140234386751392
2025-11-29 14:03:59,601 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 14:03:59,602 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 139709985488800
2025-11-29 14:03:59,729 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 14:03:59,730 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140237326925488
2025-11-29 14:03:59,841 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 14:03:59,842 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 14:03:59,842 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140147479646928
2025-11-29 14:03:59,843 - game3d.cache.manager - DEBUG - Created cache manager #1 for board 140676854430832
2025-11-29 14:04:01,583 - InferenceServer - INFO - Detected compiled model (OptimizedModule). Loading weights into underlying _orig_mod.
2025-11-29 14:04:01,588 - InferenceServer - INFO - Model already compiled (or compilation unavailable), skipping re-compile.
2025-11-29 14:04:01,588 - InferenceServer - INFO - Server Ready. Listening...
2025-11-29 14:04:24,681 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-11-29 14:04:24,712 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 14:04:24,712 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 14:04:24,712 - game3d.game.terminal - WARNING -   - Black: Priests=2, King=(4,4,8)
2025-11-29 14:04:24,712 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,5,7), VECTORSLIDER at (3,2,1)
2025-11-29 14:04:24,747 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 14:04:24,747 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 14:04:24,747 - game3d.game.terminal - WARNING -   - Black: Priests=2, King=(4,4,8)
2025-11-29 14:04:24,747 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,5,7), VECTORSLIDER at (3,2,1)
2025-11-29 14:04:24,793 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 14:04:24,793 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 14:04:24,793 - game3d.game.terminal - WARNING -   - Black: Priests=2, King=(4,4,8)
2025-11-29 14:04:24,793 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,5,7), VECTORSLIDER at (3,2,1)
2025-11-29 14:04:24,824 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 14:04:24,824 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 14:04:24,824 - game3d.game.terminal - WARNING -   - Black: Priests=2, King=(4,4,8)
2025-11-29 14:04:24,824 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,5,7), VECTORSLIDER at (3,2,1)
2025-11-29 14:04:24,869 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 14:04:24,869 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 14:04:24,869 - game3d.game.terminal - WARNING -   - Black: Priests=2, King=(4,4,8)
2025-11-29 14:04:24,869 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,5,7), VECTORSLIDER at (3,2,1)
2025-11-29 14:04:24,928 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 14:04:24,928 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139704993996496
2025-11-29 14:04:26,013 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-11-29 14:04:26,052 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 14:04:26,052 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 14:04:26,052 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-11-29 14:04:26,052 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,5,7), VECTORSLIDER at (5,6,1)
2025-11-29 14:04:26,081 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 14:04:26,081 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 14:04:26,081 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-11-29 14:04:26,081 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,5,7), VECTORSLIDER at (5,6,1)
2025-11-29 14:04:26,128 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 14:04:26,128 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 14:04:26,128 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-11-29 14:04:26,128 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,5,7), VECTORSLIDER at (5,6,1)
2025-11-29 14:04:26,155 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 14:04:26,155 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 14:04:26,155 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-11-29 14:04:26,155 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,5,7), VECTORSLIDER at (5,6,1)
2025-11-29 14:04:26,195 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 14:04:26,195 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 14:04:26,195 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-11-29 14:04:26,195 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,5,7), VECTORSLIDER at (5,6,1)
2025-11-29 14:04:26,249 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 14:04:26,249 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 140142313770240
2025-11-29 14:04:29,890 - game3d.game.turnmove - INFO - Move 100: BLACK PAWN [4 6 6]->[5 5 5] (Capture)
2025-11-29 14:04:36,814 - game3d.cache.caches.movecache - INFO - Checkmate detected for WHITE (Priests: 0)
2025-11-29 14:04:36,853 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 14:04:36,853 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 14:04:36,853 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-11-29 14:04:36,853 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,5,7), VECTORSLIDER at (3,2,1)
2025-11-29 14:04:36,881 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 14:04:36,881 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 14:04:36,881 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-11-29 14:04:36,881 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,5,7), VECTORSLIDER at (3,2,1)
2025-11-29 14:04:36,927 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 14:04:36,927 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 14:04:36,927 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-11-29 14:04:36,927 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,5,7), VECTORSLIDER at (3,2,1)
2025-11-29 14:04:36,962 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 14:04:36,962 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 14:04:36,962 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-11-29 14:04:36,962 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,5,7), VECTORSLIDER at (3,2,1)
2025-11-29 14:04:37,014 - game3d.game.terminal - WARNING - Game over: Checkmate (Winner: BLACK)
2025-11-29 14:04:37,014 - game3d.game.terminal - WARNING -   - White: Priests=0, King=(4,4,0)
2025-11-29 14:04:37,014 - game3d.game.terminal - WARNING -   - Black: Priests=1, King=(4,4,8)
2025-11-29 14:04:37,014 - game3d.game.terminal - WARNING -   - Attackers: INFILTRATOR at (6,5,7), VECTORSLIDER at (3,2,1)
2025-11-29 14:04:37,066 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 14:04:37,066 - game3d.cache.manager - DEBUG - Created cache manager #3 for board 140142315491760
2025-11-29 14:04:39,846 - game3d.game.turnmove - INFO - Move 100: BLACK PANEL [4 4 4]->[4 4 3] (Move)
2025-11-29 14:04:40,262 - InferenceServer - INFO - Server shutting down.
2025-11-29 14:04:40,263 - training.parallel_self_play - INFO - Stopping Server...
2025-11-29 14:04:40,262 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f0ea94e8400>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 170, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: infiltrator_move_dispatcher() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f0ea99de160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 105, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 305, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 358, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 312, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 173, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 114, in infiltrator_move_dispatcher
    return generate_infiltrator_moves(state.cache_manager, state.color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 38, in generate_infiltrator_moves
    teleport_dirs = _get_pawn_front_directions(cache_manager, color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 77, in _get_pawn_front_directions
    _, piece_types = cache_manager.occupancy_cache.batch_get_attributes_unsafe(enemy_coords)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 330, in batch_get_attributes_unsafe
    return _vectorized_batch_attributes_unsafe_parallel(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f0ea94e8400>) returned a result with an exception set
2025-11-29 14:04:40,264 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f76974ec400>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f76979ea160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 105, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 305, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 358, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 232, in generate_pseudolegal_moves_batch
    colors_batch, types_batch = state.cache_manager.occupancy_cache.batch_get_attributes_unsafe(batch_coords)
                                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 330, in batch_get_attributes_unsafe
    return _vectorized_batch_attributes_unsafe_parallel(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f76974ec400>) returned a result with an exception set
2025-11-29 14:04:40,263 - game3d.game3d - CRITICAL - ðŸš¨ MOVE EXECUTION FAILED: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f10c4fe4400>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 170, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: infiltrator_move_dispatcher() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f10c54e2160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 105, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 305, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 358, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 312, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 173, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 114, in infiltrator_move_dispatcher
    return generate_infiltrator_moves(state.cache_manager, state.color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 38, in generate_infiltrator_moves
    teleport_dirs = _get_pawn_front_directions(cache_manager, color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 77, in _get_pawn_front_directions
    _, piece_types = cache_manager.occupancy_cache.batch_get_attributes_unsafe(enemy_coords)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 330, in batch_get_attributes_unsafe
    return _vectorized_batch_attributes_unsafe_parallel(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f10c4fe4400>) returned a result with an exception set
2025-11-29 14:04:40,265 - worker.0 - ERROR - Worker 0 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f0ea94e8400>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 170, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: infiltrator_move_dispatcher() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f0ea99de160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 105, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 305, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 358, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 312, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 173, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 114, in infiltrator_move_dispatcher
    return generate_infiltrator_moves(state.cache_manager, state.color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 38, in generate_infiltrator_moves
    teleport_dirs = _get_pawn_front_directions(cache_manager, color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 77, in _get_pawn_front_directions
    _, piece_types = cache_manager.occupancy_cache.batch_get_attributes_unsafe(enemy_coords)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 330, in batch_get_attributes_unsafe
    return _vectorized_batch_attributes_unsafe_parallel(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f0ea94e8400>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f0ea94e8400>) returned a result with an exception set
2025-11-29 14:04:40,266 - worker.2 - ERROR - Worker 2 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f76974ec400>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f76979ea160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 105, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 305, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 358, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 232, in generate_pseudolegal_moves_batch
    colors_batch, types_batch = state.cache_manager.occupancy_cache.batch_get_attributes_unsafe(batch_coords)
                                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 330, in batch_get_attributes_unsafe
    return _vectorized_batch_attributes_unsafe_parallel(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f76974ec400>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f76974ec400>) returned a result with an exception set
2025-11-29 14:04:40,267 - worker.3 - ERROR - Worker 3 failed: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f10c4fe4400>) returned a result with an exception set
Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 170, in _process_piece_type
    raw_moves = dispatcher(state, coord, ignore_occupancy=ignore_occupancy)
TypeError: infiltrator_move_dispatcher() got an unexpected keyword argument 'ignore_occupancy'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3dgame/venv/lib/python3.13/site-packages/numba/core/serialize.py", line 30, in _numba_unpickle
    def _numba_unpickle(address, bytedata, hashed):
    
KeyboardInterrupt

The above exception was the direct cause of the following exception:

SystemError: <function _numba_unpickle at 0x7f10c54e2160> returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 95, in submit_move
    new_state = turnmove.make_move(self._state, move_array)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game/turnmove.py", line 341, in make_move
    gen_module._generator.update_legal_moves_incremental(game_state)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 487, in update_legal_moves_incremental
    all_moves = self._apply_all_filters(state, all_moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 360, in _apply_all_filters
    moves = filter_safe_moves_optimized(state, moves)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/generator.py", line 140, in filter_safe_moves_optimized
    if move_would_leave_king_in_check(game_state, moves[i]):
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 105, in move_would_leave_king_in_check
    is_check = square_attacked_by_incremental(
        game_state.board,
    ...<4 lines>...
        to_coord
    )
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 305, in square_attacked_by_incremental
    return _square_attacked_by_slow(board, square, attacker_color, cache)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/attacks/check.py", line 358, in _square_attacked_by_slow
    moves = generate_pseudolegal_moves_batch(dummy_state, attacker_positions)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 312, in generate_pseudolegal_moves_batch
    piece_moves = _process_piece_type(state, piece_type, indices, batch_coords,
                                     dispatcher, ignore_occupancy)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/movement/pseudolegal.py", line 173, in _process_piece_type
    raw_moves = dispatcher(state, coord)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 114, in infiltrator_move_dispatcher
    return generate_infiltrator_moves(state.cache_manager, state.color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 38, in generate_infiltrator_moves
    teleport_dirs = _get_pawn_front_directions(cache_manager, color, pos)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/pieces/pieces/infiltrator.py", line 77, in _get_pawn_front_directions
    _, piece_types = cache_manager.occupancy_cache.batch_get_attributes_unsafe(enemy_coords)
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/cache/caches/occupancycache.py", line 330, in batch_get_attributes_unsafe
    return _vectorized_batch_attributes_unsafe_parallel(self._occ, self._ptype, coords)
SystemError: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f10c4fe4400>) returned a result with an exception set

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/training/parallel_self_play.py", line 300, in _game_worker_client
    receipt = game.submit_move(submit_move)
  File "/home/salamimommy/Documents/code/3d-chess-for-AI/game3d/game3d.py", line 98, in submit_move
    raise InvalidMoveError(f"Move execution failed: {e}") from e
game3d.game3d.InvalidMoveError: Move execution failed: CPUDispatcher(<function _vectorized_batch_attributes_unsafe_parallel at 0x7f10c4fe4400>) returned a result with an exception set
2025-11-29 14:04:40,276 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 14:04:40,276 - game3d.cache.manager - DEBUG - Created cache manager #2 for board 139695930017248
2025-11-29 14:04:40,284 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 14:04:40,284 - game3d.cache.manager - DEBUG - Created cache manager #4 for board 140142307664000
2025-11-29 14:04:40,284 - game3d.cache.manager - INFO - Initialized occupancy cache from board setup: 486 pieces
2025-11-29 14:04:40,285 - game3d.cache.manager - DEBUG - Created cache manager #3 for board 139704996724112
2025-11-29 14:04:40,520 - __main__ - INFO - Training interrupted by user
2025-11-29 14:04:40,746 - __main__ - INFO - ðŸ§¹ Clearing all caches...
